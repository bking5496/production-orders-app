(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))c(x);new MutationObserver(x=>{for(const y of x)if(y.type==="childList")for(const S of y.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&c(S)}).observe(document,{childList:!0,subtree:!0});function h(x){const y={};return x.integrity&&(y.integrity=x.integrity),x.referrerPolicy&&(y.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?y.credentials="include":x.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function c(x){if(x.ep)return;x.ep=!0;const y=h(x);fetch(x.href,y)}})();function Gc(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Ec={exports:{}},Hn={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q0;function Uf(){if(q0)return Hn;q0=1;var o=Symbol.for("react.transitional.element"),i=Symbol.for("react.fragment");function h(c,x,y){var S=null;if(y!==void 0&&(S=""+y),x.key!==void 0&&(S=""+x.key),"key"in x){y={};for(var A in x)A!=="key"&&(y[A]=x[A])}else y=x;return x=y.ref,{$$typeof:o,type:c,key:S,ref:x!==void 0?x:null,props:y}}return Hn.Fragment=i,Hn.jsx=h,Hn.jsxs=h,Hn}var P0;function qf(){return P0||(P0=1,Ec.exports=Uf()),Ec.exports}var e=qf(),Bc={exports:{}},st={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H0;function Pf(){if(H0)return st;H0=1;var o=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),S=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),F=Symbol.iterator;function U(d){return d===null||typeof d!="object"?null:(d=F&&d[F]||d["@@iterator"],typeof d=="function"?d:null)}var se={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G=Object.assign,W={};function N(d,T,E){this.props=d,this.context=T,this.refs=W,this.updater=E||se}N.prototype.isReactComponent={},N.prototype.setState=function(d,T){if(typeof d!="object"&&typeof d!="function"&&d!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,d,T,"setState")},N.prototype.forceUpdate=function(d){this.updater.enqueueForceUpdate(this,d,"forceUpdate")};function g(){}g.prototype=N.prototype;function M(d,T,E){this.props=d,this.context=T,this.refs=W,this.updater=E||se}var Y=M.prototype=new g;Y.constructor=M,G(Y,N.prototype),Y.isPureReactComponent=!0;var Z=Array.isArray,le={H:null,A:null,T:null,S:null,V:null},ke=Object.prototype.hasOwnProperty;function Be(d,T,E,R,Q,Ce){return E=Ce.ref,{$$typeof:o,type:d,key:T,ref:E!==void 0?E:null,props:Ce}}function je(d,T){return Be(d.type,T,void 0,void 0,void 0,d.props)}function Ee(d){return typeof d=="object"&&d!==null&&d.$$typeof===o}function D(d){var T={"=":"=0",":":"=2"};return"$"+d.replace(/[=:]/g,function(E){return T[E]})}var ve=/\/+/g;function ee(d,T){return typeof d=="object"&&d!==null&&d.key!=null?D(""+d.key):T.toString(36)}function Ae(){}function $(d){switch(d.status){case"fulfilled":return d.value;case"rejected":throw d.reason;default:switch(typeof d.status=="string"?d.then(Ae,Ae):(d.status="pending",d.then(function(T){d.status==="pending"&&(d.status="fulfilled",d.value=T)},function(T){d.status==="pending"&&(d.status="rejected",d.reason=T)})),d.status){case"fulfilled":return d.value;case"rejected":throw d.reason}}throw d}function C(d,T,E,R,Q){var Ce=typeof d;(Ce==="undefined"||Ce==="boolean")&&(d=null);var Me=!1;if(d===null)Me=!0;else switch(Ce){case"bigint":case"string":case"number":Me=!0;break;case"object":switch(d.$$typeof){case o:case i:Me=!0;break;case v:return Me=d._init,C(Me(d._payload),T,E,R,Q)}}if(Me)return Q=Q(d),Me=R===""?"."+ee(d,0):R,Z(Q)?(E="",Me!=null&&(E=Me.replace(ve,"$&/")+"/"),C(Q,T,E,"",function(ge){return ge})):Q!=null&&(Ee(Q)&&(Q=je(Q,E+(Q.key==null||d&&d.key===Q.key?"":(""+Q.key).replace(ve,"$&/")+"/")+Me)),T.push(Q)),1;Me=0;var He=R===""?".":R+":";if(Z(d))for(var I=0;I<d.length;I++)R=d[I],Ce=He+ee(R,I),Me+=C(R,T,E,Ce,Q);else if(I=U(d),typeof I=="function")for(d=I.call(d),I=0;!(R=d.next()).done;)R=R.value,Ce=He+ee(R,I++),Me+=C(R,T,E,Ce,Q);else if(Ce==="object"){if(typeof d.then=="function")return C($(d),T,E,R,Q);throw T=String(d),Error("Objects are not valid as a React child (found: "+(T==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":T)+"). If you meant to render a collection of children, use an array instead.")}return Me}function O(d,T,E){if(d==null)return d;var R=[],Q=0;return C(d,R,"","",function(Ce){return T.call(E,Ce,Q++)}),R}function q(d){if(d._status===-1){var T=d._result;T=T(),T.then(function(E){(d._status===0||d._status===-1)&&(d._status=1,d._result=E)},function(E){(d._status===0||d._status===-1)&&(d._status=2,d._result=E)}),d._status===-1&&(d._status=0,d._result=T)}if(d._status===1)return d._result.default;throw d._result}var z=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var T=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(T))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)};function H(){}return st.Children={map:O,forEach:function(d,T,E){O(d,function(){T.apply(this,arguments)},E)},count:function(d){var T=0;return O(d,function(){T++}),T},toArray:function(d){return O(d,function(T){return T})||[]},only:function(d){if(!Ee(d))throw Error("React.Children.only expected to receive a single React element child.");return d}},st.Component=N,st.Fragment=h,st.Profiler=x,st.PureComponent=M,st.StrictMode=c,st.Suspense=j,st.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=le,st.__COMPILER_RUNTIME={__proto__:null,c:function(d){return le.H.useMemoCache(d)}},st.cache=function(d){return function(){return d.apply(null,arguments)}},st.cloneElement=function(d,T,E){if(d==null)throw Error("The argument must be a React element, but you passed "+d+".");var R=G({},d.props),Q=d.key,Ce=void 0;if(T!=null)for(Me in T.ref!==void 0&&(Ce=void 0),T.key!==void 0&&(Q=""+T.key),T)!ke.call(T,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&T.ref===void 0||(R[Me]=T[Me]);var Me=arguments.length-2;if(Me===1)R.children=E;else if(1<Me){for(var He=Array(Me),I=0;I<Me;I++)He[I]=arguments[I+2];R.children=He}return Be(d.type,Q,void 0,void 0,Ce,R)},st.createContext=function(d){return d={$$typeof:S,_currentValue:d,_currentValue2:d,_threadCount:0,Provider:null,Consumer:null},d.Provider=d,d.Consumer={$$typeof:y,_context:d},d},st.createElement=function(d,T,E){var R,Q={},Ce=null;if(T!=null)for(R in T.key!==void 0&&(Ce=""+T.key),T)ke.call(T,R)&&R!=="key"&&R!=="__self"&&R!=="__source"&&(Q[R]=T[R]);var Me=arguments.length-2;if(Me===1)Q.children=E;else if(1<Me){for(var He=Array(Me),I=0;I<Me;I++)He[I]=arguments[I+2];Q.children=He}if(d&&d.defaultProps)for(R in Me=d.defaultProps,Me)Q[R]===void 0&&(Q[R]=Me[R]);return Be(d,Ce,void 0,void 0,null,Q)},st.createRef=function(){return{current:null}},st.forwardRef=function(d){return{$$typeof:A,render:d}},st.isValidElement=Ee,st.lazy=function(d){return{$$typeof:v,_payload:{_status:-1,_result:d},_init:q}},st.memo=function(d,T){return{$$typeof:f,type:d,compare:T===void 0?null:T}},st.startTransition=function(d){var T=le.T,E={};le.T=E;try{var R=d(),Q=le.S;Q!==null&&Q(E,R),typeof R=="object"&&R!==null&&typeof R.then=="function"&&R.then(H,z)}catch(Ce){z(Ce)}finally{le.T=T}},st.unstable_useCacheRefresh=function(){return le.H.useCacheRefresh()},st.use=function(d){return le.H.use(d)},st.useActionState=function(d,T,E){return le.H.useActionState(d,T,E)},st.useCallback=function(d,T){return le.H.useCallback(d,T)},st.useContext=function(d){return le.H.useContext(d)},st.useDebugValue=function(){},st.useDeferredValue=function(d,T){return le.H.useDeferredValue(d,T)},st.useEffect=function(d,T,E){var R=le.H;if(typeof E=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return R.useEffect(d,T)},st.useId=function(){return le.H.useId()},st.useImperativeHandle=function(d,T,E){return le.H.useImperativeHandle(d,T,E)},st.useInsertionEffect=function(d,T){return le.H.useInsertionEffect(d,T)},st.useLayoutEffect=function(d,T){return le.H.useLayoutEffect(d,T)},st.useMemo=function(d,T){return le.H.useMemo(d,T)},st.useOptimistic=function(d,T){return le.H.useOptimistic(d,T)},st.useReducer=function(d,T,E){return le.H.useReducer(d,T,E)},st.useRef=function(d){return le.H.useRef(d)},st.useState=function(d){return le.H.useState(d)},st.useSyncExternalStore=function(d,T,E){return le.H.useSyncExternalStore(d,T,E)},st.useTransition=function(){return le.H.useTransition()},st.version="19.1.0",st}var V0;function Fc(){return V0||(V0=1,Bc.exports=Pf()),Bc.exports}var u=Fc();const ka=Gc(u);var kc={exports:{}},Vn={},Tc={exports:{}},Dc={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I0;function Hf(){return I0||(I0=1,function(o){function i(O,q){var z=O.length;O.push(q);e:for(;0<z;){var H=z-1>>>1,d=O[H];if(0<x(d,q))O[H]=q,O[z]=d,z=H;else break e}}function h(O){return O.length===0?null:O[0]}function c(O){if(O.length===0)return null;var q=O[0],z=O.pop();if(z!==q){O[0]=z;e:for(var H=0,d=O.length,T=d>>>1;H<T;){var E=2*(H+1)-1,R=O[E],Q=E+1,Ce=O[Q];if(0>x(R,z))Q<d&&0>x(Ce,R)?(O[H]=Ce,O[Q]=z,H=Q):(O[H]=R,O[E]=z,H=E);else if(Q<d&&0>x(Ce,z))O[H]=Ce,O[Q]=z,H=Q;else break e}}return q}function x(O,q){var z=O.sortIndex-q.sortIndex;return z!==0?z:O.id-q.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var y=performance;o.unstable_now=function(){return y.now()}}else{var S=Date,A=S.now();o.unstable_now=function(){return S.now()-A}}var j=[],f=[],v=1,F=null,U=3,se=!1,G=!1,W=!1,N=!1,g=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,Y=typeof setImmediate<"u"?setImmediate:null;function Z(O){for(var q=h(f);q!==null;){if(q.callback===null)c(f);else if(q.startTime<=O)c(f),q.sortIndex=q.expirationTime,i(j,q);else break;q=h(f)}}function le(O){if(W=!1,Z(O),!G)if(h(j)!==null)G=!0,ke||(ke=!0,ee());else{var q=h(f);q!==null&&C(le,q.startTime-O)}}var ke=!1,Be=-1,je=5,Ee=-1;function D(){return N?!0:!(o.unstable_now()-Ee<je)}function ve(){if(N=!1,ke){var O=o.unstable_now();Ee=O;var q=!0;try{e:{G=!1,W&&(W=!1,M(Be),Be=-1),se=!0;var z=U;try{t:{for(Z(O),F=h(j);F!==null&&!(F.expirationTime>O&&D());){var H=F.callback;if(typeof H=="function"){F.callback=null,U=F.priorityLevel;var d=H(F.expirationTime<=O);if(O=o.unstable_now(),typeof d=="function"){F.callback=d,Z(O),q=!0;break t}F===h(j)&&c(j),Z(O)}else c(j);F=h(j)}if(F!==null)q=!0;else{var T=h(f);T!==null&&C(le,T.startTime-O),q=!1}}break e}finally{F=null,U=z,se=!1}q=void 0}}finally{q?ee():ke=!1}}}var ee;if(typeof Y=="function")ee=function(){Y(ve)};else if(typeof MessageChannel<"u"){var Ae=new MessageChannel,$=Ae.port2;Ae.port1.onmessage=ve,ee=function(){$.postMessage(null)}}else ee=function(){g(ve,0)};function C(O,q){Be=g(function(){O(o.unstable_now())},q)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(O){O.callback=null},o.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):je=0<O?Math.floor(1e3/O):5},o.unstable_getCurrentPriorityLevel=function(){return U},o.unstable_next=function(O){switch(U){case 1:case 2:case 3:var q=3;break;default:q=U}var z=U;U=q;try{return O()}finally{U=z}},o.unstable_requestPaint=function(){N=!0},o.unstable_runWithPriority=function(O,q){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var z=U;U=O;try{return q()}finally{U=z}},o.unstable_scheduleCallback=function(O,q,z){var H=o.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?H+z:H):z=H,O){case 1:var d=-1;break;case 2:d=250;break;case 5:d=1073741823;break;case 4:d=1e4;break;default:d=5e3}return d=z+d,O={id:v++,callback:q,priorityLevel:O,startTime:z,expirationTime:d,sortIndex:-1},z>H?(O.sortIndex=z,i(f,O),h(j)===null&&O===h(f)&&(W?(M(Be),Be=-1):W=!0,C(le,z-H))):(O.sortIndex=d,i(j,O),G||se||(G=!0,ke||(ke=!0,ee()))),O},o.unstable_shouldYield=D,o.unstable_wrapCallback=function(O){var q=U;return function(){var z=U;U=q;try{return O.apply(this,arguments)}finally{U=z}}}}(Dc)),Dc}var G0;function Vf(){return G0||(G0=1,Tc.exports=Hf()),Tc.exports}var Lc={exports:{}},ls={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F0;function If(){if(F0)return ls;F0=1;var o=Fc();function i(j){var f="https://react.dev/errors/"+j;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)f+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+j+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function h(){}var c={d:{f:h,r:function(){throw Error(i(522))},D:h,C:h,L:h,m:h,X:h,S:h,M:h},p:0,findDOMNode:null},x=Symbol.for("react.portal");function y(j,f,v){var F=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:x,key:F==null?null:""+F,children:j,containerInfo:f,implementation:v}}var S=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function A(j,f){if(j==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return ls.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=c,ls.createPortal=function(j,f){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(i(299));return y(j,f,null,v)},ls.flushSync=function(j){var f=S.T,v=c.p;try{if(S.T=null,c.p=2,j)return j()}finally{S.T=f,c.p=v,c.d.f()}},ls.preconnect=function(j,f){typeof j=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,c.d.C(j,f))},ls.prefetchDNS=function(j){typeof j=="string"&&c.d.D(j)},ls.preinit=function(j,f){if(typeof j=="string"&&f&&typeof f.as=="string"){var v=f.as,F=A(v,f.crossOrigin),U=typeof f.integrity=="string"?f.integrity:void 0,se=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;v==="style"?c.d.S(j,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:F,integrity:U,fetchPriority:se}):v==="script"&&c.d.X(j,{crossOrigin:F,integrity:U,fetchPriority:se,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},ls.preinitModule=function(j,f){if(typeof j=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var v=A(f.as,f.crossOrigin);c.d.M(j,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&c.d.M(j)},ls.preload=function(j,f){if(typeof j=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var v=f.as,F=A(v,f.crossOrigin);c.d.L(j,v,{crossOrigin:F,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},ls.preloadModule=function(j,f){if(typeof j=="string")if(f){var v=A(f.as,f.crossOrigin);c.d.m(j,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else c.d.m(j)},ls.requestFormReset=function(j){c.d.r(j)},ls.unstable_batchedUpdates=function(j,f){return j(f)},ls.useFormState=function(j,f,v){return S.H.useFormState(j,f,v)},ls.useFormStatus=function(){return S.H.useHostTransitionStatus()},ls.version="19.1.0",ls}var Q0;function dh(){if(Q0)return Lc.exports;Q0=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(i){console.error(i)}}return o(),Lc.exports=If(),Lc.exports}var X0;function Gf(){if(X0)return Vn;X0=1;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o=Vf(),i=Fc(),h=dh();function c(t){var s="https://react.dev/errors/"+t;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)s+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function x(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function y(t){var s=t,a=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,(s.flags&4098)!==0&&(a=s.return),t=s.return;while(t)}return s.tag===3?a:null}function S(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function A(t){if(y(t)!==t)throw Error(c(188))}function j(t){var s=t.alternate;if(!s){if(s=y(t),s===null)throw Error(c(188));return s!==t?null:t}for(var a=t,l=s;;){var n=a.return;if(n===null)break;var r=n.alternate;if(r===null){if(l=n.return,l!==null){a=l;continue}break}if(n.child===r.child){for(r=n.child;r;){if(r===a)return A(n),t;if(r===l)return A(n),s;r=r.sibling}throw Error(c(188))}if(a.return!==l.return)a=n,l=r;else{for(var m=!1,w=n.child;w;){if(w===a){m=!0,a=n,l=r;break}if(w===l){m=!0,l=n,a=r;break}w=w.sibling}if(!m){for(w=r.child;w;){if(w===a){m=!0,a=r,l=n;break}if(w===l){m=!0,l=r,a=n;break}w=w.sibling}if(!m)throw Error(c(189))}}if(a.alternate!==l)throw Error(c(190))}if(a.tag!==3)throw Error(c(188));return a.stateNode.current===a?t:s}function f(t){var s=t.tag;if(s===5||s===26||s===27||s===6)return t;for(t=t.child;t!==null;){if(s=f(t),s!==null)return s;t=t.sibling}return null}var v=Object.assign,F=Symbol.for("react.element"),U=Symbol.for("react.transitional.element"),se=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),M=Symbol.for("react.consumer"),Y=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),le=Symbol.for("react.suspense"),ke=Symbol.for("react.suspense_list"),Be=Symbol.for("react.memo"),je=Symbol.for("react.lazy"),Ee=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),ve=Symbol.iterator;function ee(t){return t===null||typeof t!="object"?null:(t=ve&&t[ve]||t["@@iterator"],typeof t=="function"?t:null)}var Ae=Symbol.for("react.client.reference");function $(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===Ae?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case G:return"Fragment";case N:return"Profiler";case W:return"StrictMode";case le:return"Suspense";case ke:return"SuspenseList";case Ee:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case se:return"Portal";case Y:return(t.displayName||"Context")+".Provider";case M:return(t._context.displayName||"Context")+".Consumer";case Z:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Be:return s=t.displayName||null,s!==null?s:$(t.type)||"Memo";case je:s=t._payload,t=t._init;try{return $(t(s))}catch{}}return null}var C=Array.isArray,O=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=h.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z={pending:!1,data:null,method:null,action:null},H=[],d=-1;function T(t){return{current:t}}function E(t){0>d||(t.current=H[d],H[d]=null,d--)}function R(t,s){d++,H[d]=t.current,t.current=s}var Q=T(null),Ce=T(null),Me=T(null),He=T(null);function I(t,s){switch(R(Me,s),R(Ce,t),R(Q,null),s.nodeType){case 9:case 11:t=(t=s.documentElement)&&(t=t.namespaceURI)?f0(t):0;break;default:if(t=s.tagName,s=s.namespaceURI)s=f0(s),t=g0(s,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}E(Q),R(Q,t)}function ge(){E(Q),E(Ce),E(Me)}function oe(t){t.memoizedState!==null&&R(He,t);var s=Q.current,a=g0(s,t.type);s!==a&&(R(Ce,t),R(Q,a))}function Le(t){Ce.current===t&&(E(Q),E(Ce)),He.current===t&&(E(He),Yn._currentValue=z)}var ye=Object.prototype.hasOwnProperty,Ue=o.unstable_scheduleCallback,pe=o.unstable_cancelCallback,Se=o.unstable_shouldYield,ze=o.unstable_requestPaint,Ye=o.unstable_now,Qe=o.unstable_getCurrentPriorityLevel,Pe=o.unstable_ImmediatePriority,Re=o.unstable_UserBlockingPriority,et=o.unstable_NormalPriority,Fe=o.unstable_LowPriority,Te=o.unstable_IdlePriority,P=o.log,p=o.unstable_setDisableYieldValue,k=null,ne=null;function Ne(t){if(typeof P=="function"&&p(t),ne&&typeof ne.setStrictMode=="function")try{ne.setStrictMode(k,t)}catch{}}var B=Math.clz32?Math.clz32:Ze,ue=Math.log,Ge=Math.LN2;function Ze(t){return t>>>=0,t===0?32:31-(ue(t)/Ge|0)|0}var ht=256,It=4194304;function At(t){var s=t&42;if(s!==0)return s;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function is(t,s,a){var l=t.pendingLanes;if(l===0)return 0;var n=0,r=t.suspendedLanes,m=t.pingedLanes;t=t.warmLanes;var w=l&134217727;return w!==0?(l=w&~r,l!==0?n=At(l):(m&=w,m!==0?n=At(m):a||(a=w&~t,a!==0&&(n=At(a))))):(w=l&~r,w!==0?n=At(w):m!==0?n=At(m):a||(a=l&~t,a!==0&&(n=At(a)))),n===0?0:s!==0&&s!==n&&(s&r)===0&&(r=n&-n,a=s&-s,r>=a||r===32&&(a&4194048)!==0)?s:n}function Dt(t,s){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&s)===0}function _(t,s){switch(t){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function be(){var t=ht;return ht<<=1,(ht&4194048)===0&&(ht=256),t}function me(){var t=It;return It<<=1,(It&62914560)===0&&(It=4194304),t}function ce(t){for(var s=[],a=0;31>a;a++)s.push(t);return s}function re(t,s){t.pendingLanes|=s,s!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function we(t,s,a,l,n,r){var m=t.pendingLanes;t.pendingLanes=a,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=a,t.entangledLanes&=a,t.errorRecoveryDisabledLanes&=a,t.shellSuspendCounter=0;var w=t.entanglements,L=t.expirationTimes,J=t.hiddenUpdates;for(a=m&~a;0<a;){var de=31-B(a),xe=1<<de;w[de]=0,L[de]=-1;var te=J[de];if(te!==null)for(J[de]=null,de=0;de<te.length;de++){var ae=te[de];ae!==null&&(ae.lane&=-536870913)}a&=~xe}l!==0&&_e(t,l,0),r!==0&&n===0&&t.tag!==0&&(t.suspendedLanes|=r&~(m&~s))}function _e(t,s,a){t.pendingLanes|=s,t.suspendedLanes&=~s;var l=31-B(s);t.entangledLanes|=s,t.entanglements[l]=t.entanglements[l]|1073741824|a&4194090}function Ve(t,s){var a=t.entangledLanes|=s;for(t=t.entanglements;a;){var l=31-B(a),n=1<<l;n&s|t[l]&s&&(t[l]|=s),a&=~n}}function b(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function ie(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function $e(){var t=q.p;return t!==0?t:(t=window.event,t===void 0?32:L0(t.type))}function ut(t,s){var a=q.p;try{return q.p=t,s()}finally{q.p=a}}var St=Math.random().toString(36).slice(2),Ke="__reactFiber$"+St,ot="__reactProps$"+St,ss="__reactContainer$"+St,Ts="__reactEvents$"+St,Fl="__reactListeners$"+St,wi="__reactHandles$"+St,ad="__reactResources$"+St,Ql="__reactMarker$"+St;function Ni(t){delete t[Ke],delete t[ot],delete t[Ts],delete t[Fl],delete t[wi]}function ll(t){var s=t[Ke];if(s)return s;for(var a=t.parentNode;a;){if(s=a[ss]||a[Ke]){if(a=s.alternate,s.child!==null||a!==null&&a.child!==null)for(t=v0(t);t!==null;){if(a=t[Ke])return a;t=v0(t)}return s}t=a,a=t.parentNode}return null}function nl(t){if(t=t[Ke]||t[ss]){var s=t.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return t}return null}function Xl(t){var s=t.tag;if(s===5||s===26||s===27||s===6)return t.stateNode;throw Error(c(33))}function rl(t){var s=t[ad];return s||(s=t[ad]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Gt(t){t[Ql]=!0}var ld=new Set,nd={};function za(t,s){il(t,s),il(t+"Capture",s)}function il(t,s){for(nd[t]=s,t=0;t<s.length;t++)ld.add(s[t])}var Bh=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),rd={},id={};function kh(t){return ye.call(id,t)?!0:ye.call(rd,t)?!1:Bh.test(t)?id[t]=!0:(rd[t]=!0,!1)}function Zn(t,s,a){if(kh(s))if(a===null)t.removeAttribute(s);else{switch(typeof a){case"undefined":case"function":case"symbol":t.removeAttribute(s);return;case"boolean":var l=s.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){t.removeAttribute(s);return}}t.setAttribute(s,""+a)}}function Kn(t,s,a){if(a===null)t.removeAttribute(s);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(s);return}t.setAttribute(s,""+a)}}function Hs(t,s,a,l){if(l===null)t.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(a);return}t.setAttributeNS(s,a,""+l)}}var ji,od;function ol(t){if(ji===void 0)try{throw Error()}catch(a){var s=a.stack.trim().match(/\n( *(at )?)/);ji=s&&s[1]||"",od=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ji+t+od}var Si=!1;function _i(t,s){if(!t||Si)return"";Si=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(s){var xe=function(){throw Error()};if(Object.defineProperty(xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xe,[])}catch(ae){var te=ae}Reflect.construct(t,[],xe)}else{try{xe.call()}catch(ae){te=ae}t.call(xe.prototype)}}else{try{throw Error()}catch(ae){te=ae}(xe=t())&&typeof xe.catch=="function"&&xe.catch(function(){})}}catch(ae){if(ae&&te&&typeof ae.stack=="string")return[ae.stack,te.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=l.DetermineComponentFrameRoot(),m=r[0],w=r[1];if(m&&w){var L=m.split(`
`),J=w.split(`
`);for(n=l=0;l<L.length&&!L[l].includes("DetermineComponentFrameRoot");)l++;for(;n<J.length&&!J[n].includes("DetermineComponentFrameRoot");)n++;if(l===L.length||n===J.length)for(l=L.length-1,n=J.length-1;1<=l&&0<=n&&L[l]!==J[n];)n--;for(;1<=l&&0<=n;l--,n--)if(L[l]!==J[n]){if(l!==1||n!==1)do if(l--,n--,0>n||L[l]!==J[n]){var de=`
`+L[l].replace(" at new "," at ");return t.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",t.displayName)),de}while(1<=l&&0<=n);break}}}finally{Si=!1,Error.prepareStackTrace=a}return(a=t?t.displayName||t.name:"")?ol(a):""}function Th(t){switch(t.tag){case 26:case 27:case 5:return ol(t.type);case 16:return ol("Lazy");case 13:return ol("Suspense");case 19:return ol("SuspenseList");case 0:case 15:return _i(t.type,!1);case 11:return _i(t.type.render,!1);case 1:return _i(t.type,!0);case 31:return ol("Activity");default:return""}}function cd(t){try{var s="";do s+=Th(t),t=t.return;while(t);return s}catch(a){return`
Error generating stack: `+a.message+`
`+a.stack}}function js(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function dd(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Dh(t){var s=dd(t)?"checked":"value",a=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),l=""+t[s];if(!t.hasOwnProperty(s)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var n=a.get,r=a.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return n.call(this)},set:function(m){l=""+m,r.call(this,m)}}),Object.defineProperty(t,s,{enumerable:a.enumerable}),{getValue:function(){return l},setValue:function(m){l=""+m},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function Jn(t){t._valueTracker||(t._valueTracker=Dh(t))}function ud(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var a=s.getValue(),l="";return t&&(l=dd(t)?t.checked?"true":"false":t.value),t=l,t!==a?(s.setValue(t),!0):!1}function er(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Lh=/[\n"\\]/g;function Ss(t){return t.replace(Lh,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ai(t,s,a,l,n,r,m,w){t.name="",m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"?t.type=m:t.removeAttribute("type"),s!=null?m==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+js(s)):t.value!==""+js(s)&&(t.value=""+js(s)):m!=="submit"&&m!=="reset"||t.removeAttribute("value"),s!=null?Ci(t,m,js(s)):a!=null?Ci(t,m,js(a)):l!=null&&t.removeAttribute("value"),n==null&&r!=null&&(t.defaultChecked=!!r),n!=null&&(t.checked=n&&typeof n!="function"&&typeof n!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?t.name=""+js(w):t.removeAttribute("name")}function md(t,s,a,l,n,r,m,w){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(t.type=r),s!=null||a!=null){if(!(r!=="submit"&&r!=="reset"||s!=null))return;a=a!=null?""+js(a):"",s=s!=null?""+js(s):a,w||s===t.value||(t.value=s),t.defaultValue=s}l=l??n,l=typeof l!="function"&&typeof l!="symbol"&&!!l,t.checked=w?t.checked:!!l,t.defaultChecked=!!l,m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(t.name=m)}function Ci(t,s,a){s==="number"&&er(t.ownerDocument)===t||t.defaultValue===""+a||(t.defaultValue=""+a)}function cl(t,s,a,l){if(t=t.options,s){s={};for(var n=0;n<a.length;n++)s["$"+a[n]]=!0;for(a=0;a<t.length;a++)n=s.hasOwnProperty("$"+t[a].value),t[a].selected!==n&&(t[a].selected=n),n&&l&&(t[a].defaultSelected=!0)}else{for(a=""+js(a),s=null,n=0;n<t.length;n++){if(t[n].value===a){t[n].selected=!0,l&&(t[n].defaultSelected=!0);return}s!==null||t[n].disabled||(s=t[n])}s!==null&&(s.selected=!0)}}function hd(t,s,a){if(s!=null&&(s=""+js(s),s!==t.value&&(t.value=s),a==null)){t.defaultValue!==s&&(t.defaultValue=s);return}t.defaultValue=a!=null?""+js(a):""}function xd(t,s,a,l){if(s==null){if(l!=null){if(a!=null)throw Error(c(92));if(C(l)){if(1<l.length)throw Error(c(93));l=l[0]}a=l}a==null&&(a=""),s=a}a=js(s),t.defaultValue=a,l=t.textContent,l===a&&l!==""&&l!==null&&(t.value=l)}function dl(t,s){if(s){var a=t.firstChild;if(a&&a===t.lastChild&&a.nodeType===3){a.nodeValue=s;return}}t.textContent=s}var Rh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fd(t,s,a){var l=s.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?l?t.setProperty(s,""):s==="float"?t.cssFloat="":t[s]="":l?t.setProperty(s,a):typeof a!="number"||a===0||Rh.has(s)?s==="float"?t.cssFloat=a:t[s]=(""+a).trim():t[s]=a+"px"}function gd(t,s,a){if(s!=null&&typeof s!="object")throw Error(c(62));if(t=t.style,a!=null){for(var l in a)!a.hasOwnProperty(l)||s!=null&&s.hasOwnProperty(l)||(l.indexOf("--")===0?t.setProperty(l,""):l==="float"?t.cssFloat="":t[l]="");for(var n in s)l=s[n],s.hasOwnProperty(n)&&a[n]!==l&&fd(t,n,l)}else for(var r in s)s.hasOwnProperty(r)&&fd(t,r,s[r])}function Mi(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function tr(t){return Yh.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var Oi=null;function Ei(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ul=null,ml=null;function pd(t){var s=nl(t);if(s&&(t=s.stateNode)){var a=t[ot]||null;e:switch(t=s.stateNode,s.type){case"input":if(Ai(t,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),s=a.name,a.type==="radio"&&s!=null){for(a=t;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Ss(""+s)+'"][type="radio"]'),s=0;s<a.length;s++){var l=a[s];if(l!==t&&l.form===t.form){var n=l[ot]||null;if(!n)throw Error(c(90));Ai(l,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name)}}for(s=0;s<a.length;s++)l=a[s],l.form===t.form&&ud(l)}break e;case"textarea":hd(t,a.value,a.defaultValue);break e;case"select":s=a.value,s!=null&&cl(t,!!a.multiple,s,!1)}}}var Bi=!1;function bd(t,s,a){if(Bi)return t(s,a);Bi=!0;try{var l=t(s);return l}finally{if(Bi=!1,(ul!==null||ml!==null)&&(Ur(),ul&&(s=ul,t=ml,ml=ul=null,pd(s),t)))for(s=0;s<t.length;s++)pd(t[s])}}function Wl(t,s){var a=t.stateNode;if(a===null)return null;var l=a[ot]||null;if(l===null)return null;a=l[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(t=t.type,l=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!l;break e;default:t=!1}if(t)return null;if(a&&typeof a!="function")throw Error(c(231,s,typeof a));return a}var Vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ki=!1;if(Vs)try{var Zl={};Object.defineProperty(Zl,"passive",{get:function(){ki=!0}}),window.addEventListener("test",Zl,Zl),window.removeEventListener("test",Zl,Zl)}catch{ki=!1}var da=null,Ti=null,sr=null;function yd(){if(sr)return sr;var t,s=Ti,a=s.length,l,n="value"in da?da.value:da.textContent,r=n.length;for(t=0;t<a&&s[t]===n[t];t++);var m=a-t;for(l=1;l<=m&&s[a-l]===n[r-l];l++);return sr=n.slice(t,1<l?1-l:void 0)}function ar(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function lr(){return!0}function vd(){return!1}function ds(t){function s(a,l,n,r,m){this._reactName=a,this._targetInst=n,this.type=l,this.nativeEvent=r,this.target=m,this.currentTarget=null;for(var w in t)t.hasOwnProperty(w)&&(a=t[w],this[w]=a?a(r):r[w]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?lr:vd,this.isPropagationStopped=vd,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=lr)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=lr)},persist:function(){},isPersistent:lr}),s}var Ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nr=ds(Ya),Kl=v({},Ya,{view:0,detail:0}),$h=ds(Kl),Di,Li,Jl,rr=v({},Kl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zi,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Jl&&(Jl&&t.type==="mousemove"?(Di=t.screenX-Jl.screenX,Li=t.screenY-Jl.screenY):Li=Di=0,Jl=t),Di)},movementY:function(t){return"movementY"in t?t.movementY:Li}}),wd=ds(rr),Uh=v({},rr,{dataTransfer:0}),qh=ds(Uh),Ph=v({},Kl,{relatedTarget:0}),Ri=ds(Ph),Hh=v({},Ya,{animationName:0,elapsedTime:0,pseudoElement:0}),Vh=ds(Hh),Ih=v({},Ya,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Gh=ds(Ih),Fh=v({},Ya,{data:0}),Nd=ds(Fh),Qh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zh(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=Wh[t])?!!s[t]:!1}function zi(){return Zh}var Kh=v({},Kl,{key:function(t){if(t.key){var s=Qh[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=ar(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Xh[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zi,charCode:function(t){return t.type==="keypress"?ar(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ar(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Jh=ds(Kh),ex=v({},rr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jd=ds(ex),tx=v({},Kl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zi}),sx=ds(tx),ax=v({},Ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),lx=ds(ax),nx=v({},rr,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),rx=ds(nx),ix=v({},Ya,{newState:0,oldState:0}),ox=ds(ix),cx=[9,13,27,32],Yi=Vs&&"CompositionEvent"in window,en=null;Vs&&"documentMode"in document&&(en=document.documentMode);var dx=Vs&&"TextEvent"in window&&!en,Sd=Vs&&(!Yi||en&&8<en&&11>=en),_d=" ",Ad=!1;function Cd(t,s){switch(t){case"keyup":return cx.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Md(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var hl=!1;function ux(t,s){switch(t){case"compositionend":return Md(s);case"keypress":return s.which!==32?null:(Ad=!0,_d);case"textInput":return t=s.data,t===_d&&Ad?null:t;default:return null}}function mx(t,s){if(hl)return t==="compositionend"||!Yi&&Cd(t,s)?(t=yd(),sr=Ti=da=null,hl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Sd&&s.locale!=="ko"?null:s.data;default:return null}}var hx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Od(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!hx[t.type]:s==="textarea"}function Ed(t,s,a,l){ul?ml?ml.push(l):ml=[l]:ul=l,s=Gr(s,"onChange"),0<s.length&&(a=new nr("onChange","change",null,a,l),t.push({event:a,listeners:s}))}var tn=null,sn=null;function xx(t){d0(t,0)}function ir(t){var s=Xl(t);if(ud(s))return t}function Bd(t,s){if(t==="change")return s}var kd=!1;if(Vs){var $i;if(Vs){var Ui="oninput"in document;if(!Ui){var Td=document.createElement("div");Td.setAttribute("oninput","return;"),Ui=typeof Td.oninput=="function"}$i=Ui}else $i=!1;kd=$i&&(!document.documentMode||9<document.documentMode)}function Dd(){tn&&(tn.detachEvent("onpropertychange",Ld),sn=tn=null)}function Ld(t){if(t.propertyName==="value"&&ir(sn)){var s=[];Ed(s,sn,t,Ei(t)),bd(xx,s)}}function fx(t,s,a){t==="focusin"?(Dd(),tn=s,sn=a,tn.attachEvent("onpropertychange",Ld)):t==="focusout"&&Dd()}function gx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ir(sn)}function px(t,s){if(t==="click")return ir(s)}function bx(t,s){if(t==="input"||t==="change")return ir(s)}function yx(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var fs=typeof Object.is=="function"?Object.is:yx;function an(t,s){if(fs(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var a=Object.keys(t),l=Object.keys(s);if(a.length!==l.length)return!1;for(l=0;l<a.length;l++){var n=a[l];if(!ye.call(s,n)||!fs(t[n],s[n]))return!1}return!0}function Rd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zd(t,s){var a=Rd(t);t=0;for(var l;a;){if(a.nodeType===3){if(l=t+a.textContent.length,t<=s&&l>=s)return{node:a,offset:s-t};t=l}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Rd(a)}}function Yd(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?Yd(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function $d(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var s=er(t.document);s instanceof t.HTMLIFrameElement;){try{var a=typeof s.contentWindow.location.href=="string"}catch{a=!1}if(a)t=s.contentWindow;else break;s=er(t.document)}return s}function qi(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}var vx=Vs&&"documentMode"in document&&11>=document.documentMode,xl=null,Pi=null,ln=null,Hi=!1;function Ud(t,s,a){var l=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Hi||xl==null||xl!==er(l)||(l=xl,"selectionStart"in l&&qi(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),ln&&an(ln,l)||(ln=l,l=Gr(Pi,"onSelect"),0<l.length&&(s=new nr("onSelect","select",null,s,a),t.push({event:s,listeners:l}),s.target=xl)))}function $a(t,s){var a={};return a[t.toLowerCase()]=s.toLowerCase(),a["Webkit"+t]="webkit"+s,a["Moz"+t]="moz"+s,a}var fl={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionrun:$a("Transition","TransitionRun"),transitionstart:$a("Transition","TransitionStart"),transitioncancel:$a("Transition","TransitionCancel"),transitionend:$a("Transition","TransitionEnd")},Vi={},qd={};Vs&&(qd=document.createElement("div").style,"AnimationEvent"in window||(delete fl.animationend.animation,delete fl.animationiteration.animation,delete fl.animationstart.animation),"TransitionEvent"in window||delete fl.transitionend.transition);function Ua(t){if(Vi[t])return Vi[t];if(!fl[t])return t;var s=fl[t],a;for(a in s)if(s.hasOwnProperty(a)&&a in qd)return Vi[t]=s[a];return t}var Pd=Ua("animationend"),Hd=Ua("animationiteration"),Vd=Ua("animationstart"),wx=Ua("transitionrun"),Nx=Ua("transitionstart"),jx=Ua("transitioncancel"),Id=Ua("transitionend"),Gd=new Map,Ii="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ii.push("scrollEnd");function Ds(t,s){Gd.set(t,s),za(s,[t])}var Fd=new WeakMap;function _s(t,s){if(typeof t=="object"&&t!==null){var a=Fd.get(t);return a!==void 0?a:(s={value:t,source:s,stack:cd(s)},Fd.set(t,s),s)}return{value:t,source:s,stack:cd(s)}}var As=[],gl=0,Gi=0;function or(){for(var t=gl,s=Gi=gl=0;s<t;){var a=As[s];As[s++]=null;var l=As[s];As[s++]=null;var n=As[s];As[s++]=null;var r=As[s];if(As[s++]=null,l!==null&&n!==null){var m=l.pending;m===null?n.next=n:(n.next=m.next,m.next=n),l.pending=n}r!==0&&Qd(a,n,r)}}function cr(t,s,a,l){As[gl++]=t,As[gl++]=s,As[gl++]=a,As[gl++]=l,Gi|=l,t.lanes|=l,t=t.alternate,t!==null&&(t.lanes|=l)}function Fi(t,s,a,l){return cr(t,s,a,l),dr(t)}function pl(t,s){return cr(t,null,null,s),dr(t)}function Qd(t,s,a){t.lanes|=a;var l=t.alternate;l!==null&&(l.lanes|=a);for(var n=!1,r=t.return;r!==null;)r.childLanes|=a,l=r.alternate,l!==null&&(l.childLanes|=a),r.tag===22&&(t=r.stateNode,t===null||t._visibility&1||(n=!0)),t=r,r=r.return;return t.tag===3?(r=t.stateNode,n&&s!==null&&(n=31-B(a),t=r.hiddenUpdates,l=t[n],l===null?t[n]=[s]:l.push(s),s.lane=a|536870912),r):null}function dr(t){if(50<En)throw En=0,ec=null,Error(c(185));for(var s=t.return;s!==null;)t=s,s=t.return;return t.tag===3?t.stateNode:null}var bl={};function Sx(t,s,a,l){this.tag=t,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gs(t,s,a,l){return new Sx(t,s,a,l)}function Qi(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Is(t,s){var a=t.alternate;return a===null?(a=gs(t.tag,s,t.key,t.mode),a.elementType=t.elementType,a.type=t.type,a.stateNode=t.stateNode,a.alternate=t,t.alternate=a):(a.pendingProps=s,a.type=t.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=t.flags&65011712,a.childLanes=t.childLanes,a.lanes=t.lanes,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,s=t.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},a.sibling=t.sibling,a.index=t.index,a.ref=t.ref,a.refCleanup=t.refCleanup,a}function Xd(t,s){t.flags&=65011714;var a=t.alternate;return a===null?(t.childLanes=0,t.lanes=s,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=a.childLanes,t.lanes=a.lanes,t.child=a.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=a.memoizedProps,t.memoizedState=a.memoizedState,t.updateQueue=a.updateQueue,t.type=a.type,s=a.dependencies,t.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),t}function ur(t,s,a,l,n,r){var m=0;if(l=t,typeof t=="function")Qi(t)&&(m=1);else if(typeof t=="string")m=Cf(t,a,Q.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case Ee:return t=gs(31,a,s,n),t.elementType=Ee,t.lanes=r,t;case G:return qa(a.children,n,r,s);case W:m=8,n|=24;break;case N:return t=gs(12,a,s,n|2),t.elementType=N,t.lanes=r,t;case le:return t=gs(13,a,s,n),t.elementType=le,t.lanes=r,t;case ke:return t=gs(19,a,s,n),t.elementType=ke,t.lanes=r,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case g:case Y:m=10;break e;case M:m=9;break e;case Z:m=11;break e;case Be:m=14;break e;case je:m=16,l=null;break e}m=29,a=Error(c(130,t===null?"null":typeof t,"")),l=null}return s=gs(m,a,s,n),s.elementType=t,s.type=l,s.lanes=r,s}function qa(t,s,a,l){return t=gs(7,t,l,s),t.lanes=a,t}function Xi(t,s,a){return t=gs(6,t,null,s),t.lanes=a,t}function Wi(t,s,a){return s=gs(4,t.children!==null?t.children:[],t.key,s),s.lanes=a,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}var yl=[],vl=0,mr=null,hr=0,Cs=[],Ms=0,Pa=null,Gs=1,Fs="";function Ha(t,s){yl[vl++]=hr,yl[vl++]=mr,mr=t,hr=s}function Wd(t,s,a){Cs[Ms++]=Gs,Cs[Ms++]=Fs,Cs[Ms++]=Pa,Pa=t;var l=Gs;t=Fs;var n=32-B(l)-1;l&=~(1<<n),a+=1;var r=32-B(s)+n;if(30<r){var m=n-n%5;r=(l&(1<<m)-1).toString(32),l>>=m,n-=m,Gs=1<<32-B(s)+n|a<<n|l,Fs=r+t}else Gs=1<<r|a<<n|l,Fs=t}function Zi(t){t.return!==null&&(Ha(t,1),Wd(t,1,0))}function Ki(t){for(;t===mr;)mr=yl[--vl],yl[vl]=null,hr=yl[--vl],yl[vl]=null;for(;t===Pa;)Pa=Cs[--Ms],Cs[Ms]=null,Fs=Cs[--Ms],Cs[Ms]=null,Gs=Cs[--Ms],Cs[Ms]=null}var os=null,Bt=null,mt=!1,Va=null,zs=!1,Ji=Error(c(519));function Ia(t){var s=Error(c(418,""));throw on(_s(s,t)),Ji}function Zd(t){var s=t.stateNode,a=t.type,l=t.memoizedProps;switch(s[Ke]=t,s[ot]=l,a){case"dialog":it("cancel",s),it("close",s);break;case"iframe":case"object":case"embed":it("load",s);break;case"video":case"audio":for(a=0;a<kn.length;a++)it(kn[a],s);break;case"source":it("error",s);break;case"img":case"image":case"link":it("error",s),it("load",s);break;case"details":it("toggle",s);break;case"input":it("invalid",s),md(s,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0),Jn(s);break;case"select":it("invalid",s);break;case"textarea":it("invalid",s),xd(s,l.value,l.defaultValue,l.children),Jn(s)}a=l.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||s.textContent===""+a||l.suppressHydrationWarning===!0||x0(s.textContent,a)?(l.popover!=null&&(it("beforetoggle",s),it("toggle",s)),l.onScroll!=null&&it("scroll",s),l.onScrollEnd!=null&&it("scrollend",s),l.onClick!=null&&(s.onclick=Fr),s=!0):s=!1,s||Ia(t)}function Kd(t){for(os=t.return;os;)switch(os.tag){case 5:case 13:zs=!1;return;case 27:case 3:zs=!0;return;default:os=os.return}}function nn(t){if(t!==os)return!1;if(!mt)return Kd(t),mt=!0,!1;var s=t.tag,a;if((a=s!==3&&s!==27)&&((a=s===5)&&(a=t.type,a=!(a!=="form"&&a!=="button")||gc(t.type,t.memoizedProps)),a=!a),a&&Bt&&Ia(t),Kd(t),s===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(c(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8)if(a=t.data,a==="/$"){if(s===0){Bt=Rs(t.nextSibling);break e}s--}else a!=="$"&&a!=="$!"&&a!=="$?"||s++;t=t.nextSibling}Bt=null}}else s===27?(s=Bt,Aa(t.type)?(t=vc,vc=null,Bt=t):Bt=s):Bt=os?Rs(t.stateNode.nextSibling):null;return!0}function rn(){Bt=os=null,mt=!1}function Jd(){var t=Va;return t!==null&&(hs===null?hs=t:hs.push.apply(hs,t),Va=null),t}function on(t){Va===null?Va=[t]:Va.push(t)}var eo=T(null),Ga=null,Qs=null;function ua(t,s,a){R(eo,s._currentValue),s._currentValue=a}function Xs(t){t._currentValue=eo.current,E(eo)}function to(t,s,a){for(;t!==null;){var l=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,l!==null&&(l.childLanes|=s)):l!==null&&(l.childLanes&s)!==s&&(l.childLanes|=s),t===a)break;t=t.return}}function so(t,s,a,l){var n=t.child;for(n!==null&&(n.return=t);n!==null;){var r=n.dependencies;if(r!==null){var m=n.child;r=r.firstContext;e:for(;r!==null;){var w=r;r=n;for(var L=0;L<s.length;L++)if(w.context===s[L]){r.lanes|=a,w=r.alternate,w!==null&&(w.lanes|=a),to(r.return,a,t),l||(m=null);break e}r=w.next}}else if(n.tag===18){if(m=n.return,m===null)throw Error(c(341));m.lanes|=a,r=m.alternate,r!==null&&(r.lanes|=a),to(m,a,t),m=null}else m=n.child;if(m!==null)m.return=n;else for(m=n;m!==null;){if(m===t){m=null;break}if(n=m.sibling,n!==null){n.return=m.return,m=n;break}m=m.return}n=m}}function cn(t,s,a,l){t=null;for(var n=s,r=!1;n!==null;){if(!r){if((n.flags&524288)!==0)r=!0;else if((n.flags&262144)!==0)break}if(n.tag===10){var m=n.alternate;if(m===null)throw Error(c(387));if(m=m.memoizedProps,m!==null){var w=n.type;fs(n.pendingProps.value,m.value)||(t!==null?t.push(w):t=[w])}}else if(n===He.current){if(m=n.alternate,m===null)throw Error(c(387));m.memoizedState.memoizedState!==n.memoizedState.memoizedState&&(t!==null?t.push(Yn):t=[Yn])}n=n.return}t!==null&&so(s,t,a,l),s.flags|=262144}function xr(t){for(t=t.firstContext;t!==null;){if(!fs(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Fa(t){Ga=t,Qs=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function as(t){return eu(Ga,t)}function fr(t,s){return Ga===null&&Fa(t),eu(t,s)}function eu(t,s){var a=s._currentValue;if(s={context:s,memoizedValue:a,next:null},Qs===null){if(t===null)throw Error(c(308));Qs=s,t.dependencies={lanes:0,firstContext:s},t.flags|=524288}else Qs=Qs.next=s;return a}var _x=typeof AbortController<"u"?AbortController:function(){var t=[],s=this.signal={aborted:!1,addEventListener:function(a,l){t.push(l)}};this.abort=function(){s.aborted=!0,t.forEach(function(a){return a()})}},Ax=o.unstable_scheduleCallback,Cx=o.unstable_NormalPriority,Ht={$$typeof:Y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ao(){return{controller:new _x,data:new Map,refCount:0}}function dn(t){t.refCount--,t.refCount===0&&Ax(Cx,function(){t.controller.abort()})}var un=null,lo=0,wl=0,Nl=null;function Mx(t,s){if(un===null){var a=un=[];lo=0,wl=ic(),Nl={status:"pending",value:void 0,then:function(l){a.push(l)}}}return lo++,s.then(tu,tu),s}function tu(){if(--lo===0&&un!==null){Nl!==null&&(Nl.status="fulfilled");var t=un;un=null,wl=0,Nl=null;for(var s=0;s<t.length;s++)(0,t[s])()}}function Ox(t,s){var a=[],l={status:"pending",value:null,reason:null,then:function(n){a.push(n)}};return t.then(function(){l.status="fulfilled",l.value=s;for(var n=0;n<a.length;n++)(0,a[n])(s)},function(n){for(l.status="rejected",l.reason=n,n=0;n<a.length;n++)(0,a[n])(void 0)}),l}var su=O.S;O.S=function(t,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&Mx(t,s),su!==null&&su(t,s)};var Qa=T(null);function no(){var t=Qa.current;return t!==null?t:jt.pooledCache}function gr(t,s){s===null?R(Qa,Qa.current):R(Qa,s.pool)}function au(){var t=no();return t===null?null:{parent:Ht._currentValue,pool:t}}var mn=Error(c(460)),lu=Error(c(474)),pr=Error(c(542)),ro={then:function(){}};function nu(t){return t=t.status,t==="fulfilled"||t==="rejected"}function br(){}function ru(t,s,a){switch(a=t[a],a===void 0?t.push(s):a!==s&&(s.then(br,br),s=a),s.status){case"fulfilled":return s.value;case"rejected":throw t=s.reason,ou(t),t;default:if(typeof s.status=="string")s.then(br,br);else{if(t=jt,t!==null&&100<t.shellSuspendCounter)throw Error(c(482));t=s,t.status="pending",t.then(function(l){if(s.status==="pending"){var n=s;n.status="fulfilled",n.value=l}},function(l){if(s.status==="pending"){var n=s;n.status="rejected",n.reason=l}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw t=s.reason,ou(t),t}throw hn=s,mn}}var hn=null;function iu(){if(hn===null)throw Error(c(459));var t=hn;return hn=null,t}function ou(t){if(t===mn||t===pr)throw Error(c(483))}var ma=!1;function io(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function oo(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function ha(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function xa(t,s,a){var l=t.updateQueue;if(l===null)return null;if(l=l.shared,(xt&2)!==0){var n=l.pending;return n===null?s.next=s:(s.next=n.next,n.next=s),l.pending=s,s=dr(t),Qd(t,null,a),s}return cr(t,l,s,a),dr(t)}function xn(t,s,a){if(s=s.updateQueue,s!==null&&(s=s.shared,(a&4194048)!==0)){var l=s.lanes;l&=t.pendingLanes,a|=l,s.lanes=a,Ve(t,a)}}function co(t,s){var a=t.updateQueue,l=t.alternate;if(l!==null&&(l=l.updateQueue,a===l)){var n=null,r=null;if(a=a.firstBaseUpdate,a!==null){do{var m={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};r===null?n=r=m:r=r.next=m,a=a.next}while(a!==null);r===null?n=r=s:r=r.next=s}else n=r=s;a={baseState:l.baseState,firstBaseUpdate:n,lastBaseUpdate:r,shared:l.shared,callbacks:l.callbacks},t.updateQueue=a;return}t=a.lastBaseUpdate,t===null?a.firstBaseUpdate=s:t.next=s,a.lastBaseUpdate=s}var uo=!1;function fn(){if(uo){var t=Nl;if(t!==null)throw t}}function gn(t,s,a,l){uo=!1;var n=t.updateQueue;ma=!1;var r=n.firstBaseUpdate,m=n.lastBaseUpdate,w=n.shared.pending;if(w!==null){n.shared.pending=null;var L=w,J=L.next;L.next=null,m===null?r=J:m.next=J,m=L;var de=t.alternate;de!==null&&(de=de.updateQueue,w=de.lastBaseUpdate,w!==m&&(w===null?de.firstBaseUpdate=J:w.next=J,de.lastBaseUpdate=L))}if(r!==null){var xe=n.baseState;m=0,de=J=L=null,w=r;do{var te=w.lane&-536870913,ae=te!==w.lane;if(ae?(ct&te)===te:(l&te)===te){te!==0&&te===wl&&(uo=!0),de!==null&&(de=de.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var Je=t,Xe=w;te=s;var yt=a;switch(Xe.tag){case 1:if(Je=Xe.payload,typeof Je=="function"){xe=Je.call(yt,xe,te);break e}xe=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=Xe.payload,te=typeof Je=="function"?Je.call(yt,xe,te):Je,te==null)break e;xe=v({},xe,te);break e;case 2:ma=!0}}te=w.callback,te!==null&&(t.flags|=64,ae&&(t.flags|=8192),ae=n.callbacks,ae===null?n.callbacks=[te]:ae.push(te))}else ae={lane:te,tag:w.tag,payload:w.payload,callback:w.callback,next:null},de===null?(J=de=ae,L=xe):de=de.next=ae,m|=te;if(w=w.next,w===null){if(w=n.shared.pending,w===null)break;ae=w,w=ae.next,ae.next=null,n.lastBaseUpdate=ae,n.shared.pending=null}}while(!0);de===null&&(L=xe),n.baseState=L,n.firstBaseUpdate=J,n.lastBaseUpdate=de,r===null&&(n.shared.lanes=0),Na|=m,t.lanes=m,t.memoizedState=xe}}function cu(t,s){if(typeof t!="function")throw Error(c(191,t));t.call(s)}function du(t,s){var a=t.callbacks;if(a!==null)for(t.callbacks=null,t=0;t<a.length;t++)cu(a[t],s)}var jl=T(null),yr=T(0);function uu(t,s){t=sa,R(yr,t),R(jl,s),sa=t|s.baseLanes}function mo(){R(yr,sa),R(jl,jl.current)}function ho(){sa=yr.current,E(jl),E(yr)}var fa=0,lt=null,pt=null,Yt=null,vr=!1,Sl=!1,Xa=!1,wr=0,pn=0,_l=null,Ex=0;function Lt(){throw Error(c(321))}function xo(t,s){if(s===null)return!1;for(var a=0;a<s.length&&a<t.length;a++)if(!fs(t[a],s[a]))return!1;return!0}function fo(t,s,a,l,n,r){return fa=r,lt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,O.H=t===null||t.memoizedState===null?Qu:Xu,Xa=!1,r=a(l,n),Xa=!1,Sl&&(r=hu(s,a,l,n)),mu(t),r}function mu(t){O.H=Cr;var s=pt!==null&&pt.next!==null;if(fa=0,Yt=pt=lt=null,vr=!1,pn=0,_l=null,s)throw Error(c(300));t===null||Ft||(t=t.dependencies,t!==null&&xr(t)&&(Ft=!0))}function hu(t,s,a,l){lt=t;var n=0;do{if(Sl&&(_l=null),pn=0,Sl=!1,25<=n)throw Error(c(301));if(n+=1,Yt=pt=null,t.updateQueue!=null){var r=t.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}O.H=zx,r=s(a,l)}while(Sl);return r}function Bx(){var t=O.H,s=t.useState()[0];return s=typeof s.then=="function"?bn(s):s,t=t.useState()[0],(pt!==null?pt.memoizedState:null)!==t&&(lt.flags|=1024),s}function go(){var t=wr!==0;return wr=0,t}function po(t,s,a){s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~a}function bo(t){if(vr){for(t=t.memoizedState;t!==null;){var s=t.queue;s!==null&&(s.pending=null),t=t.next}vr=!1}fa=0,Yt=pt=lt=null,Sl=!1,pn=wr=0,_l=null}function us(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?lt.memoizedState=Yt=t:Yt=Yt.next=t,Yt}function $t(){if(pt===null){var t=lt.alternate;t=t!==null?t.memoizedState:null}else t=pt.next;var s=Yt===null?lt.memoizedState:Yt.next;if(s!==null)Yt=s,pt=t;else{if(t===null)throw lt.alternate===null?Error(c(467)):Error(c(310));pt=t,t={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},Yt===null?lt.memoizedState=Yt=t:Yt=Yt.next=t}return Yt}function yo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bn(t){var s=pn;return pn+=1,_l===null&&(_l=[]),t=ru(_l,t,s),s=lt,(Yt===null?s.memoizedState:Yt.next)===null&&(s=s.alternate,O.H=s===null||s.memoizedState===null?Qu:Xu),t}function Nr(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return bn(t);if(t.$$typeof===Y)return as(t)}throw Error(c(438,String(t)))}function vo(t){var s=null,a=lt.updateQueue;if(a!==null&&(s=a.memoCache),s==null){var l=lt.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(s={data:l.data.map(function(n){return n.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),a===null&&(a=yo(),lt.updateQueue=a),a.memoCache=s,a=s.data[s.index],a===void 0)for(a=s.data[s.index]=Array(t),l=0;l<t;l++)a[l]=D;return s.index++,a}function Ws(t,s){return typeof s=="function"?s(t):s}function jr(t){var s=$t();return wo(s,pt,t)}function wo(t,s,a){var l=t.queue;if(l===null)throw Error(c(311));l.lastRenderedReducer=a;var n=t.baseQueue,r=l.pending;if(r!==null){if(n!==null){var m=n.next;n.next=r.next,r.next=m}s.baseQueue=n=r,l.pending=null}if(r=t.baseState,n===null)t.memoizedState=r;else{s=n.next;var w=m=null,L=null,J=s,de=!1;do{var xe=J.lane&-536870913;if(xe!==J.lane?(ct&xe)===xe:(fa&xe)===xe){var te=J.revertLane;if(te===0)L!==null&&(L=L.next={lane:0,revertLane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),xe===wl&&(de=!0);else if((fa&te)===te){J=J.next,te===wl&&(de=!0);continue}else xe={lane:0,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},L===null?(w=L=xe,m=r):L=L.next=xe,lt.lanes|=te,Na|=te;xe=J.action,Xa&&a(r,xe),r=J.hasEagerState?J.eagerState:a(r,xe)}else te={lane:xe,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},L===null?(w=L=te,m=r):L=L.next=te,lt.lanes|=xe,Na|=xe;J=J.next}while(J!==null&&J!==s);if(L===null?m=r:L.next=w,!fs(r,t.memoizedState)&&(Ft=!0,de&&(a=Nl,a!==null)))throw a;t.memoizedState=r,t.baseState=m,t.baseQueue=L,l.lastRenderedState=r}return n===null&&(l.lanes=0),[t.memoizedState,l.dispatch]}function No(t){var s=$t(),a=s.queue;if(a===null)throw Error(c(311));a.lastRenderedReducer=t;var l=a.dispatch,n=a.pending,r=s.memoizedState;if(n!==null){a.pending=null;var m=n=n.next;do r=t(r,m.action),m=m.next;while(m!==n);fs(r,s.memoizedState)||(Ft=!0),s.memoizedState=r,s.baseQueue===null&&(s.baseState=r),a.lastRenderedState=r}return[r,l]}function xu(t,s,a){var l=lt,n=$t(),r=mt;if(r){if(a===void 0)throw Error(c(407));a=a()}else a=s();var m=!fs((pt||n).memoizedState,a);m&&(n.memoizedState=a,Ft=!0),n=n.queue;var w=pu.bind(null,l,n,t);if(yn(2048,8,w,[t]),n.getSnapshot!==s||m||Yt!==null&&Yt.memoizedState.tag&1){if(l.flags|=2048,Al(9,Sr(),gu.bind(null,l,n,a,s),null),jt===null)throw Error(c(349));r||(fa&124)!==0||fu(l,s,a)}return a}function fu(t,s,a){t.flags|=16384,t={getSnapshot:s,value:a},s=lt.updateQueue,s===null?(s=yo(),lt.updateQueue=s,s.stores=[t]):(a=s.stores,a===null?s.stores=[t]:a.push(t))}function gu(t,s,a,l){s.value=a,s.getSnapshot=l,bu(s)&&yu(t)}function pu(t,s,a){return a(function(){bu(s)&&yu(t)})}function bu(t){var s=t.getSnapshot;t=t.value;try{var a=s();return!fs(t,a)}catch{return!0}}function yu(t){var s=pl(t,2);s!==null&&ws(s,t,2)}function jo(t){var s=us();if(typeof t=="function"){var a=t;if(t=a(),Xa){Ne(!0);try{a()}finally{Ne(!1)}}}return s.memoizedState=s.baseState=t,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:t},s}function vu(t,s,a,l){return t.baseState=a,wo(t,pt,typeof l=="function"?l:Ws)}function kx(t,s,a,l,n){if(Ar(t))throw Error(c(485));if(t=s.action,t!==null){var r={payload:n,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(m){r.listeners.push(m)}};O.T!==null?a(!0):r.isTransition=!1,l(r),a=s.pending,a===null?(r.next=s.pending=r,wu(s,r)):(r.next=a.next,s.pending=a.next=r)}}function wu(t,s){var a=s.action,l=s.payload,n=t.state;if(s.isTransition){var r=O.T,m={};O.T=m;try{var w=a(n,l),L=O.S;L!==null&&L(m,w),Nu(t,s,w)}catch(J){So(t,s,J)}finally{O.T=r}}else try{r=a(n,l),Nu(t,s,r)}catch(J){So(t,s,J)}}function Nu(t,s,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(l){ju(t,s,l)},function(l){return So(t,s,l)}):ju(t,s,a)}function ju(t,s,a){s.status="fulfilled",s.value=a,Su(s),t.state=a,s=t.pending,s!==null&&(a=s.next,a===s?t.pending=null:(a=a.next,s.next=a,wu(t,a)))}function So(t,s,a){var l=t.pending;if(t.pending=null,l!==null){l=l.next;do s.status="rejected",s.reason=a,Su(s),s=s.next;while(s!==l)}t.action=null}function Su(t){t=t.listeners;for(var s=0;s<t.length;s++)(0,t[s])()}function _u(t,s){return s}function Au(t,s){if(mt){var a=jt.formState;if(a!==null){e:{var l=lt;if(mt){if(Bt){t:{for(var n=Bt,r=zs;n.nodeType!==8;){if(!r){n=null;break t}if(n=Rs(n.nextSibling),n===null){n=null;break t}}r=n.data,n=r==="F!"||r==="F"?n:null}if(n){Bt=Rs(n.nextSibling),l=n.data==="F!";break e}}Ia(l)}l=!1}l&&(s=a[0])}}return a=us(),a.memoizedState=a.baseState=s,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_u,lastRenderedState:s},a.queue=l,a=Iu.bind(null,lt,l),l.dispatch=a,l=jo(!1),r=Oo.bind(null,lt,!1,l.queue),l=us(),n={state:s,dispatch:null,action:t,pending:null},l.queue=n,a=kx.bind(null,lt,n,r,a),n.dispatch=a,l.memoizedState=t,[s,a,!1]}function Cu(t){var s=$t();return Mu(s,pt,t)}function Mu(t,s,a){if(s=wo(t,s,_u)[0],t=jr(Ws)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var l=bn(s)}catch(m){throw m===mn?pr:m}else l=s;s=$t();var n=s.queue,r=n.dispatch;return a!==s.memoizedState&&(lt.flags|=2048,Al(9,Sr(),Tx.bind(null,n,a),null)),[l,r,t]}function Tx(t,s){t.action=s}function Ou(t){var s=$t(),a=pt;if(a!==null)return Mu(s,a,t);$t(),s=s.memoizedState,a=$t();var l=a.queue.dispatch;return a.memoizedState=t,[s,l,!1]}function Al(t,s,a,l){return t={tag:t,create:a,deps:l,inst:s,next:null},s=lt.updateQueue,s===null&&(s=yo(),lt.updateQueue=s),a=s.lastEffect,a===null?s.lastEffect=t.next=t:(l=a.next,a.next=t,t.next=l,s.lastEffect=t),t}function Sr(){return{destroy:void 0,resource:void 0}}function Eu(){return $t().memoizedState}function _r(t,s,a,l){var n=us();l=l===void 0?null:l,lt.flags|=t,n.memoizedState=Al(1|s,Sr(),a,l)}function yn(t,s,a,l){var n=$t();l=l===void 0?null:l;var r=n.memoizedState.inst;pt!==null&&l!==null&&xo(l,pt.memoizedState.deps)?n.memoizedState=Al(s,r,a,l):(lt.flags|=t,n.memoizedState=Al(1|s,r,a,l))}function Bu(t,s){_r(8390656,8,t,s)}function ku(t,s){yn(2048,8,t,s)}function Tu(t,s){return yn(4,2,t,s)}function Du(t,s){return yn(4,4,t,s)}function Lu(t,s){if(typeof s=="function"){t=t();var a=s(t);return function(){typeof a=="function"?a():s(null)}}if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function Ru(t,s,a){a=a!=null?a.concat([t]):null,yn(4,4,Lu.bind(null,s,t),a)}function _o(){}function zu(t,s){var a=$t();s=s===void 0?null:s;var l=a.memoizedState;return s!==null&&xo(s,l[1])?l[0]:(a.memoizedState=[t,s],t)}function Yu(t,s){var a=$t();s=s===void 0?null:s;var l=a.memoizedState;if(s!==null&&xo(s,l[1]))return l[0];if(l=t(),Xa){Ne(!0);try{t()}finally{Ne(!1)}}return a.memoizedState=[l,s],l}function Ao(t,s,a){return a===void 0||(fa&1073741824)!==0?t.memoizedState=s:(t.memoizedState=a,t=qm(),lt.lanes|=t,Na|=t,a)}function $u(t,s,a,l){return fs(a,s)?a:jl.current!==null?(t=Ao(t,a,l),fs(t,s)||(Ft=!0),t):(fa&42)===0?(Ft=!0,t.memoizedState=a):(t=qm(),lt.lanes|=t,Na|=t,s)}function Uu(t,s,a,l,n){var r=q.p;q.p=r!==0&&8>r?r:8;var m=O.T,w={};O.T=w,Oo(t,!1,s,a);try{var L=n(),J=O.S;if(J!==null&&J(w,L),L!==null&&typeof L=="object"&&typeof L.then=="function"){var de=Ox(L,l);vn(t,s,de,vs(t))}else vn(t,s,l,vs(t))}catch(xe){vn(t,s,{then:function(){},status:"rejected",reason:xe},vs())}finally{q.p=r,O.T=m}}function Dx(){}function Co(t,s,a,l){if(t.tag!==5)throw Error(c(476));var n=qu(t).queue;Uu(t,n,s,z,a===null?Dx:function(){return Pu(t),a(l)})}function qu(t){var s=t.memoizedState;if(s!==null)return s;s={memoizedState:z,baseState:z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:z},next:null};var a={};return s.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:a},next:null},t.memoizedState=s,t=t.alternate,t!==null&&(t.memoizedState=s),s}function Pu(t){var s=qu(t).next.queue;vn(t,s,{},vs())}function Mo(){return as(Yn)}function Hu(){return $t().memoizedState}function Vu(){return $t().memoizedState}function Lx(t){for(var s=t.return;s!==null;){switch(s.tag){case 24:case 3:var a=vs();t=ha(a);var l=xa(s,t,a);l!==null&&(ws(l,s,a),xn(l,s,a)),s={cache:ao()},t.payload=s;return}s=s.return}}function Rx(t,s,a){var l=vs();a={lane:l,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null},Ar(t)?Gu(s,a):(a=Fi(t,s,a,l),a!==null&&(ws(a,t,l),Fu(a,s,l)))}function Iu(t,s,a){var l=vs();vn(t,s,a,l)}function vn(t,s,a,l){var n={lane:l,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null};if(Ar(t))Gu(s,n);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=s.lastRenderedReducer,r!==null))try{var m=s.lastRenderedState,w=r(m,a);if(n.hasEagerState=!0,n.eagerState=w,fs(w,m))return cr(t,s,n,0),jt===null&&or(),!1}catch{}finally{}if(a=Fi(t,s,n,l),a!==null)return ws(a,t,l),Fu(a,s,l),!0}return!1}function Oo(t,s,a,l){if(l={lane:2,revertLane:ic(),action:l,hasEagerState:!1,eagerState:null,next:null},Ar(t)){if(s)throw Error(c(479))}else s=Fi(t,a,l,2),s!==null&&ws(s,t,2)}function Ar(t){var s=t.alternate;return t===lt||s!==null&&s===lt}function Gu(t,s){Sl=vr=!0;var a=t.pending;a===null?s.next=s:(s.next=a.next,a.next=s),t.pending=s}function Fu(t,s,a){if((a&4194048)!==0){var l=s.lanes;l&=t.pendingLanes,a|=l,s.lanes=a,Ve(t,a)}}var Cr={readContext:as,use:Nr,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useLayoutEffect:Lt,useInsertionEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useSyncExternalStore:Lt,useId:Lt,useHostTransitionStatus:Lt,useFormState:Lt,useActionState:Lt,useOptimistic:Lt,useMemoCache:Lt,useCacheRefresh:Lt},Qu={readContext:as,use:Nr,useCallback:function(t,s){return us().memoizedState=[t,s===void 0?null:s],t},useContext:as,useEffect:Bu,useImperativeHandle:function(t,s,a){a=a!=null?a.concat([t]):null,_r(4194308,4,Lu.bind(null,s,t),a)},useLayoutEffect:function(t,s){return _r(4194308,4,t,s)},useInsertionEffect:function(t,s){_r(4,2,t,s)},useMemo:function(t,s){var a=us();s=s===void 0?null:s;var l=t();if(Xa){Ne(!0);try{t()}finally{Ne(!1)}}return a.memoizedState=[l,s],l},useReducer:function(t,s,a){var l=us();if(a!==void 0){var n=a(s);if(Xa){Ne(!0);try{a(s)}finally{Ne(!1)}}}else n=s;return l.memoizedState=l.baseState=n,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:n},l.queue=t,t=t.dispatch=Rx.bind(null,lt,t),[l.memoizedState,t]},useRef:function(t){var s=us();return t={current:t},s.memoizedState=t},useState:function(t){t=jo(t);var s=t.queue,a=Iu.bind(null,lt,s);return s.dispatch=a,[t.memoizedState,a]},useDebugValue:_o,useDeferredValue:function(t,s){var a=us();return Ao(a,t,s)},useTransition:function(){var t=jo(!1);return t=Uu.bind(null,lt,t.queue,!0,!1),us().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,s,a){var l=lt,n=us();if(mt){if(a===void 0)throw Error(c(407));a=a()}else{if(a=s(),jt===null)throw Error(c(349));(ct&124)!==0||fu(l,s,a)}n.memoizedState=a;var r={value:a,getSnapshot:s};return n.queue=r,Bu(pu.bind(null,l,r,t),[t]),l.flags|=2048,Al(9,Sr(),gu.bind(null,l,r,a,s),null),a},useId:function(){var t=us(),s=jt.identifierPrefix;if(mt){var a=Fs,l=Gs;a=(l&~(1<<32-B(l)-1)).toString(32)+a,s=""+s+"R"+a,a=wr++,0<a&&(s+="H"+a.toString(32)),s+=""}else a=Ex++,s=""+s+"r"+a.toString(32)+"";return t.memoizedState=s},useHostTransitionStatus:Mo,useFormState:Au,useActionState:Au,useOptimistic:function(t){var s=us();s.memoizedState=s.baseState=t;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=a,s=Oo.bind(null,lt,!0,a),a.dispatch=s,[t,s]},useMemoCache:vo,useCacheRefresh:function(){return us().memoizedState=Lx.bind(null,lt)}},Xu={readContext:as,use:Nr,useCallback:zu,useContext:as,useEffect:ku,useImperativeHandle:Ru,useInsertionEffect:Tu,useLayoutEffect:Du,useMemo:Yu,useReducer:jr,useRef:Eu,useState:function(){return jr(Ws)},useDebugValue:_o,useDeferredValue:function(t,s){var a=$t();return $u(a,pt.memoizedState,t,s)},useTransition:function(){var t=jr(Ws)[0],s=$t().memoizedState;return[typeof t=="boolean"?t:bn(t),s]},useSyncExternalStore:xu,useId:Hu,useHostTransitionStatus:Mo,useFormState:Cu,useActionState:Cu,useOptimistic:function(t,s){var a=$t();return vu(a,pt,t,s)},useMemoCache:vo,useCacheRefresh:Vu},zx={readContext:as,use:Nr,useCallback:zu,useContext:as,useEffect:ku,useImperativeHandle:Ru,useInsertionEffect:Tu,useLayoutEffect:Du,useMemo:Yu,useReducer:No,useRef:Eu,useState:function(){return No(Ws)},useDebugValue:_o,useDeferredValue:function(t,s){var a=$t();return pt===null?Ao(a,t,s):$u(a,pt.memoizedState,t,s)},useTransition:function(){var t=No(Ws)[0],s=$t().memoizedState;return[typeof t=="boolean"?t:bn(t),s]},useSyncExternalStore:xu,useId:Hu,useHostTransitionStatus:Mo,useFormState:Ou,useActionState:Ou,useOptimistic:function(t,s){var a=$t();return pt!==null?vu(a,pt,t,s):(a.baseState=t,[t,a.queue.dispatch])},useMemoCache:vo,useCacheRefresh:Vu},Cl=null,wn=0;function Mr(t){var s=wn;return wn+=1,Cl===null&&(Cl=[]),ru(Cl,t,s)}function Nn(t,s){s=s.props.ref,t.ref=s!==void 0?s:null}function Or(t,s){throw s.$$typeof===F?Error(c(525)):(t=Object.prototype.toString.call(s),Error(c(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t)))}function Wu(t){var s=t._init;return s(t._payload)}function Zu(t){function s(X,V){if(t){var K=X.deletions;K===null?(X.deletions=[V],X.flags|=16):K.push(V)}}function a(X,V){if(!t)return null;for(;V!==null;)s(X,V),V=V.sibling;return null}function l(X){for(var V=new Map;X!==null;)X.key!==null?V.set(X.key,X):V.set(X.index,X),X=X.sibling;return V}function n(X,V){return X=Is(X,V),X.index=0,X.sibling=null,X}function r(X,V,K){return X.index=K,t?(K=X.alternate,K!==null?(K=K.index,K<V?(X.flags|=67108866,V):K):(X.flags|=67108866,V)):(X.flags|=1048576,V)}function m(X){return t&&X.alternate===null&&(X.flags|=67108866),X}function w(X,V,K,he){return V===null||V.tag!==6?(V=Xi(K,X.mode,he),V.return=X,V):(V=n(V,K),V.return=X,V)}function L(X,V,K,he){var qe=K.type;return qe===G?de(X,V,K.props.children,he,K.key):V!==null&&(V.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===je&&Wu(qe)===V.type)?(V=n(V,K.props),Nn(V,K),V.return=X,V):(V=ur(K.type,K.key,K.props,null,X.mode,he),Nn(V,K),V.return=X,V)}function J(X,V,K,he){return V===null||V.tag!==4||V.stateNode.containerInfo!==K.containerInfo||V.stateNode.implementation!==K.implementation?(V=Wi(K,X.mode,he),V.return=X,V):(V=n(V,K.children||[]),V.return=X,V)}function de(X,V,K,he,qe){return V===null||V.tag!==7?(V=qa(K,X.mode,he,qe),V.return=X,V):(V=n(V,K),V.return=X,V)}function xe(X,V,K){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=Xi(""+V,X.mode,K),V.return=X,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case U:return K=ur(V.type,V.key,V.props,null,X.mode,K),Nn(K,V),K.return=X,K;case se:return V=Wi(V,X.mode,K),V.return=X,V;case je:var he=V._init;return V=he(V._payload),xe(X,V,K)}if(C(V)||ee(V))return V=qa(V,X.mode,K,null),V.return=X,V;if(typeof V.then=="function")return xe(X,Mr(V),K);if(V.$$typeof===Y)return xe(X,fr(X,V),K);Or(X,V)}return null}function te(X,V,K,he){var qe=V!==null?V.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return qe!==null?null:w(X,V,""+K,he);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case U:return K.key===qe?L(X,V,K,he):null;case se:return K.key===qe?J(X,V,K,he):null;case je:return qe=K._init,K=qe(K._payload),te(X,V,K,he)}if(C(K)||ee(K))return qe!==null?null:de(X,V,K,he,null);if(typeof K.then=="function")return te(X,V,Mr(K),he);if(K.$$typeof===Y)return te(X,V,fr(X,K),he);Or(X,K)}return null}function ae(X,V,K,he,qe){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return X=X.get(K)||null,w(V,X,""+he,qe);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case U:return X=X.get(he.key===null?K:he.key)||null,L(V,X,he,qe);case se:return X=X.get(he.key===null?K:he.key)||null,J(V,X,he,qe);case je:var nt=he._init;return he=nt(he._payload),ae(X,V,K,he,qe)}if(C(he)||ee(he))return X=X.get(K)||null,de(V,X,he,qe,null);if(typeof he.then=="function")return ae(X,V,K,Mr(he),qe);if(he.$$typeof===Y)return ae(X,V,K,fr(V,he),qe);Or(V,he)}return null}function Je(X,V,K,he){for(var qe=null,nt=null,Ie=V,We=V=0,Xt=null;Ie!==null&&We<K.length;We++){Ie.index>We?(Xt=Ie,Ie=null):Xt=Ie.sibling;var dt=te(X,Ie,K[We],he);if(dt===null){Ie===null&&(Ie=Xt);break}t&&Ie&&dt.alternate===null&&s(X,Ie),V=r(dt,V,We),nt===null?qe=dt:nt.sibling=dt,nt=dt,Ie=Xt}if(We===K.length)return a(X,Ie),mt&&Ha(X,We),qe;if(Ie===null){for(;We<K.length;We++)Ie=xe(X,K[We],he),Ie!==null&&(V=r(Ie,V,We),nt===null?qe=Ie:nt.sibling=Ie,nt=Ie);return mt&&Ha(X,We),qe}for(Ie=l(Ie);We<K.length;We++)Xt=ae(Ie,X,We,K[We],he),Xt!==null&&(t&&Xt.alternate!==null&&Ie.delete(Xt.key===null?We:Xt.key),V=r(Xt,V,We),nt===null?qe=Xt:nt.sibling=Xt,nt=Xt);return t&&Ie.forEach(function(Ba){return s(X,Ba)}),mt&&Ha(X,We),qe}function Xe(X,V,K,he){if(K==null)throw Error(c(151));for(var qe=null,nt=null,Ie=V,We=V=0,Xt=null,dt=K.next();Ie!==null&&!dt.done;We++,dt=K.next()){Ie.index>We?(Xt=Ie,Ie=null):Xt=Ie.sibling;var Ba=te(X,Ie,dt.value,he);if(Ba===null){Ie===null&&(Ie=Xt);break}t&&Ie&&Ba.alternate===null&&s(X,Ie),V=r(Ba,V,We),nt===null?qe=Ba:nt.sibling=Ba,nt=Ba,Ie=Xt}if(dt.done)return a(X,Ie),mt&&Ha(X,We),qe;if(Ie===null){for(;!dt.done;We++,dt=K.next())dt=xe(X,dt.value,he),dt!==null&&(V=r(dt,V,We),nt===null?qe=dt:nt.sibling=dt,nt=dt);return mt&&Ha(X,We),qe}for(Ie=l(Ie);!dt.done;We++,dt=K.next())dt=ae(Ie,X,We,dt.value,he),dt!==null&&(t&&dt.alternate!==null&&Ie.delete(dt.key===null?We:dt.key),V=r(dt,V,We),nt===null?qe=dt:nt.sibling=dt,nt=dt);return t&&Ie.forEach(function($f){return s(X,$f)}),mt&&Ha(X,We),qe}function yt(X,V,K,he){if(typeof K=="object"&&K!==null&&K.type===G&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case U:e:{for(var qe=K.key;V!==null;){if(V.key===qe){if(qe=K.type,qe===G){if(V.tag===7){a(X,V.sibling),he=n(V,K.props.children),he.return=X,X=he;break e}}else if(V.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===je&&Wu(qe)===V.type){a(X,V.sibling),he=n(V,K.props),Nn(he,K),he.return=X,X=he;break e}a(X,V);break}else s(X,V);V=V.sibling}K.type===G?(he=qa(K.props.children,X.mode,he,K.key),he.return=X,X=he):(he=ur(K.type,K.key,K.props,null,X.mode,he),Nn(he,K),he.return=X,X=he)}return m(X);case se:e:{for(qe=K.key;V!==null;){if(V.key===qe)if(V.tag===4&&V.stateNode.containerInfo===K.containerInfo&&V.stateNode.implementation===K.implementation){a(X,V.sibling),he=n(V,K.children||[]),he.return=X,X=he;break e}else{a(X,V);break}else s(X,V);V=V.sibling}he=Wi(K,X.mode,he),he.return=X,X=he}return m(X);case je:return qe=K._init,K=qe(K._payload),yt(X,V,K,he)}if(C(K))return Je(X,V,K,he);if(ee(K)){if(qe=ee(K),typeof qe!="function")throw Error(c(150));return K=qe.call(K),Xe(X,V,K,he)}if(typeof K.then=="function")return yt(X,V,Mr(K),he);if(K.$$typeof===Y)return yt(X,V,fr(X,K),he);Or(X,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,V!==null&&V.tag===6?(a(X,V.sibling),he=n(V,K),he.return=X,X=he):(a(X,V),he=Xi(K,X.mode,he),he.return=X,X=he),m(X)):a(X,V)}return function(X,V,K,he){try{wn=0;var qe=yt(X,V,K,he);return Cl=null,qe}catch(Ie){if(Ie===mn||Ie===pr)throw Ie;var nt=gs(29,Ie,null,X.mode);return nt.lanes=he,nt.return=X,nt}finally{}}}var Ml=Zu(!0),Ku=Zu(!1),Os=T(null),Ys=null;function ga(t){var s=t.alternate;R(Vt,Vt.current&1),R(Os,t),Ys===null&&(s===null||jl.current!==null||s.memoizedState!==null)&&(Ys=t)}function Ju(t){if(t.tag===22){if(R(Vt,Vt.current),R(Os,t),Ys===null){var s=t.alternate;s!==null&&s.memoizedState!==null&&(Ys=t)}}else pa()}function pa(){R(Vt,Vt.current),R(Os,Os.current)}function Zs(t){E(Os),Ys===t&&(Ys=null),E(Vt)}var Vt=T(0);function Er(t){for(var s=t;s!==null;){if(s.tag===13){var a=s.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||yc(a)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Eo(t,s,a,l){s=t.memoizedState,a=a(l,s),a=a==null?s:v({},s,a),t.memoizedState=a,t.lanes===0&&(t.updateQueue.baseState=a)}var Bo={enqueueSetState:function(t,s,a){t=t._reactInternals;var l=vs(),n=ha(l);n.payload=s,a!=null&&(n.callback=a),s=xa(t,n,l),s!==null&&(ws(s,t,l),xn(s,t,l))},enqueueReplaceState:function(t,s,a){t=t._reactInternals;var l=vs(),n=ha(l);n.tag=1,n.payload=s,a!=null&&(n.callback=a),s=xa(t,n,l),s!==null&&(ws(s,t,l),xn(s,t,l))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var a=vs(),l=ha(a);l.tag=2,s!=null&&(l.callback=s),s=xa(t,l,a),s!==null&&(ws(s,t,a),xn(s,t,a))}};function em(t,s,a,l,n,r,m){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(l,r,m):s.prototype&&s.prototype.isPureReactComponent?!an(a,l)||!an(n,r):!0}function tm(t,s,a,l){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(a,l),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(a,l),s.state!==t&&Bo.enqueueReplaceState(s,s.state,null)}function Wa(t,s){var a=s;if("ref"in s){a={};for(var l in s)l!=="ref"&&(a[l]=s[l])}if(t=t.defaultProps){a===s&&(a=v({},a));for(var n in t)a[n]===void 0&&(a[n]=t[n])}return a}var Br=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)};function sm(t){Br(t)}function am(t){console.error(t)}function lm(t){Br(t)}function kr(t,s){try{var a=t.onUncaughtError;a(s.value,{componentStack:s.stack})}catch(l){setTimeout(function(){throw l})}}function nm(t,s,a){try{var l=t.onCaughtError;l(a.value,{componentStack:a.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function ko(t,s,a){return a=ha(a),a.tag=3,a.payload={element:null},a.callback=function(){kr(t,s)},a}function rm(t){return t=ha(t),t.tag=3,t}function im(t,s,a,l){var n=a.type.getDerivedStateFromError;if(typeof n=="function"){var r=l.value;t.payload=function(){return n(r)},t.callback=function(){nm(s,a,l)}}var m=a.stateNode;m!==null&&typeof m.componentDidCatch=="function"&&(t.callback=function(){nm(s,a,l),typeof n!="function"&&(ja===null?ja=new Set([this]):ja.add(this));var w=l.stack;this.componentDidCatch(l.value,{componentStack:w!==null?w:""})})}function Yx(t,s,a,l,n){if(a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(s=a.alternate,s!==null&&cn(s,a,n,!0),a=Os.current,a!==null){switch(a.tag){case 13:return Ys===null?sc():a.alternate===null&&kt===0&&(kt=3),a.flags&=-257,a.flags|=65536,a.lanes=n,l===ro?a.flags|=16384:(s=a.updateQueue,s===null?a.updateQueue=new Set([l]):s.add(l),lc(t,l,n)),!1;case 22:return a.flags|=65536,l===ro?a.flags|=16384:(s=a.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([l])},a.updateQueue=s):(a=s.retryQueue,a===null?s.retryQueue=new Set([l]):a.add(l)),lc(t,l,n)),!1}throw Error(c(435,a.tag))}return lc(t,l,n),sc(),!1}if(mt)return s=Os.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=n,l!==Ji&&(t=Error(c(422),{cause:l}),on(_s(t,a)))):(l!==Ji&&(s=Error(c(423),{cause:l}),on(_s(s,a))),t=t.current.alternate,t.flags|=65536,n&=-n,t.lanes|=n,l=_s(l,a),n=ko(t.stateNode,l,n),co(t,n),kt!==4&&(kt=2)),!1;var r=Error(c(520),{cause:l});if(r=_s(r,a),On===null?On=[r]:On.push(r),kt!==4&&(kt=2),s===null)return!0;l=_s(l,a),a=s;do{switch(a.tag){case 3:return a.flags|=65536,t=n&-n,a.lanes|=t,t=ko(a.stateNode,l,t),co(a,t),!1;case 1:if(s=a.type,r=a.stateNode,(a.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(ja===null||!ja.has(r))))return a.flags|=65536,n&=-n,a.lanes|=n,n=rm(n),im(n,t,a,l),co(a,n),!1}a=a.return}while(a!==null);return!1}var om=Error(c(461)),Ft=!1;function Kt(t,s,a,l){s.child=t===null?Ku(s,null,a,l):Ml(s,t.child,a,l)}function cm(t,s,a,l,n){a=a.render;var r=s.ref;if("ref"in l){var m={};for(var w in l)w!=="ref"&&(m[w]=l[w])}else m=l;return Fa(s),l=fo(t,s,a,m,r,n),w=go(),t!==null&&!Ft?(po(t,s,n),Ks(t,s,n)):(mt&&w&&Zi(s),s.flags|=1,Kt(t,s,l,n),s.child)}function dm(t,s,a,l,n){if(t===null){var r=a.type;return typeof r=="function"&&!Qi(r)&&r.defaultProps===void 0&&a.compare===null?(s.tag=15,s.type=r,um(t,s,r,l,n)):(t=ur(a.type,null,l,s,s.mode,n),t.ref=s.ref,t.return=s,s.child=t)}if(r=t.child,!Uo(t,n)){var m=r.memoizedProps;if(a=a.compare,a=a!==null?a:an,a(m,l)&&t.ref===s.ref)return Ks(t,s,n)}return s.flags|=1,t=Is(r,l),t.ref=s.ref,t.return=s,s.child=t}function um(t,s,a,l,n){if(t!==null){var r=t.memoizedProps;if(an(r,l)&&t.ref===s.ref)if(Ft=!1,s.pendingProps=l=r,Uo(t,n))(t.flags&131072)!==0&&(Ft=!0);else return s.lanes=t.lanes,Ks(t,s,n)}return To(t,s,a,l,n)}function mm(t,s,a){var l=s.pendingProps,n=l.children,r=t!==null?t.memoizedState:null;if(l.mode==="hidden"){if((s.flags&128)!==0){if(l=r!==null?r.baseLanes|a:a,t!==null){for(n=s.child=t.child,r=0;n!==null;)r=r|n.lanes|n.childLanes,n=n.sibling;s.childLanes=r&~l}else s.childLanes=0,s.child=null;return hm(t,s,l,a)}if((a&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},t!==null&&gr(s,r!==null?r.cachePool:null),r!==null?uu(s,r):mo(),Ju(s);else return s.lanes=s.childLanes=536870912,hm(t,s,r!==null?r.baseLanes|a:a,a)}else r!==null?(gr(s,r.cachePool),uu(s,r),pa(),s.memoizedState=null):(t!==null&&gr(s,null),mo(),pa());return Kt(t,s,n,a),s.child}function hm(t,s,a,l){var n=no();return n=n===null?null:{parent:Ht._currentValue,pool:n},s.memoizedState={baseLanes:a,cachePool:n},t!==null&&gr(s,null),mo(),Ju(s),t!==null&&cn(t,s,l,!0),null}function Tr(t,s){var a=s.ref;if(a===null)t!==null&&t.ref!==null&&(s.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(c(284));(t===null||t.ref!==a)&&(s.flags|=4194816)}}function To(t,s,a,l,n){return Fa(s),a=fo(t,s,a,l,void 0,n),l=go(),t!==null&&!Ft?(po(t,s,n),Ks(t,s,n)):(mt&&l&&Zi(s),s.flags|=1,Kt(t,s,a,n),s.child)}function xm(t,s,a,l,n,r){return Fa(s),s.updateQueue=null,a=hu(s,l,a,n),mu(t),l=go(),t!==null&&!Ft?(po(t,s,r),Ks(t,s,r)):(mt&&l&&Zi(s),s.flags|=1,Kt(t,s,a,r),s.child)}function fm(t,s,a,l,n){if(Fa(s),s.stateNode===null){var r=bl,m=a.contextType;typeof m=="object"&&m!==null&&(r=as(m)),r=new a(l,r),s.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Bo,s.stateNode=r,r._reactInternals=s,r=s.stateNode,r.props=l,r.state=s.memoizedState,r.refs={},io(s),m=a.contextType,r.context=typeof m=="object"&&m!==null?as(m):bl,r.state=s.memoizedState,m=a.getDerivedStateFromProps,typeof m=="function"&&(Eo(s,a,m,l),r.state=s.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(m=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),m!==r.state&&Bo.enqueueReplaceState(r,r.state,null),gn(s,l,r,n),fn(),r.state=s.memoizedState),typeof r.componentDidMount=="function"&&(s.flags|=4194308),l=!0}else if(t===null){r=s.stateNode;var w=s.memoizedProps,L=Wa(a,w);r.props=L;var J=r.context,de=a.contextType;m=bl,typeof de=="object"&&de!==null&&(m=as(de));var xe=a.getDerivedStateFromProps;de=typeof xe=="function"||typeof r.getSnapshotBeforeUpdate=="function",w=s.pendingProps!==w,de||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(w||J!==m)&&tm(s,r,l,m),ma=!1;var te=s.memoizedState;r.state=te,gn(s,l,r,n),fn(),J=s.memoizedState,w||te!==J||ma?(typeof xe=="function"&&(Eo(s,a,xe,l),J=s.memoizedState),(L=ma||em(s,a,L,l,te,J,m))?(de||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(s.flags|=4194308)):(typeof r.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=l,s.memoizedState=J),r.props=l,r.state=J,r.context=m,l=L):(typeof r.componentDidMount=="function"&&(s.flags|=4194308),l=!1)}else{r=s.stateNode,oo(t,s),m=s.memoizedProps,de=Wa(a,m),r.props=de,xe=s.pendingProps,te=r.context,J=a.contextType,L=bl,typeof J=="object"&&J!==null&&(L=as(J)),w=a.getDerivedStateFromProps,(J=typeof w=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(m!==xe||te!==L)&&tm(s,r,l,L),ma=!1,te=s.memoizedState,r.state=te,gn(s,l,r,n),fn();var ae=s.memoizedState;m!==xe||te!==ae||ma||t!==null&&t.dependencies!==null&&xr(t.dependencies)?(typeof w=="function"&&(Eo(s,a,w,l),ae=s.memoizedState),(de=ma||em(s,a,de,l,te,ae,L)||t!==null&&t.dependencies!==null&&xr(t.dependencies))?(J||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(l,ae,L),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(l,ae,L)),typeof r.componentDidUpdate=="function"&&(s.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof r.componentDidUpdate!="function"||m===t.memoizedProps&&te===t.memoizedState||(s.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||m===t.memoizedProps&&te===t.memoizedState||(s.flags|=1024),s.memoizedProps=l,s.memoizedState=ae),r.props=l,r.state=ae,r.context=L,l=de):(typeof r.componentDidUpdate!="function"||m===t.memoizedProps&&te===t.memoizedState||(s.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||m===t.memoizedProps&&te===t.memoizedState||(s.flags|=1024),l=!1)}return r=l,Tr(t,s),l=(s.flags&128)!==0,r||l?(r=s.stateNode,a=l&&typeof a.getDerivedStateFromError!="function"?null:r.render(),s.flags|=1,t!==null&&l?(s.child=Ml(s,t.child,null,n),s.child=Ml(s,null,a,n)):Kt(t,s,a,n),s.memoizedState=r.state,t=s.child):t=Ks(t,s,n),t}function gm(t,s,a,l){return rn(),s.flags|=256,Kt(t,s,a,l),s.child}var Do={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Lo(t){return{baseLanes:t,cachePool:au()}}function Ro(t,s,a){return t=t!==null?t.childLanes&~a:0,s&&(t|=Es),t}function pm(t,s,a){var l=s.pendingProps,n=!1,r=(s.flags&128)!==0,m;if((m=r)||(m=t!==null&&t.memoizedState===null?!1:(Vt.current&2)!==0),m&&(n=!0,s.flags&=-129),m=(s.flags&32)!==0,s.flags&=-33,t===null){if(mt){if(n?ga(s):pa(),mt){var w=Bt,L;if(L=w){e:{for(L=w,w=zs;L.nodeType!==8;){if(!w){w=null;break e}if(L=Rs(L.nextSibling),L===null){w=null;break e}}w=L}w!==null?(s.memoizedState={dehydrated:w,treeContext:Pa!==null?{id:Gs,overflow:Fs}:null,retryLane:536870912,hydrationErrors:null},L=gs(18,null,null,0),L.stateNode=w,L.return=s,s.child=L,os=s,Bt=null,L=!0):L=!1}L||Ia(s)}if(w=s.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return yc(w)?s.lanes=32:s.lanes=536870912,null;Zs(s)}return w=l.children,l=l.fallback,n?(pa(),n=s.mode,w=Dr({mode:"hidden",children:w},n),l=qa(l,n,a,null),w.return=s,l.return=s,w.sibling=l,s.child=w,n=s.child,n.memoizedState=Lo(a),n.childLanes=Ro(t,m,a),s.memoizedState=Do,l):(ga(s),zo(s,w))}if(L=t.memoizedState,L!==null&&(w=L.dehydrated,w!==null)){if(r)s.flags&256?(ga(s),s.flags&=-257,s=Yo(t,s,a)):s.memoizedState!==null?(pa(),s.child=t.child,s.flags|=128,s=null):(pa(),n=l.fallback,w=s.mode,l=Dr({mode:"visible",children:l.children},w),n=qa(n,w,a,null),n.flags|=2,l.return=s,n.return=s,l.sibling=n,s.child=l,Ml(s,t.child,null,a),l=s.child,l.memoizedState=Lo(a),l.childLanes=Ro(t,m,a),s.memoizedState=Do,s=n);else if(ga(s),yc(w)){if(m=w.nextSibling&&w.nextSibling.dataset,m)var J=m.dgst;m=J,l=Error(c(419)),l.stack="",l.digest=m,on({value:l,source:null,stack:null}),s=Yo(t,s,a)}else if(Ft||cn(t,s,a,!1),m=(a&t.childLanes)!==0,Ft||m){if(m=jt,m!==null&&(l=a&-a,l=(l&42)!==0?1:b(l),l=(l&(m.suspendedLanes|a))!==0?0:l,l!==0&&l!==L.retryLane))throw L.retryLane=l,pl(t,l),ws(m,t,l),om;w.data==="$?"||sc(),s=Yo(t,s,a)}else w.data==="$?"?(s.flags|=192,s.child=t.child,s=null):(t=L.treeContext,Bt=Rs(w.nextSibling),os=s,mt=!0,Va=null,zs=!1,t!==null&&(Cs[Ms++]=Gs,Cs[Ms++]=Fs,Cs[Ms++]=Pa,Gs=t.id,Fs=t.overflow,Pa=s),s=zo(s,l.children),s.flags|=4096);return s}return n?(pa(),n=l.fallback,w=s.mode,L=t.child,J=L.sibling,l=Is(L,{mode:"hidden",children:l.children}),l.subtreeFlags=L.subtreeFlags&65011712,J!==null?n=Is(J,n):(n=qa(n,w,a,null),n.flags|=2),n.return=s,l.return=s,l.sibling=n,s.child=l,l=n,n=s.child,w=t.child.memoizedState,w===null?w=Lo(a):(L=w.cachePool,L!==null?(J=Ht._currentValue,L=L.parent!==J?{parent:J,pool:J}:L):L=au(),w={baseLanes:w.baseLanes|a,cachePool:L}),n.memoizedState=w,n.childLanes=Ro(t,m,a),s.memoizedState=Do,l):(ga(s),a=t.child,t=a.sibling,a=Is(a,{mode:"visible",children:l.children}),a.return=s,a.sibling=null,t!==null&&(m=s.deletions,m===null?(s.deletions=[t],s.flags|=16):m.push(t)),s.child=a,s.memoizedState=null,a)}function zo(t,s){return s=Dr({mode:"visible",children:s},t.mode),s.return=t,t.child=s}function Dr(t,s){return t=gs(22,t,null,s),t.lanes=0,t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},t}function Yo(t,s,a){return Ml(s,t.child,null,a),t=zo(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function bm(t,s,a){t.lanes|=s;var l=t.alternate;l!==null&&(l.lanes|=s),to(t.return,s,a)}function $o(t,s,a,l,n){var r=t.memoizedState;r===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:l,tail:a,tailMode:n}:(r.isBackwards=s,r.rendering=null,r.renderingStartTime=0,r.last=l,r.tail=a,r.tailMode=n)}function ym(t,s,a){var l=s.pendingProps,n=l.revealOrder,r=l.tail;if(Kt(t,s,l.children,a),l=Vt.current,(l&2)!==0)l=l&1|2,s.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bm(t,a,s);else if(t.tag===19)bm(t,a,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}l&=1}switch(R(Vt,l),n){case"forwards":for(a=s.child,n=null;a!==null;)t=a.alternate,t!==null&&Er(t)===null&&(n=a),a=a.sibling;a=n,a===null?(n=s.child,s.child=null):(n=a.sibling,a.sibling=null),$o(s,!1,n,a,r);break;case"backwards":for(a=null,n=s.child,s.child=null;n!==null;){if(t=n.alternate,t!==null&&Er(t)===null){s.child=n;break}t=n.sibling,n.sibling=a,a=n,n=t}$o(s,!0,a,null,r);break;case"together":$o(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ks(t,s,a){if(t!==null&&(s.dependencies=t.dependencies),Na|=s.lanes,(a&s.childLanes)===0)if(t!==null){if(cn(t,s,a,!1),(a&s.childLanes)===0)return null}else return null;if(t!==null&&s.child!==t.child)throw Error(c(153));if(s.child!==null){for(t=s.child,a=Is(t,t.pendingProps),s.child=a,a.return=s;t.sibling!==null;)t=t.sibling,a=a.sibling=Is(t,t.pendingProps),a.return=s;a.sibling=null}return s.child}function Uo(t,s){return(t.lanes&s)!==0?!0:(t=t.dependencies,!!(t!==null&&xr(t)))}function $x(t,s,a){switch(s.tag){case 3:I(s,s.stateNode.containerInfo),ua(s,Ht,t.memoizedState.cache),rn();break;case 27:case 5:oe(s);break;case 4:I(s,s.stateNode.containerInfo);break;case 10:ua(s,s.type,s.memoizedProps.value);break;case 13:var l=s.memoizedState;if(l!==null)return l.dehydrated!==null?(ga(s),s.flags|=128,null):(a&s.child.childLanes)!==0?pm(t,s,a):(ga(s),t=Ks(t,s,a),t!==null?t.sibling:null);ga(s);break;case 19:var n=(t.flags&128)!==0;if(l=(a&s.childLanes)!==0,l||(cn(t,s,a,!1),l=(a&s.childLanes)!==0),n){if(l)return ym(t,s,a);s.flags|=128}if(n=s.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),R(Vt,Vt.current),l)break;return null;case 22:case 23:return s.lanes=0,mm(t,s,a);case 24:ua(s,Ht,t.memoizedState.cache)}return Ks(t,s,a)}function vm(t,s,a){if(t!==null)if(t.memoizedProps!==s.pendingProps)Ft=!0;else{if(!Uo(t,a)&&(s.flags&128)===0)return Ft=!1,$x(t,s,a);Ft=(t.flags&131072)!==0}else Ft=!1,mt&&(s.flags&1048576)!==0&&Wd(s,hr,s.index);switch(s.lanes=0,s.tag){case 16:e:{t=s.pendingProps;var l=s.elementType,n=l._init;if(l=n(l._payload),s.type=l,typeof l=="function")Qi(l)?(t=Wa(l,t),s.tag=1,s=fm(null,s,l,t,a)):(s.tag=0,s=To(null,s,l,t,a));else{if(l!=null){if(n=l.$$typeof,n===Z){s.tag=11,s=cm(null,s,l,t,a);break e}else if(n===Be){s.tag=14,s=dm(null,s,l,t,a);break e}}throw s=$(l)||l,Error(c(306,s,""))}}return s;case 0:return To(t,s,s.type,s.pendingProps,a);case 1:return l=s.type,n=Wa(l,s.pendingProps),fm(t,s,l,n,a);case 3:e:{if(I(s,s.stateNode.containerInfo),t===null)throw Error(c(387));l=s.pendingProps;var r=s.memoizedState;n=r.element,oo(t,s),gn(s,l,null,a);var m=s.memoizedState;if(l=m.cache,ua(s,Ht,l),l!==r.cache&&so(s,[Ht],a,!0),fn(),l=m.element,r.isDehydrated)if(r={element:l,isDehydrated:!1,cache:m.cache},s.updateQueue.baseState=r,s.memoizedState=r,s.flags&256){s=gm(t,s,l,a);break e}else if(l!==n){n=_s(Error(c(424)),s),on(n),s=gm(t,s,l,a);break e}else{switch(t=s.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Bt=Rs(t.firstChild),os=s,mt=!0,Va=null,zs=!0,a=Ku(s,null,l,a),s.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(rn(),l===n){s=Ks(t,s,a);break e}Kt(t,s,l,a)}s=s.child}return s;case 26:return Tr(t,s),t===null?(a=S0(s.type,null,s.pendingProps,null))?s.memoizedState=a:mt||(a=s.type,t=s.pendingProps,l=Qr(Me.current).createElement(a),l[Ke]=s,l[ot]=t,es(l,a,t),Gt(l),s.stateNode=l):s.memoizedState=S0(s.type,t.memoizedProps,s.pendingProps,t.memoizedState),null;case 27:return oe(s),t===null&&mt&&(l=s.stateNode=w0(s.type,s.pendingProps,Me.current),os=s,zs=!0,n=Bt,Aa(s.type)?(vc=n,Bt=Rs(l.firstChild)):Bt=n),Kt(t,s,s.pendingProps.children,a),Tr(t,s),t===null&&(s.flags|=4194304),s.child;case 5:return t===null&&mt&&((n=l=Bt)&&(l=xf(l,s.type,s.pendingProps,zs),l!==null?(s.stateNode=l,os=s,Bt=Rs(l.firstChild),zs=!1,n=!0):n=!1),n||Ia(s)),oe(s),n=s.type,r=s.pendingProps,m=t!==null?t.memoizedProps:null,l=r.children,gc(n,r)?l=null:m!==null&&gc(n,m)&&(s.flags|=32),s.memoizedState!==null&&(n=fo(t,s,Bx,null,null,a),Yn._currentValue=n),Tr(t,s),Kt(t,s,l,a),s.child;case 6:return t===null&&mt&&((t=a=Bt)&&(a=ff(a,s.pendingProps,zs),a!==null?(s.stateNode=a,os=s,Bt=null,t=!0):t=!1),t||Ia(s)),null;case 13:return pm(t,s,a);case 4:return I(s,s.stateNode.containerInfo),l=s.pendingProps,t===null?s.child=Ml(s,null,l,a):Kt(t,s,l,a),s.child;case 11:return cm(t,s,s.type,s.pendingProps,a);case 7:return Kt(t,s,s.pendingProps,a),s.child;case 8:return Kt(t,s,s.pendingProps.children,a),s.child;case 12:return Kt(t,s,s.pendingProps.children,a),s.child;case 10:return l=s.pendingProps,ua(s,s.type,l.value),Kt(t,s,l.children,a),s.child;case 9:return n=s.type._context,l=s.pendingProps.children,Fa(s),n=as(n),l=l(n),s.flags|=1,Kt(t,s,l,a),s.child;case 14:return dm(t,s,s.type,s.pendingProps,a);case 15:return um(t,s,s.type,s.pendingProps,a);case 19:return ym(t,s,a);case 31:return l=s.pendingProps,a=s.mode,l={mode:l.mode,children:l.children},t===null?(a=Dr(l,a),a.ref=s.ref,s.child=a,a.return=s,s=a):(a=Is(t.child,l),a.ref=s.ref,s.child=a,a.return=s,s=a),s;case 22:return mm(t,s,a);case 24:return Fa(s),l=as(Ht),t===null?(n=no(),n===null&&(n=jt,r=ao(),n.pooledCache=r,r.refCount++,r!==null&&(n.pooledCacheLanes|=a),n=r),s.memoizedState={parent:l,cache:n},io(s),ua(s,Ht,n)):((t.lanes&a)!==0&&(oo(t,s),gn(s,null,null,a),fn()),n=t.memoizedState,r=s.memoizedState,n.parent!==l?(n={parent:l,cache:l},s.memoizedState=n,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=n),ua(s,Ht,l)):(l=r.cache,ua(s,Ht,l),l!==n.cache&&so(s,[Ht],a,!0))),Kt(t,s,s.pendingProps.children,a),s.child;case 29:throw s.pendingProps}throw Error(c(156,s.tag))}function Js(t){t.flags|=4}function wm(t,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!O0(s)){if(s=Os.current,s!==null&&((ct&4194048)===ct?Ys!==null:(ct&62914560)!==ct&&(ct&536870912)===0||s!==Ys))throw hn=ro,lu;t.flags|=8192}}function Lr(t,s){s!==null&&(t.flags|=4),t.flags&16384&&(s=t.tag!==22?me():536870912,t.lanes|=s,kl|=s)}function jn(t,s){if(!mt)switch(t.tailMode){case"hidden":s=t.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?t.tail=null:a.sibling=null;break;case"collapsed":a=t.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:l.sibling=null}}function Ot(t){var s=t.alternate!==null&&t.alternate.child===t.child,a=0,l=0;if(s)for(var n=t.child;n!==null;)a|=n.lanes|n.childLanes,l|=n.subtreeFlags&65011712,l|=n.flags&65011712,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)a|=n.lanes|n.childLanes,l|=n.subtreeFlags,l|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=l,t.childLanes=a,s}function Ux(t,s,a){var l=s.pendingProps;switch(Ki(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(s),null;case 1:return Ot(s),null;case 3:return a=s.stateNode,l=null,t!==null&&(l=t.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),Xs(Ht),ge(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(t===null||t.child===null)&&(nn(s)?Js(s):t===null||t.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Jd())),Ot(s),null;case 26:return a=s.memoizedState,t===null?(Js(s),a!==null?(Ot(s),wm(s,a)):(Ot(s),s.flags&=-16777217)):a?a!==t.memoizedState?(Js(s),Ot(s),wm(s,a)):(Ot(s),s.flags&=-16777217):(t.memoizedProps!==l&&Js(s),Ot(s),s.flags&=-16777217),null;case 27:Le(s),a=Me.current;var n=s.type;if(t!==null&&s.stateNode!=null)t.memoizedProps!==l&&Js(s);else{if(!l){if(s.stateNode===null)throw Error(c(166));return Ot(s),null}t=Q.current,nn(s)?Zd(s):(t=w0(n,l,a),s.stateNode=t,Js(s))}return Ot(s),null;case 5:if(Le(s),a=s.type,t!==null&&s.stateNode!=null)t.memoizedProps!==l&&Js(s);else{if(!l){if(s.stateNode===null)throw Error(c(166));return Ot(s),null}if(t=Q.current,nn(s))Zd(s);else{switch(n=Qr(Me.current),t){case 1:t=n.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:t=n.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":t=n.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":t=n.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":t=n.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof l.is=="string"?n.createElement("select",{is:l.is}):n.createElement("select"),l.multiple?t.multiple=!0:l.size&&(t.size=l.size);break;default:t=typeof l.is=="string"?n.createElement(a,{is:l.is}):n.createElement(a)}}t[Ke]=s,t[ot]=l;e:for(n=s.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.tag!==27&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break e;for(;n.sibling===null;){if(n.return===null||n.return===s)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s.stateNode=t;e:switch(es(t,a,l),a){case"button":case"input":case"select":case"textarea":t=!!l.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&Js(s)}}return Ot(s),s.flags&=-16777217,null;case 6:if(t&&s.stateNode!=null)t.memoizedProps!==l&&Js(s);else{if(typeof l!="string"&&s.stateNode===null)throw Error(c(166));if(t=Me.current,nn(s)){if(t=s.stateNode,a=s.memoizedProps,l=null,n=os,n!==null)switch(n.tag){case 27:case 5:l=n.memoizedProps}t[Ke]=s,t=!!(t.nodeValue===a||l!==null&&l.suppressHydrationWarning===!0||x0(t.nodeValue,a)),t||Ia(s)}else t=Qr(t).createTextNode(l),t[Ke]=s,s.stateNode=t}return Ot(s),null;case 13:if(l=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(n=nn(s),l!==null&&l.dehydrated!==null){if(t===null){if(!n)throw Error(c(318));if(n=s.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(c(317));n[Ke]=s}else rn(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Ot(s),n=!1}else n=Jd(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=n),n=!0;if(!n)return s.flags&256?(Zs(s),s):(Zs(s),null)}if(Zs(s),(s.flags&128)!==0)return s.lanes=a,s;if(a=l!==null,t=t!==null&&t.memoizedState!==null,a){l=s.child,n=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(n=l.alternate.memoizedState.cachePool.pool);var r=null;l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(r=l.memoizedState.cachePool.pool),r!==n&&(l.flags|=2048)}return a!==t&&a&&(s.child.flags|=8192),Lr(s,s.updateQueue),Ot(s),null;case 4:return ge(),t===null&&uc(s.stateNode.containerInfo),Ot(s),null;case 10:return Xs(s.type),Ot(s),null;case 19:if(E(Vt),n=s.memoizedState,n===null)return Ot(s),null;if(l=(s.flags&128)!==0,r=n.rendering,r===null)if(l)jn(n,!1);else{if(kt!==0||t!==null&&(t.flags&128)!==0)for(t=s.child;t!==null;){if(r=Er(t),r!==null){for(s.flags|=128,jn(n,!1),t=r.updateQueue,s.updateQueue=t,Lr(s,t),s.subtreeFlags=0,t=a,a=s.child;a!==null;)Xd(a,t),a=a.sibling;return R(Vt,Vt.current&1|2),s.child}t=t.sibling}n.tail!==null&&Ye()>Yr&&(s.flags|=128,l=!0,jn(n,!1),s.lanes=4194304)}else{if(!l)if(t=Er(r),t!==null){if(s.flags|=128,l=!0,t=t.updateQueue,s.updateQueue=t,Lr(s,t),jn(n,!0),n.tail===null&&n.tailMode==="hidden"&&!r.alternate&&!mt)return Ot(s),null}else 2*Ye()-n.renderingStartTime>Yr&&a!==536870912&&(s.flags|=128,l=!0,jn(n,!1),s.lanes=4194304);n.isBackwards?(r.sibling=s.child,s.child=r):(t=n.last,t!==null?t.sibling=r:s.child=r,n.last=r)}return n.tail!==null?(s=n.tail,n.rendering=s,n.tail=s.sibling,n.renderingStartTime=Ye(),s.sibling=null,t=Vt.current,R(Vt,l?t&1|2:t&1),s):(Ot(s),null);case 22:case 23:return Zs(s),ho(),l=s.memoizedState!==null,t!==null?t.memoizedState!==null!==l&&(s.flags|=8192):l&&(s.flags|=8192),l?(a&536870912)!==0&&(s.flags&128)===0&&(Ot(s),s.subtreeFlags&6&&(s.flags|=8192)):Ot(s),a=s.updateQueue,a!==null&&Lr(s,a.retryQueue),a=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),l=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),l!==a&&(s.flags|=2048),t!==null&&E(Qa),null;case 24:return a=null,t!==null&&(a=t.memoizedState.cache),s.memoizedState.cache!==a&&(s.flags|=2048),Xs(Ht),Ot(s),null;case 25:return null;case 30:return null}throw Error(c(156,s.tag))}function qx(t,s){switch(Ki(s),s.tag){case 1:return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return Xs(Ht),ge(),t=s.flags,(t&65536)!==0&&(t&128)===0?(s.flags=t&-65537|128,s):null;case 26:case 27:case 5:return Le(s),null;case 13:if(Zs(s),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(c(340));rn()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return E(Vt),null;case 4:return ge(),null;case 10:return Xs(s.type),null;case 22:case 23:return Zs(s),ho(),t!==null&&E(Qa),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 24:return Xs(Ht),null;case 25:return null;default:return null}}function Nm(t,s){switch(Ki(s),s.tag){case 3:Xs(Ht),ge();break;case 26:case 27:case 5:Le(s);break;case 4:ge();break;case 13:Zs(s);break;case 19:E(Vt);break;case 10:Xs(s.type);break;case 22:case 23:Zs(s),ho(),t!==null&&E(Qa);break;case 24:Xs(Ht)}}function Sn(t,s){try{var a=s.updateQueue,l=a!==null?a.lastEffect:null;if(l!==null){var n=l.next;a=n;do{if((a.tag&t)===t){l=void 0;var r=a.create,m=a.inst;l=r(),m.destroy=l}a=a.next}while(a!==n)}}catch(w){wt(s,s.return,w)}}function ba(t,s,a){try{var l=s.updateQueue,n=l!==null?l.lastEffect:null;if(n!==null){var r=n.next;l=r;do{if((l.tag&t)===t){var m=l.inst,w=m.destroy;if(w!==void 0){m.destroy=void 0,n=s;var L=a,J=w;try{J()}catch(de){wt(n,L,de)}}}l=l.next}while(l!==r)}}catch(de){wt(s,s.return,de)}}function jm(t){var s=t.updateQueue;if(s!==null){var a=t.stateNode;try{du(s,a)}catch(l){wt(t,t.return,l)}}}function Sm(t,s,a){a.props=Wa(t.type,t.memoizedProps),a.state=t.memoizedState;try{a.componentWillUnmount()}catch(l){wt(t,s,l)}}function _n(t,s){try{var a=t.ref;if(a!==null){switch(t.tag){case 26:case 27:case 5:var l=t.stateNode;break;case 30:l=t.stateNode;break;default:l=t.stateNode}typeof a=="function"?t.refCleanup=a(l):a.current=l}}catch(n){wt(t,s,n)}}function $s(t,s){var a=t.ref,l=t.refCleanup;if(a!==null)if(typeof l=="function")try{l()}catch(n){wt(t,s,n)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(n){wt(t,s,n)}else a.current=null}function _m(t){var s=t.type,a=t.memoizedProps,l=t.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":a.autoFocus&&l.focus();break e;case"img":a.src?l.src=a.src:a.srcSet&&(l.srcset=a.srcSet)}}catch(n){wt(t,t.return,n)}}function qo(t,s,a){try{var l=t.stateNode;cf(l,t.type,a,s),l[ot]=s}catch(n){wt(t,t.return,n)}}function Am(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Aa(t.type)||t.tag===4}function Po(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Am(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Aa(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ho(t,s,a){var l=t.tag;if(l===5||l===6)t=t.stateNode,s?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(t,s):(s=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,s.appendChild(t),a=a._reactRootContainer,a!=null||s.onclick!==null||(s.onclick=Fr));else if(l!==4&&(l===27&&Aa(t.type)&&(a=t.stateNode,s=null),t=t.child,t!==null))for(Ho(t,s,a),t=t.sibling;t!==null;)Ho(t,s,a),t=t.sibling}function Rr(t,s,a){var l=t.tag;if(l===5||l===6)t=t.stateNode,s?a.insertBefore(t,s):a.appendChild(t);else if(l!==4&&(l===27&&Aa(t.type)&&(a=t.stateNode),t=t.child,t!==null))for(Rr(t,s,a),t=t.sibling;t!==null;)Rr(t,s,a),t=t.sibling}function Cm(t){var s=t.stateNode,a=t.memoizedProps;try{for(var l=t.type,n=s.attributes;n.length;)s.removeAttributeNode(n[0]);es(s,l,a),s[Ke]=t,s[ot]=a}catch(r){wt(t,t.return,r)}}var ea=!1,Rt=!1,Vo=!1,Mm=typeof WeakSet=="function"?WeakSet:Set,Qt=null;function Px(t,s){if(t=t.containerInfo,xc=ei,t=$d(t),qi(t)){if("selectionStart"in t)var a={start:t.selectionStart,end:t.selectionEnd};else e:{a=(a=t.ownerDocument)&&a.defaultView||window;var l=a.getSelection&&a.getSelection();if(l&&l.rangeCount!==0){a=l.anchorNode;var n=l.anchorOffset,r=l.focusNode;l=l.focusOffset;try{a.nodeType,r.nodeType}catch{a=null;break e}var m=0,w=-1,L=-1,J=0,de=0,xe=t,te=null;t:for(;;){for(var ae;xe!==a||n!==0&&xe.nodeType!==3||(w=m+n),xe!==r||l!==0&&xe.nodeType!==3||(L=m+l),xe.nodeType===3&&(m+=xe.nodeValue.length),(ae=xe.firstChild)!==null;)te=xe,xe=ae;for(;;){if(xe===t)break t;if(te===a&&++J===n&&(w=m),te===r&&++de===l&&(L=m),(ae=xe.nextSibling)!==null)break;xe=te,te=xe.parentNode}xe=ae}a=w===-1||L===-1?null:{start:w,end:L}}else a=null}a=a||{start:0,end:0}}else a=null;for(fc={focusedElem:t,selectionRange:a},ei=!1,Qt=s;Qt!==null;)if(s=Qt,t=s.child,(s.subtreeFlags&1024)!==0&&t!==null)t.return=s,Qt=t;else for(;Qt!==null;){switch(s=Qt,r=s.alternate,t=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((t&1024)!==0&&r!==null){t=void 0,a=s,n=r.memoizedProps,r=r.memoizedState,l=a.stateNode;try{var Je=Wa(a.type,n,a.elementType===a.type);t=l.getSnapshotBeforeUpdate(Je,r),l.__reactInternalSnapshotBeforeUpdate=t}catch(Xe){wt(a,a.return,Xe)}}break;case 3:if((t&1024)!==0){if(t=s.stateNode.containerInfo,a=t.nodeType,a===9)bc(t);else if(a===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":bc(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(c(163))}if(t=s.sibling,t!==null){t.return=s.return,Qt=t;break}Qt=s.return}}function Om(t,s,a){var l=a.flags;switch(a.tag){case 0:case 11:case 15:ya(t,a),l&4&&Sn(5,a);break;case 1:if(ya(t,a),l&4)if(t=a.stateNode,s===null)try{t.componentDidMount()}catch(m){wt(a,a.return,m)}else{var n=Wa(a.type,s.memoizedProps);s=s.memoizedState;try{t.componentDidUpdate(n,s,t.__reactInternalSnapshotBeforeUpdate)}catch(m){wt(a,a.return,m)}}l&64&&jm(a),l&512&&_n(a,a.return);break;case 3:if(ya(t,a),l&64&&(t=a.updateQueue,t!==null)){if(s=null,a.child!==null)switch(a.child.tag){case 27:case 5:s=a.child.stateNode;break;case 1:s=a.child.stateNode}try{du(t,s)}catch(m){wt(a,a.return,m)}}break;case 27:s===null&&l&4&&Cm(a);case 26:case 5:ya(t,a),s===null&&l&4&&_m(a),l&512&&_n(a,a.return);break;case 12:ya(t,a);break;case 13:ya(t,a),l&4&&km(t,a),l&64&&(t=a.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(a=Zx.bind(null,a),gf(t,a))));break;case 22:if(l=a.memoizedState!==null||ea,!l){s=s!==null&&s.memoizedState!==null||Rt,n=ea;var r=Rt;ea=l,(Rt=s)&&!r?va(t,a,(a.subtreeFlags&8772)!==0):ya(t,a),ea=n,Rt=r}break;case 30:break;default:ya(t,a)}}function Em(t){var s=t.alternate;s!==null&&(t.alternate=null,Em(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&Ni(s)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Ct=null,ms=!1;function ta(t,s,a){for(a=a.child;a!==null;)Bm(t,s,a),a=a.sibling}function Bm(t,s,a){if(ne&&typeof ne.onCommitFiberUnmount=="function")try{ne.onCommitFiberUnmount(k,a)}catch{}switch(a.tag){case 26:Rt||$s(a,s),ta(t,s,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Rt||$s(a,s);var l=Ct,n=ms;Aa(a.type)&&(Ct=a.stateNode,ms=!1),ta(t,s,a),Dn(a.stateNode),Ct=l,ms=n;break;case 5:Rt||$s(a,s);case 6:if(l=Ct,n=ms,Ct=null,ta(t,s,a),Ct=l,ms=n,Ct!==null)if(ms)try{(Ct.nodeType===9?Ct.body:Ct.nodeName==="HTML"?Ct.ownerDocument.body:Ct).removeChild(a.stateNode)}catch(r){wt(a,s,r)}else try{Ct.removeChild(a.stateNode)}catch(r){wt(a,s,r)}break;case 18:Ct!==null&&(ms?(t=Ct,y0(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,a.stateNode),Pn(t)):y0(Ct,a.stateNode));break;case 4:l=Ct,n=ms,Ct=a.stateNode.containerInfo,ms=!0,ta(t,s,a),Ct=l,ms=n;break;case 0:case 11:case 14:case 15:Rt||ba(2,a,s),Rt||ba(4,a,s),ta(t,s,a);break;case 1:Rt||($s(a,s),l=a.stateNode,typeof l.componentWillUnmount=="function"&&Sm(a,s,l)),ta(t,s,a);break;case 21:ta(t,s,a);break;case 22:Rt=(l=Rt)||a.memoizedState!==null,ta(t,s,a),Rt=l;break;default:ta(t,s,a)}}function km(t,s){if(s.memoizedState===null&&(t=s.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Pn(t)}catch(a){wt(s,s.return,a)}}function Hx(t){switch(t.tag){case 13:case 19:var s=t.stateNode;return s===null&&(s=t.stateNode=new Mm),s;case 22:return t=t.stateNode,s=t._retryCache,s===null&&(s=t._retryCache=new Mm),s;default:throw Error(c(435,t.tag))}}function Io(t,s){var a=Hx(t);s.forEach(function(l){var n=Kx.bind(null,t,l);a.has(l)||(a.add(l),l.then(n,n))})}function ps(t,s){var a=s.deletions;if(a!==null)for(var l=0;l<a.length;l++){var n=a[l],r=t,m=s,w=m;e:for(;w!==null;){switch(w.tag){case 27:if(Aa(w.type)){Ct=w.stateNode,ms=!1;break e}break;case 5:Ct=w.stateNode,ms=!1;break e;case 3:case 4:Ct=w.stateNode.containerInfo,ms=!0;break e}w=w.return}if(Ct===null)throw Error(c(160));Bm(r,m,n),Ct=null,ms=!1,r=n.alternate,r!==null&&(r.return=null),n.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Tm(s,t),s=s.sibling}var Ls=null;function Tm(t,s){var a=t.alternate,l=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:ps(s,t),bs(t),l&4&&(ba(3,t,t.return),Sn(3,t),ba(5,t,t.return));break;case 1:ps(s,t),bs(t),l&512&&(Rt||a===null||$s(a,a.return)),l&64&&ea&&(t=t.updateQueue,t!==null&&(l=t.callbacks,l!==null&&(a=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=a===null?l:a.concat(l))));break;case 26:var n=Ls;if(ps(s,t),bs(t),l&512&&(Rt||a===null||$s(a,a.return)),l&4){var r=a!==null?a.memoizedState:null;if(l=t.memoizedState,a===null)if(l===null)if(t.stateNode===null){e:{l=t.type,a=t.memoizedProps,n=n.ownerDocument||n;t:switch(l){case"title":r=n.getElementsByTagName("title")[0],(!r||r[Ql]||r[Ke]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=n.createElement(l),n.head.insertBefore(r,n.querySelector("head > title"))),es(r,l,a),r[Ke]=t,Gt(r),l=r;break e;case"link":var m=C0("link","href",n).get(l+(a.href||""));if(m){for(var w=0;w<m.length;w++)if(r=m[w],r.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&r.getAttribute("rel")===(a.rel==null?null:a.rel)&&r.getAttribute("title")===(a.title==null?null:a.title)&&r.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){m.splice(w,1);break t}}r=n.createElement(l),es(r,l,a),n.head.appendChild(r);break;case"meta":if(m=C0("meta","content",n).get(l+(a.content||""))){for(w=0;w<m.length;w++)if(r=m[w],r.getAttribute("content")===(a.content==null?null:""+a.content)&&r.getAttribute("name")===(a.name==null?null:a.name)&&r.getAttribute("property")===(a.property==null?null:a.property)&&r.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&r.getAttribute("charset")===(a.charSet==null?null:a.charSet)){m.splice(w,1);break t}}r=n.createElement(l),es(r,l,a),n.head.appendChild(r);break;default:throw Error(c(468,l))}r[Ke]=t,Gt(r),l=r}t.stateNode=l}else M0(n,t.type,t.stateNode);else t.stateNode=A0(n,l,t.memoizedProps);else r!==l?(r===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):r.count--,l===null?M0(n,t.type,t.stateNode):A0(n,l,t.memoizedProps)):l===null&&t.stateNode!==null&&qo(t,t.memoizedProps,a.memoizedProps)}break;case 27:ps(s,t),bs(t),l&512&&(Rt||a===null||$s(a,a.return)),a!==null&&l&4&&qo(t,t.memoizedProps,a.memoizedProps);break;case 5:if(ps(s,t),bs(t),l&512&&(Rt||a===null||$s(a,a.return)),t.flags&32){n=t.stateNode;try{dl(n,"")}catch(ae){wt(t,t.return,ae)}}l&4&&t.stateNode!=null&&(n=t.memoizedProps,qo(t,n,a!==null?a.memoizedProps:n)),l&1024&&(Vo=!0);break;case 6:if(ps(s,t),bs(t),l&4){if(t.stateNode===null)throw Error(c(162));l=t.memoizedProps,a=t.stateNode;try{a.nodeValue=l}catch(ae){wt(t,t.return,ae)}}break;case 3:if(Zr=null,n=Ls,Ls=Xr(s.containerInfo),ps(s,t),Ls=n,bs(t),l&4&&a!==null&&a.memoizedState.isDehydrated)try{Pn(s.containerInfo)}catch(ae){wt(t,t.return,ae)}Vo&&(Vo=!1,Dm(t));break;case 4:l=Ls,Ls=Xr(t.stateNode.containerInfo),ps(s,t),bs(t),Ls=l;break;case 12:ps(s,t),bs(t);break;case 13:ps(s,t),bs(t),t.child.flags&8192&&t.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Zo=Ye()),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,Io(t,l)));break;case 22:n=t.memoizedState!==null;var L=a!==null&&a.memoizedState!==null,J=ea,de=Rt;if(ea=J||n,Rt=de||L,ps(s,t),Rt=de,ea=J,bs(t),l&8192)e:for(s=t.stateNode,s._visibility=n?s._visibility&-2:s._visibility|1,n&&(a===null||L||ea||Rt||Za(t)),a=null,s=t;;){if(s.tag===5||s.tag===26){if(a===null){L=a=s;try{if(r=L.stateNode,n)m=r.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none";else{w=L.stateNode;var xe=L.memoizedProps.style,te=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;w.style.display=te==null||typeof te=="boolean"?"":(""+te).trim()}}catch(ae){wt(L,L.return,ae)}}}else if(s.tag===6){if(a===null){L=s;try{L.stateNode.nodeValue=n?"":L.memoizedProps}catch(ae){wt(L,L.return,ae)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===t)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;a===s&&(a=null),s=s.return}a===s&&(a=null),s.sibling.return=s.return,s=s.sibling}l&4&&(l=t.updateQueue,l!==null&&(a=l.retryQueue,a!==null&&(l.retryQueue=null,Io(t,a))));break;case 19:ps(s,t),bs(t),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,Io(t,l)));break;case 30:break;case 21:break;default:ps(s,t),bs(t)}}function bs(t){var s=t.flags;if(s&2){try{for(var a,l=t.return;l!==null;){if(Am(l)){a=l;break}l=l.return}if(a==null)throw Error(c(160));switch(a.tag){case 27:var n=a.stateNode,r=Po(t);Rr(t,r,n);break;case 5:var m=a.stateNode;a.flags&32&&(dl(m,""),a.flags&=-33);var w=Po(t);Rr(t,w,m);break;case 3:case 4:var L=a.stateNode.containerInfo,J=Po(t);Ho(t,J,L);break;default:throw Error(c(161))}}catch(de){wt(t,t.return,de)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function Dm(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var s=t;Dm(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),t=t.sibling}}function ya(t,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Om(t,s.alternate,s),s=s.sibling}function Za(t){for(t=t.child;t!==null;){var s=t;switch(s.tag){case 0:case 11:case 14:case 15:ba(4,s,s.return),Za(s);break;case 1:$s(s,s.return);var a=s.stateNode;typeof a.componentWillUnmount=="function"&&Sm(s,s.return,a),Za(s);break;case 27:Dn(s.stateNode);case 26:case 5:$s(s,s.return),Za(s);break;case 22:s.memoizedState===null&&Za(s);break;case 30:Za(s);break;default:Za(s)}t=t.sibling}}function va(t,s,a){for(a=a&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var l=s.alternate,n=t,r=s,m=r.flags;switch(r.tag){case 0:case 11:case 15:va(n,r,a),Sn(4,r);break;case 1:if(va(n,r,a),l=r,n=l.stateNode,typeof n.componentDidMount=="function")try{n.componentDidMount()}catch(J){wt(l,l.return,J)}if(l=r,n=l.updateQueue,n!==null){var w=l.stateNode;try{var L=n.shared.hiddenCallbacks;if(L!==null)for(n.shared.hiddenCallbacks=null,n=0;n<L.length;n++)cu(L[n],w)}catch(J){wt(l,l.return,J)}}a&&m&64&&jm(r),_n(r,r.return);break;case 27:Cm(r);case 26:case 5:va(n,r,a),a&&l===null&&m&4&&_m(r),_n(r,r.return);break;case 12:va(n,r,a);break;case 13:va(n,r,a),a&&m&4&&km(n,r);break;case 22:r.memoizedState===null&&va(n,r,a),_n(r,r.return);break;case 30:break;default:va(n,r,a)}s=s.sibling}}function Go(t,s){var a=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),t=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(t=s.memoizedState.cachePool.pool),t!==a&&(t!=null&&t.refCount++,a!=null&&dn(a))}function Fo(t,s){t=null,s.alternate!==null&&(t=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==t&&(s.refCount++,t!=null&&dn(t))}function Us(t,s,a,l){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Lm(t,s,a,l),s=s.sibling}function Lm(t,s,a,l){var n=s.flags;switch(s.tag){case 0:case 11:case 15:Us(t,s,a,l),n&2048&&Sn(9,s);break;case 1:Us(t,s,a,l);break;case 3:Us(t,s,a,l),n&2048&&(t=null,s.alternate!==null&&(t=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==t&&(s.refCount++,t!=null&&dn(t)));break;case 12:if(n&2048){Us(t,s,a,l),t=s.stateNode;try{var r=s.memoizedProps,m=r.id,w=r.onPostCommit;typeof w=="function"&&w(m,s.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(L){wt(s,s.return,L)}}else Us(t,s,a,l);break;case 13:Us(t,s,a,l);break;case 23:break;case 22:r=s.stateNode,m=s.alternate,s.memoizedState!==null?r._visibility&2?Us(t,s,a,l):An(t,s):r._visibility&2?Us(t,s,a,l):(r._visibility|=2,Ol(t,s,a,l,(s.subtreeFlags&10256)!==0)),n&2048&&Go(m,s);break;case 24:Us(t,s,a,l),n&2048&&Fo(s.alternate,s);break;default:Us(t,s,a,l)}}function Ol(t,s,a,l,n){for(n=n&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var r=t,m=s,w=a,L=l,J=m.flags;switch(m.tag){case 0:case 11:case 15:Ol(r,m,w,L,n),Sn(8,m);break;case 23:break;case 22:var de=m.stateNode;m.memoizedState!==null?de._visibility&2?Ol(r,m,w,L,n):An(r,m):(de._visibility|=2,Ol(r,m,w,L,n)),n&&J&2048&&Go(m.alternate,m);break;case 24:Ol(r,m,w,L,n),n&&J&2048&&Fo(m.alternate,m);break;default:Ol(r,m,w,L,n)}s=s.sibling}}function An(t,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var a=t,l=s,n=l.flags;switch(l.tag){case 22:An(a,l),n&2048&&Go(l.alternate,l);break;case 24:An(a,l),n&2048&&Fo(l.alternate,l);break;default:An(a,l)}s=s.sibling}}var Cn=8192;function El(t){if(t.subtreeFlags&Cn)for(t=t.child;t!==null;)Rm(t),t=t.sibling}function Rm(t){switch(t.tag){case 26:El(t),t.flags&Cn&&t.memoizedState!==null&&Of(Ls,t.memoizedState,t.memoizedProps);break;case 5:El(t);break;case 3:case 4:var s=Ls;Ls=Xr(t.stateNode.containerInfo),El(t),Ls=s;break;case 22:t.memoizedState===null&&(s=t.alternate,s!==null&&s.memoizedState!==null?(s=Cn,Cn=16777216,El(t),Cn=s):El(t));break;default:El(t)}}function zm(t){var s=t.alternate;if(s!==null&&(t=s.child,t!==null)){s.child=null;do s=t.sibling,t.sibling=null,t=s;while(t!==null)}}function Mn(t){var s=t.deletions;if((t.flags&16)!==0){if(s!==null)for(var a=0;a<s.length;a++){var l=s[a];Qt=l,$m(l,t)}zm(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Ym(t),t=t.sibling}function Ym(t){switch(t.tag){case 0:case 11:case 15:Mn(t),t.flags&2048&&ba(9,t,t.return);break;case 3:Mn(t);break;case 12:Mn(t);break;case 22:var s=t.stateNode;t.memoizedState!==null&&s._visibility&2&&(t.return===null||t.return.tag!==13)?(s._visibility&=-3,zr(t)):Mn(t);break;default:Mn(t)}}function zr(t){var s=t.deletions;if((t.flags&16)!==0){if(s!==null)for(var a=0;a<s.length;a++){var l=s[a];Qt=l,$m(l,t)}zm(t)}for(t=t.child;t!==null;){switch(s=t,s.tag){case 0:case 11:case 15:ba(8,s,s.return),zr(s);break;case 22:a=s.stateNode,a._visibility&2&&(a._visibility&=-3,zr(s));break;default:zr(s)}t=t.sibling}}function $m(t,s){for(;Qt!==null;){var a=Qt;switch(a.tag){case 0:case 11:case 15:ba(8,a,s);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var l=a.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:dn(a.memoizedState.cache)}if(l=a.child,l!==null)l.return=a,Qt=l;else e:for(a=t;Qt!==null;){l=Qt;var n=l.sibling,r=l.return;if(Em(l),l===a){Qt=null;break e}if(n!==null){n.return=r,Qt=n;break e}Qt=r}}}var Vx={getCacheForType:function(t){var s=as(Ht),a=s.data.get(t);return a===void 0&&(a=t(),s.data.set(t,a)),a}},Ix=typeof WeakMap=="function"?WeakMap:Map,xt=0,jt=null,rt=null,ct=0,ft=0,ys=null,wa=!1,Bl=!1,Qo=!1,sa=0,kt=0,Na=0,Ka=0,Xo=0,Es=0,kl=0,On=null,hs=null,Wo=!1,Zo=0,Yr=1/0,$r=null,ja=null,Jt=0,Sa=null,Tl=null,Dl=0,Ko=0,Jo=null,Um=null,En=0,ec=null;function vs(){if((xt&2)!==0&&ct!==0)return ct&-ct;if(O.T!==null){var t=wl;return t!==0?t:ic()}return $e()}function qm(){Es===0&&(Es=(ct&536870912)===0||mt?be():536870912);var t=Os.current;return t!==null&&(t.flags|=32),Es}function ws(t,s,a){(t===jt&&(ft===2||ft===9)||t.cancelPendingCommit!==null)&&(Ll(t,0),_a(t,ct,Es,!1)),re(t,a),((xt&2)===0||t!==jt)&&(t===jt&&((xt&2)===0&&(Ka|=a),kt===4&&_a(t,ct,Es,!1)),qs(t))}function Pm(t,s,a){if((xt&6)!==0)throw Error(c(327));var l=!a&&(s&124)===0&&(s&t.expiredLanes)===0||Dt(t,s),n=l?Qx(t,s):ac(t,s,!0),r=l;do{if(n===0){Bl&&!l&&_a(t,s,0,!1);break}else{if(a=t.current.alternate,r&&!Gx(a)){n=ac(t,s,!1),r=!1;continue}if(n===2){if(r=s,t.errorRecoveryDisabledLanes&r)var m=0;else m=t.pendingLanes&-536870913,m=m!==0?m:m&536870912?536870912:0;if(m!==0){s=m;e:{var w=t;n=On;var L=w.current.memoizedState.isDehydrated;if(L&&(Ll(w,m).flags|=256),m=ac(w,m,!1),m!==2){if(Qo&&!L){w.errorRecoveryDisabledLanes|=r,Ka|=r,n=4;break e}r=hs,hs=n,r!==null&&(hs===null?hs=r:hs.push.apply(hs,r))}n=m}if(r=!1,n!==2)continue}}if(n===1){Ll(t,0),_a(t,s,0,!0);break}e:{switch(l=t,r=n,r){case 0:case 1:throw Error(c(345));case 4:if((s&4194048)!==s)break;case 6:_a(l,s,Es,!wa);break e;case 2:hs=null;break;case 3:case 5:break;default:throw Error(c(329))}if((s&62914560)===s&&(n=Zo+300-Ye(),10<n)){if(_a(l,s,Es,!wa),is(l,0,!0)!==0)break e;l.timeoutHandle=p0(Hm.bind(null,l,a,hs,$r,Wo,s,Es,Ka,kl,wa,r,2,-0,0),n);break e}Hm(l,a,hs,$r,Wo,s,Es,Ka,kl,wa,r,0,-0,0)}}break}while(!0);qs(t)}function Hm(t,s,a,l,n,r,m,w,L,J,de,xe,te,ae){if(t.timeoutHandle=-1,xe=s.subtreeFlags,(xe&8192||(xe&16785408)===16785408)&&(zn={stylesheets:null,count:0,unsuspend:Mf},Rm(s),xe=Ef(),xe!==null)){t.cancelPendingCommit=xe(Wm.bind(null,t,s,r,a,l,n,m,w,L,de,1,te,ae)),_a(t,r,m,!J);return}Wm(t,s,r,a,l,n,m,w,L)}function Gx(t){for(var s=t;;){var a=s.tag;if((a===0||a===11||a===15)&&s.flags&16384&&(a=s.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var l=0;l<a.length;l++){var n=a[l],r=n.getSnapshot;n=n.value;try{if(!fs(r(),n))return!1}catch{return!1}}if(a=s.child,s.subtreeFlags&16384&&a!==null)a.return=s,s=a;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function _a(t,s,a,l){s&=~Xo,s&=~Ka,t.suspendedLanes|=s,t.pingedLanes&=~s,l&&(t.warmLanes|=s),l=t.expirationTimes;for(var n=s;0<n;){var r=31-B(n),m=1<<r;l[r]=-1,n&=~m}a!==0&&_e(t,a,s)}function Ur(){return(xt&6)===0?(Bn(0),!1):!0}function tc(){if(rt!==null){if(ft===0)var t=rt.return;else t=rt,Qs=Ga=null,bo(t),Cl=null,wn=0,t=rt;for(;t!==null;)Nm(t.alternate,t),t=t.return;rt=null}}function Ll(t,s){var a=t.timeoutHandle;a!==-1&&(t.timeoutHandle=-1,uf(a)),a=t.cancelPendingCommit,a!==null&&(t.cancelPendingCommit=null,a()),tc(),jt=t,rt=a=Is(t.current,null),ct=s,ft=0,ys=null,wa=!1,Bl=Dt(t,s),Qo=!1,kl=Es=Xo=Ka=Na=kt=0,hs=On=null,Wo=!1,(s&8)!==0&&(s|=s&32);var l=t.entangledLanes;if(l!==0)for(t=t.entanglements,l&=s;0<l;){var n=31-B(l),r=1<<n;s|=t[n],l&=~r}return sa=s,or(),a}function Vm(t,s){lt=null,O.H=Cr,s===mn||s===pr?(s=iu(),ft=3):s===lu?(s=iu(),ft=4):ft=s===om?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,ys=s,rt===null&&(kt=1,kr(t,_s(s,t.current)))}function Im(){var t=O.H;return O.H=Cr,t===null?Cr:t}function Gm(){var t=O.A;return O.A=Vx,t}function sc(){kt=4,wa||(ct&4194048)!==ct&&Os.current!==null||(Bl=!0),(Na&134217727)===0&&(Ka&134217727)===0||jt===null||_a(jt,ct,Es,!1)}function ac(t,s,a){var l=xt;xt|=2;var n=Im(),r=Gm();(jt!==t||ct!==s)&&($r=null,Ll(t,s)),s=!1;var m=kt;e:do try{if(ft!==0&&rt!==null){var w=rt,L=ys;switch(ft){case 8:tc(),m=6;break e;case 3:case 2:case 9:case 6:Os.current===null&&(s=!0);var J=ft;if(ft=0,ys=null,Rl(t,w,L,J),a&&Bl){m=0;break e}break;default:J=ft,ft=0,ys=null,Rl(t,w,L,J)}}Fx(),m=kt;break}catch(de){Vm(t,de)}while(!0);return s&&t.shellSuspendCounter++,Qs=Ga=null,xt=l,O.H=n,O.A=r,rt===null&&(jt=null,ct=0,or()),m}function Fx(){for(;rt!==null;)Fm(rt)}function Qx(t,s){var a=xt;xt|=2;var l=Im(),n=Gm();jt!==t||ct!==s?($r=null,Yr=Ye()+500,Ll(t,s)):Bl=Dt(t,s);e:do try{if(ft!==0&&rt!==null){s=rt;var r=ys;t:switch(ft){case 1:ft=0,ys=null,Rl(t,s,r,1);break;case 2:case 9:if(nu(r)){ft=0,ys=null,Qm(s);break}s=function(){ft!==2&&ft!==9||jt!==t||(ft=7),qs(t)},r.then(s,s);break e;case 3:ft=7;break e;case 4:ft=5;break e;case 7:nu(r)?(ft=0,ys=null,Qm(s)):(ft=0,ys=null,Rl(t,s,r,7));break;case 5:var m=null;switch(rt.tag){case 26:m=rt.memoizedState;case 5:case 27:var w=rt;if(!m||O0(m)){ft=0,ys=null;var L=w.sibling;if(L!==null)rt=L;else{var J=w.return;J!==null?(rt=J,qr(J)):rt=null}break t}}ft=0,ys=null,Rl(t,s,r,5);break;case 6:ft=0,ys=null,Rl(t,s,r,6);break;case 8:tc(),kt=6;break e;default:throw Error(c(462))}}Xx();break}catch(de){Vm(t,de)}while(!0);return Qs=Ga=null,O.H=l,O.A=n,xt=a,rt!==null?0:(jt=null,ct=0,or(),kt)}function Xx(){for(;rt!==null&&!Se();)Fm(rt)}function Fm(t){var s=vm(t.alternate,t,sa);t.memoizedProps=t.pendingProps,s===null?qr(t):rt=s}function Qm(t){var s=t,a=s.alternate;switch(s.tag){case 15:case 0:s=xm(a,s,s.pendingProps,s.type,void 0,ct);break;case 11:s=xm(a,s,s.pendingProps,s.type.render,s.ref,ct);break;case 5:bo(s);default:Nm(a,s),s=rt=Xd(s,sa),s=vm(a,s,sa)}t.memoizedProps=t.pendingProps,s===null?qr(t):rt=s}function Rl(t,s,a,l){Qs=Ga=null,bo(s),Cl=null,wn=0;var n=s.return;try{if(Yx(t,n,s,a,ct)){kt=1,kr(t,_s(a,t.current)),rt=null;return}}catch(r){if(n!==null)throw rt=n,r;kt=1,kr(t,_s(a,t.current)),rt=null;return}s.flags&32768?(mt||l===1?t=!0:Bl||(ct&536870912)!==0?t=!1:(wa=t=!0,(l===2||l===9||l===3||l===6)&&(l=Os.current,l!==null&&l.tag===13&&(l.flags|=16384))),Xm(s,t)):qr(s)}function qr(t){var s=t;do{if((s.flags&32768)!==0){Xm(s,wa);return}t=s.return;var a=Ux(s.alternate,s,sa);if(a!==null){rt=a;return}if(s=s.sibling,s!==null){rt=s;return}rt=s=t}while(s!==null);kt===0&&(kt=5)}function Xm(t,s){do{var a=qx(t.alternate,t);if(a!==null){a.flags&=32767,rt=a;return}if(a=t.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!s&&(t=t.sibling,t!==null)){rt=t;return}rt=t=a}while(t!==null);kt=6,rt=null}function Wm(t,s,a,l,n,r,m,w,L){t.cancelPendingCommit=null;do Pr();while(Jt!==0);if((xt&6)!==0)throw Error(c(327));if(s!==null){if(s===t.current)throw Error(c(177));if(r=s.lanes|s.childLanes,r|=Gi,we(t,a,r,m,w,L),t===jt&&(rt=jt=null,ct=0),Tl=s,Sa=t,Dl=a,Ko=r,Jo=n,Um=l,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,Jx(et,function(){return t0(),null})):(t.callbackNode=null,t.callbackPriority=0),l=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||l){l=O.T,O.T=null,n=q.p,q.p=2,m=xt,xt|=4;try{Px(t,s,a)}finally{xt=m,q.p=n,O.T=l}}Jt=1,Zm(),Km(),Jm()}}function Zm(){if(Jt===1){Jt=0;var t=Sa,s=Tl,a=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||a){a=O.T,O.T=null;var l=q.p;q.p=2;var n=xt;xt|=4;try{Tm(s,t);var r=fc,m=$d(t.containerInfo),w=r.focusedElem,L=r.selectionRange;if(m!==w&&w&&w.ownerDocument&&Yd(w.ownerDocument.documentElement,w)){if(L!==null&&qi(w)){var J=L.start,de=L.end;if(de===void 0&&(de=J),"selectionStart"in w)w.selectionStart=J,w.selectionEnd=Math.min(de,w.value.length);else{var xe=w.ownerDocument||document,te=xe&&xe.defaultView||window;if(te.getSelection){var ae=te.getSelection(),Je=w.textContent.length,Xe=Math.min(L.start,Je),yt=L.end===void 0?Xe:Math.min(L.end,Je);!ae.extend&&Xe>yt&&(m=yt,yt=Xe,Xe=m);var X=zd(w,Xe),V=zd(w,yt);if(X&&V&&(ae.rangeCount!==1||ae.anchorNode!==X.node||ae.anchorOffset!==X.offset||ae.focusNode!==V.node||ae.focusOffset!==V.offset)){var K=xe.createRange();K.setStart(X.node,X.offset),ae.removeAllRanges(),Xe>yt?(ae.addRange(K),ae.extend(V.node,V.offset)):(K.setEnd(V.node,V.offset),ae.addRange(K))}}}}for(xe=[],ae=w;ae=ae.parentNode;)ae.nodeType===1&&xe.push({element:ae,left:ae.scrollLeft,top:ae.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<xe.length;w++){var he=xe[w];he.element.scrollLeft=he.left,he.element.scrollTop=he.top}}ei=!!xc,fc=xc=null}finally{xt=n,q.p=l,O.T=a}}t.current=s,Jt=2}}function Km(){if(Jt===2){Jt=0;var t=Sa,s=Tl,a=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||a){a=O.T,O.T=null;var l=q.p;q.p=2;var n=xt;xt|=4;try{Om(t,s.alternate,s)}finally{xt=n,q.p=l,O.T=a}}Jt=3}}function Jm(){if(Jt===4||Jt===3){Jt=0,ze();var t=Sa,s=Tl,a=Dl,l=Um;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Jt=5:(Jt=0,Tl=Sa=null,e0(t,t.pendingLanes));var n=t.pendingLanes;if(n===0&&(ja=null),ie(a),s=s.stateNode,ne&&typeof ne.onCommitFiberRoot=="function")try{ne.onCommitFiberRoot(k,s,void 0,(s.current.flags&128)===128)}catch{}if(l!==null){s=O.T,n=q.p,q.p=2,O.T=null;try{for(var r=t.onRecoverableError,m=0;m<l.length;m++){var w=l[m];r(w.value,{componentStack:w.stack})}}finally{O.T=s,q.p=n}}(Dl&3)!==0&&Pr(),qs(t),n=t.pendingLanes,(a&4194090)!==0&&(n&42)!==0?t===ec?En++:(En=0,ec=t):En=0,Bn(0)}}function e0(t,s){(t.pooledCacheLanes&=s)===0&&(s=t.pooledCache,s!=null&&(t.pooledCache=null,dn(s)))}function Pr(t){return Zm(),Km(),Jm(),t0()}function t0(){if(Jt!==5)return!1;var t=Sa,s=Ko;Ko=0;var a=ie(Dl),l=O.T,n=q.p;try{q.p=32>a?32:a,O.T=null,a=Jo,Jo=null;var r=Sa,m=Dl;if(Jt=0,Tl=Sa=null,Dl=0,(xt&6)!==0)throw Error(c(331));var w=xt;if(xt|=4,Ym(r.current),Lm(r,r.current,m,a),xt=w,Bn(0,!1),ne&&typeof ne.onPostCommitFiberRoot=="function")try{ne.onPostCommitFiberRoot(k,r)}catch{}return!0}finally{q.p=n,O.T=l,e0(t,s)}}function s0(t,s,a){s=_s(a,s),s=ko(t.stateNode,s,2),t=xa(t,s,2),t!==null&&(re(t,2),qs(t))}function wt(t,s,a){if(t.tag===3)s0(t,t,a);else for(;s!==null;){if(s.tag===3){s0(s,t,a);break}else if(s.tag===1){var l=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(ja===null||!ja.has(l))){t=_s(a,t),a=rm(2),l=xa(s,a,2),l!==null&&(im(a,l,s,t),re(l,2),qs(l));break}}s=s.return}}function lc(t,s,a){var l=t.pingCache;if(l===null){l=t.pingCache=new Ix;var n=new Set;l.set(s,n)}else n=l.get(s),n===void 0&&(n=new Set,l.set(s,n));n.has(a)||(Qo=!0,n.add(a),t=Wx.bind(null,t,s,a),s.then(t,t))}function Wx(t,s,a){var l=t.pingCache;l!==null&&l.delete(s),t.pingedLanes|=t.suspendedLanes&a,t.warmLanes&=~a,jt===t&&(ct&a)===a&&(kt===4||kt===3&&(ct&62914560)===ct&&300>Ye()-Zo?(xt&2)===0&&Ll(t,0):Xo|=a,kl===ct&&(kl=0)),qs(t)}function a0(t,s){s===0&&(s=me()),t=pl(t,s),t!==null&&(re(t,s),qs(t))}function Zx(t){var s=t.memoizedState,a=0;s!==null&&(a=s.retryLane),a0(t,a)}function Kx(t,s){var a=0;switch(t.tag){case 13:var l=t.stateNode,n=t.memoizedState;n!==null&&(a=n.retryLane);break;case 19:l=t.stateNode;break;case 22:l=t.stateNode._retryCache;break;default:throw Error(c(314))}l!==null&&l.delete(s),a0(t,a)}function Jx(t,s){return Ue(t,s)}var Hr=null,zl=null,nc=!1,Vr=!1,rc=!1,Ja=0;function qs(t){t!==zl&&t.next===null&&(zl===null?Hr=zl=t:zl=zl.next=t),Vr=!0,nc||(nc=!0,tf())}function Bn(t,s){if(!rc&&Vr){rc=!0;do for(var a=!1,l=Hr;l!==null;){if(t!==0){var n=l.pendingLanes;if(n===0)var r=0;else{var m=l.suspendedLanes,w=l.pingedLanes;r=(1<<31-B(42|t)+1)-1,r&=n&~(m&~w),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(a=!0,i0(l,r))}else r=ct,r=is(l,l===jt?r:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(r&3)===0||Dt(l,r)||(a=!0,i0(l,r));l=l.next}while(a);rc=!1}}function ef(){l0()}function l0(){Vr=nc=!1;var t=0;Ja!==0&&(df()&&(t=Ja),Ja=0);for(var s=Ye(),a=null,l=Hr;l!==null;){var n=l.next,r=n0(l,s);r===0?(l.next=null,a===null?Hr=n:a.next=n,n===null&&(zl=a)):(a=l,(t!==0||(r&3)!==0)&&(Vr=!0)),l=n}Bn(t)}function n0(t,s){for(var a=t.suspendedLanes,l=t.pingedLanes,n=t.expirationTimes,r=t.pendingLanes&-62914561;0<r;){var m=31-B(r),w=1<<m,L=n[m];L===-1?((w&a)===0||(w&l)!==0)&&(n[m]=_(w,s)):L<=s&&(t.expiredLanes|=w),r&=~w}if(s=jt,a=ct,a=is(t,t===s?a:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),l=t.callbackNode,a===0||t===s&&(ft===2||ft===9)||t.cancelPendingCommit!==null)return l!==null&&l!==null&&pe(l),t.callbackNode=null,t.callbackPriority=0;if((a&3)===0||Dt(t,a)){if(s=a&-a,s===t.callbackPriority)return s;switch(l!==null&&pe(l),ie(a)){case 2:case 8:a=Re;break;case 32:a=et;break;case 268435456:a=Te;break;default:a=et}return l=r0.bind(null,t),a=Ue(a,l),t.callbackPriority=s,t.callbackNode=a,s}return l!==null&&l!==null&&pe(l),t.callbackPriority=2,t.callbackNode=null,2}function r0(t,s){if(Jt!==0&&Jt!==5)return t.callbackNode=null,t.callbackPriority=0,null;var a=t.callbackNode;if(Pr()&&t.callbackNode!==a)return null;var l=ct;return l=is(t,t===jt?l:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),l===0?null:(Pm(t,l,s),n0(t,Ye()),t.callbackNode!=null&&t.callbackNode===a?r0.bind(null,t):null)}function i0(t,s){if(Pr())return null;Pm(t,s,!0)}function tf(){mf(function(){(xt&6)!==0?Ue(Pe,ef):l0()})}function ic(){return Ja===0&&(Ja=be()),Ja}function o0(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:tr(""+t)}function c0(t,s){var a=s.ownerDocument.createElement("input");return a.name=s.name,a.value=s.value,t.id&&a.setAttribute("form",t.id),s.parentNode.insertBefore(a,s),t=new FormData(t),a.parentNode.removeChild(a),t}function sf(t,s,a,l,n){if(s==="submit"&&a&&a.stateNode===n){var r=o0((n[ot]||null).action),m=l.submitter;m&&(s=(s=m[ot]||null)?o0(s.formAction):m.getAttribute("formAction"),s!==null&&(r=s,m=null));var w=new nr("action","action",null,l,n);t.push({event:w,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Ja!==0){var L=m?c0(n,m):new FormData(n);Co(a,{pending:!0,data:L,method:n.method,action:r},null,L)}}else typeof r=="function"&&(w.preventDefault(),L=m?c0(n,m):new FormData(n),Co(a,{pending:!0,data:L,method:n.method,action:r},r,L))},currentTarget:n}]})}}for(var oc=0;oc<Ii.length;oc++){var cc=Ii[oc],af=cc.toLowerCase(),lf=cc[0].toUpperCase()+cc.slice(1);Ds(af,"on"+lf)}Ds(Pd,"onAnimationEnd"),Ds(Hd,"onAnimationIteration"),Ds(Vd,"onAnimationStart"),Ds("dblclick","onDoubleClick"),Ds("focusin","onFocus"),Ds("focusout","onBlur"),Ds(wx,"onTransitionRun"),Ds(Nx,"onTransitionStart"),Ds(jx,"onTransitionCancel"),Ds(Id,"onTransitionEnd"),il("onMouseEnter",["mouseout","mouseover"]),il("onMouseLeave",["mouseout","mouseover"]),il("onPointerEnter",["pointerout","pointerover"]),il("onPointerLeave",["pointerout","pointerover"]),za("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),za("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),za("onBeforeInput",["compositionend","keypress","textInput","paste"]),za("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),za("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),za("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nf=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(kn));function d0(t,s){s=(s&4)!==0;for(var a=0;a<t.length;a++){var l=t[a],n=l.event;l=l.listeners;e:{var r=void 0;if(s)for(var m=l.length-1;0<=m;m--){var w=l[m],L=w.instance,J=w.currentTarget;if(w=w.listener,L!==r&&n.isPropagationStopped())break e;r=w,n.currentTarget=J;try{r(n)}catch(de){Br(de)}n.currentTarget=null,r=L}else for(m=0;m<l.length;m++){if(w=l[m],L=w.instance,J=w.currentTarget,w=w.listener,L!==r&&n.isPropagationStopped())break e;r=w,n.currentTarget=J;try{r(n)}catch(de){Br(de)}n.currentTarget=null,r=L}}}}function it(t,s){var a=s[Ts];a===void 0&&(a=s[Ts]=new Set);var l=t+"__bubble";a.has(l)||(u0(s,t,2,!1),a.add(l))}function dc(t,s,a){var l=0;s&&(l|=4),u0(a,t,l,s)}var Ir="_reactListening"+Math.random().toString(36).slice(2);function uc(t){if(!t[Ir]){t[Ir]=!0,ld.forEach(function(a){a!=="selectionchange"&&(nf.has(a)||dc(a,!1,t),dc(a,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[Ir]||(s[Ir]=!0,dc("selectionchange",!1,s))}}function u0(t,s,a,l){switch(L0(s)){case 2:var n=Tf;break;case 8:n=Df;break;default:n=_c}a=n.bind(null,s,a,t),n=void 0,!ki||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(n=!0),l?n!==void 0?t.addEventListener(s,a,{capture:!0,passive:n}):t.addEventListener(s,a,!0):n!==void 0?t.addEventListener(s,a,{passive:n}):t.addEventListener(s,a,!1)}function mc(t,s,a,l,n){var r=l;if((s&1)===0&&(s&2)===0&&l!==null)e:for(;;){if(l===null)return;var m=l.tag;if(m===3||m===4){var w=l.stateNode.containerInfo;if(w===n)break;if(m===4)for(m=l.return;m!==null;){var L=m.tag;if((L===3||L===4)&&m.stateNode.containerInfo===n)return;m=m.return}for(;w!==null;){if(m=ll(w),m===null)return;if(L=m.tag,L===5||L===6||L===26||L===27){l=r=m;continue e}w=w.parentNode}}l=l.return}bd(function(){var J=r,de=Ei(a),xe=[];e:{var te=Gd.get(t);if(te!==void 0){var ae=nr,Je=t;switch(t){case"keypress":if(ar(a)===0)break e;case"keydown":case"keyup":ae=Jh;break;case"focusin":Je="focus",ae=Ri;break;case"focusout":Je="blur",ae=Ri;break;case"beforeblur":case"afterblur":ae=Ri;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ae=wd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ae=qh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ae=sx;break;case Pd:case Hd:case Vd:ae=Vh;break;case Id:ae=lx;break;case"scroll":case"scrollend":ae=$h;break;case"wheel":ae=rx;break;case"copy":case"cut":case"paste":ae=Gh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ae=jd;break;case"toggle":case"beforetoggle":ae=ox}var Xe=(s&4)!==0,yt=!Xe&&(t==="scroll"||t==="scrollend"),X=Xe?te!==null?te+"Capture":null:te;Xe=[];for(var V=J,K;V!==null;){var he=V;if(K=he.stateNode,he=he.tag,he!==5&&he!==26&&he!==27||K===null||X===null||(he=Wl(V,X),he!=null&&Xe.push(Tn(V,he,K))),yt)break;V=V.return}0<Xe.length&&(te=new ae(te,Je,null,a,de),xe.push({event:te,listeners:Xe}))}}if((s&7)===0){e:{if(te=t==="mouseover"||t==="pointerover",ae=t==="mouseout"||t==="pointerout",te&&a!==Oi&&(Je=a.relatedTarget||a.fromElement)&&(ll(Je)||Je[ss]))break e;if((ae||te)&&(te=de.window===de?de:(te=de.ownerDocument)?te.defaultView||te.parentWindow:window,ae?(Je=a.relatedTarget||a.toElement,ae=J,Je=Je?ll(Je):null,Je!==null&&(yt=y(Je),Xe=Je.tag,Je!==yt||Xe!==5&&Xe!==27&&Xe!==6)&&(Je=null)):(ae=null,Je=J),ae!==Je)){if(Xe=wd,he="onMouseLeave",X="onMouseEnter",V="mouse",(t==="pointerout"||t==="pointerover")&&(Xe=jd,he="onPointerLeave",X="onPointerEnter",V="pointer"),yt=ae==null?te:Xl(ae),K=Je==null?te:Xl(Je),te=new Xe(he,V+"leave",ae,a,de),te.target=yt,te.relatedTarget=K,he=null,ll(de)===J&&(Xe=new Xe(X,V+"enter",Je,a,de),Xe.target=K,Xe.relatedTarget=yt,he=Xe),yt=he,ae&&Je)t:{for(Xe=ae,X=Je,V=0,K=Xe;K;K=Yl(K))V++;for(K=0,he=X;he;he=Yl(he))K++;for(;0<V-K;)Xe=Yl(Xe),V--;for(;0<K-V;)X=Yl(X),K--;for(;V--;){if(Xe===X||X!==null&&Xe===X.alternate)break t;Xe=Yl(Xe),X=Yl(X)}Xe=null}else Xe=null;ae!==null&&m0(xe,te,ae,Xe,!1),Je!==null&&yt!==null&&m0(xe,yt,Je,Xe,!0)}}e:{if(te=J?Xl(J):window,ae=te.nodeName&&te.nodeName.toLowerCase(),ae==="select"||ae==="input"&&te.type==="file")var qe=Bd;else if(Od(te))if(kd)qe=bx;else{qe=gx;var nt=fx}else ae=te.nodeName,!ae||ae.toLowerCase()!=="input"||te.type!=="checkbox"&&te.type!=="radio"?J&&Mi(J.elementType)&&(qe=Bd):qe=px;if(qe&&(qe=qe(t,J))){Ed(xe,qe,a,de);break e}nt&&nt(t,te,J),t==="focusout"&&J&&te.type==="number"&&J.memoizedProps.value!=null&&Ci(te,"number",te.value)}switch(nt=J?Xl(J):window,t){case"focusin":(Od(nt)||nt.contentEditable==="true")&&(xl=nt,Pi=J,ln=null);break;case"focusout":ln=Pi=xl=null;break;case"mousedown":Hi=!0;break;case"contextmenu":case"mouseup":case"dragend":Hi=!1,Ud(xe,a,de);break;case"selectionchange":if(vx)break;case"keydown":case"keyup":Ud(xe,a,de)}var Ie;if(Yi)e:{switch(t){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else hl?Cd(t,a)&&(We="onCompositionEnd"):t==="keydown"&&a.keyCode===229&&(We="onCompositionStart");We&&(Sd&&a.locale!=="ko"&&(hl||We!=="onCompositionStart"?We==="onCompositionEnd"&&hl&&(Ie=yd()):(da=de,Ti="value"in da?da.value:da.textContent,hl=!0)),nt=Gr(J,We),0<nt.length&&(We=new Nd(We,t,null,a,de),xe.push({event:We,listeners:nt}),Ie?We.data=Ie:(Ie=Md(a),Ie!==null&&(We.data=Ie)))),(Ie=dx?ux(t,a):mx(t,a))&&(We=Gr(J,"onBeforeInput"),0<We.length&&(nt=new Nd("onBeforeInput","beforeinput",null,a,de),xe.push({event:nt,listeners:We}),nt.data=Ie)),sf(xe,t,J,a,de)}d0(xe,s)})}function Tn(t,s,a){return{instance:t,listener:s,currentTarget:a}}function Gr(t,s){for(var a=s+"Capture",l=[];t!==null;){var n=t,r=n.stateNode;if(n=n.tag,n!==5&&n!==26&&n!==27||r===null||(n=Wl(t,a),n!=null&&l.unshift(Tn(t,n,r)),n=Wl(t,s),n!=null&&l.push(Tn(t,n,r))),t.tag===3)return l;t=t.return}return[]}function Yl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function m0(t,s,a,l,n){for(var r=s._reactName,m=[];a!==null&&a!==l;){var w=a,L=w.alternate,J=w.stateNode;if(w=w.tag,L!==null&&L===l)break;w!==5&&w!==26&&w!==27||J===null||(L=J,n?(J=Wl(a,r),J!=null&&m.unshift(Tn(a,J,L))):n||(J=Wl(a,r),J!=null&&m.push(Tn(a,J,L)))),a=a.return}m.length!==0&&t.push({event:s,listeners:m})}var rf=/\r\n?/g,of=/\u0000|\uFFFD/g;function h0(t){return(typeof t=="string"?t:""+t).replace(rf,`
`).replace(of,"")}function x0(t,s){return s=h0(s),h0(t)===s}function Fr(){}function bt(t,s,a,l,n,r){switch(a){case"children":typeof l=="string"?s==="body"||s==="textarea"&&l===""||dl(t,l):(typeof l=="number"||typeof l=="bigint")&&s!=="body"&&dl(t,""+l);break;case"className":Kn(t,"class",l);break;case"tabIndex":Kn(t,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Kn(t,a,l);break;case"style":gd(t,l,r);break;case"data":if(s!=="object"){Kn(t,"data",l);break}case"src":case"href":if(l===""&&(s!=="a"||a!=="href")){t.removeAttribute(a);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){t.removeAttribute(a);break}l=tr(""+l),t.setAttribute(a,l);break;case"action":case"formAction":if(typeof l=="function"){t.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(a==="formAction"?(s!=="input"&&bt(t,s,"name",n.name,n,null),bt(t,s,"formEncType",n.formEncType,n,null),bt(t,s,"formMethod",n.formMethod,n,null),bt(t,s,"formTarget",n.formTarget,n,null)):(bt(t,s,"encType",n.encType,n,null),bt(t,s,"method",n.method,n,null),bt(t,s,"target",n.target,n,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){t.removeAttribute(a);break}l=tr(""+l),t.setAttribute(a,l);break;case"onClick":l!=null&&(t.onclick=Fr);break;case"onScroll":l!=null&&it("scroll",t);break;case"onScrollEnd":l!=null&&it("scrollend",t);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(c(61));if(a=l.__html,a!=null){if(n.children!=null)throw Error(c(60));t.innerHTML=a}}break;case"multiple":t.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":t.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){t.removeAttribute("xlink:href");break}a=tr(""+l),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(a,""+l):t.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(a,""):t.removeAttribute(a);break;case"capture":case"download":l===!0?t.setAttribute(a,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(a,l):t.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?t.setAttribute(a,l):t.removeAttribute(a);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?t.removeAttribute(a):t.setAttribute(a,l);break;case"popover":it("beforetoggle",t),it("toggle",t),Zn(t,"popover",l);break;case"xlinkActuate":Hs(t,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":Hs(t,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":Hs(t,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":Hs(t,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":Hs(t,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":Hs(t,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":Hs(t,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":Hs(t,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":Hs(t,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":Zn(t,"is",l);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=zh.get(a)||a,Zn(t,a,l))}}function hc(t,s,a,l,n,r){switch(a){case"style":gd(t,l,r);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(c(61));if(a=l.__html,a!=null){if(n.children!=null)throw Error(c(60));t.innerHTML=a}}break;case"children":typeof l=="string"?dl(t,l):(typeof l=="number"||typeof l=="bigint")&&dl(t,""+l);break;case"onScroll":l!=null&&it("scroll",t);break;case"onScrollEnd":l!=null&&it("scrollend",t);break;case"onClick":l!=null&&(t.onclick=Fr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!nd.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(n=a.endsWith("Capture"),s=a.slice(2,n?a.length-7:void 0),r=t[ot]||null,r=r!=null?r[a]:null,typeof r=="function"&&t.removeEventListener(s,r,n),typeof l=="function")){typeof r!="function"&&r!==null&&(a in t?t[a]=null:t.hasAttribute(a)&&t.removeAttribute(a)),t.addEventListener(s,l,n);break e}a in t?t[a]=l:l===!0?t.setAttribute(a,""):Zn(t,a,l)}}}function es(t,s,a){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":it("error",t),it("load",t);var l=!1,n=!1,r;for(r in a)if(a.hasOwnProperty(r)){var m=a[r];if(m!=null)switch(r){case"src":l=!0;break;case"srcSet":n=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(c(137,s));default:bt(t,s,r,m,a,null)}}n&&bt(t,s,"srcSet",a.srcSet,a,null),l&&bt(t,s,"src",a.src,a,null);return;case"input":it("invalid",t);var w=r=m=n=null,L=null,J=null;for(l in a)if(a.hasOwnProperty(l)){var de=a[l];if(de!=null)switch(l){case"name":n=de;break;case"type":m=de;break;case"checked":L=de;break;case"defaultChecked":J=de;break;case"value":r=de;break;case"defaultValue":w=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(c(137,s));break;default:bt(t,s,l,de,a,null)}}md(t,r,w,L,J,m,n,!1),Jn(t);return;case"select":it("invalid",t),l=m=r=null;for(n in a)if(a.hasOwnProperty(n)&&(w=a[n],w!=null))switch(n){case"value":r=w;break;case"defaultValue":m=w;break;case"multiple":l=w;default:bt(t,s,n,w,a,null)}s=r,a=m,t.multiple=!!l,s!=null?cl(t,!!l,s,!1):a!=null&&cl(t,!!l,a,!0);return;case"textarea":it("invalid",t),r=n=l=null;for(m in a)if(a.hasOwnProperty(m)&&(w=a[m],w!=null))switch(m){case"value":l=w;break;case"defaultValue":n=w;break;case"children":r=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(c(91));break;default:bt(t,s,m,w,a,null)}xd(t,l,n,r),Jn(t);return;case"option":for(L in a)if(a.hasOwnProperty(L)&&(l=a[L],l!=null))switch(L){case"selected":t.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:bt(t,s,L,l,a,null)}return;case"dialog":it("beforetoggle",t),it("toggle",t),it("cancel",t),it("close",t);break;case"iframe":case"object":it("load",t);break;case"video":case"audio":for(l=0;l<kn.length;l++)it(kn[l],t);break;case"image":it("error",t),it("load",t);break;case"details":it("toggle",t);break;case"embed":case"source":case"link":it("error",t),it("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in a)if(a.hasOwnProperty(J)&&(l=a[J],l!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(c(137,s));default:bt(t,s,J,l,a,null)}return;default:if(Mi(s)){for(de in a)a.hasOwnProperty(de)&&(l=a[de],l!==void 0&&hc(t,s,de,l,a,void 0));return}}for(w in a)a.hasOwnProperty(w)&&(l=a[w],l!=null&&bt(t,s,w,l,a,null))}function cf(t,s,a,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var n=null,r=null,m=null,w=null,L=null,J=null,de=null;for(ae in a){var xe=a[ae];if(a.hasOwnProperty(ae)&&xe!=null)switch(ae){case"checked":break;case"value":break;case"defaultValue":L=xe;default:l.hasOwnProperty(ae)||bt(t,s,ae,null,l,xe)}}for(var te in l){var ae=l[te];if(xe=a[te],l.hasOwnProperty(te)&&(ae!=null||xe!=null))switch(te){case"type":r=ae;break;case"name":n=ae;break;case"checked":J=ae;break;case"defaultChecked":de=ae;break;case"value":m=ae;break;case"defaultValue":w=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(c(137,s));break;default:ae!==xe&&bt(t,s,te,ae,l,xe)}}Ai(t,m,w,L,J,de,r,n);return;case"select":ae=m=w=te=null;for(r in a)if(L=a[r],a.hasOwnProperty(r)&&L!=null)switch(r){case"value":break;case"multiple":ae=L;default:l.hasOwnProperty(r)||bt(t,s,r,null,l,L)}for(n in l)if(r=l[n],L=a[n],l.hasOwnProperty(n)&&(r!=null||L!=null))switch(n){case"value":te=r;break;case"defaultValue":w=r;break;case"multiple":m=r;default:r!==L&&bt(t,s,n,r,l,L)}s=w,a=m,l=ae,te!=null?cl(t,!!a,te,!1):!!l!=!!a&&(s!=null?cl(t,!!a,s,!0):cl(t,!!a,a?[]:"",!1));return;case"textarea":ae=te=null;for(w in a)if(n=a[w],a.hasOwnProperty(w)&&n!=null&&!l.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:bt(t,s,w,null,l,n)}for(m in l)if(n=l[m],r=a[m],l.hasOwnProperty(m)&&(n!=null||r!=null))switch(m){case"value":te=n;break;case"defaultValue":ae=n;break;case"children":break;case"dangerouslySetInnerHTML":if(n!=null)throw Error(c(91));break;default:n!==r&&bt(t,s,m,n,l,r)}hd(t,te,ae);return;case"option":for(var Je in a)if(te=a[Je],a.hasOwnProperty(Je)&&te!=null&&!l.hasOwnProperty(Je))switch(Je){case"selected":t.selected=!1;break;default:bt(t,s,Je,null,l,te)}for(L in l)if(te=l[L],ae=a[L],l.hasOwnProperty(L)&&te!==ae&&(te!=null||ae!=null))switch(L){case"selected":t.selected=te&&typeof te!="function"&&typeof te!="symbol";break;default:bt(t,s,L,te,l,ae)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in a)te=a[Xe],a.hasOwnProperty(Xe)&&te!=null&&!l.hasOwnProperty(Xe)&&bt(t,s,Xe,null,l,te);for(J in l)if(te=l[J],ae=a[J],l.hasOwnProperty(J)&&te!==ae&&(te!=null||ae!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(c(137,s));break;default:bt(t,s,J,te,l,ae)}return;default:if(Mi(s)){for(var yt in a)te=a[yt],a.hasOwnProperty(yt)&&te!==void 0&&!l.hasOwnProperty(yt)&&hc(t,s,yt,void 0,l,te);for(de in l)te=l[de],ae=a[de],!l.hasOwnProperty(de)||te===ae||te===void 0&&ae===void 0||hc(t,s,de,te,l,ae);return}}for(var X in a)te=a[X],a.hasOwnProperty(X)&&te!=null&&!l.hasOwnProperty(X)&&bt(t,s,X,null,l,te);for(xe in l)te=l[xe],ae=a[xe],!l.hasOwnProperty(xe)||te===ae||te==null&&ae==null||bt(t,s,xe,te,l,ae)}var xc=null,fc=null;function Qr(t){return t.nodeType===9?t:t.ownerDocument}function f0(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function g0(t,s){if(t===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&s==="foreignObject"?0:t}function gc(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var pc=null;function df(){var t=window.event;return t&&t.type==="popstate"?t===pc?!1:(pc=t,!0):(pc=null,!1)}var p0=typeof setTimeout=="function"?setTimeout:void 0,uf=typeof clearTimeout=="function"?clearTimeout:void 0,b0=typeof Promise=="function"?Promise:void 0,mf=typeof queueMicrotask=="function"?queueMicrotask:typeof b0<"u"?function(t){return b0.resolve(null).then(t).catch(hf)}:p0;function hf(t){setTimeout(function(){throw t})}function Aa(t){return t==="head"}function y0(t,s){var a=s,l=0,n=0;do{var r=a.nextSibling;if(t.removeChild(a),r&&r.nodeType===8)if(a=r.data,a==="/$"){if(0<l&&8>l){a=l;var m=t.ownerDocument;if(a&1&&Dn(m.documentElement),a&2&&Dn(m.body),a&4)for(a=m.head,Dn(a),m=a.firstChild;m;){var w=m.nextSibling,L=m.nodeName;m[Ql]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&m.rel.toLowerCase()==="stylesheet"||a.removeChild(m),m=w}}if(n===0){t.removeChild(r),Pn(s);return}n--}else a==="$"||a==="$?"||a==="$!"?n++:l=a.charCodeAt(0)-48;else l=0;a=r}while(a);Pn(s)}function bc(t){var s=t.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var a=s;switch(s=s.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":bc(a),Ni(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}t.removeChild(a)}}function xf(t,s,a,l){for(;t.nodeType===1;){var n=a;if(t.nodeName.toLowerCase()!==s.toLowerCase()){if(!l&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(l){if(!t[Ql])switch(s){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(r=t.getAttribute("rel"),r==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(r!==n.rel||t.getAttribute("href")!==(n.href==null||n.href===""?null:n.href)||t.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin)||t.getAttribute("title")!==(n.title==null?null:n.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(r=t.getAttribute("src"),(r!==(n.src==null?null:n.src)||t.getAttribute("type")!==(n.type==null?null:n.type)||t.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin))&&r&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(s==="input"&&t.type==="hidden"){var r=n.name==null?null:""+n.name;if(n.type==="hidden"&&t.getAttribute("name")===r)return t}else return t;if(t=Rs(t.nextSibling),t===null)break}return null}function ff(t,s,a){if(s==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!a||(t=Rs(t.nextSibling),t===null))return null;return t}function yc(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState==="complete"}function gf(t,s){var a=t.ownerDocument;if(t.data!=="$?"||a.readyState==="complete")s();else{var l=function(){s(),a.removeEventListener("DOMContentLoaded",l)};a.addEventListener("DOMContentLoaded",l),t._reactRetry=l}}function Rs(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return t}var vc=null;function v0(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var a=t.data;if(a==="$"||a==="$!"||a==="$?"){if(s===0)return t;s--}else a==="/$"&&s++}t=t.previousSibling}return null}function w0(t,s,a){switch(s=Qr(a),t){case"html":if(t=s.documentElement,!t)throw Error(c(452));return t;case"head":if(t=s.head,!t)throw Error(c(453));return t;case"body":if(t=s.body,!t)throw Error(c(454));return t;default:throw Error(c(451))}}function Dn(t){for(var s=t.attributes;s.length;)t.removeAttributeNode(s[0]);Ni(t)}var Bs=new Map,N0=new Set;function Xr(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var aa=q.d;q.d={f:pf,r:bf,D:yf,C:vf,L:wf,m:Nf,X:Sf,S:jf,M:_f};function pf(){var t=aa.f(),s=Ur();return t||s}function bf(t){var s=nl(t);s!==null&&s.tag===5&&s.type==="form"?Pu(s):aa.r(t)}var $l=typeof document>"u"?null:document;function j0(t,s,a){var l=$l;if(l&&typeof s=="string"&&s){var n=Ss(s);n='link[rel="'+t+'"][href="'+n+'"]',typeof a=="string"&&(n+='[crossorigin="'+a+'"]'),N0.has(n)||(N0.add(n),t={rel:t,crossOrigin:a,href:s},l.querySelector(n)===null&&(s=l.createElement("link"),es(s,"link",t),Gt(s),l.head.appendChild(s)))}}function yf(t){aa.D(t),j0("dns-prefetch",t,null)}function vf(t,s){aa.C(t,s),j0("preconnect",t,s)}function wf(t,s,a){aa.L(t,s,a);var l=$l;if(l&&t&&s){var n='link[rel="preload"][as="'+Ss(s)+'"]';s==="image"&&a&&a.imageSrcSet?(n+='[imagesrcset="'+Ss(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(n+='[imagesizes="'+Ss(a.imageSizes)+'"]')):n+='[href="'+Ss(t)+'"]';var r=n;switch(s){case"style":r=Ul(t);break;case"script":r=ql(t)}Bs.has(r)||(t=v({rel:"preload",href:s==="image"&&a&&a.imageSrcSet?void 0:t,as:s},a),Bs.set(r,t),l.querySelector(n)!==null||s==="style"&&l.querySelector(Ln(r))||s==="script"&&l.querySelector(Rn(r))||(s=l.createElement("link"),es(s,"link",t),Gt(s),l.head.appendChild(s)))}}function Nf(t,s){aa.m(t,s);var a=$l;if(a&&t){var l=s&&typeof s.as=="string"?s.as:"script",n='link[rel="modulepreload"][as="'+Ss(l)+'"][href="'+Ss(t)+'"]',r=n;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=ql(t)}if(!Bs.has(r)&&(t=v({rel:"modulepreload",href:t},s),Bs.set(r,t),a.querySelector(n)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Rn(r)))return}l=a.createElement("link"),es(l,"link",t),Gt(l),a.head.appendChild(l)}}}function jf(t,s,a){aa.S(t,s,a);var l=$l;if(l&&t){var n=rl(l).hoistableStyles,r=Ul(t);s=s||"default";var m=n.get(r);if(!m){var w={loading:0,preload:null};if(m=l.querySelector(Ln(r)))w.loading=5;else{t=v({rel:"stylesheet",href:t,"data-precedence":s},a),(a=Bs.get(r))&&wc(t,a);var L=m=l.createElement("link");Gt(L),es(L,"link",t),L._p=new Promise(function(J,de){L.onload=J,L.onerror=de}),L.addEventListener("load",function(){w.loading|=1}),L.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Wr(m,s,l)}m={type:"stylesheet",instance:m,count:1,state:w},n.set(r,m)}}}function Sf(t,s){aa.X(t,s);var a=$l;if(a&&t){var l=rl(a).hoistableScripts,n=ql(t),r=l.get(n);r||(r=a.querySelector(Rn(n)),r||(t=v({src:t,async:!0},s),(s=Bs.get(n))&&Nc(t,s),r=a.createElement("script"),Gt(r),es(r,"link",t),a.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},l.set(n,r))}}function _f(t,s){aa.M(t,s);var a=$l;if(a&&t){var l=rl(a).hoistableScripts,n=ql(t),r=l.get(n);r||(r=a.querySelector(Rn(n)),r||(t=v({src:t,async:!0,type:"module"},s),(s=Bs.get(n))&&Nc(t,s),r=a.createElement("script"),Gt(r),es(r,"link",t),a.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},l.set(n,r))}}function S0(t,s,a,l){var n=(n=Me.current)?Xr(n):null;if(!n)throw Error(c(446));switch(t){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(s=Ul(a.href),a=rl(n).hoistableStyles,l=a.get(s),l||(l={type:"style",instance:null,count:0,state:null},a.set(s,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){t=Ul(a.href);var r=rl(n).hoistableStyles,m=r.get(t);if(m||(n=n.ownerDocument||n,m={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(t,m),(r=n.querySelector(Ln(t)))&&!r._p&&(m.instance=r,m.state.loading=5),Bs.has(t)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Bs.set(t,a),r||Af(n,t,a,m.state))),s&&l===null)throw Error(c(528,""));return m}if(s&&l!==null)throw Error(c(529,""));return null;case"script":return s=a.async,a=a.src,typeof a=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=ql(a),a=rl(n).hoistableScripts,l=a.get(s),l||(l={type:"script",instance:null,count:0,state:null},a.set(s,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(c(444,t))}}function Ul(t){return'href="'+Ss(t)+'"'}function Ln(t){return'link[rel="stylesheet"]['+t+"]"}function _0(t){return v({},t,{"data-precedence":t.precedence,precedence:null})}function Af(t,s,a,l){t.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=t.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),es(s,"link",a),Gt(s),t.head.appendChild(s))}function ql(t){return'[src="'+Ss(t)+'"]'}function Rn(t){return"script[async]"+t}function A0(t,s,a){if(s.count++,s.instance===null)switch(s.type){case"style":var l=t.querySelector('style[data-href~="'+Ss(a.href)+'"]');if(l)return s.instance=l,Gt(l),l;var n=v({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return l=(t.ownerDocument||t).createElement("style"),Gt(l),es(l,"style",n),Wr(l,a.precedence,t),s.instance=l;case"stylesheet":n=Ul(a.href);var r=t.querySelector(Ln(n));if(r)return s.state.loading|=4,s.instance=r,Gt(r),r;l=_0(a),(n=Bs.get(n))&&wc(l,n),r=(t.ownerDocument||t).createElement("link"),Gt(r);var m=r;return m._p=new Promise(function(w,L){m.onload=w,m.onerror=L}),es(r,"link",l),s.state.loading|=4,Wr(r,a.precedence,t),s.instance=r;case"script":return r=ql(a.src),(n=t.querySelector(Rn(r)))?(s.instance=n,Gt(n),n):(l=a,(n=Bs.get(r))&&(l=v({},a),Nc(l,n)),t=t.ownerDocument||t,n=t.createElement("script"),Gt(n),es(n,"link",l),t.head.appendChild(n),s.instance=n);case"void":return null;default:throw Error(c(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(l=s.instance,s.state.loading|=4,Wr(l,a.precedence,t));return s.instance}function Wr(t,s,a){for(var l=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=l.length?l[l.length-1]:null,r=n,m=0;m<l.length;m++){var w=l[m];if(w.dataset.precedence===s)r=w;else if(r!==n)break}r?r.parentNode.insertBefore(t,r.nextSibling):(s=a.nodeType===9?a.head:a,s.insertBefore(t,s.firstChild))}function wc(t,s){t.crossOrigin==null&&(t.crossOrigin=s.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=s.referrerPolicy),t.title==null&&(t.title=s.title)}function Nc(t,s){t.crossOrigin==null&&(t.crossOrigin=s.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=s.referrerPolicy),t.integrity==null&&(t.integrity=s.integrity)}var Zr=null;function C0(t,s,a){if(Zr===null){var l=new Map,n=Zr=new Map;n.set(a,l)}else n=Zr,l=n.get(a),l||(l=new Map,n.set(a,l));if(l.has(t))return l;for(l.set(t,null),a=a.getElementsByTagName(t),n=0;n<a.length;n++){var r=a[n];if(!(r[Ql]||r[Ke]||t==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var m=r.getAttribute(s)||"";m=t+m;var w=l.get(m);w?w.push(r):l.set(m,[r])}}return l}function M0(t,s,a){t=t.ownerDocument||t,t.head.insertBefore(a,s==="title"?t.querySelector("head > title"):null)}function Cf(t,s,a){if(a===1||s.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return t=s.disabled,typeof s.precedence=="string"&&t==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function O0(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}var zn=null;function Mf(){}function Of(t,s,a){if(zn===null)throw Error(c(475));var l=zn;if(s.type==="stylesheet"&&(typeof a.media!="string"||matchMedia(a.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var n=Ul(a.href),r=t.querySelector(Ln(n));if(r){t=r._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(l.count++,l=Kr.bind(l),t.then(l,l)),s.state.loading|=4,s.instance=r,Gt(r);return}r=t.ownerDocument||t,a=_0(a),(n=Bs.get(n))&&wc(a,n),r=r.createElement("link"),Gt(r);var m=r;m._p=new Promise(function(w,L){m.onload=w,m.onerror=L}),es(r,"link",a),s.instance=r}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(s,t),(t=s.state.preload)&&(s.state.loading&3)===0&&(l.count++,s=Kr.bind(l),t.addEventListener("load",s),t.addEventListener("error",s))}}function Ef(){if(zn===null)throw Error(c(475));var t=zn;return t.stylesheets&&t.count===0&&jc(t,t.stylesheets),0<t.count?function(s){var a=setTimeout(function(){if(t.stylesheets&&jc(t,t.stylesheets),t.unsuspend){var l=t.unsuspend;t.unsuspend=null,l()}},6e4);return t.unsuspend=s,function(){t.unsuspend=null,clearTimeout(a)}}:null}function Kr(){if(this.count--,this.count===0){if(this.stylesheets)jc(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Jr=null;function jc(t,s){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Jr=new Map,s.forEach(Bf,t),Jr=null,Kr.call(t))}function Bf(t,s){if(!(s.state.loading&4)){var a=Jr.get(t);if(a)var l=a.get(null);else{a=new Map,Jr.set(t,a);for(var n=t.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<n.length;r++){var m=n[r];(m.nodeName==="LINK"||m.getAttribute("media")!=="not all")&&(a.set(m.dataset.precedence,m),l=m)}l&&a.set(null,l)}n=s.instance,m=n.getAttribute("data-precedence"),r=a.get(m)||l,r===l&&a.set(null,n),a.set(m,n),this.count++,l=Kr.bind(this),n.addEventListener("load",l),n.addEventListener("error",l),r?r.parentNode.insertBefore(n,r.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(n,t.firstChild)),s.state.loading|=4}}var Yn={$$typeof:Y,Provider:null,Consumer:null,_currentValue:z,_currentValue2:z,_threadCount:0};function kf(t,s,a,l,n,r,m,w){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ce(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ce(0),this.hiddenUpdates=ce(null),this.identifierPrefix=l,this.onUncaughtError=n,this.onCaughtError=r,this.onRecoverableError=m,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function E0(t,s,a,l,n,r,m,w,L,J,de,xe){return t=new kf(t,s,a,m,w,L,J,xe),s=1,r===!0&&(s|=24),r=gs(3,null,null,s),t.current=r,r.stateNode=t,s=ao(),s.refCount++,t.pooledCache=s,s.refCount++,r.memoizedState={element:l,isDehydrated:a,cache:s},io(r),t}function B0(t){return t?(t=bl,t):bl}function k0(t,s,a,l,n,r){n=B0(n),l.context===null?l.context=n:l.pendingContext=n,l=ha(s),l.payload={element:a},r=r===void 0?null:r,r!==null&&(l.callback=r),a=xa(t,l,s),a!==null&&(ws(a,t,s),xn(a,t,s))}function T0(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var a=t.retryLane;t.retryLane=a!==0&&a<s?a:s}}function Sc(t,s){T0(t,s),(t=t.alternate)&&T0(t,s)}function D0(t){if(t.tag===13){var s=pl(t,67108864);s!==null&&ws(s,t,67108864),Sc(t,67108864)}}var ei=!0;function Tf(t,s,a,l){var n=O.T;O.T=null;var r=q.p;try{q.p=2,_c(t,s,a,l)}finally{q.p=r,O.T=n}}function Df(t,s,a,l){var n=O.T;O.T=null;var r=q.p;try{q.p=8,_c(t,s,a,l)}finally{q.p=r,O.T=n}}function _c(t,s,a,l){if(ei){var n=Ac(l);if(n===null)mc(t,s,l,ti,a),R0(t,l);else if(Rf(n,t,s,a,l))l.stopPropagation();else if(R0(t,l),s&4&&-1<Lf.indexOf(t)){for(;n!==null;){var r=nl(n);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var m=At(r.pendingLanes);if(m!==0){var w=r;for(w.pendingLanes|=2,w.entangledLanes|=2;m;){var L=1<<31-B(m);w.entanglements[1]|=L,m&=~L}qs(r),(xt&6)===0&&(Yr=Ye()+500,Bn(0))}}break;case 13:w=pl(r,2),w!==null&&ws(w,r,2),Ur(),Sc(r,2)}if(r=Ac(l),r===null&&mc(t,s,l,ti,a),r===n)break;n=r}n!==null&&l.stopPropagation()}else mc(t,s,l,null,a)}}function Ac(t){return t=Ei(t),Cc(t)}var ti=null;function Cc(t){if(ti=null,t=ll(t),t!==null){var s=y(t);if(s===null)t=null;else{var a=s.tag;if(a===13){if(t=S(s),t!==null)return t;t=null}else if(a===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null)}}return ti=t,null}function L0(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Qe()){case Pe:return 2;case Re:return 8;case et:case Fe:return 32;case Te:return 268435456;default:return 32}default:return 32}}var Mc=!1,Ca=null,Ma=null,Oa=null,$n=new Map,Un=new Map,Ea=[],Lf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function R0(t,s){switch(t){case"focusin":case"focusout":Ca=null;break;case"dragenter":case"dragleave":Ma=null;break;case"mouseover":case"mouseout":Oa=null;break;case"pointerover":case"pointerout":$n.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Un.delete(s.pointerId)}}function qn(t,s,a,l,n,r){return t===null||t.nativeEvent!==r?(t={blockedOn:s,domEventName:a,eventSystemFlags:l,nativeEvent:r,targetContainers:[n]},s!==null&&(s=nl(s),s!==null&&D0(s)),t):(t.eventSystemFlags|=l,s=t.targetContainers,n!==null&&s.indexOf(n)===-1&&s.push(n),t)}function Rf(t,s,a,l,n){switch(s){case"focusin":return Ca=qn(Ca,t,s,a,l,n),!0;case"dragenter":return Ma=qn(Ma,t,s,a,l,n),!0;case"mouseover":return Oa=qn(Oa,t,s,a,l,n),!0;case"pointerover":var r=n.pointerId;return $n.set(r,qn($n.get(r)||null,t,s,a,l,n)),!0;case"gotpointercapture":return r=n.pointerId,Un.set(r,qn(Un.get(r)||null,t,s,a,l,n)),!0}return!1}function z0(t){var s=ll(t.target);if(s!==null){var a=y(s);if(a!==null){if(s=a.tag,s===13){if(s=S(a),s!==null){t.blockedOn=s,ut(t.priority,function(){if(a.tag===13){var l=vs();l=b(l);var n=pl(a,l);n!==null&&ws(n,a,l),Sc(a,l)}});return}}else if(s===3&&a.stateNode.current.memoizedState.isDehydrated){t.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}t.blockedOn=null}function si(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var a=Ac(t.nativeEvent);if(a===null){a=t.nativeEvent;var l=new a.constructor(a.type,a);Oi=l,a.target.dispatchEvent(l),Oi=null}else return s=nl(a),s!==null&&D0(s),t.blockedOn=a,!1;s.shift()}return!0}function Y0(t,s,a){si(t)&&a.delete(s)}function zf(){Mc=!1,Ca!==null&&si(Ca)&&(Ca=null),Ma!==null&&si(Ma)&&(Ma=null),Oa!==null&&si(Oa)&&(Oa=null),$n.forEach(Y0),Un.forEach(Y0)}function ai(t,s){t.blockedOn===s&&(t.blockedOn=null,Mc||(Mc=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,zf)))}var li=null;function $0(t){li!==t&&(li=t,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){li===t&&(li=null);for(var s=0;s<t.length;s+=3){var a=t[s],l=t[s+1],n=t[s+2];if(typeof l!="function"){if(Cc(l||a)===null)continue;break}var r=nl(a);r!==null&&(t.splice(s,3),s-=3,Co(r,{pending:!0,data:n,method:a.method,action:l},l,n))}}))}function Pn(t){function s(L){return ai(L,t)}Ca!==null&&ai(Ca,t),Ma!==null&&ai(Ma,t),Oa!==null&&ai(Oa,t),$n.forEach(s),Un.forEach(s);for(var a=0;a<Ea.length;a++){var l=Ea[a];l.blockedOn===t&&(l.blockedOn=null)}for(;0<Ea.length&&(a=Ea[0],a.blockedOn===null);)z0(a),a.blockedOn===null&&Ea.shift();if(a=(t.ownerDocument||t).$$reactFormReplay,a!=null)for(l=0;l<a.length;l+=3){var n=a[l],r=a[l+1],m=n[ot]||null;if(typeof r=="function")m||$0(a);else if(m){var w=null;if(r&&r.hasAttribute("formAction")){if(n=r,m=r[ot]||null)w=m.formAction;else if(Cc(n)!==null)continue}else w=m.action;typeof w=="function"?a[l+1]=w:(a.splice(l,3),l-=3),$0(a)}}}function Oc(t){this._internalRoot=t}ni.prototype.render=Oc.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(c(409));var a=s.current,l=vs();k0(a,l,t,s,null,null)},ni.prototype.unmount=Oc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;k0(t.current,2,null,t,null,null),Ur(),s[ss]=null}};function ni(t){this._internalRoot=t}ni.prototype.unstable_scheduleHydration=function(t){if(t){var s=$e();t={blockedOn:null,target:t,priority:s};for(var a=0;a<Ea.length&&s!==0&&s<Ea[a].priority;a++);Ea.splice(a,0,t),a===0&&z0(t)}};var U0=i.version;if(U0!=="19.1.0")throw Error(c(527,U0,"19.1.0"));q.findDOMNode=function(t){var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(c(188)):(t=Object.keys(t).join(","),Error(c(268,t)));return t=j(s),t=t!==null?f(t):null,t=t===null?null:t.stateNode,t};var Yf={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ri=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ri.isDisabled&&ri.supportsFiber)try{k=ri.inject(Yf),ne=ri}catch{}}return Vn.createRoot=function(t,s){if(!x(t))throw Error(c(299));var a=!1,l="",n=sm,r=am,m=lm,w=null;return s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(l=s.identifierPrefix),s.onUncaughtError!==void 0&&(n=s.onUncaughtError),s.onCaughtError!==void 0&&(r=s.onCaughtError),s.onRecoverableError!==void 0&&(m=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(w=s.unstable_transitionCallbacks)),s=E0(t,1,!1,null,null,a,l,n,r,m,w,null),t[ss]=s.current,uc(t),new Oc(s)},Vn.hydrateRoot=function(t,s,a){if(!x(t))throw Error(c(299));var l=!1,n="",r=sm,m=am,w=lm,L=null,J=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(n=a.identifierPrefix),a.onUncaughtError!==void 0&&(r=a.onUncaughtError),a.onCaughtError!==void 0&&(m=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(L=a.unstable_transitionCallbacks),a.formState!==void 0&&(J=a.formState)),s=E0(t,1,!0,s,a??null,l,n,r,m,w,L,J),s.context=B0(null),a=s.current,l=vs(),l=b(l),n=ha(l),n.callback=null,xa(a,n,l),a=l,s.current.lanes=a,re(s,a),qs(s),t[ss]=s.current,uc(t),new ni(s)},Vn.version="19.1.0",Vn}var W0;function Ff(){if(W0)return kc.exports;W0=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(i){console.error(i)}}return o(),kc.exports=Gf(),kc.exports}var Qf=Ff();const Xf=Gc(Qf);window.APP_CONFIG={APP_NAME:"Production Management System",APP_VERSION:"2.0.0",COMPANY_NAME:"Oracles Africa",COMPANY_EMAIL:"admin@oracles.africa",ENV:window.location.hostname==="localhost"?"development":"production",DEBUG:window.location.hostname==="localhost",API_BASE:"/api",API_TIMEOUT:3e4,API_RETRY_ATTEMPTS:3,API_RETRY_DELAY:1e3,WS_URL:`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}`,WS_RECONNECT_ATTEMPTS:5,WS_RECONNECT_DELAY:1e3,WS_PING_INTERVAL:3e4,TOKEN_KEY:"pms_token",USER_KEY:"pms_user",SESSION_TIMEOUT:6e5,SESSION_WARNING_TIME:3e5,REMEMBER_ME_DURATION:6048e5,ENVIRONMENTS:{BLENDING:"blending",PACKAGING:"packaging"},DEFAULT_ENVIRONMENTS:["blending","packaging"],ORDER_STATUSES:{PENDING:"pending",IN_PROGRESS:"in_progress",STOPPED:"stopped",COMPLETED:"completed"},ORDER_STATUS_FLOW:{pending:["in_progress"],in_progress:["stopped","completed"],stopped:["in_progress","completed"],completed:[]},PRIORITY_LEVELS:{LOW:"low",NORMAL:"normal",HIGH:"high",URGENT:"urgent"},PRIORITY_WEIGHTS:{low:1,normal:2,high:3,urgent:4},MACHINE_STATUSES:{AVAILABLE:"available",IN_USE:"in_use",MAINTENANCE:"maintenance",OFFLINE:"offline",PAUSED:"paused"},MACHINE_STATUS_TRANSITIONS:{available:["in_use","maintenance","offline"],in_use:["paused","available","offline"],paused:["in_use","available"],maintenance:["available","offline"],offline:["available","maintenance"]},USER_ROLES:{ADMIN:"admin",SUPERVISOR:"supervisor",OPERATOR:"operator"},ROLE_PERMISSIONS:{admin:["createOrder","updateOrder","deleteOrder","viewOrders","startProduction","stopProduction","completeOrder","manageMachines","viewMachines","manageUsers","viewUsers","viewAnalytics","exportData","manageSettings"],supervisor:["createOrder","updateOrder","deleteOrder","viewOrders","startProduction","stopProduction","completeOrder","viewMachines","viewAnalytics","exportData"],operator:["viewOrders","startProduction","stopProduction","completeOrder","viewMachines"]},STOP_REASONS:[{value:"equipment_breakdown",label:"Equipment Breakdown",category:"mechanical"},{value:"material_shortage",label:"Material Shortage",category:"supply"},{value:"maintenance",label:"Planned Maintenance",category:"mechanical"},{value:"quality_issue",label:"Quality Issue",category:"quality"},{value:"safety_concern",label:"Safety Concern",category:"safety"},{value:"operator_break",label:"Operator Break",category:"operational"},{value:"power_outage",label:"Power Outage",category:"infrastructure"},{value:"shift_change",label:"Shift Change",category:"operational"},{value:"other",label:"Other",category:"other"}],STOP_CATEGORIES:{mechanical:{label:"Mechanical",color:"red"},supply:{label:"Supply Chain",color:"orange"},quality:{label:"Quality",color:"yellow"},safety:{label:"Safety",color:"red"},operational:{label:"Operational",color:"blue"},infrastructure:{label:"Infrastructure",color:"purple"},other:{label:"Other",color:"gray"}},WASTE_TYPES:["Raw Material","Packaging Material","Finished Product","Energy","Water","Other"],WASTE_UNITS:[{value:"kg",label:"Kilograms",type:"weight"},{value:"g",label:"Grams",type:"weight"},{value:"tons",label:"Tons",type:"weight"},{value:"units",label:"Units",type:"count"},{value:"liters",label:"Liters",type:"volume"},{value:"ml",label:"Milliliters",type:"volume"},{value:"meters",label:"Meters",type:"length"},{value:"kwh",label:"kWh",type:"energy"}],THEME:{PRIMARY_COLOR:"blue",SECONDARY_COLOR:"gray",SUCCESS_COLOR:"green",WARNING_COLOR:"yellow",ERROR_COLOR:"red",INFO_COLOR:"blue"},PAGE_SIZE_OPTIONS:[10,25,50,100],DEFAULT_PAGE_SIZE:25,TOAST_DURATION:5e3,TOAST_POSITION:"top-right",MODAL_SIZES:{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-6xl"},TIMEZONE:{name:"SAST",fullName:"South African Standard Time",offset:"+02:00",offsetMinutes:120,olsonName:"Africa/Johannesburg",displayInUI:!0},DATE_FORMATS:{display:{date:"YYYY-MM-DD",time:"HH:mm:ss",datetime:"YYYY-MM-DD HH:mm:ss",datetimeShort:"YYYY-MM-DD HH:mm",friendly:"DD MMM YYYY",friendlyWithTime:"DD MMM YYYY, HH:mm SAST"},input:{date:"YYYY-MM-DD",time:"HH:mm",datetime:"YYYY-MM-DDTHH:mm"},api:{iso:"YYYY-MM-DDTHH:mm:ss.SSSZ"}},DATE_FORMAT:{dateStyle:"short",timeStyle:"short"},DATE_FORMAT_LONG:{dateStyle:"long",timeStyle:"medium"},LOCALE:"en-ZA",BUSINESS_HOURS:{timezone:"SAST",workDays:[1,2,3,4,5],startTime:"08:00",endTime:"17:00",lunchBreak:{start:"12:00",end:"13:00"},breaks:[{name:"Morning Tea",start:"10:00",end:"10:15"},{name:"Afternoon Tea",start:"15:00",end:"15:15"}]},SHIFTS:{day:{name:"Day Shift",start:"06:00",end:"14:00",timezone:"SAST"},afternoon:{name:"Afternoon Shift",start:"14:00",end:"22:00",timezone:"SAST"},night:{name:"Night Shift",start:"22:00",end:"06:00",timezone:"SAST"}},UPLOAD:{MAX_FILE_SIZE:10*1024*1024,CHUNK_SIZE:1024*1024,ALLOWED_EXTENSIONS:["xlsx","xls","csv","pdf","png","jpg","jpeg"],ALLOWED_MIME_TYPES:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv","application/pdf","image/png","image/jpeg"],IMAGE_MAX_WIDTH:2e3,IMAGE_MAX_HEIGHT:2e3,IMAGE_QUALITY:.9},EXPORT_FORMATS:["json","csv","excel","pdf"],EXPORT_BATCH_SIZE:1e3,CACHE_TTL:{SHORT:3e5,MEDIUM:18e5,LONG:36e5,VERY_LONG:864e5},REFRESH_INTERVALS:{ORDERS:3e4,MACHINES:6e4,ANALYTICS:3e5,NOTIFICATIONS:6e4},ANALYTICS:{CHART_COLORS:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316"],DEFAULT_DATE_RANGE:30,MAX_CHART_POINTS:100,EFFICIENCY_TARGETS:{EXCELLENT:95,GOOD:85,AVERAGE:75,POOR:65}},VALIDATION:{USERNAME_MIN_LENGTH:3,USERNAME_MAX_LENGTH:50,PASSWORD_MIN_LENGTH:6,PASSWORD_MAX_LENGTH:128,ORDER_NUMBER_PATTERN:/^[A-Z0-9-]+$/,EMAIL_PATTERN:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,PHONE_PATTERN:/^[\d\s\-\+\(\)]+$/},BUSINESS_RULES:{MIN_ORDER_QUANTITY:1,MAX_ORDER_QUANTITY:999999,ORDER_NUMBER_PREFIX:"ORD",AUTO_LOGOUT_AFTER_INACTIVITY:!0,REQUIRE_STOP_REASON:!0,REQUIRE_WASTE_TRACKING:!0,ALLOW_NEGATIVE_EFFICIENCY:!1,MAX_CONCURRENT_ORDERS_PER_MACHINE:1},FEATURES:{REAL_TIME_UPDATES:!0,OFFLINE_MODE:!0,EXPORT_FUNCTIONALITY:!0,ADVANCED_ANALYTICS:!0,MACHINE_MAINTENANCE_TRACKING:!0,TIMEZONE_DISPLAY:!0,BUSINESS_HOURS_VALIDATION:!0,SHIFT_TRACKING:!0,QUALITY_CONTROL:!1,INVENTORY_MANAGEMENT:!1,PREDICTIVE_MAINTENANCE:!1},EXTERNAL_SERVICES:{ANALYTICS_ENABLED:!1,ANALYTICS_ID:"",ERROR_TRACKING_ENABLED:!1,ERROR_TRACKING_DSN:"",SUPPORT_EMAIL:"support@oracles.africa",DOCUMENTATION_URL:"https://docs.oracles.africa/pms"},STATUS_COLORS:{pending:{bg:"bg-yellow-100",text:"text-yellow-800",border:"border-yellow-300",dot:"bg-yellow-400"},in_progress:{bg:"bg-blue-100",text:"text-blue-800",border:"border-blue-300",dot:"bg-blue-400"},stopped:{bg:"bg-red-100",text:"text-red-800",border:"border-red-300",dot:"bg-red-400"},completed:{bg:"bg-green-100",text:"text-green-800",border:"border-green-300",dot:"bg-green-400"}},PRIORITY_COLORS:{low:{bg:"bg-gray-100",text:"text-gray-600",border:"border-gray-300"},normal:{bg:"bg-blue-100",text:"text-blue-600",border:"border-blue-300"},high:{bg:"bg-orange-100",text:"text-orange-600",border:"border-orange-300"},urgent:{bg:"bg-red-100",text:"text-red-600",border:"border-red-300"}},MACHINE_STATUS_COLORS:{available:{bg:"bg-green-100",text:"text-green-800",dot:"bg-green-400"},in_use:{bg:"bg-blue-100",text:"text-blue-800",dot:"bg-blue-400"},paused:{bg:"bg-yellow-100",text:"text-yellow-800",dot:"bg-yellow-400"},maintenance:{bg:"bg-orange-100",text:"text-orange-800",dot:"bg-orange-400"},offline:{bg:"bg-red-100",text:"text-red-800",dot:"bg-red-400"}}};window.APP_CONFIG.ENV==="production"&&(Object.freeze(window.APP_CONFIG),Object.freeze(window.APP_CONFIG.ORDER_STATUSES),Object.freeze(window.APP_CONFIG.PRIORITY_LEVELS),Object.freeze(window.APP_CONFIG.MACHINE_STATUSES),Object.freeze(window.APP_CONFIG.USER_ROLES),Object.freeze(window.APP_CONFIG.ROLE_PERMISSIONS),Object.freeze(window.APP_CONFIG.FEATURES));const Wf={events:{},on(o,i){return this.events[o]||(this.events[o]=[]),this.events[o].push(i),()=>{this.off(o,i)}},off(o,i){this.events[o]&&(this.events[o]=this.events[o].filter(h=>h!==i))},emit(o,i){this.events[o]&&this.events[o].forEach(h=>{try{h(i)}catch(c){console.error(`Error in event handler for ${o}:`,c)}})},clear(o){o?delete this.events[o]:this.events={}}};window.EventBus=Wf;class Zf{constructor(){this.baseURL=window.APP_CONFIG?.API_BASE||"/api",this.retryAttempts=3,this.retryDelay=1e3}getHeaders(){const i={"Content-Type":"application/json"},h=localStorage.getItem("token");return h&&(i.Authorization=`Bearer ${h}`),i}async handleResponse(i){if(!i.ok){if(i.status===401||i.status===403)throw console.log(" Authentication failed - clearing tokens and triggering logout"),localStorage.removeItem("token"),localStorage.removeItem("user_data"),window.EventBus&&window.EventBus.emit("auth:logout"),new Error("Session expired. Please login again.");let h;try{h=await i.json()}catch{h={error:"Request failed",success:!1}}const c=new Error(h.error||h.message||"Request failed");throw c.response={status:i.status,data:h,success:h.success||!1},c}if(i.headers.get("content-length")==="0")return{success:!0,data:null};try{return await i.json()}catch{return{success:!0,data:null}}}async retryRequest(i,h=this.retryAttempts){for(let c=0;c<h;c++)try{return await i()}catch(x){if(x.response?.status===401||x.response?.status===403||x.response?.status===400||c===h-1)throw x;await new Promise(y=>setTimeout(y,this.retryDelay*(c+1))),console.warn(`API request failed, retrying... (${c+1}/${h})`)}}async request(i,h={}){const c=`${this.baseURL}${i}`,x={...h,headers:{...this.getHeaders(),...h.headers},credentials:"include"};return this.retryRequest(async()=>{try{const y=await fetch(c,x);return this.handleResponse(y)}catch(y){throw console.error("API request failed:",{url:c,method:x.method||"GET",error:y.message}),y}})}async get(i,h={}){const c=new URLSearchParams(Object.entries(h).filter(([y,S])=>S!=null)).toString(),x=c?`${i}?${c}`:i;return this.request(x,{method:"GET"})}async post(i,h={}){return this.request(i,{method:"POST",body:JSON.stringify(h)})}async put(i,h={}){return this.request(i,{method:"PUT",body:JSON.stringify(h)})}async patch(i,h={}){return this.request(i,{method:"PATCH",body:JSON.stringify(h)})}async delete(i){return this.request(i,{method:"DELETE"})}async uploadFile(i,h,c=null){const x=new FormData;return x.append("file",h),new Promise((y,S)=>{const A=new XMLHttpRequest,j=localStorage.getItem("token");j&&A.setRequestHeader("Authorization",`Bearer ${j}`),c&&A.upload.addEventListener("progress",f=>{if(f.lengthComputable){const v=f.loaded/f.total*100;c(v)}}),A.addEventListener("load",()=>{if(A.status>=200&&A.status<300)try{const f=JSON.parse(A.responseText);y(f)}catch{y({success:!0})}else S(new Error(`Upload failed: ${A.statusText}`))}),A.addEventListener("error",()=>{S(new Error("Upload failed"))}),A.open("POST",`${this.baseURL}${i}`),A.send(x)})}async login(i,h){const c=await this.post("/auth/login",{username:i,password:h});return c.success&&c.data?.token&&localStorage.setItem("token",c.data.token),c}async logout(){try{await this.post("/auth/logout")}finally{localStorage.removeItem("token"),window.EventBus&&window.EventBus.emit("auth:logout")}}async verifySession(){return this.post("/auth/verify")}async getWebSocketToken(){return this.get("/auth/websocket-token")}async getOrders(i={}){return this.get("/orders",i)}async createOrder(i){return this.post("/orders",i)}async updateOrder(i,h){return this.put(`/orders/${i}`,h)}async deleteOrder(i){return this.delete(`/orders/${i}`)}async startProduction(i,h){return this.post(`/orders/${i}/start`,{machine_id:h})}async stopProduction(i,h,c=""){return this.post(`/orders/${i}/stop`,{reason:h,notes:c})}async pauseProduction(i,h){return this.post(`/orders/${i}/pause`,{reason:h})}async resumeProduction(i){return this.post(`/orders/${i}/resume`)}async completeProduction(i,h={}){return this.post(`/orders/${i}/complete`,h)}async getMachines(i=null){return this.get("/machines",i?{environment:i}:{})}async createMachine(i){return this.post("/machines",i)}async updateMachine(i,h){return this.put(`/machines/${i}`,h)}async updateMachineStatus(i,h){return this.patch(`/machines/${i}/status`,{status:h})}async deleteMachine(i){return this.delete(`/machines/${i}`)}async getMachineStats(){return this.get("/machines/stats")}async getUsers(){return this.get("/users")}async createUser(i){return this.post("/users",i)}async updateUser(i,h){return this.put(`/users/${i}`,h)}async getProductionStatus(){return this.get("/production/status")}async getMachineStatus(){return this.get("/machines/status")}async getActiveOrders(){return this.get("/orders/active")}async getProductionFloorOverview(){return this.get("/production/floor-overview")}async getAnalyticsSummary(i={}){return this.get("/analytics/summary",i)}async getDowntimeAnalytics(i={}){return this.get("/analytics/downtime",i)}async getDowntimeReports(i={}){return this.get("/reports/downtime",i)}async getArchivedOrders(){return this.get("/orders/archived")}async getOrder(i){return this.get(`/orders/${i}`)}async getAnalyticsStops(){return this.get("/analytics/stops")}async getGeneralSettings(){return this.get("/settings/general")}async updateGeneralSettings(i){return this.put("/settings/general",i)}async getLaborAssignments(i=null){return this.get("/planner/assignments",i?{date:i}:{})}async createLaborAssignment(i){return this.post("/planner/assignments",i)}async deleteLaborAssignment(i){return this.delete(`/planner/assignments/${i}`)}async getSupervisors(i=null,h=null){const c={};return i&&(c.date=i),h&&(c.shift=h),this.get("/planner/supervisors",c)}async addSupervisor(i){return this.post("/planner/supervisors",i)}async deleteSupervisor(i){return this.delete(`/planner/supervisors/${i}`)}async getEnvironments(){return this.get("/environments")}async exportData(i,h={}){const c=await fetch(`${this.baseURL}/export/${i}?${new URLSearchParams(h)}`,{headers:this.getHeaders(),credentials:"include"});if(!c.ok)throw new Error("Export failed");return c.blob()}async uploadOrders(i,h=null){return this.uploadFile("/upload-orders",i,h)}async checkHealth(){return this.get("/health")}}const fe=new Zf;window.API=fe;class Kf{constructor(){this.ws=null,this.connectionId=null,this.connectionState="disconnected",this.isAuthenticated=!1,this.reconnectAttempts=0,this.maxReconnectAttempts=10,this.reconnectDelay=1e3,this.heartbeatInterval=3e4,this.messageQueue=[],this.subscriptions=new Set,this.rooms=new Set,this.eventHandlers=new Map,this.metrics={messagesReceived:0,messagesSent:0,reconnections:0,lastPing:null,connectionTime:null},this.heartbeatTimer=null,this.reconnectTimer=null,this.connectionTimeoutTimer=null,console.log(" Enhanced WebSocket Service initialized")}async connect(i=null){return this.connectionState==="connecting"||this.isConnected()?(console.log(" WebSocket already connecting or connected"),Promise.resolve()):new Promise(async(h,c)=>{try{this.connectionState="connecting",this.emit("connectionStateChanged",{state:"connecting"});const x=i||await this.getWebSocketToken();if(!x){console.log(" No authentication token available, skipping WebSocket connection"),this.connectionState="disconnected",this.emit("connectionStateChanged",{state:"disconnected"});return}const y=this.buildWebSocketUrl(x);console.log(" Connecting to:",y),this.ws=new WebSocket(y,x),this.connectionTimeoutTimer=setTimeout(()=>{this.connectionState==="connecting"&&(this.ws.close(),c(new Error("Connection timeout")))},1e4),this.setupEnhancedEventHandlers(h,c)}catch(x){this.handleConnectionError(x),c(x)}})}buildWebSocketUrl(i){return window.location.hostname==="localhost"?(this.authToken=i,"ws://localhost:3000"):(this.authToken=i,"wss://oracles.africa/ws")}setupEnhancedEventHandlers(i,h){const c={value:!1};this.ws.onopen=x=>{this.connectionTimeoutTimer&&(clearTimeout(this.connectionTimeoutTimer),this.connectionTimeoutTimer=null),console.log(" Enhanced WebSocket connected"),this.connectionState="connected",this.metrics.connectionTime=new Date,this.reconnectAttempts=0,this.connectionId=`enh_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,this.startHeartbeat(),this.processMessageQueue(),this.resubscribeToChannels(),this.emit("connected",{connectionId:this.connectionId,serverTime:new Date().toISOString(),enhanced:!0}),c.value||(c.value=!0,i())},this.ws.onmessage=x=>{try{const y=JSON.parse(x.data);this.metrics.messagesReceived++,this.handleEnhancedMessage(y)}catch(y){console.error(" Failed to parse WebSocket message:",y)}},this.ws.onclose=x=>{this.connectionTimeoutTimer&&(clearTimeout(this.connectionTimeoutTimer),this.connectionTimeoutTimer=null),console.log(` Enhanced WebSocket disconnected - Code: ${x.code}, Reason: ${x.reason}`),this.handleDisconnection(x),c.value||(c.value=!0,h(new Error(`Connection failed: ${x.code} ${x.reason}`)))},this.ws.onerror=x=>{console.error(" Enhanced WebSocket error:",x),c.value||(c.value=!0,h(x))}}handleConnectionError(i){console.error(" WebSocket connection error:",i),this.connectionState="disconnected",this.lastError=i,this.connectionTimeoutTimer&&(clearTimeout(this.connectionTimeoutTimer),this.connectionTimeoutTimer=null),this.metrics.connectionErrors=(this.metrics.connectionErrors||0)+1,this.emit("error",i),i.message&&i.message.includes("token")&&console.warn(" Token-related error, may need re-authentication")}handleEnhancedMessage(i){const{type:h,data:c,room:x,channel:y,priority:S="normal",timestamp:A}=i;switch(console.log(` Enhanced message received: ${h}`,{room:x,channel:y,priority:S}),h){case"welcome":this.isAuthenticated=!0,this.emit("authenticated",c),console.log(" Enhanced WebSocket authenticated:",c.user);break;case"auth_error":console.error(" Authentication failed:",c.error),this.disconnect(),this.emit("auth_error",c);break;case"pong":this.metrics.lastPing=new Date;break;case"room_joined":this.rooms.add(c.room),console.log(" Joined room:",c.room),this.emit("room_joined",c);break;case"room_left":this.rooms.delete(c.room),console.log(" Left room:",c.room),this.emit("room_left",c);break;case"subscription_confirmed":c.channels?.forEach(j=>this.subscriptions.add(j)),this.emit("subscribed",c);break;case"error":console.error(" Server error:",c.error),this.emit("server_error",c);break;case"order_started":case"order_stopped":case"order_resumed":case"order_completed":this.emit("order_update",{type:h,data:c,timestamp:A,room:x,channel:y}),this.emit(h,{data:c,timestamp:A,room:x,channel:y});break;case"machine_status_changed":this.emit("machine_update",{type:h,data:c,timestamp:A,room:x,channel:y}),this.emit(h,{data:c,timestamp:A,room:x,channel:y});break;case"production_alert":this.emit("alert",{data:c,timestamp:A,priority:S,room:x,channel:y});break;case"user_notification":this.emit("notification",{data:c,timestamp:A,priority:S});break;default:this.emit(h,{data:c,timestamp:A,room:x,channel:y,priority:S});break}}subscribe(i,h=null){if(typeof i=="string"&&(i=[i]),!Array.isArray(i))return;i.forEach(x=>this.subscriptions.add(x));const c={channels:i};h&&(c.room=h,this.rooms.add(h)),this.isConnected()&&this.isAuthenticated?(this.send("subscribe",c),console.log(" Subscribing to channels:",i,h?`in room: ${h}`:"")):console.log(" Queued subscription (will subscribe when connected):",i)}joinRoom(i){this.isConnected()&&this.isAuthenticated?(this.send("join_room",{room:i}),console.log(" Joining room:",i)):console.log(" Queued room join:",i)}leaveRoom(i){this.isConnected()&&this.isAuthenticated&&(this.send("leave_room",{room:i}),this.rooms.delete(i),console.log(" Leaving room:",i))}send(i,h={},c="normal"){const x={type:i,data:h,priority:c,timestamp:new Date().toISOString(),clientId:this.connectionId};if(!this.isConnected())return this.messageQueue.push(x),console.log(" Message queued:",i),!1;try{return this.ws.send(JSON.stringify(x)),this.metrics.messagesSent++,console.log(` Enhanced message sent: ${i}`),!0}catch(y){return console.error(" Failed to send message:",y),this.messageQueue.push(x),!1}}processMessageQueue(){if(this.messageQueue.length===0)return;console.log(` Processing ${this.messageQueue.length} queued messages`);const i=[...this.messageQueue];this.messageQueue=[],i.forEach(h=>{this.send(h.type,h.data,h.priority)})}resubscribeToChannels(){if(this.subscriptions.size>0){const i=Array.from(this.subscriptions);this.send("subscribe",{channels:i}),console.log(" Resubscribed to channels:",i)}this.rooms.size>0&&(this.rooms.forEach(i=>{this.send("join_room",{room:i})}),console.log(" Rejoined rooms:",Array.from(this.rooms)))}startHeartbeat(){this.stopHeartbeat(),this.heartbeatTimer=setInterval(()=>{if(this.isConnected()){const i=Date.now();this.send("ping",{clientTime:i})}},this.heartbeatInterval),console.log(` Enhanced heartbeat started (${this.heartbeatInterval}ms)`)}stopHeartbeat(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null)}handleDisconnection(i){this.connectionState="disconnected",this.isAuthenticated=!1,this.stopHeartbeat(),this.emit("disconnected",{code:i.code,reason:i.reason,connectionTime:this.metrics.connectionTime,reconnectAttempts:this.reconnectAttempts}),i.code!==1e3&&i.code!==1001&&this.scheduleReconnect()}scheduleReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.error(" Max reconnection attempts reached"),this.emit("max_reconnect_attempts");return}const i=this.reconnectDelay*Math.pow(2,this.reconnectAttempts),h=Math.random()*1e3,c=i+h;this.reconnectAttempts++,this.metrics.reconnections++,console.log(` Scheduling reconnection ${this.reconnectAttempts}/${this.maxReconnectAttempts} in ${Math.round(c)}ms`),this.connectionState="reconnecting",this.emit("connectionStateChanged",{state:"reconnecting",attempt:this.reconnectAttempts,delay:Math.round(c)}),this.reconnectTimer=setTimeout(()=>{this.connect().catch(x=>{console.warn(" Reconnection failed:",x.message)})},c)}isConnected(){return this.ws&&this.ws.readyState===WebSocket.OPEN}getConnectionStatus(){return{state:this.connectionState,isConnected:this.isConnected(),isAuthenticated:this.isAuthenticated,connectionId:this.connectionId,subscriptions:Array.from(this.subscriptions),rooms:Array.from(this.rooms),queuedMessages:this.messageQueue.length,metrics:{...this.metrics},reconnectAttempts:this.reconnectAttempts}}disconnect(){console.log(" Disconnecting Enhanced WebSocket"),this.stopHeartbeat(),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.connectionTimeoutTimer&&(clearTimeout(this.connectionTimeoutTimer),this.connectionTimeoutTimer=null),this.ws&&(this.ws.close(1e3,"Client disconnect"),this.ws=null),this.connectionState="disconnected",this.isAuthenticated=!1,this.reconnectAttempts=0,this.connectionId=null,this.messageQueue=[],this.emit("disconnected",{deliberate:!0})}on(i,h){this.eventHandlers.has(i)||this.eventHandlers.set(i,new Set),this.eventHandlers.get(i).add(h),console.log(` Handler registered for: ${i}`)}off(i,h){this.eventHandlers.has(i)&&this.eventHandlers.get(i).delete(h)}emit(i,h){this.eventHandlers.has(i)&&this.eventHandlers.get(i).forEach(c=>{try{c(h)}catch(x){console.error(` Error in event handler for ${i}:`,x)}})}async getWebSocketToken(){try{const i=localStorage.getItem("token");if(console.log(" Checking for stored token:",i?`${i.substring(0,20)}...`:"None found"),!i)return console.log(" No token in localStorage, cannot get WebSocket token"),null;const h={"Content-Type":"application/json",Authorization:`Bearer ${i}`};console.log(" Requesting WebSocket token from /api/auth/websocket-token");const c=await fetch("/api/auth/websocket-token",{method:"GET",credentials:"include",headers:h});if(console.log(" WebSocket token response status:",c.status),c.status===401)return console.warn(" Not authenticated for WebSocket - token may be expired"),localStorage.removeItem("token"),null;if(!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);const x=await c.json(),y=x.data?.token||x.token;return console.log(" WebSocket token obtained successfully:",y?`${y.substring(0,20)}...`:"None"),y}catch(i){return console.error(" Failed to get WebSocket token:",i),null}}getMetrics(){return{...this.metrics,uptime:this.metrics.connectionTime?Date.now()-this.metrics.connectionTime.getTime():0,subscriptionCount:this.subscriptions.size,roomCount:this.rooms.size,handlerCount:Array.from(this.eventHandlers.values()).reduce((i,h)=>i+h.size,0)}}resetMetrics(){this.metrics={messagesReceived:0,messagesSent:0,reconnections:0,lastPing:null,connectionTime:this.metrics.connectionTime}}}const zt=new Kf;window.EnhancedWebSocketService=zt;const uh=ka.createContext(null),ca=()=>ka.useContext(uh),mh=({children:o})=>{const[i,h]=ka.useState(null),[c,x]=ka.useState(!0),[y,S]=ka.useState(!1),A=async()=>{x(!0);try{if(!localStorage.getItem("token")){console.log(" No token found in localStorage"),h(null),S(!1),x(!1);return}console.log(" Token found, verifying session...");const se=await window.API.verifySession(),G=se?.data?.user||se?.user;if(G){if(console.log(" Session verified successfully:",G.username),h(G),S(!0),localStorage.setItem("user_data",JSON.stringify(G)),window.EnhancedWebSocketService&&!window.EnhancedWebSocketService.isConnected())try{console.log(" User already authenticated - connecting WebSocket"),await window.EnhancedWebSocketService.connect()}catch(W){console.warn(" WebSocket connection failed for existing session:",W.message)}}else throw console.log(" Session verification failed - no user data returned"),new Error("No user data returned from session verification")}catch(U){console.log(" Session verification failed:",U.message),h(null),S(!1),localStorage.removeItem("user_data"),localStorage.removeItem("token")}finally{x(!1)}};ka.useEffect(()=>{A();const U=window.EventBus.on("auth:logout",()=>{h(null),S(!1),localStorage.removeItem("user_data"),localStorage.removeItem("token")});return()=>U()},[]);const F={user:i,login:async(U,se)=>{const G=await window.API.login(U,se);if(G.data?.user&&G.data?.token&&(h(G.data.user),S(!0),localStorage.setItem("user_data",JSON.stringify(G.data.user)),localStorage.setItem("token",G.data.token),window.EnhancedWebSocketService))try{console.log(" Connecting WebSocket after successful login"),await window.EnhancedWebSocketService.connect()}catch(W){console.warn(" WebSocket connection failed after login:",W.message)}return G},logout:async()=>{try{await window.API.logout()}catch(U){console.error("Logout failed:",U)}finally{if(window.EnhancedWebSocketService)try{console.log(" Disconnecting WebSocket on logout"),window.EnhancedWebSocketService.disconnect()}catch(U){console.warn(" WebSocket disconnect failed on logout:",U.message)}h(null),S(!1),localStorage.removeItem("user_data"),localStorage.removeItem("token")}},loading:c,isAuthenticated:y,hasRole:U=>i?(Array.isArray(U)?U:[U]).includes(i.role):!1,checkAuth:A};return ka.createElement(uh.Provider,{value:F},o)};window.useAuth=ca;window.AuthProvider=mh;class Jf{constructor(){this.routes=[],this.currentRoute=null,this.listening=!1}init(){this.listening=!0,window.addEventListener("popstate",i=>{this.handleRouteChange()}),this.handleRouteChange()}addRoute(i){this.routes.push(i)}navigate(i,h={}){i!==window.location.pathname&&(window.history.pushState({},"",i),this.handleRouteChange())}back(){window.history.back()}handleRouteChange(){const i=window.location.pathname,h=this.findRoute(i);this.currentRoute=h,window.EventBus&&window.EventBus.emit("router:navigation",{route:h,path:i,params:h?{}:null})}findRoute(i){return this.routes.find(h=>{if(h.path===i)return!0;const c=h.path.split("/"),x=i.split("/");return c.length!==x.length?!1:c.every((y,S)=>y.startsWith(":")||y===x[S])})}getCurrentRoute(){return{route:this.currentRoute,path:window.location.pathname,params:{},query:this.getQueryParams()}}getQueryParams(){const i=new URLSearchParams(window.location.search),h={};for(const[c,x]of i)h[c]=x;return h}updateQueryParams(i,h=!1){const c=new URL(window.location);Object.entries(i).forEach(([x,y])=>{y==null?c.searchParams.delete(x):c.searchParams.set(x,y)}),h?window.history.replaceState({},"",c):window.history.pushState({},"",c)}isActive(i,h=!1){const c=window.location.pathname;return h?c===i:c.startsWith(i)}link(i){return i}}const Qc=new Jf;window.Router=Qc;const eg=()=>{const[o,i]=React.useState(window.Router.getCurrentRoute());React.useEffect(()=>{const y=S=>{i({route:S.route,path:S.path,params:S.params||{},query:window.Router.getQueryParams()})};if(window.EventBus)return window.EventBus.on("router:navigation",y)},[]);const h=React.useCallback((y,S)=>{window.Router.navigate(y,S)},[]),c=React.useCallback(()=>{window.Router.back()},[]),x=React.useCallback((y,S)=>{window.Router.updateQueryParams(y,S)},[]);return{route:o.route,path:o.path,params:o.params,query:o.query,navigate:h,back:c,updateQuery:x,isActive:window.Router.isActive.bind(window.Router),link:window.Router.link.bind(window.Router)}};window.useRouter=eg;/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tg=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sg=o=>o.replace(/^([A-Z])|[\s-_]+(\w)/g,(i,h,c)=>c?c.toUpperCase():h.toLowerCase()),Z0=o=>{const i=sg(o);return i.charAt(0).toUpperCase()+i.slice(1)},hh=(...o)=>o.filter((i,h,c)=>!!i&&i.trim()!==""&&c.indexOf(i)===h).join(" ").trim(),ag=o=>{for(const i in o)if(i.startsWith("aria-")||i==="role"||i==="title")return!0};/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lg={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ng=u.forwardRef(({color:o="currentColor",size:i=24,strokeWidth:h=2,absoluteStrokeWidth:c,className:x="",children:y,iconNode:S,...A},j)=>u.createElement("svg",{ref:j,...lg,width:i,height:i,stroke:o,strokeWidth:c?Number(h)*24/Number(i):h,className:hh("lucide",x),...!y&&!ag(A)&&{"aria-hidden":"true"},...A},[...S.map(([f,v])=>u.createElement(f,v)),...Array.isArray(y)?y:[y]]));/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=(o,i)=>{const h=u.forwardRef(({className:c,...x},y)=>u.createElement(ng,{ref:y,iconNode:i,className:hh(`lucide-${tg(Z0(o))}`,`lucide-${o}`,c),...x}));return h.displayName=Z0(o),h};/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rg=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Wt=De("activity",rg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],$c=De("arrow-down",ig);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],xh=De("arrow-up",og);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cg=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Vl=De("bell",cg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],xs=De("calendar",dg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ug=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],ts=De("chart-column",ug);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mg=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],fh=De("chart-pie",mg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],xg=De("check",hg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fg=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],pi=De("chevron-down",fg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gg=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Xc=De("chevron-right",gg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pg=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Wc=De("chevron-left",pg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bg=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Nt=De("circle-check-big",bg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],mi=De("circle-check",yg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vg=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Zc=De("circle-x",vg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Uc=De("clipboard-list",wg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ng=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Zt=De("clock",Ng);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],qc=De("cpu",jg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sg=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],_g=De("database",Sg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ag=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Ns=De("download",Ag);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],Mg=De("droplets",Cg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Eg=De("ellipsis-vertical",Og);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],gh=De("eye-off",Bg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kg=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ps=De("eye",kg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tg=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M3 19a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.5a.5.5 0 0 0-.769-.422l-4.462 2.844A.5.5 0 0 1 15 10.5v-2a.5.5 0 0 0-.769-.422L9.77 10.922A.5.5 0 0 1 9 10.5V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z",key:"1iv0i2"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Et=De("factory",Tg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Kc=De("file-text",Dg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Qn=De("funnel",Lg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],Gn=De("gauge",Rg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zg=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Yg=De("grid-3x3",zg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $g=[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]],Ug=De("hand",$g);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],ph=De("house",qg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pg=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],bh=De("info",Pg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hg=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],hi=De("layers",Hg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vg=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],Ig=De("layout-dashboard",Vg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Fg=De("loader-circle",Gg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],yh=De("log-out",Qg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xg=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Wg=De("map-pin",Xg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],vh=De("maximize-2",Zg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],wh=De("menu",Kg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jg=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],K0=De("minimize-2",Jg);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=[["path",{d:"M5 12h14",key:"1ays0h"}]],tp=De("minus",ep);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=[["path",{d:"M5.5 20H8",key:"1k40s5"}],["path",{d:"M17 9h.01",key:"1j24nn"}],["rect",{width:"10",height:"16",x:"12",y:"4",rx:"2",key:"ixliua"}],["path",{d:"M8 6H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h4",key:"1mp6e1"}],["circle",{cx:"17",cy:"15",r:"1",key:"tqvash"}]],J0=De("monitor-speaker",sp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ap=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],xi=De("monitor",ap);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lp=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],eh=De("moon",lp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const np=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],rp=De("mouse-pointer",np);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],cs=De("package",ip);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],Nh=De("pause",op);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],di=De("pen-line",cp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dp=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],jh=De("pen",dp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],Ta=De("play",up);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mp=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],qt=De("plus",mp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hp=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Tt=De("refresh-cw",hp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xp=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],fi=De("rotate-ccw",xp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fp=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],na=De("save",fp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gp=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],oa=De("search",gp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pp=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Pt=De("settings",pp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bp=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],yp=De("shield-check",bp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vp=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],ui=De("shield",vp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wp=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Hl=De("square",wp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Np=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],th=De("sun",Np);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ra=De("target",jp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sp=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],Pc=De("thermometer",Sp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _p=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Hc=De("timer",_p);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ap=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Da=De("trash-2",Ap);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cp=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Jc=De("trending-down",Cp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mp=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],la=De("trending-up",Mp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Op=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],gt=De("triangle-alert",Op);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ep=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],Rc=De("truck",Ep);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bp=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],bi=De("upload",Bp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kp=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ia=De("user-check",kp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tp=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],zc=De("user-plus",Tp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dp=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Lp=De("user-x",Dp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rp=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Sh=De("user",Rp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],vt=De("users",zp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yp=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],$p=De("wifi-off",Yp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Up=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],qp=De("wifi",Up);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pp=[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]],sh=De("workflow",Pp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hp=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],tl=De("wrench",Hp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vp=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],rs=De("x",Vp);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ip=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Xn=De("zap",Ip),ah={calendar:xs,users:vt,search:oa,plus:qt,check:Nt,checkCircle2:mi,x:rs,menu:wh,home:ph,chevronDown:pi,clipboard:Uc,userCheck:ia,settings:Pt,edit:jh,save:na,trash:Da,upload:bi,download:Ns,logOut:yh,activity:Wt,wifi:qp,wifiOff:$p,bell:Vl,alertTriangle:gt,package:cs,shield:ui,dashboard:Ig,clock:Zt,barChart3:ts,zap:Xn,trendingUp:la,user:Sh,moreVertical:Eg},La=({icon:o,size:i=24,className:h="",animate:c=!1,color:x="currentColor",...y})=>{const S=ah[o];if(!S)return console.warn(`Icon '${o}' not found in iconMap. Available icons:`,Object.keys(ah)),e.jsx(gt,{size:i,className:`${h} text-yellow-500`,...y});const j=`${h} ${c?"transition-all duration-200 hover:scale-110":""}`.trim();return e.jsx(S,{size:i,className:j,color:x,...y})},Gp=()=>{const[o,i]=u.useState(navigator.onLine),[h,c]=u.useState("disconnected"),[x,y]=u.useState(new Date),[S,A]=u.useState(!1),j=u.useRef(null);u.useEffect(()=>{const se=()=>{i(!0),y(new Date)},G=()=>{i(!1),y(new Date)};window.addEventListener("online",se),window.addEventListener("offline",G);const W=()=>{c("connected"),y(new Date)},N=()=>{c("disconnected"),y(new Date)},g=()=>{c("reconnecting"),y(new Date)};if(window.EnhancedWebSocketService){window.EnhancedWebSocketService.on("connected",W),window.EnhancedWebSocketService.on("authenticated",W),window.EnhancedWebSocketService.on("disconnected",N),window.EnhancedWebSocketService.on("reconnecting",g);const Y=window.EnhancedWebSocketService.getConnectionStatus();c(Y.isConnected?"connected":Y.state)}const M=Y=>{j.current&&!j.current.contains(Y.target)&&A(!1)};return document.addEventListener("mousedown",M),()=>{window.removeEventListener("online",se),window.removeEventListener("offline",G),document.removeEventListener("mousedown",M),window.EnhancedWebSocketService&&(window.EnhancedWebSocketService.off("connected",W),window.EnhancedWebSocketService.off("authenticated",W),window.EnhancedWebSocketService.off("disconnected",N),window.EnhancedWebSocketService.off("reconnecting",g))}},[o]);const f=o&&h==="connected",v=h==="reconnecting",F=h==="error"||!o;let U;return v?U={color:"bg-yellow-100 text-yellow-800 border-yellow-200",text:"Reconnecting",icon:"wifi",iconColor:"text-yellow-600",pulse:!0}:f?U={color:"bg-green-100 text-green-800 border-green-200",text:"Live",icon:"wifi",iconColor:"text-green-600",pulse:!1}:F?U={color:"bg-red-100 text-red-800 border-red-200",text:o?"Error":"Offline",icon:"wifiOff",iconColor:"text-red-600",pulse:!1}:U={color:"bg-blue-100 text-blue-800 border-blue-200",text:"Connecting",icon:"wifi",iconColor:"text-blue-600",pulse:!0},e.jsxs("div",{className:"relative",ref:j,children:[e.jsxs("button",{onClick:()=>A(!S),className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-xs border transition-all duration-200 hover:shadow-sm ${U.color}`,children:[e.jsx(La,{icon:U.icon,size:12,className:`${U.iconColor} ${U.pulse?"animate-pulse":""}`}),e.jsx("span",{className:"font-medium",children:U.text}),e.jsx("span",{className:"text-gray-500 hidden lg:inline text-xs",children:x.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.jsx(pi,{className:`w-3 h-3 transition-transform ${S?"rotate-180":""}`})]}),S&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-72 bg-white rounded-lg shadow-lg border border-gray-200 p-4 z-50",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Connection Status"}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${U.color}`,children:U.text})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-gray-500",children:"Network"}),e.jsx("div",{className:`font-medium ${o?"text-green-600":"text-red-600"}`,children:o?"Online":"Offline"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-gray-500",children:"WebSocket"}),e.jsx("div",{className:`font-medium ${h==="connected"?"text-green-600":h==="reconnecting"?"text-yellow-600":"text-red-600"}`,children:h.charAt(0).toUpperCase()+h.slice(1)})]})]}),e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",x.toLocaleString()]})})]})})]})},Fp=()=>{const{user:o,logout:i}=ca(),[h,c]=u.useState(!1),x=u.useRef(null);if(u.useEffect(()=>{const j=f=>{x.current&&!x.current.contains(f.target)&&c(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]),!o)return null;const y=o.username?o.username.slice(0,2).toUpperCase():"UN",A={admin:"bg-red-500",manager:"bg-blue-500",supervisor:"bg-green-500",operator:"bg-gray-500"}[o.role]||"bg-gray-500";return e.jsxs("div",{className:"relative",ref:x,children:[e.jsxs("button",{onClick:()=>c(!h),className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"User menu",children:[e.jsx("div",{className:`w-10 h-10 ${A} rounded-full flex items-center justify-center text-white shadow-sm ring-2 ring-white`,children:e.jsx("span",{className:"text-sm font-bold",children:y})}),e.jsxs("div",{className:"hidden md:block text-left",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:o.username}),e.jsxs("p",{className:"text-xs text-gray-500 capitalize flex items-center",children:[e.jsx("span",{className:`w-2 h-2 ${A} rounded-full mr-1.5`}),o.role]})]}),e.jsx(pi,{className:`w-4 h-4 text-gray-400 transition-transform duration-200 ${h?"rotate-180":""}`})]}),h&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-50",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-8 h-8 ${A} rounded-full flex items-center justify-center text-white`,children:e.jsx("span",{className:"text-xs font-bold",children:y})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:o.username}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:o.role})]})]})}),e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{className:"flex items-center w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-150",onClick:()=>c(!1),children:[e.jsx(Sh,{className:"w-4 h-4 mr-3 text-gray-400"}),"View Profile"]}),e.jsxs("button",{className:"flex items-center w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors duration-150",onClick:()=>c(!1),children:[e.jsx(Pt,{className:"w-4 h-4 mr-3 text-gray-400"}),"Settings"]}),e.jsx("div",{className:"border-t border-gray-100 my-1"}),e.jsxs("button",{onClick:()=>{i(),c(!1)},className:"flex items-center w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors duration-150",children:[e.jsx(yh,{className:"w-4 h-4 mr-3"}),"Sign Out"]})]})]})]})},Qp=({onMenuClick:o,notifications:i=[]})=>{const[h,c]=u.useState(!1),[x,y]=u.useState(!1),S=u.useRef(null),A=u.useRef(null);u.useEffect(()=>{const f=v=>{S.current&&!S.current.contains(v.target)&&c(!1),A.current&&!A.current.contains(v.target)&&y(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const j=i.filter(f=>!f.read).length;return e.jsxs("header",{className:"bg-white shadow-sm border-b border-gray-200 relative z-40",children:[e.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:o,className:"lg:hidden p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-lg min-h-[44px] min-w-[44px] flex items-center justify-center transition-colors duration-200","aria-label":"Open navigation menu",children:e.jsx(wh,{size:20})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(Wt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 hidden sm:block",children:"Production Management"}),e.jsx("h1",{className:"text-lg font-bold text-gray-900 sm:hidden",children:"PMS"})]})]})]}),e.jsx("div",{className:"hidden md:flex flex-1 max-w-md mx-8",ref:A,children:e.jsxs("div",{className:"relative w-full",children:[e.jsx(oa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search orders, machines, users...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",onFocus:()=>y(!0)}),x&&e.jsx("div",{className:"absolute top-full mt-2 w-full bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:e.jsx("div",{className:"px-4 py-2 text-xs text-gray-500",children:"Recent searches appear here"})})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Gp,{}),e.jsx("button",{className:"md:hidden p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200",onClick:()=>y(!x),children:e.jsx(oa,{size:18})}),e.jsxs("div",{className:"relative",ref:S,children:[e.jsxs("button",{onClick:()=>c(!h),className:"relative p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200","aria-label":"Notifications",children:[e.jsx(Vl,{size:18}),j>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:j>9?"9+":j})]}),h&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-lg border border-gray-200 z-50",children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),j>0&&e.jsxs("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:[j," new"]})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:i.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Vl,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No notifications yet"})]}):i.slice(0,10).map((f,v)=>e.jsx("div",{className:`p-4 border-b border-gray-50 hover:bg-gray-50 transition-colors ${f.read?"":"bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`flex-shrink-0 w-2 h-2 rounded-full mt-2 ${f.type==="error"?"bg-red-500":f.type==="warning"?"bg-yellow-500":f.type==="success"?"bg-green-500":"bg-blue-500"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:f.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:f.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:f.time})]})]})},v))}),i.length>0&&e.jsx("div",{className:"p-4 border-t border-gray-100",children:e.jsx("button",{className:"w-full text-center text-sm text-blue-600 hover:text-blue-800 font-medium",children:"View all notifications"})})]})]}),e.jsx(Fp,{})]})]})}),x&&e.jsx("div",{className:"md:hidden px-4 py-3 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"relative",children:[e.jsx(oa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",autoFocus:!0})]})})]})},Xp=({isOpen:o,onClose:i})=>{const{user:h}=ca(),[c,x]=u.useState(window.location.pathname),S=[{name:"Dashboard",href:"/",icon:"dashboard",priority:"critical",roles:["operator","supervisor","manager","admin"]},{name:"Production Monitor",href:"/production",icon:"activity",priority:"critical",roles:["operator","supervisor","manager","admin"]},{name:"Orders",href:"/orders",icon:"package",priority:"daily",roles:["operator","supervisor","manager","admin"]},{name:"Machines",href:"/machines",icon:"settings",priority:"daily",roles:["operator","supervisor","manager","admin"]},{name:"4D Digital Twin Factory",href:"/digital-twin",icon:"package",priority:"management",roles:["supervisor","manager","admin"]},{name:"Labor Layout",href:"/labour-layout",icon:"users",priority:"daily",roles:["supervisor","manager","admin"]},{name:"Labor Planner",href:"/labor-planner",icon:"calendar",priority:"daily",roles:["supervisor","manager","admin"]},{name:"Attendance Register",href:"/attendance-register",icon:"userCheck",priority:"daily",roles:["supervisor","manager","admin"]},{name:"Maturation Room",href:"/maturation-room",icon:"package",priority:"daily",roles:["operator","supervisor","manager","admin"]},{name:"Analytics",href:"/analytics",icon:"barChart3",priority:"management",roles:["manager","admin"]},{name:"Shift Reports",href:"/shift-reports",icon:"clock",priority:"management",roles:["supervisor","manager","admin"]},{name:"Settings",href:"/settings",icon:"settings",priority:"management",roles:["supervisor","manager","admin"]},{name:"Admin & Users",href:"/admin",icon:"shield",priority:"management",roles:["admin"]}].filter(U=>U.roles.includes(h?.role||"operator")),A=[{title:"Critical",items:S.filter(U=>U.priority==="critical")},{title:"Daily Operations",items:S.filter(U=>U.priority==="daily")},{title:"Management",items:S.filter(U=>U.priority==="management")}],j=(U,se)=>{U.preventDefault(),x(se),window.history.pushState({},"",se);const G=new PopStateEvent("popstate");window.dispatchEvent(G),i&&i()},f=h?.username?h.username.slice(0,2).toUpperCase():"UN",F={admin:"from-red-500 to-red-600",manager:"from-blue-500 to-blue-600",supervisor:"from-green-500 to-green-600",operator:"from-gray-500 to-gray-600"}[h?.role]||"from-gray-500 to-gray-600";return e.jsxs(e.Fragment,{children:[o&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-30 lg:hidden transition-all duration-300",onClick:i}),e.jsxs("div",{className:`fixed inset-y-0 left-0 z-40 w-72 bg-gradient-to-b from-gray-800 to-gray-900 text-white transform transition-all duration-300 lg:static lg:inset-0 ${o?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,children:[e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b border-gray-700/50 bg-gray-800/50",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-slate-700 rounded-xl flex items-center justify-center",children:e.jsx(Wt,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white font-bold text-lg",children:"PMS"}),e.jsx("div",{className:"text-xs text-gray-400",children:"v2.0.0"})]})]}),e.jsx("button",{onClick:i,className:"lg:hidden p-2 text-gray-300 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-white rounded-lg min-h-[44px] min-w-[44px] flex items-center justify-center transition-all duration-200","aria-label":"Close navigation menu",children:e.jsx(rs,{size:20})})]}),e.jsx("div",{className:"px-4 py-4 border-b border-gray-700/50 bg-gray-800/30",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${F} rounded-xl flex items-center justify-center ring-2 ring-white/20 shadow-lg`,children:e.jsx("span",{className:"text-sm font-bold text-white",children:f})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-white",children:h?.username}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`w-2 h-2 bg-gradient-to-r ${F} rounded-full`}),e.jsx("p",{className:"text-xs text-gray-300 capitalize",children:h?.role})]})]}),e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse",title:"Online"})]})}),e.jsx("nav",{className:"flex-1 px-3 py-4 overflow-y-auto",children:A.map(U=>U.items.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:U.title}),e.jsx("div",{className:"space-y-1",children:U.items.map(se=>{const G=c===se.href;return e.jsxs("a",{href:se.href,onClick:W=>j(W,se.href),className:`group flex items-center px-3 py-3 text-sm font-medium rounded-lg transition-all duration-200 min-h-[44px] touch-manipulation ${G?"bg-gradient-to-r from-blue-600 to-slate-700 text-white shadow-lg":"text-gray-300 hover:bg-gray-700 hover:text-white hover:shadow-md"}`,children:[e.jsx(La,{icon:se.icon,size:18,className:"mr-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:se.name}),G&&e.jsx("div",{className:"ml-auto w-2 h-2 bg-white rounded-full animate-pulse"})]},se.name)})})]},U.title))}),e.jsx("div",{className:"p-4 border-t border-gray-700/50 bg-gray-800/30",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[e.jsx("span",{children:" 2025 PMS"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{children:"System Online"})]})]})})]})]})};function Wp({children:o,loading:i=!1,error:h=null,notifications:c=[]}){const[x,y]=u.useState(!1),S=c.length>0?c:[{id:1,title:"Production Alert",message:"Machine LQ-001 requires maintenance",type:"warning",time:"5 minutes ago",read:!1},{id:2,title:"Order Completed",message:"Order #GEN014 has been completed successfully",type:"success",time:"1 hour ago",read:!0}];return u.useEffect(()=>{const A=j=>{j.key==="Escape"&&x&&y(!1)};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[x]),i?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(Wt,{className:"w-6 h-6 text-blue-600 animate-pulse"})})]}),e.jsx("h2",{className:"mt-4 text-lg font-semibold text-gray-900",children:"Loading Production System"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Please wait while we initialize the application..."})]})}):h?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 text-center",children:[e.jsxs("div",{children:[e.jsx(gt,{className:"mx-auto h-16 w-16 text-red-500"}),e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Something went wrong"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"We're sorry, but something unexpected happened."})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-red-800 font-mono",children:h?.message||"Unknown error occurred"})}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Reload Page"})]})}):e.jsxs("div",{className:"h-screen flex overflow-hidden bg-gradient-to-br from-gray-50 to-gray-100",children:[e.jsx(Xp,{isOpen:x,onClose:()=>y(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden relative",children:[e.jsx(Qp,{onMenuClick:()=>y(!0),notifications:S}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gradient-to-br from-gray-50 to-white",children:e.jsx("div",{className:"py-6 transition-all duration-300",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("nav",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(ph,{className:"w-4 h-4"}),e.jsx("span",{children:"/"}),e.jsx("span",{className:"text-gray-900 font-medium",children:window.location.pathname==="/"?"Dashboard":window.location.pathname.slice(1).split("-").map(A=>A.charAt(0).toUpperCase()+A.slice(1)).join(" ")})]})}),e.jsx("div",{className:"animate-in slide-in-from-bottom-4 duration-300",children:o})]})})}),e.jsx("footer",{className:"bg-white border-t border-gray-200 px-4 py-3",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{children:" 2025 Production Management System"}),e.jsx("span",{children:""}),e.jsx("span",{children:"Version 2.0.0"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["Last updated: ",new Date().toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(mi,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{children:"System Operational"})]})]})]})})]})]})}function Zp(){const[o,i]=u.useState({username:"",password:""}),[h,c]=u.useState(""),[x,y]=u.useState(!1),{login:S}=ca(),A=async f=>{f.preventDefault(),c(""),y(!0);try{await S(o.username,o.password)}catch(v){c(v.message||"Login failed. Please try again.")}finally{y(!1)}},j=f=>v=>{i(F=>({...F,[f]:v.target.value})),h&&c("")};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Production Management"}),e.jsx("p",{className:"text-gray-600",children:"Sign in to continue"})]}),e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[h&&e.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded",children:h}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),e.jsx("input",{type:"text",value:o.username,onChange:j("username"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,autoFocus:!0,disabled:x})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:o.password,onChange:j("password"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,disabled:x})]}),e.jsx("button",{type:"submit",disabled:x,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-200 disabled:opacity-50",children:x?"Signing in...":"Sign In"})]})]})})}const Kp=({notification:o,onClose:i})=>{const{type:h,title:c,message:x,timestamp:y}=o;u.useEffect(()=>{const j=setTimeout(()=>{i()},5e3);return()=>clearTimeout(j)},[i]);const S=()=>{switch(h){case"order_started":return"bg-blue-50 border-blue-200 text-blue-800";case"order_completed":return"bg-green-50 border-green-200 text-green-800";case"order_stopped":return"bg-red-50 border-red-200 text-red-800";case"order_resumed":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"machine_status_changed":return"bg-purple-50 border-purple-200 text-purple-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}},A=()=>{switch(h){case"order_started":return"activity";case"order_completed":return"check";case"order_stopped":return"x";case"order_resumed":return"activity";case"machine_status_changed":return"settings";default:return"info"}};return e.jsx("div",{className:`mb-3 p-4 rounded-lg border-l-4 shadow-md transition-all duration-300 ${S()}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(La,{icon:A(),size:20,className:"mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-sm",children:c}),e.jsx("p",{className:"text-sm mt-1 text-gray-600",children:x}),e.jsx("p",{className:"text-xs mt-2 text-gray-500",children:new Date(y).toLocaleTimeString()})]}),e.jsx("button",{onClick:i,className:"ml-3 flex-shrink-0 text-gray-400 hover:text-gray-600",children:e.jsx(La,{icon:"x",size:16})})]})})},lh=()=>{const[o,i]=u.useState([]),[h,c]=u.useState(!1),x=u.useRef({});u.useEffect(()=>{if(!window.WebSocketService){console.warn("WebSocket service not available");return}const j=()=>{c(!0),window.WebSocketService.subscribe(["orders","machines","notifications"])},f=()=>{c(!1)},v=G=>{const{type:W,data:N,timestamp:g}=G;let M,Y;switch(W){case"order_started":M="Production Started",Y=`Order ${N.order.order_number} started on ${N.order.machine_name} by ${N.operator}`;break;case"order_stopped":M="Production Stopped",Y=`Order ${N.order.order_number} stopped - ${N.reason}`;break;case"order_resumed":M="Production Resumed",Y=`Order ${N.order.order_number} resumed by ${N.resumed_by}`;break;case"order_completed":M="Order Completed",Y=`Order ${N.order.order_number} completed (${N.efficiency.toFixed(1)}% efficiency)`;break;default:M="Order Update",Y=`Order ${N.order?.order_number||"Unknown"} has been updated`}y({id:`${W}_${Date.now()}`,type:W,title:M,message:Y,timestamp:g,data:N})},F=G=>{const{type:W,data:N,timestamp:g}=G;W==="machine_status_changed"&&y({id:`machine_${N.machine_id}_${Date.now()}`,type:W,title:"Machine Status Changed",message:`Machine status updated to ${N.status}`,timestamp:g,data:N})},U=G=>{const{data:W,timestamp:N}=G;y({id:`notification_${Date.now()}`,type:"notification",title:W.title||"System Notification",message:W.message||"You have a new notification",timestamp:N,data:W})};return x.current={handleConnected:j,handleDisconnected:f,handleOrderUpdate:v,handleMachineUpdate:F,handleNotification:U},window.WebSocketService.on("connected",j),window.WebSocketService.on("authenticated",j),window.WebSocketService.on("disconnected",f),window.WebSocketService.on("order_update",v),window.WebSocketService.on("machine_update",F),window.WebSocketService.on("notification",U),window.WebSocketService.getStatus().isConnected&&j(),()=>{const G=x.current;window.WebSocketService.off("connected",G.handleConnected),window.WebSocketService.off("authenticated",G.handleConnected),window.WebSocketService.off("disconnected",G.handleDisconnected),window.WebSocketService.off("order_update",G.handleOrderUpdate),window.WebSocketService.off("machine_update",G.handleMachineUpdate),window.WebSocketService.off("notification",G.handleNotification)}},[]);const y=j=>{i(f=>[j,...f.slice(0,4)])},S=j=>{i(f=>f.filter(v=>v.id!==j))},A=()=>{i([])};return o.length===0?null:e.jsxs("div",{className:"fixed top-4 right-4 z-50 w-96 max-w-sm",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Live Updates"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${h?"bg-green-400":"bg-gray-400"}`}),e.jsx("button",{onClick:A,className:"text-xs text-gray-500 hover:text-gray-700",children:"Clear All"})]})]}),e.jsx("div",{className:"space-y-3 max-h-screen overflow-y-auto",children:o.map(j=>e.jsx(Kp,{notification:j,onClose:()=>S(j.id)},j.id))})]})},Jp=({maxItems:o=10})=>{const[i,h]=u.useState([]),[c,x]=u.useState(!1),y=u.useRef({});return u.useEffect(()=>{if(!window.WebSocketService)return;const S=()=>{x(!0)},A=()=>{x(!1)},j=v=>{const{type:F,data:U,timestamp:se}=v;let G={id:`${F}_${Date.now()}`,type:F,timestamp:se,icon:"activity",color:"text-blue-600",data:U};switch(F){case"order_started":G.message=`${U.operator} started production of ${U.order.order_number}`,G.icon="activity",G.color="text-blue-600";break;case"order_completed":G.message=`${U.completed_by} completed ${U.order.order_number} (${U.efficiency.toFixed(1)}% efficiency)`,G.icon="check",G.color="text-green-600";break;case"order_stopped":G.message=`${U.stopped_by} stopped ${U.order.order_number} - ${U.reason}`,G.icon="x",G.color="text-red-600";break;case"order_resumed":G.message=`${U.resumed_by} resumed ${U.order.order_number}`,G.icon="activity",G.color="text-yellow-600";break;case"machine_status_changed":G.message=`Machine status changed to ${U.status}`,G.icon="settings",G.color="text-purple-600";break;default:G.message="Unknown activity"}h(W=>[G,...W.slice(0,o-1)])};return y.current={handleConnected:S,handleDisconnected:A,handleActivity:j},window.WebSocketService.on("connected",S),window.WebSocketService.on("authenticated",S),window.WebSocketService.on("disconnected",A),window.WebSocketService.on("order_update",j),window.WebSocketService.on("machine_update",j),window.WebSocketService.getStatus().isConnected&&S(),()=>{const v=y.current;window.WebSocketService.off("connected",v.handleConnected),window.WebSocketService.off("authenticated",v.handleConnected),window.WebSocketService.off("disconnected",v.handleDisconnected),window.WebSocketService.off("order_update",v.handleActivity),window.WebSocketService.off("machine_update",v.handleActivity)}},[o]),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"}),e.jsx("div",{className:`w-2 h-2 rounded-full ${c?"bg-green-400":"bg-gray-400"}`,title:c?"Live updates active":"No live connection"})]}),i.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No recent activity"}):e.jsx("div",{className:"space-y-3",children:i.map(S=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(La,{icon:S.icon,size:16,className:`mt-0.5 ${S.color}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-900",children:S.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(S.timestamp).toLocaleTimeString()})]})]},S.id))})]})};class Yc extends u.Component{constructor(i){super(i),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(i){return{hasError:!0}}componentDidCatch(i,h){this.setState({error:i,errorInfo:h}),console.error("Error caught by ErrorBoundary:",i,h)}getErrorMessage=i=>{const h={NETWORK_ERROR:{title:"Connection Problem",message:"Check your network connection and try again.",actions:["retry","work_offline"],severity:"warning"},MACHINE_OFFLINE:{title:"Machine Communication Lost",message:"Unable to communicate with selected machine.",actions:["check_machine","contact_maintenance"],severity:"critical"},DATA_SYNC_FAILED:{title:"Data Sync Failed",message:"Your changes may not be saved. Try again.",actions:["retry","save_locally"],severity:"warning"},SESSION_EXPIRED:{title:"Session Expired",message:"Please log in again to continue.",actions:["login"],severity:"warning"}},c=i?.code||(i?.message?.includes("fetch")?"NETWORK_ERROR":i?.message?.includes("session")?"SESSION_EXPIRED":"UNKNOWN");return h[c]||{title:"System Error",message:"An unexpected error occurred. Please try refreshing the page.",actions:["retry","contact_support"],severity:"critical"}};handleErrorAction=i=>{switch(i){case"retry":this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload();break;case"work_offline":this.setState({hasError:!1,error:null,errorInfo:null});break;case"check_machine":window.history.pushState({},"","/machines"),this.setState({hasError:!1,error:null,errorInfo:null});break;case"contact_maintenance":alert("Please contact maintenance team at ext. 1234");break;case"save_locally":console.log("Attempting to save data locally...");break;case"contact_support":alert("Please contact IT support at ext. 5678");break;case"login":localStorage.removeItem("token"),window.location.reload();break;default:console.log("Unknown action:",i)}};render(){if(this.state.hasError){const i=this.getErrorMessage(this.state.error);return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"max-w-md w-full space-y-8",children:e.jsx("div",{className:`p-6 rounded-lg border-l-4 ${i.severity==="critical"?"bg-red-50 border-red-500":"bg-yellow-50 border-yellow-500"}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(La,{icon:"x",size:24,className:`mr-3 mt-1 ${i.severity==="critical"?"text-red-600":"text-yellow-600"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-bold text-lg ${i.severity==="critical"?"text-red-800":"text-yellow-800"}`,children:i.title}),e.jsx("p",{className:`mt-2 ${i.severity==="critical"?"text-red-700":"text-yellow-700"}`,children:i.message}),e.jsx("div",{className:"mt-6 flex flex-col gap-3 sm:flex-row",children:i.actions.map(h=>e.jsx("button",{className:`flex-1 px-4 py-3 rounded text-sm font-medium min-h-[44px] touch-manipulation ${i.severity==="critical"?"bg-red-600 text-white hover:bg-red-700":"bg-yellow-600 text-white hover:bg-yellow-700"}`,onClick:()=>this.handleErrorAction(h),children:h.replace("_"," ").toUpperCase()},h))}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-sm text-gray-600 hover:text-gray-800",children:"Technical Details"}),e.jsxs("div",{className:"mt-2 p-3 bg-gray-100 rounded text-xs font-mono text-gray-700 overflow-auto max-h-32",children:[this.state.error&&this.state.error.toString(),e.jsx("br",{}),this.state.errorInfo?.componentStack||"No component stack available"]})]})]})]})})})})}return this.props.children}}const nh=({onSessionExpiring:o,onSessionExpired:i})=>{const[h,c]=u.useState(null),[x,y]=u.useState(!1),[S,A]=u.useState(!1),j=u.useCallback(async()=>{try{const F=await fe.get("/auth/session-status"),U=F.timeRemaining||F.data?.timeRemaining;U!==void 0&&(c(U),U<3e5&&U>0?(y(!0),o?.(U)):U<=0?(y(!1),i?.()):y(!1))}catch(F){console.error("Session check failed:",F),F.response?.status===401&&i?.()}},[o,i]),f=async()=>{A(!0);try{await fe.post("/auth/extend-session"),y(!1),c(null),console.log("Session extended successfully")}catch(F){console.error("Failed to extend session:",F),F.response?.status===401&&i?.()}finally{A(!1)}};if(u.useEffect(()=>{const F=setInterval(j,6e4);return j(),()=>clearInterval(F)},[j]),!x)return null;const v=Math.ceil(h/6e4);return e.jsx("div",{className:"fixed top-4 right-4 bg-yellow-50 border border-yellow-200 rounded-lg p-4 shadow-lg z-50 max-w-sm w-full",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(La,{icon:"clock",size:20,className:"text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-yellow-800",children:"Session Expiring"}),e.jsxs("p",{className:"text-sm text-yellow-700 mt-1",children:["Your session will expire in ",v," minute",v!==1?"s":"","."]}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("button",{onClick:f,disabled:S,className:"flex-1 bg-yellow-600 text-white px-3 py-2 rounded text-sm font-medium hover:bg-yellow-700 disabled:opacity-50 disabled:cursor-not-allowed min-h-[44px] touch-manipulation flex items-center justify-center",children:S?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Extending..."]}):"Extend Session"}),e.jsx("button",{onClick:()=>y(!1),className:"px-3 py-2 text-yellow-700 hover:text-yellow-800 text-sm font-medium min-h-[44px] min-w-[44px] flex items-center justify-center",children:e.jsx(La,{icon:"x",size:16})})]})]})]})})},eb=()=>{const[o,i]=u.useState("active"),h=u.useCallback(x=>{i("expiring"),console.log(`Session expiring in ${Math.ceil(x/6e4)} minutes`)},[]),c=u.useCallback(()=>{i("expired"),console.log("Session expired, redirecting to login..."),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),window.location.href="/login"},[]);return{sessionStatus:o,handleSessionExpiring:h,handleSessionExpired:c}};function ed(){const[o,i]=u.useState("disconnected"),[h,c]=u.useState(!1),[x,y]=u.useState(!1),[S,A]=u.useState({});u.useEffect(()=>{(()=>{const Z=zt.getConnectionStatus();i(Z.state),c(Z.isConnected),y(Z.isAuthenticated),A(zt.getMetrics())})();const W=setInterval(()=>{A(zt.getMetrics())},3e4),N=Z=>{i(Z.state)},g=()=>{c(!0),i("connected")},M=()=>{c(!1),y(!1),i("disconnected")},Y=()=>{y(!0)};return zt.on("connectionStateChanged",N),zt.on("connected",g),zt.on("disconnected",M),zt.on("authenticated",Y),()=>{clearInterval(W),zt.off("connectionStateChanged",N),zt.off("connected",g),zt.off("disconnected",M),zt.off("authenticated",Y)}},[]);const j=u.useCallback(async(G=null)=>{try{await zt.connect(G)}catch(W){console.error("Connection failed:",W)}},[]),f=u.useCallback(()=>{zt.disconnect()},[]),v=u.useCallback((G,W,N="normal")=>zt.send(G,W,N),[]),F=u.useCallback((G,W=null)=>{zt.subscribe(G,W)},[]),U=u.useCallback(G=>{zt.joinRoom(G)},[]),se=u.useCallback(G=>{zt.leaveRoom(G)},[]);return{connectionStatus:o,isConnected:h,isAuthenticated:x,metrics:S,connect:j,disconnect:f,send:v,subscribe:F,joinRoom:U,leaveRoom:se}}function _t(o,i,h=[]){const c=u.useRef(i);u.useEffect(()=>{c.current=i},h),u.useEffect(()=>{const x=y=>{c.current(y)};return zt.on(o,x),()=>{zt.off(o,x)}},[o])}function td(){const[o,i]=u.useState([]),[h,c]=u.useState(null);return _t("order_update",x=>{c({type:x.type,order:x.data.order,timestamp:x.timestamp}),i(y=>{const S=x.data.order?.id;if(!S)return y;const A=y.filter(j=>j.id!==S);return(x.type!=="order_completed"||!x.data.order.archived)&&A.push(x.data.order),A.sort((j,f)=>new Date(f.created_at)-new Date(j.created_at))})},[]),{orders:o,lastUpdate:h,setOrders:i}}function sd(){const[o,i]=u.useState([]),[h,c]=u.useState(null);return _t("machine_update",x=>{c({type:x.type,machine:x.data,timestamp:x.timestamp}),i(y=>{const S=x.data.machine_id;return S?y.map(A=>A.id===S?{...A,status:x.data.status,order_id:x.data.order_id}:A):y})},[]),{machines:o,lastUpdate:h,setMachines:i}}function Wn(){const[o,i]=u.useState([]);_t("notification",x=>{const y={id:Date.now(),message:x.data.message||x.data,type:x.data.type||"info",timestamp:x.timestamp,priority:x.priority||"normal"};i(S=>[y,...S.slice(0,49)])},[]),_t("alert",x=>{const y={id:Date.now(),message:x.data.message||x.data,type:"alert",timestamp:x.timestamp,priority:x.priority||"high"};i(S=>[y,...S.slice(0,49)])},[]);const h=u.useCallback(x=>{i(y=>y.filter(S=>S.id!==x))},[]),c=u.useCallback(()=>{i([])},[]);return{notifications:o,clearNotification:h,clearAllNotifications:c,hasUnread:o.some(x=>!x.read)}}function yi(){const{connectionStatus:o,isConnected:i,isAuthenticated:h,metrics:c}=ed(),[x,y]=u.useState(!1);_t("connectionStateChanged",f=>{y(f.state==="reconnecting")},[]);const S=()=>{switch(o){case"connected":return h?"green":"yellow";case"connecting":return"blue";case"reconnecting":return"orange";case"error":return"red";default:return"gray"}},A=()=>{switch(o){case"connected":return h?"Connected":"Authenticating";case"connecting":return"Connecting...";case"reconnecting":return"Reconnecting...";case"error":return"Connection Error";default:return"Disconnected"}},j=()=>{switch(o){case"connected":return h?"":"";case"connecting":return"";case"reconnecting":return"";case"error":return"";default:return""}};return{status:o,isConnected:i,isAuthenticated:h,showReconnecting:x,color:S(),text:A(),icon:j(),metrics:c}}function sl(){const{connect:o,isConnected:i,isAuthenticated:h,subscribe:c}=ed();u.useEffect(()=>{const x=async()=>{try{const S=localStorage.getItem("token");if(!S){console.log(" No token found, skipping WebSocket connection");return}const A=await fetch("/api/auth/verify-session",{method:"GET",headers:{Authorization:`Bearer ${S}`,"Content-Type":"application/json"},credentials:"include"});A.ok&&!i?(console.log(" User authenticated, connecting WebSocket..."),await o()):A.status===401&&(console.log(" Token expired or invalid, removing from localStorage"),localStorage.removeItem("token"))}catch{console.log(" Not authenticated, skipping WebSocket connection"),localStorage.getItem("token")&&(console.log(" Removing potentially invalid token"),localStorage.removeItem("token"))}};localStorage.getItem("token")&&x()},[o,i]),u.useEffect(()=>{if(i&&h){const y=setTimeout(async()=>{try{const S=localStorage.getItem("token");if(!S)return;const j=S.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),f=decodeURIComponent(atob(j).split("").map(function(se){return"%"+("00"+se.charCodeAt(0).toString(16)).slice(-2)}).join("")),v=JSON.parse(f);let U=[...["general","notifications"]];switch(v.role){case"admin":U.push("admin","production","machines","alerts","analytics");break;case"supervisor":U.push("production","machines","alerts","analytics");break;case"operator":U.push("production","machines");break;default:break}console.log(` Auto-subscribing to channels for ${v.role}:`,U),c(U),["admin","supervisor","operator"].includes(v.role)&&zt.joinRoom("production")}catch(S){console.error("Failed to auto-subscribe to channels:",S)}},100);return()=>clearTimeout(y)}},[i,h,c])}function rh(){const[o,i]=u.useState(!1),[h,c]=u.useState({}),x=yi(),{connect:y,disconnect:S,send:A}=ed();return u.useEffect(()=>{const f=()=>{const F={timestamp:new Date().toISOString(),location:window.location.href,userAgent:navigator.userAgent.substring(0,100)+"...",webSocketSupport:typeof WebSocket<"u",enhancedServiceExists:typeof window.EnhancedWebSocketService<"u",enhancedServiceStatus:window.EnhancedWebSocketService?window.EnhancedWebSocketService.getConnectionStatus():null,cookies:document.cookie?"Present":"None",protocols:window.location.protocol};c(F)};f();const v=setInterval(f,2e3);return()=>clearInterval(v)},[]),o||window.location.hostname==="localhost"||window.location.search.includes("debug=websocket")||window.localStorage.getItem("websocket-debug")==="true"?e.jsxs("div",{className:"fixed bottom-4 right-4 z-50 bg-white border border-gray-300 rounded-lg shadow-lg p-4 max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"font-bold text-sm",children:"WebSocket Debug"}),e.jsx("button",{onClick:()=>i(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Status:"}),e.jsx("span",{className:`px-2 py-1 rounded text-white ${x.isConnected?"bg-green-500":"bg-red-500"}`,children:x.text})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"WebSocket Support:"})," ",h.webSocketSupport?"":""]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Enhanced Service:"})," ",h.enhancedServiceExists?"":""]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Protocol:"})," ",h.protocols]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Cookies:"})," ",h.cookies]})]}),h.enhancedServiceStatus&&e.jsxs("div",{className:"border-t pt-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Connection ID:"})," ",h.enhancedServiceStatus.connectionId||"None"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Subscriptions:"})," ",h.enhancedServiceStatus.subscriptions?.length||0]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Rooms:"})," ",h.enhancedServiceStatus.rooms?.length||0]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Queued Messages:"})," ",h.enhancedServiceStatus.queuedMessages||0]})]}),e.jsxs("div",{className:"border-t pt-2 flex gap-2",children:[e.jsx("button",{onClick:()=>y(),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs",disabled:x.isConnected,children:"Connect"}),e.jsx("button",{onClick:()=>S(),className:"px-2 py-1 bg-red-500 text-white rounded text-xs",disabled:!x.isConnected,children:"Disconnect"}),e.jsx("button",{onClick:()=>A("ping"),className:"px-2 py-1 bg-green-500 text-white rounded text-xs",disabled:!x.isConnected,children:"Ping"})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsx("button",{onClick:()=>{console.log(" WebSocket Debug Info:",h),console.log(" Enhanced Service:",window.EnhancedWebSocketService),console.log(" Connection Status:",x)},className:"px-2 py-1 bg-gray-500 text-white rounded text-xs w-full",children:"Log Debug Info"})})]})]}):e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsx("button",{onClick:()=>i(!0),className:"bg-gray-800 text-white px-3 py-1 rounded-full text-xs opacity-50 hover:opacity-100",title:"Show WebSocket Debug",children:"WS"})})}function ih(){const[o,i]=u.useState([]);Wn(),u.useEffect(()=>{const S=setTimeout(()=>{i(A=>A.slice(0,-1))},5e3);return()=>clearTimeout(S)},[o.length]),_t("user_joined",S=>{h(`${S.data.username} joined the system`,"info")},[]),_t("user_left",S=>{h(`${S.data.username} left the system`,"info")},[]),_t("system_alert",S=>{h(S.data.message,"error")},[]),_t("system_maintenance",S=>{h(`System maintenance: ${S.data.message}`,"warning")},[]);const h=(S,A="info")=>{const j={id:Date.now(),message:S,type:A,timestamp:new Date};i(f=>[j,...f.slice(0,4)])},c=S=>{i(A=>A.filter(j=>j.id!==S))},x=S=>{switch(S){case"success":return e.jsx(Nt,{className:"w-5 h-5 text-green-500"});case"warning":return e.jsx(gt,{className:"w-5 h-5 text-yellow-500"});case"error":return e.jsx(gt,{className:"w-5 h-5 text-red-500"});default:return e.jsx(bh,{className:"w-5 h-5 text-blue-500"})}},y=S=>{switch(S){case"success":return"bg-green-50 border-green-200 text-green-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"error":return"bg-red-50 border-red-200 text-red-800";default:return"bg-blue-50 border-blue-200 text-blue-800"}};return o.length===0?null:e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:o.map(S=>e.jsxs("div",{className:`flex items-center gap-3 p-4 border rounded-lg shadow-lg max-w-sm animate-slide-in ${y(S.type)}`,children:[x(S.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:S.message}),e.jsx("p",{className:"text-xs opacity-75 mt-1",children:S.timestamp.toLocaleTimeString()})]}),e.jsx("button",{onClick:()=>c(S.id),className:"flex-shrink-0 text-gray-400 hover:text-gray-600",children:e.jsx(rs,{className:"w-4 h-4"})})]},S.id))})}var tb=dh();const sb=Gc(tb),Mt=({children:o,onClose:i,title:h,size:c="medium",className:x="",showCloseButton:y=!0,closeOnBackdrop:S=!0,closeOnEscape:A=!0,footer:j,...f})=>{const[v,F]=u.useState(!1),[U,se]=u.useState(!1);u.useEffect(()=>{F(!0),se(!0),document.body.style.overflow="hidden";const le=document.activeElement;return()=>{document.body.style.overflow="unset",le&&typeof le.focus=="function"&&le.focus()}},[]),u.useEffect(()=>{if(!A)return;const le=ke=>{ke.key==="Escape"&&G()};return document.addEventListener("keydown",le),()=>document.removeEventListener("keydown",le)},[A,i]);const G=()=>{i&&(F(!1),setTimeout(()=>{i()},200))},W=le=>{S&&le.target===le.currentTarget&&G()},M=`bg-white rounded-xl shadow-2xl transform transition-all duration-200 flex flex-col relative ${{sm:"max-w-sm w-full mx-4 max-h-[85vh]",medium:"max-w-2xl w-full mx-4 max-h-[90vh]",large:"max-w-6xl w-full mx-4 max-h-[95vh]",xl:"max-w-7xl w-full mx-4 max-h-[95vh]",fullscreen:"max-w-[98vw] w-[98vw] h-[95vh]"}[c]} ${x}`,Y=`fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 transition-all duration-200 p-4 ${v?"opacity-100":"opacity-0"}`,Z=`${M} ${v?"scale-100 opacity-100":"scale-95 opacity-0"}`;return sb.createPortal(e.jsx("div",{className:Y,onClick:W,role:"dialog","aria-modal":"true","aria-labelledby":h?"modal-title":void 0,...f,children:e.jsxs("div",{className:Z,children:[(h||y)&&e.jsxs("div",{className:"flex-shrink-0 px-6 pt-6 pb-4 border-b border-gray-200 flex items-center justify-between",children:[h&&e.jsx("h2",{id:"modal-title",className:"text-xl font-bold text-gray-900",children:h}),y&&e.jsx("button",{onClick:G,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close modal",children:e.jsx(rs,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:o}),j&&e.jsx("div",{className:"flex-shrink-0 px-6 py-4 border-t border-gray-200 bg-gray-50 rounded-b-xl",children:j})]})}),document.getElementById("portal-root")||document.body)},tt=({children:o,className:i="",variant:h="default",padding:c="default",hover:x=!1,clickable:y=!1,loading:S=!1,...A})=>{const j={default:"bg-white border border-gray-200 shadow-sm",elevated:"bg-white border border-gray-200 shadow-lg",outlined:"bg-white border-2 border-gray-300 shadow-none",ghost:"bg-transparent border border-transparent shadow-none",gradient:"bg-gradient-to-br from-white to-gray-50 border border-gray-200 shadow-md"},f={none:"p-0",sm:"p-3",default:"p-6",lg:"p-8",xl:"p-10"},v="rounded-xl transition-all duration-200",F=x?"hover:shadow-md hover:-translate-y-0.5":"",U=y?"cursor-pointer hover:shadow-lg transform hover:scale-[1.02]":"",se=`${v} ${j[h]} ${f[c]} ${F} ${U} ${i}`;return S?e.jsx("div",{className:se,...A,children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"})]})]})}):e.jsx("div",{className:se,...A,children:o})},Oe=u.forwardRef(({children:o,variant:i="primary",size:h="md",className:c="",disabled:x=!1,loading:y=!1,leftIcon:S,rightIcon:A,fullWidth:j=!1,...f},v)=>{const F="inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed active:scale-[0.98] transform",U={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 shadow-sm hover:shadow-md",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500 shadow-sm hover:shadow-md",outline:"border-2 border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500 hover:border-gray-400",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500 shadow-sm hover:shadow-md",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 shadow-sm hover:shadow-md",warning:"bg-yellow-600 text-white hover:bg-yellow-700 focus:ring-yellow-500 shadow-sm hover:shadow-md",info:"bg-cyan-600 text-white hover:bg-cyan-700 focus:ring-cyan-500 shadow-sm hover:shadow-md",gradient:"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 focus:ring-blue-500 shadow-md hover:shadow-lg"},se={xs:"px-2 py-1 text-xs",sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base",xl:"px-8 py-4 text-lg"},G=j?"w-full":"",W=x||y;return e.jsxs("button",{ref:v,className:`${F} ${U[i]} ${se[h]} ${G} ${c}`,disabled:W,...f,children:[y&&e.jsx(Fg,{className:"w-4 h-4 mr-2 animate-spin"}),!y&&S&&e.jsx("span",{className:"mr-2",children:S}),o,!y&&A&&e.jsx("span",{className:"ml-2",children:A})]})});Oe.displayName="Button";const at=({children:o,variant:i="default",size:h="md",className:c="",icon:x,pulse:y=!1,removable:S=!1,onRemove:A,...j})=>{const f="inline-flex items-center font-medium rounded-full transition-all duration-200",v={default:"bg-gray-100 text-gray-800 border border-gray-200",primary:"bg-blue-100 text-blue-800 border border-blue-200",secondary:"bg-gray-100 text-gray-700 border border-gray-300",success:"bg-green-100 text-green-800 border border-green-200",danger:"bg-red-100 text-red-800 border border-red-200",warning:"bg-yellow-100 text-yellow-800 border border-yellow-200",info:"bg-cyan-100 text-cyan-800 border border-cyan-200",steel:"bg-slate-100 text-slate-800 border border-slate-200",bronze:"bg-amber-100 text-amber-800 border border-amber-200",indigo:"bg-indigo-100 text-indigo-800 border border-indigo-200",solidPrimary:"bg-blue-600 text-white",solidSuccess:"bg-green-600 text-white",solidDanger:"bg-red-600 text-white",solidWarning:"bg-yellow-600 text-white",outlinePrimary:"border-2 border-blue-600 text-blue-600 bg-white",outlineSuccess:"border-2 border-green-600 text-green-600 bg-white",outlineDanger:"border-2 border-red-600 text-red-600 bg-white"},F={xs:"px-1.5 py-0.5 text-xs",sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-0.5 text-xs",lg:"px-3 py-1 text-sm",xl:"px-4 py-1.5 text-sm"},U=y?"animate-pulse":"";return e.jsxs("span",{className:`${f} ${v[i]} ${F[h]} ${U} ${c}`,...j,children:[x&&e.jsx("span",{className:"mr-1",children:x}),o,S&&A&&e.jsx("button",{onClick:se=>{se.stopPropagation(),A()},className:"ml-1 hover:bg-black/10 rounded-full p-0.5 transition-colors","aria-label":"Remove badge",children:e.jsx(rs,{size:12})})]})},ab=u.forwardRef(({className:o="",type:i="text",error:h,label:c,placeholder:x,leftIcon:y,rightIcon:S,disabled:A=!1,required:j=!1,helperText:f,size:v="md",...F},U)=>{const[se,G]=u.useState(!1),W={sm:"px-3 py-2 text-sm",md:"px-4 py-3 text-sm",lg:"px-4 py-4 text-base"},N="block w-full rounded-lg border transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-1",g="border-gray-300 focus:border-blue-500 focus:ring-blue-500",M="border-red-300 focus:border-red-500 focus:ring-red-500",Y="bg-gray-50 text-gray-500 cursor-not-allowed",Z=h?M:g,le=`${N} ${W[v]} ${Z} ${A?Y:""} ${y?"pl-10":""} ${S||i==="password"?"pr-10":""} ${o}`,ke=i==="password"&&se?"text":i;return e.jsxs("div",{className:"space-y-2",children:[c&&e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[c,j&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[y&&e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-400",children:y})}),e.jsx("input",{ref:U,type:ke,className:le,placeholder:x,disabled:A,required:j,...F}),i==="password"&&e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>G(!se),children:se?e.jsx(gh,{className:"h-4 w-4 text-gray-400"}):e.jsx(Ps,{className:"h-4 w-4 text-gray-400"})}),S&&i!=="password"&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-400",children:S})})]}),h&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[e.jsx(gt,{className:"w-4 h-4 mr-1"}),h]}),f&&!h&&e.jsx("p",{className:"text-sm text-gray-500",children:f})]})});ab.displayName="Input";const lb=u.forwardRef(({className:o="",options:i=[],placeholder:h="Select an option",error:c,label:x,required:y=!1,disabled:S=!1,size:A="md",...j},f)=>{const v={sm:"px-3 py-2 text-sm",md:"px-4 py-3 text-sm",lg:"px-4 py-4 text-base"},F="block w-full rounded-lg border transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-1 appearance-none bg-white",U="border-gray-300 focus:border-blue-500 focus:ring-blue-500",se="border-red-300 focus:border-red-500 focus:ring-red-500",G="bg-gray-50 text-gray-500 cursor-not-allowed",W=c?se:U,N=`${F} ${v[A]} ${W} ${S?G:""} pr-10 ${o}`;return e.jsxs("div",{className:"space-y-2",children:[x&&e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[x,y&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{ref:f,className:N,disabled:S,required:y,...j,children:[h&&e.jsx("option",{value:"",children:h}),i.map((g,M)=>e.jsx("option",{value:g.value,disabled:g.disabled,children:g.label},g.value||M))]}),e.jsx(pi,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]}),c&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[e.jsx(gt,{className:"w-4 h-4 mr-1"}),c]})]})});lb.displayName="Select";function nb(){const[o,i]=u.useState(!1),{status:h,isConnected:c,isAuthenticated:x,showReconnecting:y,color:S,text:A,icon:j,metrics:f}=yi(),v=()=>{switch(S){case"green":return"bg-green-500";case"yellow":return"bg-yellow-500";case"blue":return"bg-blue-500";case"orange":return"bg-orange-500";case"red":return"bg-red-500";default:return"bg-gray-500"}},F=()=>{switch(S){case"green":return"text-green-700";case"yellow":return"text-yellow-700";case"blue":return"text-blue-700";case"orange":return"text-orange-700";case"red":return"text-red-700";default:return"text-gray-700"}},U=se=>{if(!se)return"0s";const G=Math.floor(se/1e3),W=Math.floor(G/60),N=Math.floor(W/60);return N>0?`${N}h ${W%60}m`:W>0?`${W}m ${G%60}s`:`${G}s`};return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 px-3 py-2 rounded-md transition-colors",onClick:()=>i(!o),title:"WebSocket Connection Status",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${v()}`,children:y&&e.jsx("div",{className:`absolute inset-0 rounded-full ${v()} opacity-75 animate-ping`})})}),e.jsx("span",{className:`text-sm font-medium ${F()}`,children:A}),f.messagesReceived>0&&e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:f.messagesReceived}),e.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),o&&e.jsx("div",{className:"absolute top-full right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"WebSocket Status"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-2xl",children:j}),e.jsx("span",{className:`font-medium ${F()}`,children:A})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:`ml-2 font-medium ${F()}`,children:h})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Authenticated:"}),e.jsx("span",{className:`ml-2 font-medium ${x?"text-green-600":"text-red-600"}`,children:x?"Yes":"No"})]})]}),c&&f&&e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Connection Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{children:"Messages Received:"}),e.jsx("span",{className:"ml-1 font-medium text-gray-900",children:f.messagesReceived||0})]}),e.jsxs("div",{children:[e.jsx("span",{children:"Messages Sent:"}),e.jsx("span",{className:"ml-1 font-medium text-gray-900",children:f.messagesSent||0})]}),e.jsxs("div",{children:[e.jsx("span",{children:"Reconnections:"}),e.jsx("span",{className:"ml-1 font-medium text-gray-900",children:f.reconnections||0})]}),e.jsxs("div",{children:[e.jsx("span",{children:"Uptime:"}),e.jsx("span",{className:"ml-1 font-medium text-gray-900",children:U(f.uptime)})]}),f.lastPing&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{children:"Last Ping:"}),e.jsx("span",{className:"ml-1 font-medium text-gray-900",children:new Date(f.lastPing).toLocaleTimeString()})]})]})]}),e.jsxs("div",{className:"border-t pt-3 flex space-x-2",children:[e.jsx("button",{onClick:()=>{c?window.EnhancedWebSocketService?.disconnect():window.EnhancedWebSocketService?.connect()},className:`px-3 py-1 text-xs font-medium rounded-md ${c?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:c?"Disconnect":"Connect"}),h==="error"&&e.jsx("button",{onClick:()=>window.EnhancedWebSocketService?.connect(),className:"px-3 py-1 text-xs font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 rounded-md",children:"Retry"}),e.jsx("button",{onClick:()=>{const se=window.EnhancedWebSocketService?.getMetrics();console.log("WebSocket Metrics:",se),console.log("WebSocket Status:",window.EnhancedWebSocketService?.getConnectionStatus())},className:"px-3 py-1 text-xs font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 rounded-md",children:"Debug"})]})]})]})})]})}function vi(){const{icon:o,text:i,color:h}=yi(),c=()=>{switch(h){case"green":return"text-green-600";case"yellow":return"text-yellow-600";case"blue":return"text-blue-600";case"orange":return"text-orange-600";case"red":return"text-red-600";default:return"text-gray-600"}};return e.jsxs("div",{className:"flex items-center space-x-1",title:`WebSocket: ${i}`,children:[e.jsx("span",{className:"text-sm",children:o}),e.jsx("span",{className:`text-xs font-medium ${c()}`,children:"WS"})]})}const rb=({value:o,duration:i=2e3,prefix:h="",suffix:c="",className:x=""})=>{const[y,S]=u.useState(0),A=u.useRef(null),j=u.useRef(null);return u.useEffect(()=>{const f=v=>{A.current||(A.current=v);const F=Math.min((v-A.current)/i,1),U=1-Math.pow(1-F,3);S(Math.floor(U*o)),F<1&&(j.current=requestAnimationFrame(f))};return o>0?(A.current=null,j.current=requestAnimationFrame(f)):S(0),()=>{j.current&&cancelAnimationFrame(j.current)}},[o,i]),e.jsxs("span",{className:x,children:[h,y.toLocaleString(),c]})},ii=({title:o,value:i,change:h,icon:c,color:x="blue",target:y,trend:S,sparklineData:A=[]})=>{const[j,f]=u.useState(!1),[v,F]=u.useState(!1),U=u.useRef(null);u.useEffect(()=>{const W=new IntersectionObserver(([N])=>F(N.isIntersecting),{threshold:.1});return U.current&&W.observe(U.current),()=>W.disconnect()},[]);const G={blue:{bg:"from-blue-500 to-cyan-500",shadow:"shadow-blue-200",glow:"bg-blue-100",text:"text-blue-700",accent:"border-blue-300"},green:{bg:"from-green-500 to-emerald-500",shadow:"shadow-green-200",glow:"bg-green-100",text:"text-green-700",accent:"border-green-300"},steel:{bg:"from-slate-600 to-gray-700",shadow:"shadow-slate-200",glow:"bg-slate-100",text:"text-slate-700",accent:"border-slate-300"},orange:{bg:"from-orange-500 to-red-500",shadow:"shadow-orange-200",glow:"bg-orange-100",text:"text-orange-700",accent:"border-orange-300"},red:{bg:"from-red-600 to-red-700",shadow:"shadow-red-300",glow:"bg-red-100",text:"text-red-700",accent:"border-red-300"}}[x];return e.jsxs("div",{ref:U,className:`group relative overflow-hidden rounded-2xl border ${G.accent} bg-white ${G.shadow} transition-all duration-700 hover:scale-105 hover:shadow-2xl ${v?"opacity-100 translate-y-0":"opacity-0 translate-y-8"}`,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),style:{transitionDelay:v?`${Math.random()*300}ms`:"0ms"},children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${G.bg} opacity-5 group-hover:opacity-10 transition-opacity duration-500`}),e.jsx("div",{className:`absolute inset-0 rounded-2xl ${G.glow} opacity-0 group-hover:opacity-20 blur-xl transition-all duration-500 scale-110`}),j&&e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(6)].map((W,N)=>e.jsx("div",{className:`absolute w-1 h-1 ${G.glow} rounded-full animate-bounce`,style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${N*200}ms`,animationDuration:"2s"}},N))}),e.jsxs("div",{className:"relative p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${G.bg} shadow-lg transform transition-transform duration-300 group-hover:scale-110 group-hover:rotate-6`,children:e.jsx(c,{className:"w-6 h-6 text-white"})}),S&&e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${S>0?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[S>0?e.jsx(xh,{className:"w-3 h-3"}):e.jsx($c,{className:"w-3 h-3"}),Math.abs(S),"%"]})]}),e.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-2 group-hover:text-gray-800 transition-colors",children:o||"Loading..."}),e.jsx("div",{className:"mb-3",children:e.jsx("div",{className:`text-3xl font-bold ${G.text} group-hover:text-4xl transition-all duration-300`,children:i!=null?e.jsxs(e.Fragment,{children:[e.jsx(rb,{value:parseInt(i)||0}),typeof i=="string"&&i.includes("%")&&"%"]}):e.jsx("span",{className:"text-gray-400",children:"--"})})}),y&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(parseInt(i)/y*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-2 bg-gradient-to-r ${G.bg} rounded-full transition-all duration-1000 ease-out transform origin-left`,style:{width:`${Math.min(parseInt(i)/y*100,100)}%`,transitionDelay:v?"500ms":"0ms"}})})]}),A.length>0&&e.jsx("div",{className:"h-8 flex items-end gap-0.5 opacity-70 group-hover:opacity-100 transition-opacity",children:A.slice(-12).map((W,N)=>e.jsx("div",{className:`w-1 bg-gradient-to-t ${G.bg} rounded-t opacity-60 transition-all duration-300 hover:opacity-100`,style:{height:`${W/Math.max(...A)*100}%`,animationDelay:`${N*50}ms`}},N))}),h!==void 0&&e.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:`flex items-center gap-1 text-xs font-medium ${h>=0?"text-green-600":"text-red-600"}`,children:[h>=0?e.jsx(la,{className:"w-3 h-3"}):e.jsx(Jc,{className:"w-3 h-3"}),Math.abs(h),"%"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"vs last period"})]})]})]})},Vc=({active:o=!1,color:i="green"})=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`w-3 h-3 bg-${i}-500 rounded-full ${o?"animate-pulse":""}`}),o&&e.jsx("div",{className:`absolute inset-0 w-3 h-3 bg-${i}-500 rounded-full animate-ping opacity-75`})]}),oh=({alert:o,index:i})=>{const[h,c]=u.useState(!1);u.useEffect(()=>{const A=setTimeout(()=>c(!0),i*100);return()=>clearTimeout(A)},[i]);const x={critical:{bg:"from-red-600 to-red-700",border:"border-red-400",icon:gt,pulse:!0,glow:"shadow-red-300"},warning:{bg:"from-yellow-600 to-orange-600",border:"border-yellow-400",icon:Zt,pulse:!1,glow:"shadow-yellow-300"},info:{bg:"from-blue-600 to-blue-700",border:"border-blue-400",icon:Vl,pulse:!1,glow:"shadow-blue-300"}},y=x[o.type]||x.info,S=y.icon;return e.jsx("div",{className:`transform transition-all duration-500 ${h?"opacity-100 translate-x-0":"opacity-0 translate-x-4"}`,children:e.jsx("div",{className:`group relative overflow-hidden rounded-xl border ${y.border} bg-white ${y.glow} hover:shadow-xl transition-all duration-300 hover:scale-102`,children:e.jsxs("div",{className:"flex items-center gap-4 p-4",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${y.bg} ${y.pulse?"animate-pulse":""}`,children:e.jsx(S,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:o.message}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(o.time).toLocaleTimeString()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vc,{active:o.type==="critical",color:o.type==="critical"?"red":o.type==="warning"?"yellow":"blue"}),e.jsx(at,{variant:o.type==="critical"?"danger":o.type==="warning"?"warning":"info",size:"sm",children:o.type})]})]})})})};function _h(){const[o,i]=u.useState({orders:{total:0,pending:0,in_progress:0,completed:0,paused:0},machines:{total:0,available:0,in_use:0,maintenance:0,offline:0},production:{efficiency:0,output:0,on_time_delivery:0},alerts:{critical:0,warning:0,info:0}}),[h,c]=u.useState([]),[x,y]=u.useState([]),[S,A]=u.useState(!0),[j,f]=u.useState(!1),[v,F]=u.useState(null),[U,se]=u.useState("today"),[G,W]=u.useState(!1),[N,g]=u.useState({orders:Array.from({length:20},()=>Math.floor(Math.random()*100)),machines:Array.from({length:20},()=>Math.floor(Math.random()*100)),efficiency:Array.from({length:20},()=>Math.floor(Math.random()*100))}),M=u.useRef(null);sl();const{lastUpdate:Y}=td(),{lastUpdate:Z}=sd();Wn(),u.useEffect(()=>{if(!localStorage.getItem("token")){console.warn(" No authentication token found - user needs to log in"),A(!1);return}return Be(),M.current=setInterval(()=>{console.log(" Periodic refresh - reloading dashboard data"),Be(!0)},3e4),()=>{M.current&&clearInterval(M.current)}},[U]),u.useEffect(()=>{Y&&(console.log("Dashboard received order update:",Y),Be(!0))},[Y]),u.useEffect(()=>{Z&&(console.log("Dashboard received machine update:",Z),Be(!0))},[Z]),u.useEffect(()=>{window.EnhancedWebSocketService?.isConnected()&&window.EnhancedWebSocketService.subscribe(["dashboard","orders","machines","production","alerts"])},[]);const le=(ee,Ae="success")=>{F({message:ee,type:Ae}),setTimeout(()=>F(null),3e3)},ke=(ee,Ae="data")=>Array.isArray(ee)?ee:ee?.data&&Array.isArray(ee.data)?ee.data:(console.warn(` ${Ae} is not an array:`,ee),[]),Be=async(ee=!1)=>{ee?f(!0):A(!0);try{const[Ae,$,C,O]=await Promise.all([fe.get("/orders").catch(()=>({data:[]})),fe.get("/machines").catch(()=>({data:[]})),fe.get("/users").catch(()=>({data:[]})),fe.get("/alerts").catch(()=>({data:[]}))]),q=ke(Ae,"orders"),z=ke($,"machines"),H=ke(C,"users"),d=ke(O,"alerts");console.log(" Dashboard data loaded:"),console.log("  - Orders:",q.length,"items"),console.log("  - Machines:",z.length,"items"),console.log("  - Users:",H.length,"items"),console.log("  - Alerts:",d.length,"items");const T={total:q.length,pending:q.filter(ge=>ge.status==="pending").length,in_progress:q.filter(ge=>ge.status==="in_progress").length,completed:q.filter(ge=>ge.status==="completed").length,paused:q.filter(ge=>ge.status==="paused").length},E={total:z.length,available:z.filter(ge=>ge.status==="available").length,in_use:z.filter(ge=>ge.status==="in_use").length,maintenance:z.filter(ge=>ge.status==="maintenance").length,offline:z.filter(ge=>ge.status==="offline").length},R=q.reduce((ge,oe)=>ge+(parseInt(oe.quantity)||0),0),Q=q.filter(ge=>ge.status==="completed").reduce((ge,oe)=>ge+(parseInt(oe.actual_quantity||oe.quantity)||0),0),Ce=R>0?Math.round(Q/R*100):0,Me=Math.round(75+Math.random()*20),He={efficiency:Ce,output:Q,on_time_delivery:Me},I={critical:d.filter(ge=>ge.type==="critical").length,warning:d.filter(ge=>ge.type==="warning").length,info:d.filter(ge=>ge.type==="info").length};i({orders:T,machines:E,production:He,alerts:I}),c(q.slice(0,5)),y(d.slice(0,5)),g(ge=>({orders:[...ge.orders.slice(1),T.total],machines:[...ge.machines.slice(1),E.in_use],efficiency:[...ge.efficiency.slice(1),Ce]}))}catch(Ae){console.error("Failed to load dashboard data:",Ae),le("Failed to load dashboard data","danger")}finally{A(!1),f(!1)}},je=()=>{Be(!0)},Ee=[{label:"Create Order",icon:qt,action:()=>window.location.href="#/orders",color:"blue"},{label:"View Analytics",icon:ts,action:()=>window.location.href="#/analytics",color:"steel"},{label:"Manage Machines",icon:Pt,action:()=>window.location.href="#/machines",color:"green"},{label:"Labor Planning",icon:vt,action:()=>window.location.href="#/labor-planner",color:"orange"}],D=u.useMemo(()=>x.filter(ee=>ee.type==="critical").slice(0,3),[x]),ve=({order:ee})=>e.jsxs("div",{className:"group flex items-center justify-between p-4 bg-white border border-gray-200 rounded-xl hover:shadow-lg hover:border-blue-300 transition-all duration-300 hover:scale-102",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-white font-bold text-sm bg-gradient-to-br ${ee.status==="completed"?"from-green-500 to-emerald-500":ee.status==="in_progress"?"from-blue-500 to-cyan-500":ee.status==="paused"?"from-yellow-500 to-orange-500":"from-gray-500 to-slate-500"} shadow-lg group-hover:scale-110 transition-transform duration-300`,children:ee.order_number?.slice(-3)||"N/A"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-blue-700 transition-colors",children:ee.order_number}),e.jsx("div",{className:"text-sm text-gray-600",children:ee.product_name}),ee.quantity&&e.jsxs("div",{className:"text-xs text-gray-500",children:[ee.quantity," units"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(at,{variant:ee.status==="completed"?"success":ee.status==="in_progress"?"info":ee.status==="paused"?"warning":"secondary",className:"mb-2",children:ee.status?.replace("_"," ")}),e.jsx("div",{className:"text-xs text-gray-500",children:ee.created_at?new Date(ee.created_at).toLocaleDateString():"N/A"})]})]});return S?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 border-4 border-blue-200 rounded-full animate-spin border-t-blue-600 mx-auto"}),e.jsx("div",{className:"absolute inset-0 w-20 h-20 border-4 border-slate-200 rounded-full animate-ping mx-auto"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-slate-700 bg-clip-text text-transparent",children:"Loading Production Dashboard"}),e.jsx("p",{className:"text-gray-600 max-w-md mx-auto",children:"Initializing real-time manufacturing intelligence system..."}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:[...Array(3)].map((ee,Ae)=>e.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:`${Ae*.2}s`}},Ae))})]})]})}):e.jsxs("div",{className:"min-h-full bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[e.jsx("div",{className:"bg-white/80 backdrop-blur-xl border-b border-gray-200/50 mb-8",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-600 to-slate-700 rounded-2xl shadow-xl",children:e.jsx(Et,{className:"w-8 h-8 text-white"})}),e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full animate-pulse shadow-lg"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-gray-900 via-blue-900 to-slate-900 bg-clip-text text-transparent",children:"Production Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Real-time manufacturing intelligence & performance metrics"})]}),e.jsx(vi,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-green-100 rounded-full",children:[e.jsx(Vc,{active:!0,color:"green"}),e.jsx("span",{className:"font-medium text-green-800",children:"System Online"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-100 rounded-full",children:[e.jsx(Wt,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-800",children:[o.orders.in_progress," Active Orders"]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-slate-100 rounded-full",children:[e.jsx(qc,{className:"w-4 h-4 text-slate-600"}),e.jsxs("span",{className:"font-medium text-slate-800",children:[o.machines.in_use," Machines Running"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Oe,{onClick:je,disabled:j,variant:"outline",className:"bg-white/50 backdrop-blur-sm hover:bg-white/80 transition-all duration-300",children:[e.jsx(Tt,{className:`w-4 h-4 mr-2 ${j?"animate-spin":""}`}),j?"Updating...":"Refresh"]}),e.jsxs(Oe,{onClick:()=>W(!0),className:"bg-gradient-to-r from-blue-600 to-slate-700 hover:from-blue-700 hover:to-slate-800 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(Xn,{className:"w-4 h-4 mr-2"}),"Quick Actions"]})]})]})})}),v&&e.jsx("div",{className:`fixed top-20 right-6 p-4 rounded-xl shadow-2xl z-50 backdrop-blur-xl border transform transition-all duration-500 scale-105 ${v.type==="success"?"bg-green-100/90 text-green-800 border-green-300":v.type==="danger"?"bg-red-100/90 text-red-800 border-red-300":v.type==="warning"?"bg-yellow-100/90 text-yellow-800 border-yellow-300":"bg-blue-100/90 text-blue-800 border-blue-300"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`p-2 rounded-full ${v.type==="success"?"bg-green-200":v.type==="danger"?"bg-red-200":v.type==="warning"?"bg-yellow-200":"bg-blue-200"}`,children:[v.type==="success"&&e.jsx(Nt,{className:"w-5 h-5 text-green-600"}),v.type==="danger"&&e.jsx(gt,{className:"w-5 h-5 text-red-600"}),v.type==="warning"&&e.jsx(gt,{className:"w-5 h-5 text-yellow-600"}),(!v.type||v.type==="info")&&e.jsx(Vl,{className:"w-5 h-5 text-blue-600"})]}),e.jsx("span",{className:"font-semibold",children:v.message})]})}),e.jsxs("div",{className:"p-6 space-y-8",children:[D.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 border border-red-200 rounded-2xl p-6 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-500 rounded-xl animate-pulse",children:e.jsx(gt,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-red-900",children:"Critical System Alerts"}),e.jsx(at,{variant:"danger",children:D.length})]}),e.jsx("div",{className:"space-y-3",children:D.map((ee,Ae)=>e.jsx(oh,{alert:ee,index:Ae},Ae))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(ii,{title:"Total Orders",value:o.orders.total,change:5,icon:cs,color:"blue",target:100,trend:8,sparklineData:N.orders}),e.jsx(ii,{title:"Machine Utilization",value:`${Math.round(o.machines.in_use/Math.max(o.machines.total,1)*100)}%`,change:3,icon:Et,color:"steel",target:80,trend:-2,sparklineData:N.machines}),e.jsx(ii,{title:"On-Time Delivery",value:`${o.production.on_time_delivery}%`,change:2,icon:ra,color:"green",target:95,trend:4,sparklineData:N.efficiency}),e.jsx(ii,{title:"Active Production",value:o.orders.in_progress,change:-1,icon:Wt,color:"orange",target:20,trend:-3,sparklineData:N.orders})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(tt,{className:"p-6 bg-white/80 backdrop-blur-sm border border-gray-200/50 shadow-xl rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-xl",children:e.jsx(cs,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Recent Orders"})]}),e.jsx(at,{variant:"info",className:"px-3 py-1",children:h.length})]}),h.length>0?e.jsx("div",{className:"space-y-4",children:h.map(ee=>e.jsx(ve,{order:ee},ee.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(cs,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No recent orders"})]})]}),e.jsxs(tt,{className:"p-6 bg-white/80 backdrop-blur-sm border border-gray-200/50 shadow-xl rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-orange-500 to-red-500 rounded-xl",children:e.jsx(Vl,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"System Alerts"})]}),e.jsx(at,{variant:"warning",className:"px-3 py-1",children:x.length})]}),x.length>0?e.jsx("div",{className:"space-y-4",children:x.map((ee,Ae)=>e.jsx(oh,{alert:ee,index:Ae},Ae))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Nt,{className:"w-16 h-16 mx-auto mb-4 text-green-400"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"All systems running smoothly"})]})]})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-gray-200/50 shadow-xl rounded-2xl overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200/50 bg-gradient-to-r from-indigo-50 to-slate-50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-indigo-500 to-slate-600 rounded-xl",children:e.jsx(Wt,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Live Activity Feed"}),e.jsx(Vc,{active:!0,color:"green"})]})}),e.jsx(Jp,{maxItems:8})]})]}),G&&e.jsx(Mt,{title:"Quick Actions",onClose:()=>W(!1),className:"backdrop-blur-xl",children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:Ee.map((ee,Ae)=>{const $=ee.icon;return e.jsx("button",{onClick:()=>{ee.action(),W(!1)},className:`group p-6 rounded-2xl border-2 border-dashed border-gray-300 hover:border-${ee.color}-400 hover:bg-${ee.color}-50 transition-all duration-300 hover:scale-105 hover:shadow-lg`,children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:`mx-auto w-12 h-12 bg-gradient-to-br from-${ee.color}-500 to-${ee.color}-600 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-300`,children:e.jsx($,{className:"w-6 h-6 text-white"})}),e.jsx("div",{className:"font-semibold text-gray-900 group-hover:text-gray-700",children:ee.label})]})},Ae)})})})})]})}const Gl={name:"SAST",fullName:"South African Standard Time",offset:"+02:00",offsetMinutes:120,offsetHours:2,offsetMS:7200*1e3};function Ra(){return new Date(Date.now()+Gl.offsetMS)}function al(o){if(!o)return null;const i=typeof o=="string"?new Date(o):o;return isNaN(i.getTime())?null:new Date(i.getTime()+Gl.offsetMS)}function ib(o){if(!o)return null;const i=new Date(o);return isNaN(i.getTime())?null:new Date(i.getTime()-Gl.offsetMS)}function ob(o,i={}){if(!o)return"N/A";const c={...{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},...i},x=al(o);return x?x.toLocaleString("en-ZA",c):"N/A"}function Fn(o){if(!o)return"";const i=al(o);return i?i.toISOString().split("T")[0]:""}function cb(o){if(!o)return"N/A";const i=al(o);return i?i.toLocaleString("en-ZA",{hour:"2-digit",minute:"2-digit",hour12:!1}):"N/A"}function db(o=null){const i=o?al(o):Ra();if(!i)return"";const h=i.getFullYear(),c=String(i.getMonth()+1).padStart(2,"0"),x=String(i.getDate()).padStart(2,"0"),y=String(i.getHours()).padStart(2,"0"),S=String(i.getMinutes()).padStart(2,"0");return`${h}-${c}-${x}T${y}:${S}`}function ub(o=null){return Fn(o||Ra())}function mb(){return Ra().toISOString()}function hb(o=null){const i=o||new Date;return new Date(i.getTime()+Gl.offsetMS).toISOString()}function xb(o,i=null){if(!o)return 0;const h=new Date(o),c=i?new Date(i):Ra();return Math.round((c.getTime()-h.getTime())/(1e3*60))}function fb(){return Date.now()+Gl.offsetMS}function gb(o){if(!o)return!1;const i=Fn(o),h=Fn(Ra());return i===h}function pb(o=null){const i=o?new Date(o):Ra(),h=al(i),c=new Date(h);c.setHours(0,0,0,0);const x=new Date(h);return x.setHours(23,59,59,999),{startOfDay:c.toISOString(),endOfDay:x.toISOString()}}function bb(o){if(o<0)return"0 seconds";const i=Math.floor(o/1e3),h=Math.floor(i/60),c=Math.floor(h/60),x=Math.floor(c/24);return x>0?`${x} day${x!==1?"s":""}, ${c%24} hour${c%24!==1?"s":""}`:c>0?`${c} hour${c!==1?"s":""}, ${h%60} minute${h%60!==1?"s":""}`:h>0?`${h} minute${h!==1?"s":""}, ${i%60} second${i%60!==1?"s":""}`:`${i} second${i!==1?"s":""}`}function yb(o){const i=al(o),c=Ra().getTime()-i.getTime(),x=Math.floor(c/(1e3*60)),y=Math.floor(x/60),S=Math.floor(y/24);return Math.abs(x)<1?"just now":Math.abs(x)<60?x>0?`${x} minutes ago`:`in ${Math.abs(x)} minutes`:Math.abs(y)<24?y>0?`${y} hours ago`:`in ${Math.abs(y)} hours`:Math.abs(S)<7?S>0?`${S} days ago`:`in ${Math.abs(S)} days`:Fn(o)}const ks={TIMEZONE_CONFIG:Gl,getCurrentSASTTime:Ra,toSAST:al,convertSASTToUTC:ib,formatSASTDateTime:ob,formatSASTDate:Fn,formatSASTTime:cb,getSASTDateTimeLocal:db,getSASTDateOnly:ub,getCurrentSASTISOString:mb,toSASTDatabaseString:hb,calculateDurationMinutes:xb,getSASTTimestamp:fb,isSASTToday:gb,getSASTDayRange:pb,formatDuration:bb,getSASTRelativeTime:yb},Ah=({value:o,duration:i=2e3,prefix:h="",suffix:c="",className:x=""})=>{const[y,S]=u.useState(0),A=u.useRef(null),j=u.useRef(null);return u.useEffect(()=>{const f=v=>{A.current||(A.current=v);const F=Math.min((v-A.current)/i,1),U=1-Math.pow(1-F,3);S(Math.floor(U*o)),F<1&&(j.current=requestAnimationFrame(f))};return A.current=null,j.current=requestAnimationFrame(f),()=>{j.current&&cancelAnimationFrame(j.current)}},[o,i]),e.jsxs("span",{className:x,children:[h,y.toLocaleString(),c]})},vb=({title:o,value:i,change:h,icon:c,color:x="blue",target:y,trend:S,sparklineData:A=[]})=>{const[j,f]=u.useState(!1),[v,F]=u.useState(!1),U=u.useRef(null);u.useEffect(()=>{const W=new IntersectionObserver(([N])=>F(N.isIntersecting),{threshold:.1});return U.current&&W.observe(U.current),()=>W.disconnect()},[]);const se={blue:"from-blue-600 to-slate-600",green:"from-green-600 to-emerald-600",yellow:"from-amber-500 to-orange-600",purple:"from-slate-600 to-gray-700",red:"from-red-600 to-orange-700",gray:"from-gray-600 to-slate-700"},G={blue:"bg-gradient-to-br from-blue-50 to-slate-50",green:"bg-gradient-to-br from-green-50 to-emerald-50",yellow:"bg-gradient-to-br from-amber-50 to-orange-50",purple:"bg-gradient-to-br from-slate-50 to-gray-50",red:"bg-gradient-to-br from-red-50 to-orange-50",gray:"bg-gradient-to-br from-gray-50 to-slate-50"};return e.jsxs("div",{ref:U,className:`relative overflow-hidden rounded-2xl ${G[x]} backdrop-blur-xl
        border border-white/20 shadow-xl transition-all duration-500 ease-out
        ${j?"transform scale-105 shadow-2xl":"transform scale-100"}
        ${v?"opacity-100 translate-y-0":"opacity-0 translate-y-8"}`,style:{background:j?"linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 100%)":void 0,backdropFilter:"blur(20px)"},onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${se[x]} opacity-10 
        transition-opacity duration-500 ${j?"opacity-20":"opacity-10"}`}),j&&e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(6)].map((W,N)=>e.jsx("div",{className:"absolute w-1 h-1 bg-white/30 rounded-full animate-float",style:{left:`${20+Math.random()*60}%`,top:`${20+Math.random()*60}%`,animationDelay:`${N*.2}s`,animationDuration:"3s"}},N))}),e.jsxs("div",{className:"relative p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${se[x]} 
            shadow-lg transform transition-transform duration-300 
            ${j?"scale-110 rotate-3":"scale-100 rotate-0"}`,children:e.jsx(c,{className:"w-6 h-6 text-white"})}),h!==void 0&&e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-semibold
              ${h>=0?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[e.jsx(la,{className:`w-3 h-3 ${h<0?"rotate-180":""}`}),Math.abs(h),"%"]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-800 mb-1",children:e.jsx(Ah,{value:i,duration:2e3,className:"text-transparent bg-clip-text bg-gradient-to-r from-gray-800 to-gray-600"})}),e.jsx("p",{className:"text-sm font-medium text-gray-600",children:o})]}),y&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Progress"}),e.jsxs("span",{className:"text-xs font-semibold text-gray-700",children:[Math.round(i/y*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-2 bg-gradient-to-r ${se[x]} rounded-full 
                  transition-all duration-1000 ease-out`,style:{width:`${Math.min(i/y*100,100)}%`,transform:v?"translateX(0)":"translateX(-100%)"}})})]}),A.length>0&&e.jsx("div",{className:"mt-4 h-12 flex items-end justify-between gap-1",children:A.map((W,N)=>{const g=Math.max(W/Math.max(...A)*100,5);return e.jsx("div",{className:`bg-gradient-to-t ${se[x]} rounded-sm transition-all duration-500 opacity-70`,style:{height:`${g}%`,width:`${100/A.length-2}%`,animationDelay:`${N*100}ms`}},N)})})]}),e.jsx("div",{className:`absolute inset-0 rounded-2xl transition-opacity duration-300
        ${j?"opacity-100":"opacity-0"}`,style:{background:"radial-gradient(circle at 50% 50%, rgba(255,255,255,0.1) 0%, transparent 70%)",pointerEvents:"none"}})]})},wb=({machine:o,onClick:i})=>{const[h,c]=u.useState(0),[x,y]=u.useState(!1),[S,A]=u.useState(!1),[j,f]=u.useState(!1),v=u.useRef(null);u.useEffect(()=>{const g=new IntersectionObserver(([M])=>f(M.isIntersecting),{threshold:.1});return v.current&&g.observe(v.current),()=>g.disconnect()},[]),u.useEffect(()=>{y(!0);const g=setTimeout(()=>y(!1),2e3);return()=>clearTimeout(g)},[o.status,o.order_number]),u.useEffect(()=>{if(o.status==="in_use"){const g=setInterval(()=>c(M=>M+1),1e3);return()=>clearInterval(g)}},[o.status]);const F={available:{gradient:"from-green-600 to-emerald-600",bg:"from-green-50 to-emerald-50",text:"text-green-700",icon:Nt,pulse:"bg-green-600",glow:"shadow-green-600/25"},in_use:{gradient:"from-blue-600 to-slate-600",bg:"from-blue-50 to-slate-50",text:"text-blue-700",icon:Xn,pulse:"bg-blue-600",glow:"shadow-blue-600/25"},maintenance:{gradient:"from-amber-500 to-orange-600",bg:"from-amber-50 to-orange-50",text:"text-amber-700",icon:tl,pulse:"bg-amber-500",glow:"shadow-amber-500/25"},offline:{gradient:"from-red-600 to-orange-700",bg:"from-red-50 to-orange-50",text:"text-red-700",icon:Zc,pulse:"bg-red-600",glow:"shadow-red-600/25"}},U=F[o.status]||F.offline,se=U.icon,G=Ch(o),W=o.status==="in_use",N=o.order_number;return e.jsxs("div",{ref:v,className:`group relative overflow-hidden rounded-2xl backdrop-blur-xl
                border border-white/20 shadow-xl transition-all duration-500 ease-out
                ${N?"cursor-pointer":"cursor-default"}
                ${S?`transform scale-105 shadow-2xl ${U.glow}`:"transform scale-100"}
                ${j?"opacity-100 translate-y-0":"opacity-0 translate-y-8"}
                bg-gradient-to-br ${U.bg}`,style:{background:S?"linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.05) 100%)":void 0,backdropFilter:"blur(20px)",animationDelay:`${Math.random()*200}ms`},onClick:()=>i&&i(o),onMouseEnter:()=>A(!0),onMouseLeave:()=>A(!1),children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${U.gradient} opacity-5 
                transition-opacity duration-500 ${S?"opacity-15":"opacity-5"}`}),e.jsx("div",{className:`absolute top-4 right-4 w-3 h-3 rounded-full ${U.pulse} 
                ${x?"animate-ping":""} opacity-20`}),e.jsx("div",{className:`absolute top-4 right-4 w-3 h-3 rounded-full ${U.pulse}`}),e.jsxs("div",{className:"relative p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`p-2 rounded-xl bg-gradient-to-br ${U.gradient} 
                                shadow-lg transform transition-transform duration-300 
                                ${S?"scale-110 rotate-3":"scale-100 rotate-0"}`,children:e.jsx(se,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800 text-sm",children:o.name}),e.jsx("p",{className:"text-xs text-gray-500",children:o.type})]})]}),e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold
                            bg-gradient-to-r ${U.gradient} text-white shadow-lg`,children:[o.status.replace("_"," ").toUpperCase(),W&&G>0&&e.jsxs("span",{className:"bg-white/20 px-2 py-0.5 rounded-full",children:[G,"%"]})]})]}),N&&e.jsx(Ps,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-500 transition-colors ml-2"})]}),N?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-xl p-4 border border-white/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-bold text-gray-800 truncate",children:o.order_number}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:o.product_name})]}),o.order_status==="stopped"&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-red-100 rounded-full",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs font-semibold text-red-700",children:"STOPPED"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Hc,{className:"w-4 h-4"}),e.jsx("span",{className:"text-lg font-mono font-bold",children:Nb(o.start_time)}),o.operator&&e.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[e.jsx(vt,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-medium truncate max-w-16",children:o.operator})]})]})]}),G>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Efficiency"}),e.jsxs("span",{className:"text-xs font-bold text-gray-800",children:[G,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-2 bg-gradient-to-r transition-all duration-1000 ease-out rounded-full ${G>=90?"from-green-600 to-emerald-600":G>=70?"from-amber-500 to-orange-600":"from-red-600 to-orange-700"}`,style:{width:`${Math.min(G,100)}%`,transform:j?"translateX(0)":"translateX(-100%)"}})})]})]}):e.jsx("div",{className:"flex items-center justify-center h-20",children:e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx(Et,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-xs font-medium",children:o.status.replace("_"," ").toUpperCase()})]})})]}),e.jsx("div",{className:`absolute inset-0 rounded-2xl transition-opacity duration-300
                ${S?"opacity-100":"opacity-0"}`,style:{background:"linear-gradient(135deg, transparent 30%, rgba(255,255,255,0.2) 50%, transparent 70%)",transform:S?"translateX(100%)":"translateX(-100%)",transition:"transform 0.6s ease-out, opacity 0.3s ease-out",pointerEvents:"none"}})]})},Nb=o=>{if(!o)return"00:00:00";const i=ks.toSAST(o).getTime(),h=ks.getSASTTimestamp(),c=Math.max(0,h-i),x=Math.floor(c/36e5).toString().padStart(2,"0"),y=Math.floor(c%36e5/6e4).toString().padStart(2,"0"),S=Math.floor(c%6e4/1e3).toString().padStart(2,"0");return`${x}:${y}:${S}`},Ch=o=>{if(!o.start_time||o.status!=="in_use")return 0;const i=new Date(o.start_time).getTime(),c=(Date.now()-i)/36e5*(o.production_rate||60),x=o.actual_quantity||0;return c>0?Math.min(100,Math.round(x/c*100)):0},jb=({machines:o,activeOrders:i,todayStats:h,efficiency:c})=>{const[x,y]=u.useState(!1),S=u.useRef(null);u.useEffect(()=>{const f=new IntersectionObserver(([v])=>y(v.isIntersecting),{threshold:.1});return S.current&&f.observe(S.current),()=>f.disconnect()},[]);const A=u.useMemo(()=>{const f=o.length,v=o.filter(N=>N.status==="in_use").length,F=o.filter(N=>N.status==="available").length,U=o.filter(N=>N.status==="maintenance").length,se=o.filter(N=>N.status==="offline").length,G=c||(v>0?Math.round(o.filter(N=>N.status==="in_use").reduce((N,g)=>N+Ch(g),0)/v):0),W=f>0?Math.round(v/f*100):0;return{total:f,running:v,available:F,maintenance:U,offline:se,avgEfficiency:G,utilizationRate:W,activeOrders:i.length,totalOrders:h.total_orders||0,completedOrders:h.completed_orders||0}},[o,i,h,c]),j=[{title:"Total Machines",value:A.total,icon:Et,color:"gray",change:void 0,target:void 0},{title:"Running Now",value:A.running,icon:Xn,color:"blue",change:void 0,target:A.total,sparklineData:[2,4,3,5,4,6,5,7,6,A.running]},{title:"Available",value:A.available,icon:Nt,color:"green",change:void 0,target:void 0},{title:"Utilization Rate",value:A.utilizationRate,icon:Gn,color:"purple",change:12,target:100,sparklineData:[65,70,68,75,72,78,76,82,79,A.utilizationRate]},{title:"Active Orders",value:A.activeOrders,icon:ra,color:"yellow",change:8,target:A.totalOrders,sparklineData:[1,2,3,2,4,3,5,4,6,A.activeOrders]},{title:"Maintenance",value:A.maintenance,icon:tl,color:"yellow",change:-3,target:void 0}];return e.jsxs("div",{ref:S,className:"space-y-6",children:[e.jsxs("div",{className:`transition-all duration-700 ${x?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-600 to-slate-600 rounded-lg",children:e.jsx(ts,{className:"w-6 h-6 text-white"})}),"Production Performance"]}),e.jsx("p",{className:"text-gray-600",children:"Real-time insights into your manufacturing operations"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6",children:j.map((f,v)=>e.jsx("div",{style:{animationDelay:`${v*100}ms`},children:e.jsx(vb,{...f})},f.title))})]})},Sb=({isOpen:o,onClose:i,orderId:h,orderNumber:c})=>{const[x,y]=u.useState(null),[S,A]=u.useState(!1),[j,f]=u.useState(""),[v,F]=u.useState(0),U=u.useCallback(async()=>{if(!(!h||!o)){A(!0),f("");try{console.log("Fetching order details for ID:",h);const W=await fe.get("/orders");console.log("Orders response:",W);const g=(W.data||W||[]).find(Y=>Y.id==h);if(!g)throw new Error(`Order with ID ${h} not found`);let M=[];try{const Y=await fe.get(`/reports/downtime?order_id=${h}`),Z=Y?.data||Y;if(M=Z?.records||Z||[],console.log(" Downtime response for order",h,":",M),!Array.isArray(M)||M.length===0){console.log(" No stops found for specific order, trying all stops...");const le=await fe.get("/reports/downtime"),ke=le?.data||le,Be=ke?.records||ke||[];console.log(" All stops:",Be),M=Array.isArray(Be)?Be.filter(je=>je.order_id==h):[]}}catch(Y){console.log("Downtime endpoint error:",Y),M=[]}y({order:g,stops:Array.isArray(M)?M:[]})}catch(W){console.error("Failed to fetch order details:",W),f(W.message||"Failed to load order details")}finally{A(!1)}}},[h,o]);u.useEffect(()=>{U()},[U]),u.useEffect(()=>{if(o&&x?.stops?.some(W=>!W.end_time)){const W=setInterval(()=>F(N=>N+1),1e3);return()=>clearInterval(W)}},[o,x?.stops]);const se=u.useCallback(W=>!W||!Array.isArray(W)||W.length===0?0:W.reduce((N,g)=>{if(g.start_time){const M=new Date(g.start_time).getTime();let Y;return g.end_time?Y=new Date(g.end_time).getTime():Y=Date.now(),N+(Y-M)}return N},0),[v]),G=u.useCallback(W=>{if(!W||W===0)return"0m";const N=Math.floor(W/6e4),g=Math.floor(N/60);return g>0?`${g}h ${N%60}m`:`${N}m`},[]);return o?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md transition-opacity",onClick:i}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:""}),e.jsxs("div",{className:"inline-block align-bottom bg-white/95 backdrop-blur-xl rounded-3xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full border border-white/20",children:[e.jsxs("div",{className:"bg-gradient-to-r from-slate-900 via-blue-900 to-slate-900 px-8 py-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(59,130,246,0.1),transparent)]"}),e.jsxs("div",{className:"relative flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white/10 backdrop-blur-sm rounded-xl",children:e.jsx(ra,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:c}),x&&e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mt-1 ${x.order.status==="stopped"?"bg-red-500/20 text-red-200 border border-red-500/30":x.order.status==="in_progress"?"bg-blue-500/20 text-blue-200 border border-blue-500/30":x.order.status==="completed"?"bg-green-500/20 text-green-200 border border-green-500/30":"bg-gray-500/20 text-gray-200 border border-gray-500/30"}`,children:[x.order.status==="stopped"&&e.jsx("div",{className:"w-2 h-2 bg-red-400 rounded-full animate-pulse"}),x.order.status.replace("_"," ").toUpperCase()]})]})]}),e.jsx("button",{onClick:i,className:"text-white/70 hover:text-white focus:outline-none focus:ring-2 focus:ring-white/20 rounded-xl p-2 hover:bg-white/10 transition-all duration-200",children:e.jsx(rs,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"p-8",children:[S&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Tt,{className:"w-6 h-6 animate-spin text-blue-500"}),e.jsx("span",{className:"text-gray-600 font-medium",children:"Loading order details..."})]})}),j&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(gt,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-red-800 font-medium",children:j})]})}),x&&!S&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl p-4 border border-blue-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Zt,{className:"w-6 h-6 text-blue-500 mx-auto mb-2"}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:x.order.start_time?new Date(x.order.start_time).toLocaleString("en-ZA",{hour:"2-digit",minute:"2-digit",hour12:!1}):"--:--"}),e.jsx("div",{className:"text-sm text-gray-600",children:x.order.start_time?new Date(x.order.start_time).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"}):"Started"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-4 border border-green-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ra,{className:"w-6 h-6 text-green-500 mx-auto mb-2"}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:x.order.quantity?.toLocaleString()||"0"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Target Qty"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-slate-50 to-gray-50 rounded-xl p-4 border border-slate-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ts,{className:"w-6 h-6 text-slate-600 mx-auto mb-2"}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:(x.order.actual_quantity||0).toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-600",children:"Produced"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 rounded-xl p-4 border border-orange-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Gn,{className:"w-6 h-6 text-orange-500 mx-auto mb-2"}),e.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[Math.round((x.order.actual_quantity||0)/x.order.quantity*100),"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Complete"})]})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 border border-orange-200 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h4",{className:"text-xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg",children:e.jsx(gt,{className:"w-5 h-5 text-white"})}),"Downtime Analysis"]}),x.order.status==="stopped"&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 bg-red-100 px-3 py-2 rounded-full border border-red-200",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),e.jsx("span",{className:"font-semibold",children:"ACTIVE STOP"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:e.jsx(Ah,{value:x.stops.length})}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Total Stops"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-600 mb-2",children:G(se(x.stops))}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Total Time"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-500 mb-2",children:x.stops.length>0?G(se(x.stops)/x.stops.length):"0m"}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"Avg Duration"})]})]})]}),!x.stops||!Array.isArray(x.stops)||x.stops.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"bg-gray-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:e.jsx(Zt,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 text-lg font-medium",children:"No stops recorded"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"This order has been running smoothly"})]}):e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-gray-500 to-slate-500 rounded-lg",children:e.jsx(Zt,{className:"w-5 h-5 text-white"})}),"Stop History (",x.stops.length,")"]}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto pr-2",children:(x.stops||[]).map((W,N)=>e.jsx("div",{className:"bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl p-4 hover:border-gray-300 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${W.end_time?"bg-gray-400":"bg-red-500 animate-pulse"}`}),e.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:W.reason.replace("_"," ").replace(/\b\w/g,g=>g.toUpperCase())}),e.jsx("span",{className:`text-xs px-3 py-1 rounded-full font-medium ${W.category==="Equipment"?"bg-red-100 text-red-700 border border-red-200":W.category==="Material"?"bg-orange-100 text-orange-700 border border-orange-200":W.category==="Quality"?"bg-yellow-100 text-yellow-700 border border-yellow-200":"bg-gray-100 text-gray-700 border border-gray-200"}`,children:W.category||"Other"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("span",{className:"font-mono",children:new Date(W.start_time).toLocaleString("en-ZA",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}),W.end_time&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsx("span",{className:"font-mono",children:new Date(W.end_time).toLocaleString("en-ZA",{hour:"2-digit",minute:"2-digit",hour12:!1})})]})]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsx("div",{className:`text-lg font-bold ${W.end_time?"text-gray-900":"text-red-600"}`,children:W.start_time?G(W.end_time?new Date(W.end_time).getTime()-new Date(W.start_time).getTime():Date.now()-new Date(W.start_time).getTime()):e.jsx("span",{className:"text-orange-500",children:"Unknown"})}),e.jsx("div",{className:`text-xs font-medium ${W.end_time?"text-gray-500":"text-red-600"}`,children:W.end_time?"resolved":"ACTIVE"})]})]})},N))})]})]})]}),e.jsx("div",{className:"bg-gray-50/80 backdrop-blur-sm px-8 py-6 border-t border-gray-200",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:i,className:"px-8 py-3 bg-gradient-to-r from-gray-900 to-slate-800 text-white rounded-xl hover:from-gray-800 hover:to-slate-700 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105",children:"Close Details"})})})]})]})}):null};function _b(){const[o,i]=u.useState({activeOrders:[],machineStatus:[],todayStats:{},efficiency:0}),[h,c]=u.useState(!0),[x,y]=u.useState(new Date),[S,A]=u.useState(null),[j,f]=u.useState("all"),[v,F]=u.useState(!1),[U,se]=u.useState(null),[G,W]=u.useState(!1);sl(),td(),sd(),Wn();const N=u.useCallback(async()=>{try{A(null);const Z=await fe.get("/production/floor-overview"),le=Z?.data||Z;console.log(" Production floor overview data:",le);const ke=le?.activeOrders||[],Be=le?.machineStatus||[],je=le?.todayStats||{};console.log(" Active orders:",ke.length),console.log(" Machine status:",Be.length),console.log(" Today stats:",je),i(le||{})}catch(Z){console.error("Failed to fetch production data:",Z),A(Z.message||"Failed to fetch production data")}finally{c(!1),y(new Date),F(!1)}},[]),g=()=>{F(!0),N()},M=Z=>{Z.order_id&&Z.order_number?(se({id:Z.order_id,number:Z.order_number,machineId:Z.id,machineName:Z.name,status:Z.status}),W(!0)):console.log("Machine clicked (no assigned order):",Z)};u.useEffect(()=>{if(!localStorage.getItem("token")){console.warn(" No authentication token found - user needs to log in"),c(!1);return}N();const le=setInterval(()=>{console.log(" Periodic refresh - reloading production dashboard"),N()},5e3);return()=>clearInterval(le)},[N]),_t("order_started",Z=>{console.log(" Production started:",Z.data.order),N(),y(new Date)},[N]),_t("order_stopped",Z=>{console.log(" Production stopped:",Z.data.order),i(le=>le.map(ke=>ke.id===Z.data.order.machine_id?{...ke,status:"available",order_number:null,order_id:null}:ke)),y(new Date)},[]),_t("order_resumed",Z=>{console.log(" Production resumed:",Z.data.order),i(le=>le.map(ke=>ke.id===Z.data.order.machine_id?{...ke,status:"in_use",order_number:Z.data.order.order_number,order_id:Z.data.order.id,start_time:Z.data.order.start_time}:ke)),y(new Date)},[]),_t("order_completed",Z=>{console.log(" Production completed:",Z.data.order),i(le=>le.map(ke=>ke.id===Z.data.order.machine_id?{...ke,status:"available",order_number:null,order_id:null}:ke)),y(new Date)},[]),_t("machine_status_changed",Z=>{console.log(" Machine status changed:",Z.data),i(le=>le.map(ke=>ke.id===Z.data.machine_id?{...ke,status:Z.data.status}:ke)),y(new Date)},[]),u.useEffect(()=>{window.EnhancedWebSocketService?.isConnected()&&window.EnhancedWebSocketService.subscribe(["production","orders","machines"])},[]);const Y=u.useMemo(()=>{const Z=o.machineStatus||[];return j==="all"?Z:Z.filter(le=>le.status===j)},[o,j]);return h?e.jsx("div",{className:"min-h-96 bg-gradient-to-br from-gray-50 to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-600 to-slate-600 rounded-2xl flex items-center justify-center mb-4 mx-auto animate-pulse",children:e.jsx(Et,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{className:"flex items-center justify-center gap-3 text-gray-600",children:[e.jsx(Tt,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{className:"text-lg font-medium",children:"Loading Production Floor Data..."})]})]})}):S?e.jsx("div",{className:"min-h-96 bg-gradient-to-br from-gray-50 to-red-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl border border-red-200 rounded-2xl p-8 max-w-md mx-auto text-center shadow-2xl",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-red-600 to-orange-700 rounded-2xl flex items-center justify-center mb-4 mx-auto",children:e.jsx(gt,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Connection Error"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Failed to load production data"}),e.jsx("p",{className:"text-red-600 text-sm mb-6",children:S}),e.jsx("button",{onClick:g,className:"w-full px-6 py-3 bg-gradient-to-r from-red-600 to-orange-700 text-white rounded-xl hover:from-red-700 hover:to-orange-800 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105",children:"Try Again"})]})}):e.jsxs("div",{className:"min-h-full bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50",children:[e.jsx("div",{className:"bg-white/80 backdrop-blur-xl border-b border-white/20 mb-8",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-600 via-slate-600 to-gray-700 rounded-2xl shadow-lg",children:e.jsx(Et,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-800 via-blue-800 to-slate-800 bg-clip-text text-transparent",children:"Production Floor Monitor"}),e.jsxs("p",{className:"text-gray-600 mt-1 flex items-center gap-2",children:["Real-time production monitoring and machine intelligence",e.jsx(vi,{})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/60 backdrop-blur-sm rounded-xl px-4 py-2 border border-white/30",children:[e.jsx(Qn,{className:"w-4 h-4 text-gray-500"}),e.jsxs("select",{value:j,onChange:Z=>f(Z.target.value),className:"bg-transparent border-none text-sm font-medium text-gray-700 focus:outline-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Machines"}),e.jsx("option",{value:"in_use",children:" Running"}),e.jsx("option",{value:"available",children:" Available"}),e.jsx("option",{value:"maintenance",children:" Maintenance"}),e.jsx("option",{value:"offline",children:" Offline"})]})]}),e.jsxs("button",{onClick:g,disabled:v,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-slate-600 text-white rounded-xl hover:from-blue-700 hover:to-slate-700 disabled:opacity-50 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105",children:[e.jsx(Tt,{className:`w-4 h-4 ${v?"animate-spin":""}`}),v?"Syncing...":"Refresh"]})]})]})})}),e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsx(jb,{machines:o.machineStatus||[],activeOrders:o.activeOrders||[],todayStats:o.todayStats||{},efficiency:o.efficiency||0}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-green-600 to-emerald-600 rounded-lg",children:e.jsx(Pt,{className:"w-6 h-6 text-white"})}),"Machine Status Grid",e.jsxs("span",{className:"text-lg font-normal text-gray-500",children:["(",Y.length," machines)"]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",x.toLocaleTimeString()]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6",children:Y.map((Z,le)=>e.jsx(wb,{machine:Z,onClick:M},Z.id))}),Y.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-gray-400 to-gray-500 rounded-2xl flex items-center justify-center mx-auto mb-6",children:e.jsx(Wt,{className:"w-10 h-10 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-2",children:"No Machines Found"}),e.jsx("p",{className:"text-gray-500",children:"No machines match the selected filter criteria"})]})]})]}),e.jsx(Sb,{isOpen:G,onClose:()=>W(!1),orderId:U?.id,orderNumber:U?.number}),e.jsx("style",{jsx:!0,children:`
                @keyframes float {
                    0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0; }
                    50% { transform: translateY(-20px) rotate(180deg); opacity: 1; }
                }
                .animate-float {
                    animation: float 3s ease-in-out infinite;
                }
            `})]})}const Ab=()=>{const[o,i]=u.useState(!1),[h,c]=u.useState(!1),[x,y]=u.useState({width:0,height:0});return u.useEffect(()=>{const S=()=>{const A=window.innerWidth,j=window.innerHeight;y({width:A,height:j}),i(A<768),c(A>=768&&A<1024)};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]),{isMobile:o,isTablet:h,screenSize:x,isDesktop:!o&&!h}},el=({children:o,onClick:i,variant:h="primary",size:c="md",disabled:x=!1,loading:y=!1,icon:S,className:A="",...j})=>{const f={primary:"bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 active:bg-gray-400",danger:"bg-red-600 text-white hover:bg-red-700 active:bg-red-800",success:"bg-green-600 text-white hover:bg-green-700 active:bg-green-800",outline:"border-2 border-gray-300 text-gray-700 hover:bg-gray-50 active:bg-gray-100"},v={sm:"px-4 py-2 text-sm min-h-[44px]",md:"px-6 py-3 text-base min-h-[48px]",lg:"px-8 py-4 text-lg min-h-[52px]"};return e.jsxs("button",{onClick:i,disabled:x||y,className:`
        inline-flex items-center justify-center gap-2 font-medium rounded-lg
        transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2
        ${f[h]}
        ${v[c]}
        ${x||y?"opacity-50 cursor-not-allowed":"active:scale-95"}
        ${A}
      `,...j,children:[y?e.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}):S&&e.jsx("icon",{className:"w-5 h-5"}),o]})},Cb=()=>{const[o,i]=u.useState(!1),[h,c]=u.useState("unknown");return u.useEffect(()=>{const x=()=>{if("memory"in navigator){const y=navigator.memory;y.totalJSHeapSize>y.jsHeapSizeLimit*.8&&i(!0)}if("connection"in navigator){const y=navigator.connection;c(y.effectiveType||"unknown"),(y.effectiveType==="slow-2g"||y.effectiveType==="2g")&&i(!0)}window.matchMedia("(prefers-reduced-motion: reduce)").matches&&i(!0)};if(x(),"connection"in navigator)return navigator.connection.addEventListener("change",x),()=>navigator.connection.removeEventListener("change",x)},[]),{isLowPower:o,connectionType:h,shouldReduceAnimations:o,shouldLazyLoad:h==="slow-2g"||h==="2g"}},oi={pending:{label:"Pending",color:"bg-yellow-100 text-yellow-800 border-yellow-200",icon:Zt,description:"Order ready to start production"},assigned:{label:"Assigned",color:"bg-blue-100 text-blue-800 border-blue-200",icon:Pt,description:"Machine assigned, ready to start production"},in_progress:{label:"In Progress",color:"bg-green-100 text-green-800 border-green-200",icon:Ta,description:"Production actively running"},paused:{label:"Paused",color:"bg-orange-100 text-orange-800 border-orange-200",icon:Nh,description:"Production temporarily paused"},stopped:{label:"Stopped",color:"bg-red-100 text-red-800 border-red-200",icon:Hl,description:"Production stopped due to issues"},completed:{label:"Completed",color:"bg-emerald-100 text-emerald-800 border-emerald-200",icon:Nt,description:"Production completed successfully"},cancelled:{label:"Cancelled",color:"bg-gray-400 text-white border-gray-500",icon:Zc,description:"Order cancelled"}},In={low:{label:"Low",color:"bg-gray-100 text-gray-800 border-gray-200"},medium:{label:"Medium",color:"bg-blue-100 text-blue-800 border-blue-200"},high:{label:"High",color:"bg-orange-100 text-orange-800 border-orange-200"},urgent:{label:"Urgent",color:"bg-red-100 text-red-800 border-red-200"}},Mb=({orderId:o})=>{const[i,h]=u.useState(null),[c,x]=u.useState(!0);u.useEffect(()=>{o&&y()},[o]);const y=async()=>{try{x(!0);const j=await fe.get(`/orders/${o}/downtime`);h(j)}catch(j){console.error("Failed to load downtime history:",j)}finally{x(!1)}};if(c)return e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"text-gray-500",children:"Loading downtime history..."})});if(!i?.history||i.history.length===0)return e.jsxs("div",{className:"text-center text-gray-500 italic py-8",children:[e.jsx(Nt,{className:"w-12 h-12 mx-auto mb-2 text-green-400"}),e.jsx("p",{children:"No downtime events recorded"}),e.jsx("p",{className:"text-xs mt-1",children:"Production has been running smoothly"})]});const{history:S,summary:A}=i;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:A.total_stops}),e.jsx("div",{className:"text-xs text-red-700",children:"Total Stops"})]}),e.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[Math.round(A.total_downtime_minutes),"m"]}),e.jsx("div",{className:"text-xs text-orange-700",children:"Total Downtime"})]})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:S.map((j,f)=>e.jsxs("div",{className:"bg-gray-50 border rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(at,{variant:j.end_time?"success":"warning",size:"sm",children:j.end_time?"Resolved":"Active"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:j.category})]}),e.jsx("div",{className:"text-xs text-gray-500",children:j.duration?`${Math.round(j.duration)}m`:"Active"})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Started:"})," ",new Date(j.start_time).toLocaleString()]}),j.end_time&&e.jsxs("div",{children:[e.jsx("strong",{children:"Ended:"})," ",new Date(j.end_time).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Reason:"})," ",typeof j.reason=="string"?j.reason:"No reason provided"]}),j.notes&&e.jsxs("div",{children:[e.jsx("strong",{children:"Notes:"})," ",typeof j.notes=="string"?j.notes:"No additional notes"]}),j.resolved_by_name&&e.jsxs("div",{children:[e.jsx("strong",{children:"Resolved By:"})," ",j.resolved_by_name]})]})]},j.id||f))})]})},ci=o=>{if(!o)return"N/A";let i;if(typeof o=="string")if(o.includes("T"))i=new Date(o);else{const[y,S,A]=o.split("-");i=new Date(y,S-1,A)}else i=new Date(o);if(isNaN(i.getTime()))return"Invalid Date";const h=i.getDate().toString().padStart(2,"0"),c=(i.getMonth()+1).toString().padStart(2,"0"),x=i.getFullYear();return`${h}-${c}-${x}`};function Ob(){const[o,i]=u.useState([]),[h,c]=u.useState([]),[x,y]=u.useState([]),[S,A]=u.useState([]),[j,f]=u.useState(!0),[v,F]=u.useState(!1),[U,se]=u.useState(null),[G,W]=u.useState({environment:"all",status:"all",priority:"all",machine:"all",search:"",dateRange:"all"}),[N,g]=u.useState("active"),[M,Y]=u.useState(null),[Z,le]=u.useState(!1),[ke,Be]=u.useState(!1),[je,Ee]=u.useState(!1),[D,ve]=u.useState(!1),[ee,Ae]=u.useState(!1),[$,C]=u.useState(!1),[O,q]=u.useState(!1),{isMobile:z}=Ab();Cb(),sl();const{notifications:H,clearNotification:d}=Wn(),{lastUpdate:T}=td(),[E,R]=u.useState({order_number:"",product_name:"",quantity:"",priority:"medium",environment:"",due_date:"",specifications:"",customer_info:"",batch_number:""}),[Q,Ce]=u.useState({machine_id:null,operator_id:null,batch_number:"",start_notes:""}),[Me,He]=u.useState({reason:"Unplanned Stop",category:"Equipment",notes:""}),[I,ge]=u.useState({waste_type:"BLND",weight:0,units:0,waste_reason:"",waste_category:"material",recovery_possible:!1,waste_notes:""}),[oe,Le]=u.useState({machine_id:"",scheduled_start_date:"",scheduled_start_shift:"",scheduled_end_date:"",scheduled_end_shift:"",notes:""}),[ye,Ue]=u.useState(!1),[pe,Se]=u.useState(null),[ze,Ye]=u.useState([]);u.useEffect(()=>{Qe()},[]),u.useEffect(()=>{T&&Pe()},[T]),_t("order_created",b=>{console.log(" New order created:",b.data),Te(`Order ${b.data.order_number} created successfully`,"success"),Pe()},[]),_t("order_started",b=>{console.log(" Order production started:",b.data),Te(`Production started for Order ${b.data.order_number}`,"success"),Pe()},[]),_t("order_resumed",b=>{console.log(" Order resumed:",b.data),Te(`Order ${b.data.order_number} resumed`,"success"),Pe()},[]),_t("order_stopped",b=>{console.log(" Order stopped:",b.data),Te(`Order ${b.data.order_number} stopped: ${b.data.reason}`,"error"),Pe()},[]),_t("order_completed",b=>{console.log(" Order completed:",b.data),Te(`Order ${b.data.order_number} completed and archived`,"success"),Pe()},[]),_t("machine_reserved",b=>{console.log(" Machine reserved:",b.data),Te(`Machine ${b.data.machine_name} reserved for Order ${b.data.order_number}`,"info"),Re()},[]),_t("downtime_reported",b=>{console.log(" Downtime reported:",b.data),Te(`Downtime reported: ${b.data.reason}`,"error")},[]);const Qe=async()=>{f(!0);try{await Promise.all([Pe(),Re(),et(),Fe()])}catch(b){console.error("Error loading initial data:",b),Te("Failed to load system data","error")}finally{f(!1)}},Pe=async()=>{try{v||f(!0);const b=await fe.get("/orders?include_archived=true"),ie=b?.data||b||[];console.log(" Orders loaded:",Array.isArray(ie)?ie.length:"Invalid data format","orders"),i(Array.isArray(ie)?ie:[])}catch(b){console.error(" Error loading orders:",b),Te(`Failed to load orders: ${b.message||"Unknown error"}`,"error")}finally{f(!1),F(!1)}},Re=async()=>{try{const b=await fe.get("/machines");c(b?.data||b||[])}catch(b){console.error("Error loading machines:",b)}},et=async()=>{try{const b=await fe.get("/environments");y(b?.data||b||[])}catch(b){console.error("Error loading environments:",b)}},Fe=async()=>{try{const b=await fe.get("/users?roles=operator,supervisor,admin");A(b?.data||b||[])}catch(b){console.error("Error loading operators:",b)}},Te=u.useCallback((b,ie="info")=>{se({message:b,type:ie,id:Date.now()}),setTimeout(()=>se(null),5e3)},[]),P=u.useCallback(()=>{F(!0),Pe()},[]),p=async b=>{if(b.preventDefault(),!E.product_name.trim()){Te("Product name is required","error");return}if(!E.quantity||parseInt(E.quantity)<1){Te("Quantity must be at least 1","error");return}try{f(!0);const ie={order_number:E.order_number.trim()||`ORD-${Date.now()}`,product_name:E.product_name.trim(),quantity:parseInt(E.quantity),priority:E.priority||"medium"};if(E.environment&&E.environment.trim()&&(ie.environment=E.environment.trim()),E.due_date&&(ie.due_date=E.due_date),E.specifications&&E.specifications.trim())try{ie.specifications=JSON.parse(E.specifications)}catch{ie.specifications={notes:E.specifications.trim()}}if(E.customer_info&&E.customer_info.trim())try{ie.customer_info=JSON.parse(E.customer_info)}catch{ie.customer_info={info:E.customer_info.trim()}}E.batch_number&&E.batch_number.trim()&&(ie.notes=`Batch: ${E.batch_number.trim()}`),await fe.post("/orders",ie),le(!1),It(),Te("Order created successfully","success"),Pe()}catch(ie){console.error("Error creating order:",ie),Te(ie.message||"Failed to create order","error")}finally{f(!1)}},k=async b=>{if(!b.machine_id){Te("No machine assigned to this order. Please assign a machine first.","error");return}const ie=o.find($e=>$e.machine_id===b.machine_id&&$e.id!==b.id&&$e.status==="in_progress");if(ie){Te(`Cannot start production. Machine is already running Order ${ie.order_number}. Please stop that order first.`,"error");return}if(b.start_time&&b.stop_time){const $e=new Date,ut=new Date(b.start_time),St=new Date(b.stop_time);if($e<ut){Te(`Cannot start production yet. Order is scheduled to start at ${ut.toLocaleString()}`,"error");return}if($e>St){Te(`Cannot start production. Order scheduled time has ended at ${St.toLocaleString()}`,"error");return}}try{f(!0),await fe.post(`/orders/${b.id}/start`,{machine_id:b.machine_id,operator_id:null,batch_number:b.batch_number||`BAT-${Date.now()}`,start_notes:""}),Te(`Production started for Order ${b.order_number}`,"success"),Pe(),Re()}catch($e){console.error("Error starting production:",$e),Te($e.message||"Failed to start production","error")}finally{f(!1)}},ne=async b=>{try{f(!0),await fe.post(`/orders/${b.id}/resume`),Te(`Order ${b.order_number} resumed`,"success"),Pe()}catch(ie){console.error("Error resuming production:",ie),Te(ie.message||"Failed to resume production","error")}finally{f(!1)}},Ne=b=>{Y(b),C(!0)},B=async b=>{if(b.preventDefault(),!!M)try{f(!0),await fe.post(`/orders/${M.id}/stop`,{reason:Me.reason,category:Me.category,notes:Me.notes}),C(!1),is(),Te(`Order ${M.order_number} stopped`,"error"),Pe(),Re()}catch(ie){console.error("Error stopping production:",ie),Te(ie.message||"Failed to stop production","error")}finally{f(!1)}},ue=b=>{Y(b);const ie=$e=>$e?typeof $e=="string"&&$e.match(/^\d{4}-\d{2}-\d{2}$/)?$e:$e.split("T")[0]:"";Le({machine_id:b.machine_id||"",scheduled_start_date:ie(b.scheduled_start_date)||(b.start_time?ie(b.start_time):""),scheduled_start_shift:b.scheduled_start_shift||b.shift_type||"",scheduled_end_date:ie(b.scheduled_end_date)||(b.stop_time?ie(b.stop_time):""),scheduled_end_shift:b.scheduled_end_shift||b.shift_type||"",notes:b.notes||""}),q(!0)},Ge=async b=>{try{f(!0);const ie=h.find(Ke=>Ke.id===b);if(!ie){Te("Machine not found","error");return}Se(ie);const $e=await fe.get("/orders",{include_archived:"true"}),St=($e?.data||$e||[]).filter(Ke=>{if(Ke.machine_id!==b||!Ke.scheduled_start_date&&!Ke.start_time)return!1;const ot=Ke.scheduled_start_date||(Ke.start_time?Ke.start_time.split("T")[0]:null);if(!ot)return!1;const ss=new Date().toISOString().split("T")[0],Ts=new Date;Ts.setDate(Ts.getDate()+30);const Fl=Ts.toISOString().split("T")[0];return ot>=ss&&ot<=Fl}).map(Ke=>({...Ke,display_start_date:ci(Ke.scheduled_start_date||Ke.start_time),display_end_date:ci(Ke.scheduled_end_date||Ke.stop_time),display_start_shift:Ke.scheduled_start_shift||Ke.shift_type||"N/A",display_end_shift:Ke.scheduled_end_shift||"N/A"})).sort((Ke,ot)=>{const ss=Ke.scheduled_start_date||Ke.start_time,Ts=ot.scheduled_start_date||ot.start_time;return new Date(ss)-new Date(Ts)});Ye(St),Ue(!0)}catch(ie){console.error("Error loading machine schedule:",ie),Te("Failed to load machine schedule","error")}finally{f(!1)}},Ze=async b=>{if(b.preventDefault(),!M||!oe.machine_id||!oe.scheduled_start_date||!oe.scheduled_start_shift){Te("Please select a machine, start date, and start shift","error");return}try{f(!0);const ie={day:"06:00:00",night:"18:00:00","24hr":"06:00:00"},$e=`${oe.scheduled_start_date}T${ie[oe.scheduled_start_shift]}`;let ut;if(oe.scheduled_end_date&&oe.scheduled_end_shift)ut=`${oe.scheduled_end_date}T${ie[oe.scheduled_end_shift]}`;else{const ot=new Date($e);ut=new Date(ot.getTime()+480*60*1e3).toISOString()}let St={machine_id:oe.machine_id,start_time:$e,stop_time:ut,scheduled_start_date:oe.scheduled_start_date,scheduled_start_shift:oe.scheduled_start_shift,scheduled_end_date:oe.scheduled_end_date,scheduled_end_shift:oe.scheduled_end_shift,notes:oe.notes};const Ke=o.find(ot=>{if(ot.id===M.id||ot.machine_id!==parseInt(oe.machine_id)||!ot.start_time||!ot.stop_time)return!1;const ss=new Date(ot.start_time),Ts=new Date(ot.stop_time),Fl=new Date($e),wi=new Date(ut);return Fl<Ts&&wi>ss});if(Ke){const ot=new Date(Ke.start_time).toLocaleString(),ss=new Date(Ke.stop_time).toLocaleString();Te(`Scheduling conflict! Order ${Ke.order_number} is already scheduled on this machine from ${ot} to ${ss}`,"error"),f(!1);return}await fe.put(`/orders/${M.id}`,St),q(!1),_(),Te(`Machine assigned to Order ${M.order_number}`,"success"),Pe(),Re()}catch(ie){console.error("Error assigning machine:",ie),Te(ie.message||"Failed to assign machine","error")}finally{f(!1)}},ht=async b=>{try{f(!0);const ie={actual_quantity:b.quantity,completion_notes:"Production completed successfully",waste_data:I.weight>0||I.units>0&&(I.waste_type==="PM"||I.waste_type==="FP")?I:null};await fe.post(`/orders/${b.id}/complete`,ie),ve(!1),Dt(),Te(`Order ${b.order_number} completed and archived successfully`,"success"),Pe(),Re()}catch(ie){console.error("Error completing production:",ie),Te(ie.message||"Failed to complete production","error")}finally{f(!1)}},It=()=>{R({order_number:"",product_name:"",quantity:"",priority:"medium",environment:"",due_date:"",specifications:"",customer_info:"",batch_number:""})},At=()=>{Ce({machine_id:null,operator_id:null,batch_number:"",start_notes:""})},is=()=>{He({reason:"Unplanned Stop",category:"Equipment",notes:""})},Dt=()=>{ge({waste_type:"BLND",weight:0,units:0,waste_reason:"",waste_category:"material",recovery_possible:!1,waste_notes:""})},_=()=>{Le({machine_id:"",scheduled_start_date:"",scheduled_start_shift:"",scheduled_end_date:"",scheduled_end_shift:"",notes:""})},be=(b,ie)=>h.filter($e=>$e.environment===b&&($e.status==="available"||$e.status==="idle"||$e.id===ie)),me=u.useMemo(()=>o.filter(b=>{const ie=!G.search||b.order_number?.toLowerCase().includes(G.search.toLowerCase())||b.product_name?.toLowerCase().includes(G.search.toLowerCase())||b.customer_info?.toLowerCase().includes(G.search.toLowerCase()),$e=G.environment==="all"||b.environment===G.environment,ut=G.status==="all"||b.status===G.status,St=G.priority==="all"||b.priority===G.priority,Ke=G.machine==="all"||b.machine_id?.toString()===G.machine,ot=b.archived===!0;return ie&&$e&&ut&&St&&Ke&&(N==="archive"?ot:!ot)}),[o,G,N]),ce=b=>b&&oi[b]||oi.pending,re=b=>b&&In[b]||In.medium,we=b=>{if(!b.start_time)return null;const ie=new Date(b.start_time),ut=(b.end_time?new Date(b.end_time):new Date)-ie,St=Math.floor(ut/(1e3*60*60)),Ke=Math.floor(ut%(1e3*60*60)/(1e3*60));return`${St}h ${Ke}m`},_e=b=>{if(!b||!h||!Array.isArray(h))return"Unknown";const ie=h.find($e=>$e&&$e.id===b);return ie&&ie.name?ie.name:"Unknown"},Ve=b=>{if(!b||!x||!Array.isArray(x))return b||"Unknown";const ie=x.find($e=>$e&&$e.code===b);return ie&&ie.name?ie.name:b};return j&&!v?e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-4 text-lg",children:"Loading production system..."})]}):e.jsxs("div",{className:"space-y-6 p-6 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center gap-4 bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(Et,{className:"w-8 h-8 text-blue-600"}),"Production Orders System"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Complete order lifecycle management with real-time tracking"}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(cs,{className:"w-4 h-4"}),me.length," orders"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Wt,{className:"w-4 h-4"}),o.filter(b=>b.status==="in_progress").length," active"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(qc,{className:"w-4 h-4"}),h.filter(b=>b.status==="in_use").length,"/",h.length," machines"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(nb,{}),e.jsx(el,{onClick:P,disabled:v,size:z?"sm":"md",variant:"outline",icon:Tt,className:`${v?"animate-spin":""} transition-all duration-200`,children:z?"":"Refresh"}),e.jsx(el,{onClick:()=>le(!0),size:z?"sm":"md",className:"bg-gradient-to-r from-blue-600 to-slate-700 hover:from-blue-700 hover:to-slate-800",icon:qt,children:z?"":"New Order"})]})]}),U&&e.jsx("div",{className:`p-4 rounded-lg border transition-all duration-300 ${U.type==="success"?"bg-green-50 border-green-200 text-green-800":U.type==="error"?"bg-red-50 border-red-200 text-red-800":U.type==="warning"?"bg-yellow-50 border-yellow-200 text-yellow-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:U.message}),e.jsx("button",{onClick:()=>se(null),className:"text-current hover:opacity-70 transition-opacity",children:""})]})}),H.map((b,ie)=>e.jsxs("div",{className:"p-4 rounded-lg border bg-blue-50 border-blue-200 text-blue-800 flex justify-between items-center transition-all duration-300",children:[e.jsx("span",{className:"font-medium",children:b.message}),e.jsx("button",{onClick:()=>d(b.id),className:"text-blue-600 hover:text-blue-800 transition-colors",children:""})]},ie)),e.jsx(tt,{className:"p-6 bg-white shadow-lg border border-gray-200",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(oa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search orders, products, customers...",value:G.search,onChange:b=>W(ie=>({...ie,search:b.target.value})),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>g("active"),className:`flex-1 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${N==="active"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Wt,{className:"w-4 h-4 inline mr-2"}),"Active"]}),e.jsxs("button",{onClick:()=>g("archive"),className:`flex-1 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${N==="archive"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(cs,{className:"w-4 h-4 inline mr-2"}),"Archive"]})]}),e.jsxs("select",{value:G.environment,onChange:b=>W(ie=>({...ie,environment:b.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"all",children:"All Environments"}),x.map(b=>e.jsx("option",{value:b.code,children:b.name},b.id))]}),e.jsxs("select",{value:G.status,onChange:b=>W(ie=>({...ie,status:b.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"all",children:"All Statuses"}),Object.entries(oi).map(([b,ie])=>e.jsx("option",{value:b,children:ie.label},b))]}),e.jsxs("select",{value:G.priority,onChange:b=>W(ie=>({...ie,priority:b.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"all",children:"All Priorities"}),Object.entries(In).map(([b,ie])=>e.jsx("option",{value:b,children:ie.label},b))]}),e.jsxs("select",{value:G.machine,onChange:b=>W(ie=>({...ie,machine:b.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"all",children:"All Machines"}),h.map(b=>e.jsxs("option",{value:b.id,children:[b.name," (",b.environment,")"]},b.id))]})]})]})}),e.jsxs(tt,{className:"overflow-hidden bg-white shadow-lg border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-blue-50",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 text-lg",children:[N==="archive"?"Archived Orders":"Active Orders"," (",me.length,")"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N==="archive"?"Completed and cancelled orders":"Current production orders"})]}),z?e.jsx("div",{className:"p-4 space-y-4",children:me.map(b=>{const ie=ce(b.status),$e=re(b.priority),ut=ie.icon;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 space-y-3 shadow-sm hover:shadow-md transition-shadow duration-200",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("button",{onClick:()=>ue(b),className:"font-semibold text-blue-600 hover:text-blue-800 hover:underline transition-colors duration-200 text-left",children:b.order_number}),e.jsx("p",{className:"text-sm text-gray-600",children:b.product_name}),b.customer_info&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Customer: ",typeof b.customer_info=="string"?b.customer_info:b.customer_info.company||b.customer_info.info||"N/A"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(at,{className:ie?.color||"bg-gray-100 text-gray-800 border-gray-200",children:[e.jsx(ut,{className:"w-3 h-3 mr-1"}),ie?.label||"Unknown"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Quantity:"}),e.jsx("span",{className:"ml-1 font-medium",children:b.quantity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Environment:"}),e.jsx("span",{className:"ml-1 font-medium",children:Ve(b.environment)})]}),b.machine_id&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500",children:"Machine:"}),e.jsxs("button",{onClick:()=>Ge(b.machine_id),className:"ml-1 font-medium text-blue-600 hover:text-blue-800 hover:underline transition-colors duration-200",children:[e.jsx(Wg,{className:"w-3 h-3 inline mr-1"}),_e(b.machine_id)]})]})]}),we(b)&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Hc,{className:"w-4 h-4"}),e.jsxs("span",{children:["Runtime: ",we(b)]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[e.jsx(at,{className:$e?.color||"bg-gray-100 text-gray-800 border-gray-200",children:$e?.label||"Normal"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(el,{onClick:()=>{Y(b),Be(!0)},size:"xs",variant:"outline",icon:Ps,children:"View"}),b.status==="pending"&&e.jsx(el,{onClick:()=>k(b),size:"xs",className:"bg-green-600 hover:bg-green-700",icon:Ta,children:"Start"}),b.status==="in_progress"&&e.jsx(e.Fragment,{children:e.jsx(el,{onClick:()=>Ne(b),size:"xs",className:"bg-red-600 hover:bg-red-700",icon:Hl,children:"Stop"})}),b.status==="stopped"&&e.jsx(el,{onClick:()=>ne(b),size:"xs",className:"bg-blue-600 hover:bg-blue-700",icon:Ta,children:"Resume"}),(b.status==="in_progress"||b.status==="stopped")&&e.jsx(el,{onClick:()=>{Y(b),ve(!0)},size:"xs",className:"bg-emerald-600 hover:bg-emerald-700",icon:Nt,children:"Complete"})]})]})]},b.id)})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Info"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Machine"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progress"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:me.map(b=>{const ie=ce(b.status),$e=re(b.priority),ut=ie.icon;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("button",{onClick:()=>ue(b),className:"font-medium text-blue-600 hover:text-blue-800 hover:underline transition-colors duration-200",children:b.order_number}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Qty: ",b.quantity," | ",Ve(b.environment)]}),e.jsx(at,{className:`mt-1 ${$e?.color||"bg-gray-100 text-gray-800 border-gray-200"}`,children:$e?.label||"Normal"})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900",children:b.product_name}),b.customer_info&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Customer: ",typeof b.customer_info=="string"?b.customer_info:b.customer_info.company||b.customer_info.info||"N/A"]})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs(at,{className:ie?.color||"bg-gray-100 text-gray-800 border-gray-200",children:[e.jsx(ut,{className:"w-4 h-4 mr-1"}),ie?.label||"Unknown"]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:ie?.description||"Status information"}),e.jsxs("div",{className:"space-y-1 mt-2",children:[b.start_time&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600",children:[e.jsx(Hc,{className:"w-3 h-3 mr-1"}),we(b)]}),b.due_date&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600",children:[e.jsx(xs,{className:"w-3 h-3 mr-1"}),"Due: ",ci(b.due_date)]})]})]}),e.jsx("td",{className:"px-6 py-4",children:b.machine_id?e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(qc,{className:"w-4 h-4 mr-2 text-blue-600"}),e.jsx("button",{onClick:()=>Ge(b.machine_id),className:"font-medium text-blue-600 hover:text-blue-800 hover:underline transition-colors duration-200",children:_e(b.machine_id)})]}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Not assigned"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-1",children:[b.status==="in_progress"&&b.quantity&&e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"60%"}})}),b.status==="pending"&&!b.machine_id&&e.jsx("span",{className:"text-amber-600 text-xs",children:"Awaiting machine assignment"}),b.status==="assigned"&&e.jsx("span",{className:"text-blue-600 text-xs",children:"Ready to start"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{onClick:()=>{Y(b),Be(!0)},size:"sm",variant:"outline",children:e.jsx(Ps,{className:"w-4 h-4"})}),b.status==="pending"&&!b.machine_id&&e.jsxs(Oe,{onClick:()=>{Y(b),q(!0)},size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Pt,{className:"w-4 h-4 mr-1"}),"Assign Machine"]}),b.status==="pending"&&b.machine_id&&e.jsxs(Oe,{onClick:()=>k(b),size:"sm",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Ta,{className:"w-4 h-4 mr-1"}),"Start"]}),b.status==="in_progress"&&e.jsx(e.Fragment,{children:e.jsxs(Oe,{onClick:()=>Ne(b),size:"sm",className:"bg-red-600 hover:bg-red-700",children:[e.jsx(Hl,{className:"w-4 h-4 mr-1"}),"Stop"]})}),b.status==="stopped"&&e.jsxs(Oe,{onClick:()=>ne(b),size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Ta,{className:"w-4 h-4 mr-1"}),"Resume"]}),(b.status==="in_progress"||b.status==="stopped")&&e.jsxs(Oe,{onClick:()=>{Y(b),ve(!0)},size:"sm",className:"bg-emerald-600 hover:bg-emerald-700",children:[e.jsx(Nt,{className:"w-4 h-4 mr-1"}),"Complete"]})]})})]},b.id)})})]})}),me.length===0&&e.jsxs("div",{className:"p-12 text-center text-gray-500",children:[e.jsx(cs,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters or create a new order to get started"})]})]}),Z&&e.jsx(Mt,{title:"Create New Production Order",onClose:()=>{le(!1),It()},size:"large",children:e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Order Number"}),e.jsx("input",{type:"text",value:E.order_number,onChange:b=>R({...E,order_number:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Auto-generated if empty"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity *"}),e.jsx("input",{type:"number",value:E.quantity,onChange:b=>R({...E,quantity:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0,min:"1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Name *"}),e.jsx("input",{type:"text",value:E.product_name,onChange:b=>R({...E,product_name:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0,placeholder:"Enter product name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsx("select",{value:E.priority,onChange:b=>R({...E,priority:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:Object.entries(In).map(([b,ie])=>e.jsx("option",{value:b,children:ie.label},b))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Environment *"}),e.jsxs("select",{value:E.environment,onChange:b=>R({...E,environment:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0,children:[e.jsx("option",{value:"",children:"Select Environment"}),x.map(b=>e.jsx("option",{value:b.code,children:b.name},b.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date"}),e.jsx("input",{type:"datetime-local",value:E.due_date,onChange:b=>R({...E,due_date:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer Information"}),e.jsx("input",{type:"text",value:E.customer_info,onChange:b=>R({...E,customer_info:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Customer name or reference"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Batch Number"}),e.jsx("input",{type:"text",value:E.batch_number,onChange:b=>R({...E,batch_number:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:`BAT-${Date.now()}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Specifications"}),e.jsx("textarea",{value:E.specifications,onChange:b=>R({...E,specifications:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",rows:"4",placeholder:"Product specifications, requirements, or notes..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsx(Oe,{type:"submit",className:"flex-1 bg-gradient-to-r from-blue-600 to-slate-700 hover:from-blue-700 hover:to-slate-800",disabled:j,children:j?"Creating...":"Create Order"}),e.jsx(Oe,{type:"button",onClick:()=>{le(!1),It()},variant:"outline",className:"px-8",children:"Cancel"})]})]})}),je&&M&&e.jsx(Mt,{title:`Start Production - ${M.order_number}`,onClose:()=>{Ee(!1),At()},size:"large",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Order Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700",children:"Product:"}),e.jsx("span",{className:"ml-2 font-medium",children:M.product_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700",children:"Quantity:"}),e.jsx("span",{className:"ml-2 font-medium",children:M.quantity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700",children:"Assigned Machine:"}),e.jsx("span",{className:"ml-2 font-medium",children:M.machine_id?_e(M.machine_id):"Not Assigned"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700",children:"Priority:"}),e.jsx(at,{className:re(M.priority)?.color||"bg-gray-100 text-gray-800 border-gray-200",children:re(M.priority)?.label||"Normal"})]})]})]}),!M.machine_id&&e.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:e.jsxs("p",{className:"text-yellow-800 text-sm",children:[e.jsx(gt,{className:"w-4 h-4 inline mr-2"}),"No machine assigned to this order. Please assign a machine before starting production."]})}),M.machine_id&&e.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:e.jsxs("p",{className:"text-green-800 text-sm",children:[e.jsx(Nt,{className:"w-4 h-4 inline mr-2"}),"Machine assigned! Operators will be assigned through the Labor Planner."]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Batch Number"}),e.jsx("input",{type:"text",value:Q.batch_number,onChange:b=>Ce(ie=>({...ie,batch_number:b.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:`BAT-${Date.now()}`})]}),e.jsx("div",{})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Notes"}),e.jsx("textarea",{value:Q.start_notes,onChange:b=>Ce(ie=>({...ie,start_notes:b.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",rows:"3",placeholder:"Pre-production notes, setup information, or special instructions..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsxs(Oe,{onClick:()=>k(M),disabled:!M.machine_id||j,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700",children:[e.jsx(Ta,{className:"w-4 h-4 mr-2"}),j?"Starting Production...":"Start Production"]}),e.jsx(Oe,{onClick:()=>{Ee(!1),At()},variant:"outline",className:"px-8",children:"Cancel"})]})]})}),D&&M&&e.jsx(Mt,{title:`Complete Production - ${M.order_number}`,onClose:()=>{ve(!1),Dt()},size:"large",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Production Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700",children:"Order:"}),e.jsx("span",{className:"ml-2 font-medium",children:M.order_number})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700",children:"Product:"}),e.jsx("span",{className:"ml-2 font-medium",children:M.product_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700",children:"Target Quantity:"}),e.jsx("span",{className:"ml-2 font-medium",children:M.quantity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700",children:"Runtime:"}),e.jsx("span",{className:"ml-2 font-medium",children:we(M)||"Calculating..."})]})]})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[e.jsxs("h4",{className:"font-medium text-orange-900 mb-3 flex items-center",children:[e.jsx(gt,{className:"w-5 h-5 mr-2"}),"Material Waste Tracking"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Waste Type"}),e.jsxs("select",{value:I.waste_type||"BLND",onChange:b=>ge(ie=>({...ie,waste_type:b.target.value,waste_category:"material"})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"BLND",children:"BLND"}),e.jsx("option",{value:"RM",children:"RM"}),e.jsx("option",{value:"PM",children:"PM"}),e.jsx("option",{value:"FP",children:"FP"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Weight (kg)"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:I.weight||0,onChange:b=>ge(ie=>({...ie,weight:parseFloat(b.target.value)||0})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Enter weight"})]}),(I.waste_type==="PM"||I.waste_type==="FP")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Units"}),e.jsx("input",{type:"number",min:"0",step:"1",value:I.units||0,onChange:b=>ge(ie=>({...ie,units:parseInt(b.target.value)||0})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Enter units"})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Waste Reason"}),e.jsx("input",{type:"text",value:I.waste_reason||"",onChange:b=>ge(ie=>({...ie,waste_reason:b.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Brief description of waste cause"})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:I.recovery_possible||!1,onChange:b=>ge(ie=>({...ie,recovery_possible:b.target.checked})),className:"mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Material recovery possible"})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes"}),e.jsx("textarea",{value:I.waste_notes||"",onChange:b=>ge(ie=>({...ie,waste_notes:b.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",rows:"2",placeholder:"Additional details about material waste..."})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsxs(Oe,{onClick:()=>ht(M),disabled:j,className:"flex-1 bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-700 hover:to-green-700",children:[e.jsx(Nt,{className:"w-4 h-4 mr-2"}),j?"Completing Production...":"Complete Production"]}),e.jsx(Oe,{onClick:()=>{ve(!1),Dt()},variant:"outline",className:"px-8",children:"Cancel"})]})]})}),ke&&M&&e.jsx(Mt,{title:`Order Details - ${M.order_number||"Unknown"}`,onClose:()=>{Be(!1),Y(null)},size:"fullscreen",children:e.jsxs("div",{className:"p-6 bg-white h-full",children:[e.jsx("div",{className:"mb-6 pb-4 border-b border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-1",children:M.product_name||"Unknown Product"}),e.jsxs("p",{className:"text-lg text-gray-700",children:["Order #",M.order_number||"Unknown"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(at,{className:(ce(M.status)?.color||"bg-gray-100 text-gray-800 border-gray-200")+" px-3 py-1 text-sm font-semibold",children:ce(M.status)?.label||"Unknown"}),e.jsx(at,{className:(re(M.priority)?.color||"bg-gray-100 text-gray-800 border-gray-200")+" px-3 py-1 text-sm font-semibold",children:re(M.priority)?.label||"Normal"}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsx("div",{className:"text-gray-500",children:"Created"}),e.jsx("div",{className:"font-semibold",children:ci(M.created_at)})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 h-full",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-blue-600 mb-4 border-b border-blue-200 pb-2",children:"Order Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Status:"}),e.jsx(at,{className:(ce(M.status)?.color||"bg-gray-100 text-gray-800 border-gray-200")+" px-2 py-1 text-xs",children:ce(M.status)?.label||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Target Qty:"}),e.jsx("span",{className:"font-bold text-green-600",children:M.quantity||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Actual Qty:"}),e.jsx("span",{className:"font-bold text-blue-600",children:M.actual_quantity||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Machine:"}),e.jsx("span",{className:"text-gray-900",children:M.machine_id?_e(M.machine_id):"Not Assigned"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Operator:"}),e.jsx("span",{className:"text-gray-900",children:M.operator_id?`#${M.operator_id}`:"Not Assigned"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Environment:"}),e.jsx("span",{className:"text-gray-900",children:Ve(M.environment)})]}),M.batch_number&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Batch:"}),e.jsx("span",{className:"text-gray-900",children:M.batch_number})]})]}),e.jsx("h4",{className:"text-lg font-bold text-blue-600 mt-6 mb-4 border-b border-blue-200 pb-2",children:"Timeline"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Created:"}),e.jsx("span",{className:"text-gray-900",children:M.created_at?new Date(M.created_at).toLocaleString():"Unknown"})]}),M.start_time&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Started:"}),e.jsx("span",{className:"text-gray-900",children:new Date(M.start_time).toLocaleString()})]}),M.complete_time&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Completed:"}),e.jsx("span",{className:"text-gray-900",children:new Date(M.complete_time).toLocaleString()})]}),M.stop_time&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-red-700",children:"Stopped:"}),e.jsx("span",{className:"text-red-900",children:new Date(M.stop_time).toLocaleString()})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-red-600 mb-4 border-b border-red-200 pb-2",children:"Downtime History & Issues"}),e.jsx(Mb,{orderId:M.id}),e.jsx("h4",{className:"text-lg font-bold text-orange-600 mt-6 mb-4 border-b border-orange-200 pb-2",children:"Waste Management"}),M.waste_quantity?e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Type:"}),e.jsx("span",{className:"font-bold text-orange-700",children:typeof M.waste_type=="string"?M.waste_type:"Material"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Quantity:"}),e.jsx("span",{className:"font-bold text-red-600",children:typeof M.waste_quantity=="number"||typeof M.waste_quantity=="string"?M.waste_quantity:"0"})]}),M.waste_notes&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Notes:"}),e.jsx("p",{className:"text-gray-900 mt-1",children:typeof M.waste_notes=="string"?M.waste_notes:"No waste notes available"})]})]})}):e.jsx("div",{className:"text-center text-gray-500 italic py-4",children:"No waste recorded"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-green-600 mb-4 border-b border-green-200 pb-2",children:"Production Notes"}),M.notes?e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-6",children:e.jsx("p",{className:"text-gray-900 text-sm whitespace-pre-wrap leading-relaxed",children:typeof M.notes=="string"?M.notes:"No notes available"})}):e.jsx("div",{className:"text-center text-gray-500 italic py-4 mb-6",children:"No production notes available"}),M.specifications&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-bold text-slate-600 mb-2 border-b border-slate-200 pb-1",children:"Specifications"}),e.jsx("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-3",children:e.jsx("p",{className:"text-gray-900 text-sm whitespace-pre-wrap",children:typeof M.specifications=="string"?M.specifications:M.specifications?.notes||JSON.stringify(M.specifications,null,2)})})]}),M.customer_info&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-bold text-indigo-600 mb-2 border-b border-indigo-200 pb-1",children:"Customer Info"}),e.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-3",children:e.jsx("p",{className:"text-gray-900 text-sm whitespace-pre-wrap",children:typeof M.customer_info=="string"?M.customer_info:M.customer_info?.company||M.customer_info?.info||JSON.stringify(M.customer_info,null,2)})})]}),e.jsx("div",{className:"mt-auto pt-4",children:e.jsx(Oe,{onClick:()=>{Be(!1),Y(null)},className:"w-full bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-700 hover:to-indigo-800 text-white py-3 font-semibold rounded-lg shadow-md hover:shadow-lg transition-all duration-200",children:"Close Details"})})]})]})]})}),$&&M&&e.jsx(Mt,{title:`Stop Production - Order ${M.order_number}`,onClose:()=>{C(!1),Y(null),is()},size:"medium",children:e.jsxs("form",{onSubmit:B,className:"space-y-6 p-6",children:[e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Hl,{className:"h-8 w-8 text-red-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-900",children:"Stop Production"}),e.jsxs("p",{className:"text-sm text-red-700",children:["You are about to stop production for ",e.jsx("strong",{children:M.product_name})]})]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Stop Reason ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:Me.reason,onChange:b=>He({...Me,reason:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 text-lg",required:!0,children:[e.jsx("option",{value:"Planned Stop",children:" Planned Stop"}),e.jsx("option",{value:"Unplanned Stop",children:" Unplanned Stop"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Stop Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:Me.category,onChange:b=>He({...Me,category:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 text-lg",required:!0,children:[e.jsx("option",{value:"Equipment",children:" Equipment"}),e.jsx("option",{value:"Material",children:" Material"}),e.jsx("option",{value:"Quality",children:" Quality"}),e.jsx("option",{value:"Changeover",children:" Changeover"}),e.jsx("option",{value:"Break",children:" Break"}),e.jsx("option",{value:"Safety",children:" Safety"}),e.jsx("option",{value:"Utilities",children:" Utilities"}),e.jsx("option",{value:"Maintenance",children:" Maintenance"}),e.jsx("option",{value:"Other",children:" Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Additional Notes"}),e.jsx("textarea",{value:Me.notes,onChange:b=>He({...Me,notes:b.target.value}),placeholder:"Provide additional details about the stop reason...",rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[e.jsx(Oe,{type:"button",onClick:()=>{C(!1),Y(null),is()},className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-semibold",children:"Cancel"}),e.jsxs(Oe,{type:"submit",disabled:j,className:"px-8 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold flex items-center gap-2 disabled:opacity-50",children:[e.jsx(Hl,{className:"w-5 h-5"}),j?"Stopping...":"Stop Production"]})]})]})}),O&&M&&e.jsx(Mt,{title:`${oe.machine_id?"Edit Schedule":"Assign Machine"} - Order ${M.order_number}`,onClose:()=>{q(!1),Y(null),_()},size:"large",children:e.jsxs("form",{onSubmit:Ze,className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-2",children:"Order Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Product:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:M.product_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Quantity:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:M.quantity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Environment:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:Ve(M.environment)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Priority:"}),e.jsx(at,{className:`ml-2 ${re(M.priority)?.color||"bg-gray-100 text-gray-800 border-gray-200"}`,children:re(M.priority)?.label||"Normal"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Machine *"}),e.jsxs("select",{value:oe.machine_id,onChange:b=>Le({...oe,machine_id:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0,children:[e.jsx("option",{value:"",children:"Select Machine"}),be(M.environment,parseInt(oe.machine_id)).map(b=>e.jsxs("option",{value:b.id,children:[b.name," (",b.type,") - ",b.status,b.id===parseInt(oe.machine_id)?" (Currently Assigned)":""]},b.id))]}),be(M.environment,parseInt(oe.machine_id)).length===0&&e.jsxs("p",{className:"text-red-600 text-sm mt-1",children:["No machines available in ",Ve(M.environment)," environment"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Start Schedule"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date *"}),e.jsx("input",{type:"date",value:oe.scheduled_start_date,onChange:b=>Le({...oe,scheduled_start_date:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Shift *"}),e.jsxs("select",{value:oe.scheduled_start_shift,onChange:b=>Le({...oe,scheduled_start_shift:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0,children:[e.jsx("option",{value:"",children:"Select Shift"}),e.jsx("option",{value:"day",children:"Day Shift (06:00 - 18:00)"}),e.jsx("option",{value:"night",children:"Night Shift (18:00 - 06:00)"}),e.jsx("option",{value:"24hr",children:"24Hr Shift (Full Day)"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"End Schedule (Optional)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:oe.scheduled_end_date,onChange:b=>Le({...oe,scheduled_end_date:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Shift"}),e.jsxs("select",{value:oe.scheduled_end_shift,onChange:b=>Le({...oe,scheduled_end_shift:b.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"",children:"Select Shift"}),e.jsx("option",{value:"day",children:"Day Shift (06:00 - 18:00)"}),e.jsx("option",{value:"night",children:"Night Shift (18:00 - 06:00)"}),e.jsx("option",{value:"24hr",children:"24Hr Shift (Full Day)"})]})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"If not specified, defaults to 8 hours from start time"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Notes"}),e.jsx("textarea",{value:oe.notes,onChange:b=>Le({...oe,notes:b.target.value}),placeholder:"Optional notes about this machine assignment...",rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 resize-none"})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsx(Oe,{type:"button",onClick:()=>{q(!1),Y(null),_()},variant:"outline",className:"px-8",children:"Cancel"}),e.jsx(Oe,{type:"submit",disabled:!oe.machine_id||!oe.scheduled_start_date||!oe.scheduled_start_shift||j,className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",children:j?oe.machine_id?"Updating...":"Assigning...":oe.machine_id?"Update Schedule":"Assign Machine"})]})]})}),ye&&pe&&e.jsx(Mt,{title:`Schedule - ${pe.name} (${pe.type})`,onClose:()=>{Ue(!1),Se(null),Ye([])},size:"large",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-2",children:"Machine Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Name:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:pe.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Type:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:pe.type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Status:"}),e.jsx(at,{className:`ml-2 ${pe.status==="operational"?"bg-green-100 text-green-800 border-green-200":"bg-gray-100 text-gray-800 border-gray-200"}`,children:pe.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Environment:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:Ve(pe.environment_id)})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:["Upcoming Schedule (",ze.length," orders)"]}),ze.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xs,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No scheduled orders found for the next 30 days"})]}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:ze.map(b=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>ue(b),className:"font-medium text-blue-600 hover:text-blue-800 hover:underline transition-colors duration-200",children:b.order_number}),e.jsx(at,{className:ce(b.status)?.color||"bg-gray-100 text-gray-800 border-gray-200",children:ce(b.status)?.label||b.status})]}),e.jsx("span",{className:"text-sm text-gray-500",children:b.product_name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Start:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[b.display_start_date," (",b.display_start_shift,")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"End:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[b.display_end_date," (",b.display_end_shift,")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Quantity:"}),e.jsx("span",{className:"ml-1 font-medium",children:b.quantity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Priority:"}),e.jsx(at,{className:`ml-1 ${re(b.priority)?.color||"bg-gray-100 text-gray-800 border-gray-200"}`,children:re(b.priority)?.label||"Normal"})]})]})]},b.id))})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:e.jsx(Oe,{type:"button",onClick:()=>{Ue(!1),Se(null),Ye([])},variant:"outline",className:"px-8",children:"Close"})})]})})]})}const Ut=o=>{if(!o)return"Unknown";const i=o.employee_name||o.fullName||o.username||"Unknown";if(i&&/[A-Z]/.test(i))return i;if(!i)return"Unknown";const h=i.split(" ").filter(x=>x.length>0);return h.length===0?i:h.map((x,y)=>y===0||y===h.length-1?x.charAt(0).toUpperCase()+x.slice(1).toLowerCase():x.toLowerCase()).join(" ")},Il=o=>{if(!o)return"N/A";if(typeof o=="string"&&o.toUpperCase().startsWith("EMP")){const i=o.replace(/^EMP0*/i,"");if(/^\d+$/.test(i))return i}return o.toString()};function Eb(){const[o,i]=u.useState([]),[h,c]=u.useState([]),[x,y]=u.useState([]),[S,A]=u.useState(!0),[j,f]=u.useState(!1),[v,F]=u.useState("all"),[U,se]=u.useState(""),[G,W]=u.useState("all"),[N,g]=u.useState(null);sl(),sd();const{notifications:M,clearNotification:Y}=Wn(),[Z,le]=u.useState(!1),[ke,Be]=u.useState(!1),[je,Ee]=u.useState(!1),[D,ve]=u.useState(!1),[ee,Ae]=u.useState(null),[$,C]=u.useState({name:"",type:"",environment:"",capacity:100,production_rate:60,shift_cycle_enabled:!1,cycle_start_date:"",operators_per_shift:2,hopper_loaders_per_shift:1,packers_per_shift:3}),[O,q]=u.useState([{letter:"A",offset:0,employees:[]},{letter:"B",offset:2,employees:[]},{letter:"C",offset:4,employees:[]}]),[z,H]=u.useState([]),[d,T]=u.useState(!1),[E,R]=u.useState([]),[Q,Ce]=u.useState(!1);u.useEffect(()=>{h.length>0&&!$.environment&&C(p=>({...p,environment:h[0].code}))},[h,$.environment]);const Me=u.useMemo(()=>{const p={};return Array.isArray(h)&&h.forEach(k=>{let ne=[];try{ne=typeof k.machine_types=="string"?JSON.parse(k.machine_types):k.machine_types||[]}catch(Ne){console.error("Failed to parse machine types for environment:",k.name,Ne),ne=[]}p[k.code]=x.filter(Ne=>ne.includes(Ne.name)).map(Ne=>({id:Ne.id,name:Ne.name,description:Ne.description}))}),p},[h,x]),He={available:{symbol:"",label:"RDY",bg:"bg-slate-800",text:"text-green-400",border:"border-slate-600",indicator:"bg-green-400"},in_use:{symbol:"",label:"RUN",bg:"bg-slate-800",text:"text-blue-400",border:"border-slate-600",indicator:"bg-blue-400"},maintenance:{symbol:"",label:"MNT",bg:"bg-slate-800",text:"text-yellow-400",border:"border-slate-600",indicator:"bg-yellow-400"},offline:{symbol:"",label:"OFF",bg:"bg-slate-800",text:"text-red-400",border:"border-slate-600",indicator:"bg-red-400"}},I=(p,k="success")=>{g({message:p,type:k}),setTimeout(()=>g(null),3e3)},ge=async()=>{try{const p=await fe.get("/environments"),k=p?.data||p||[];console.log(" Environments loaded in machines.jsx:",Array.isArray(k)?k.length:"Invalid data format",k),c(Array.isArray(k)?k:[])}catch(p){console.error("Failed to load environments:",p),I("Failed to load environments","danger")}},oe=async()=>{try{const p=await fe.get("/machine-types"),k=p?.data||p||[];console.log(" Machine types loaded:",Array.isArray(k)?k.length:"Invalid data format",k),y(Array.isArray(k)?k:[])}catch(p){console.error("Failed to load machine types:",p),I("Failed to load machine types","danger")}},Le=async p=>{try{const k={name:p,description:"Created during machine setup",category:"Production"};await fe.post("/machine-types",k),oe(),I(`Machine type "${p}" created successfully`)}catch(k){console.error("Error creating machine type:",k),I(`Failed to create machine type "${p}": `+(k.response?.data?.error||k.message),"danger")}},ye=async(p=!1)=>{p?f(!0):A(!0);try{console.log(" Loading machines...");const k=await fe.get("/machines"),ne=k?.data||k||[];console.log(" Raw machines response:",k),console.log(" Processed machines data:",ne),console.log(" Machines loaded successfully:",Array.isArray(ne)?ne.length:"Invalid data format","machines"),i(Array.isArray(ne)?ne:[])}catch(k){console.error(" Failed to load machines:",k);let ne="Failed to load machines";k.message.includes("Unexpected token")?ne="Authentication error - please refresh the page and try again":k.message.includes("unauthorized")||k.message.includes("Session expired")?ne="Your session has expired. Please log in again.":k.response?.status===500?ne="Server error - please try again later":ne=`Failed to load machines: ${k.message}`,I(ne,"danger")}finally{A(!1),f(!1)}},Ue=async()=>{T(!0);try{const p=await fe.get("/users"),k=p?.data?.data||p?.data||[];console.log(" Users loaded in machines.jsx:",k);const ne=k.map(Ne=>({id:Ne.id,name:Ut(Ne),employee_code:Il(Ne.employee_code),role:Ne.role,is_active:Ne.is_active})).filter(Ne=>Ne.is_active!==!1);H(ne)}catch(p){console.error("Failed to load employees:",p),console.error("Error details:",p.message,p.response),H([]),p.message.includes("unauthorized")||p.message.includes("Session expired")?I("Please log in to manage crew assignments","danger"):I(`Failed to load employees: ${p.message}. You can still configure shift cycles without employee assignments.`,"danger")}finally{T(!1)}},pe=async p=>{try{const k=await fe.get(`/machines/${p}/crews`);k.length>0?q(k):q([{letter:"A",offset:0,employees:[]},{letter:"B",offset:2,employees:[]},{letter:"C",offset:4,employees:[]}])}catch(k){console.error("Failed to load crews:",k)}},Se=async p=>{Ce(!0);try{const k=new Date;k.setDate(k.getDate()+14);const ne=new Date;ne.setDate(ne.getDate()-7);const Ne=await fe.get("/orders",{params:{machine_id:p,include_scheduled:!0}}),B={};(Array.isArray(Ne)||Ne.data&&Array.isArray(Ne.data))&&(Array.isArray(Ne)?Ne:Ne.data).forEach(Ge=>{if(Ge.machine_id===p&&Ge.scheduled_start_date){const Ze=Ge.scheduled_start_date,ht=Ge.scheduled_end_date||Ze,It=new Date(Ze),At=new Date(ht);for(let is=new Date(It);is<=At;is.setDate(is.getDate()+1)){const Dt=is.toISOString().split("T")[0];B[Dt]||(B[Dt]={day:[],night:[],orders:[]});const _=Dt===Ze,be=Dt===ht;_&&Ge.scheduled_start_shift&&B[Dt][Ge.scheduled_start_shift].push({type:"order",...Ge}),be&&Ge.scheduled_end_shift&&Ge.scheduled_end_shift!==Ge.scheduled_start_shift&&B[Dt][Ge.scheduled_end_shift].push({type:"order",...Ge}),!_&&!be&&(B[Dt].day.push({type:"order_running",...Ge}),B[Dt].night.push({type:"order_running",...Ge})),B[Dt].orders.push(Ge)}}}),R(B)}catch(k){console.error("Failed to load machine schedule:",k),R({})}finally{Ce(!1)}},ze=()=>{ye(!0)},Ye=async p=>{try{await fe.post(`/machines/${p}/crews`,{crews:O}),I("Crew assignments saved successfully")}catch(k){console.error("Failed to save crew assignments:",k),I("Failed to save crew assignments: "+(k.message||"Unknown error"),"danger")}};u.useEffect(()=>{if(!localStorage.getItem("token")){console.warn(" No authentication token found - user needs to log in"),g({message:"Please log in to access machine data",type:"warning"}),A(!1);return}ge(),oe(),ye(),Ue();const k=setInterval(()=>{console.log(" Periodic refresh - reloading machines data"),ye()},3e4);return()=>clearInterval(k)},[]),_t("machine_status_changed",p=>{console.log(" Machine status changed:",p.data),i(k=>k.map(ne=>ne.id===p.data.machine_id?{...ne,status:p.data.status,updated_at:new Date().toISOString()}:ne)),I(`Machine ${p.data.machine_name} status changed to ${p.data.status}`,"info")},[]),_t("machine_created",p=>{console.log(" New machine added:",p.data),i(k=>[...k,p.data.machine]),I(`New machine "${p.data.machine.name}" added`,"success")},[]),_t("machine_updated",p=>{console.log(" Machine updated:",p),i(k=>k.map(ne=>ne.id===p.id?p:ne)),I(`Machine "${p.name}" updated`,"info")},[]),_t("machine_deleted",p=>{console.log(" Machine deleted:",p.data),i(k=>k.filter(ne=>ne.id!==p.data.machine_id)),I("Machine deleted","warning")},[]),u.useEffect(()=>{window.EnhancedWebSocketService?.isConnected()&&window.EnhancedWebSocketService.subscribe(["machines","production"])},[]),u.useEffect(()=>{Array.isArray(M)&&M.forEach(p=>{p.type==="alert"&&p.message.includes("machine")&&(I(p.message,"danger"),Y(p.id))})},[M]);const Qe=async p=>{p.preventDefault();try{const k={name:$.name,type:$.type,environment:$.environment,capacity:parseInt($.capacity)||100,production_rate:parseFloat($.production_rate)||60,operators_per_shift:parseInt($.operators_per_shift)||2,hopper_loaders_per_shift:parseInt($.hopper_loaders_per_shift)||1,packers_per_shift:parseInt($.packers_per_shift)||3,shift_cycle_enabled:!!$.shift_cycle_enabled,cycle_start_date:$.cycle_start_date||null};await fe.post("/machines",k),le(!1),ye(),I("Machine added successfully")}catch(k){I("Failed to add machine: "+(k.message||"Unknown error"),"danger")}},Pe=async p=>{p.preventDefault();try{const k={name:$.name,type:$.type,environment:$.environment,capacity:parseInt($.capacity)||100,production_rate:parseFloat($.production_rate)||60,operators_per_shift:parseInt($.operators_per_shift)||2,hopper_loaders_per_shift:parseInt($.hopper_loaders_per_shift)||1,packers_per_shift:parseInt($.packers_per_shift)||3,shift_cycle_enabled:!!$.shift_cycle_enabled,cycle_start_date:$.cycle_start_date||null};await fe.put(`/machines/${ee.id}`,k),$.shift_cycle_enabled&&await Ye(ee.id),Be(!1),ye(),I("Machine updated successfully")}catch(k){I("Failed to update machine: "+(k.message||"Unknown error"),"danger")}},Re=async p=>{if(window.confirm("Are you sure you want to delete this machine?"))try{await fe.delete(`/machines/${p}`),ye(),I("Machine deleted successfully")}catch(k){I("Failed to delete machine: "+(k.message||"Unknown error"),"danger")}},et=async p=>{try{await fe.patch(`/machines/${ee.id}/status`,{status:p}),Ee(!1),ye(),I(`Machine status changed to ${p}`)}catch(k){I("Failed to update status: "+(k.message||"Unknown error"),"danger")}},Fe=u.useMemo(()=>{let p=Array.isArray(o)?o:[];return v!=="all"&&(p=p.filter(k=>k.environment===v)),G!=="all"&&(p=p.filter(k=>k.status===G)),U&&(p=p.filter(k=>k.name.toLowerCase().includes(U.toLowerCase())||k.type.toLowerCase().includes(U.toLowerCase()))),p},[o,v,G,U]),Te=u.useMemo(()=>{const p=Array.isArray(o)?o:[],k=p.length,ne=p.filter(Ze=>Ze.status==="available").length,Ne=p.filter(Ze=>Ze.status==="in_use").length,B=p.filter(Ze=>Ze.status==="maintenance").length,ue=p.filter(Ze=>Ze.status==="offline").length,Ge=k>0?Math.round(Ne/k*100):0;return{total:k,available:ne,inUse:Ne,maintenance:B,offline:ue,utilizationRate:Ge}},[o]),P=p=>{const k=He[p]||He.offline;return e.jsxs("div",{className:`inline-flex items-center px-3 py-1 text-xs font-bold font-mono ${k.bg} ${k.text} border ${k.border}`,children:[e.jsx("span",{className:"mr-2",children:k.symbol}),k.label]})};return S&&o.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-12 text-center shadow-xl",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-lg flex items-center justify-center mx-auto mb-6",children:e.jsx(J0,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{className:"flex items-center justify-center gap-3 text-white mb-4",children:[e.jsx(Tt,{className:"w-6 h-6 animate-spin text-blue-400"}),e.jsx("span",{className:"text-xl font-bold",children:"INITIALIZING SYSTEM..."})]}),e.jsx("div",{className:"w-64 bg-slate-700 rounded-full h-2 mx-auto",children:e.jsx("div",{className:"bg-blue-400 h-2 rounded-full animate-pulse",style:{width:"60%"}})}),e.jsx("p",{className:"text-slate-400 mt-4 font-mono text-sm",children:"Loading production equipment data"})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[N&&e.jsx("div",{className:"fixed top-6 right-6 z-50",children:e.jsx("div",{className:`p-4 rounded-lg shadow-xl border-l-4 backdrop-blur-sm ${N.type==="success"?"bg-slate-800/95 text-green-400 border-green-500":N.type==="danger"?"bg-slate-800/95 text-red-400 border-red-500":"bg-slate-800/95 text-blue-400 border-blue-500"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full animate-pulse ${N.type==="success"?"bg-green-400":N.type==="danger"?"bg-red-400":"bg-blue-400"}`}),e.jsx("span",{className:"font-mono text-sm font-medium",children:N.message})]})})}),e.jsx("div",{className:"bg-slate-800 border-b border-slate-600 shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx(J0,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-white font-mono",children:"PRODUCTION CONTROL HMI"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-green-400 text-sm font-medium font-mono",children:"ONLINE"})]}),e.jsx(vi,{})]}),e.jsx("p",{className:"text-slate-400 mt-1 font-mono text-xs",children:"REAL-TIME EQUIPMENT MONITORING SYSTEM"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-slate-700 rounded-lg border border-slate-600",children:[e.jsx(Zt,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-slate-300 text-sm font-mono",children:new Date().toLocaleTimeString()})]}),e.jsxs(Oe,{onClick:ze,disabled:j,className:"bg-slate-700 hover:bg-slate-600 text-white border-slate-600",children:[e.jsx(Tt,{className:`w-4 h-4 mr-2 ${j?"animate-spin":""}`}),"Refresh"]}),e.jsxs(Oe,{onClick:()=>{C({name:"",type:"",environment:"blending",capacity:100,production_rate:60}),le(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(qt,{className:"w-4 h-4 mr-2"}),"Add Machine"]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[e.jsx("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-4 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"TOTAL UNITS"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:Te.total})]}),e.jsx("div",{className:"w-10 h-10 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(Et,{className:"w-5 h-5 text-slate-300"})})]})}),e.jsxs("div",{className:"bg-slate-800 border border-green-500/30 rounded-lg p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-400 text-sm font-medium",children:"AVAILABLE"}),e.jsx("p",{className:"text-3xl font-bold text-green-400",children:Te.available})]}),e.jsx("div",{className:"w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Nt,{className:"w-5 h-5 text-green-400"})})]}),e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-1 mt-2",children:e.jsx("div",{className:"bg-green-400 h-1 rounded-full animate-pulse",style:{width:`${Te.total>0?Te.available/Te.total*100:0}%`}})})]}),e.jsxs("div",{className:"bg-slate-800 border border-blue-500/30 rounded-lg p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-400 text-sm font-medium",children:"ACTIVE"}),e.jsx("p",{className:"text-3xl font-bold text-blue-400",children:Te.inUse})]}),e.jsx("div",{className:"w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Wt,{className:"w-5 h-5 text-blue-400 animate-bounce"})})]}),e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-1 mt-2",children:e.jsx("div",{className:"bg-blue-400 h-1 rounded-full",style:{width:`${Te.total>0?Te.inUse/Te.total*100:0}%`}})})]}),e.jsxs("div",{className:"bg-slate-800 border border-yellow-500/30 rounded-lg p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-400 text-sm font-medium",children:"MAINTENANCE"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-400",children:Te.maintenance})]}),e.jsx("div",{className:"w-10 h-10 bg-yellow-500/20 rounded-lg flex items-center justify-center",children:e.jsx(tl,{className:"w-5 h-5 text-yellow-400"})})]}),e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-1 mt-2",children:e.jsx("div",{className:"bg-yellow-400 h-1 rounded-full animate-pulse",style:{width:`${Te.total>0?Te.maintenance/Te.total*100:0}%`}})})]}),e.jsxs("div",{className:"bg-slate-800 border border-red-500/30 rounded-lg p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 text-sm font-medium",children:"OFFLINE"}),e.jsx("p",{className:"text-3xl font-bold text-red-400",children:Te.offline})]}),e.jsx("div",{className:"w-10 h-10 bg-red-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Zc,{className:"w-5 h-5 text-red-400"})})]}),e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-1 mt-2",children:e.jsx("div",{className:"bg-red-400 h-1 rounded-full",style:{width:`${Te.total>0?Te.offline/Te.total*100:0}%`}})})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-500/30 rounded-lg p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"EFFICIENCY"}),e.jsxs("p",{className:"text-3xl font-bold text-slate-400",children:[Te.utilizationRate,"%"]})]}),e.jsx("div",{className:"w-10 h-10 bg-slate-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Gn,{className:"w-5 h-5 text-slate-400"})})]}),e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-1 mt-2",children:e.jsx("div",{className:"bg-slate-400 h-1 rounded-full",style:{width:`${Te.utilizationRate}%`}})})]})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6 shadow-lg mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(yp,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"System Control Panel"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(oa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search equipment...",value:U,onChange:p=>se(p.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white placeholder-slate-400"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Qn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),e.jsxs("select",{value:v,onChange:p=>F(p.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white appearance-none",children:[e.jsx("option",{value:"all",children:"All Production Areas"}),h.map(p=>e.jsx("option",{value:p.code,children:p.name},p.id))]})]}),e.jsx("div",{children:e.jsxs("select",{value:G,onChange:p=>W(p.target.value),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white",children:[e.jsx("option",{value:"all",children:"All Status Types"}),e.jsx("option",{value:"available",children:"Available"}),e.jsx("option",{value:"in_use",children:"Active"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"offline",children:"Offline"})]})}),e.jsx("div",{className:"flex items-center justify-center md:justify-start bg-slate-700 rounded-lg px-4 py-3 border border-slate-600",children:e.jsxs("span",{className:"text-sm text-slate-300 font-mono",children:[Fe.length," / ",o.length," units"]})})]})]}),(v==="all"||v==="blending")&&e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-red-600 rounded-lg p-6 mb-6 shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(hi,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"BLENDING PRODUCTION AREA"}),e.jsxs("p",{className:"text-orange-100 flex items-center gap-2",children:[e.jsx(Pc,{className:"w-4 h-4"}),"Raw Material Processing  Recipe Mixing  Quality Control"]})]}),e.jsxs("div",{className:"ml-auto text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-white",children:Fe.filter(p=>p.environment==="blending").length}),e.jsx("div",{className:"text-orange-200 text-sm",children:"UNITS"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-8",children:Fe.filter(p=>p.environment==="blending").map(p=>{const k=He[p.status]||He.offline;return e.jsxs("div",{className:`bg-slate-800 border ${k.border} rounded-lg p-6 shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden relative`,children:[e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${k.indicator}`})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("h3",{className:"text-lg font-bold text-white font-mono",children:p.name})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-2xl ${k.text}`,children:k.symbol}),e.jsx("span",{className:`text-xs font-bold font-mono ${k.text}`,children:k.label})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Oe,{onClick:async()=>{Ae(p),C({...p,shift_cycle_enabled:p.shift_cycle_enabled||!1,cycle_start_date:p.cycle_start_date||"",operators_per_shift:p.operators_per_shift==null?"":p.operators_per_shift,hopper_loaders_per_shift:p.hopper_loaders_per_shift==null?"":p.hopper_loaders_per_shift,packers_per_shift:p.packers_per_shift==null?"":p.packers_per_shift,specifications:p.specifications||{}}),await pe(p.id),Be(!0)},className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[e.jsx(Pt,{className:"w-4 h-4"}),"CONFIGURE"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(Oe,{onClick:()=>{Ae(p),Ee(!0)},className:"bg-slate-700 hover:bg-slate-600 text-white border-slate-600 text-xs py-2",children:e.jsx("span",{className:`text-lg ${k.text}`,children:k.symbol})}),e.jsx(Oe,{onClick:()=>{Ae(p),Se(p.id),ve(!0)},className:"bg-slate-700 hover:bg-slate-600 text-white border-slate-600 text-xs py-2",children:e.jsx(xs,{className:"w-3 h-3"})}),p.status!=="in_use"&&e.jsx(Oe,{onClick:()=>Re(p.id),className:"bg-red-600 hover:bg-red-700 text-white text-xs py-2",children:e.jsx(Da,{className:"w-3 h-3"})})]})]})]},p.id)})})]}),(v==="all"||v==="packaging")&&e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-slate-700 rounded-lg p-6 mb-6 shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(Et,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"PACKAGING PRODUCTION AREA"}),e.jsxs("p",{className:"text-blue-100 flex items-center gap-2",children:[e.jsx(ts,{className:"w-4 h-4"}),"Final Processing  Packaging Lines  Distribution Ready"]})]}),e.jsxs("div",{className:"ml-auto text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-white",children:Fe.filter(p=>p.environment==="packaging").length}),e.jsx("div",{className:"text-blue-200 text-sm",children:"UNITS"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-8",children:Fe.filter(p=>p.environment==="packaging").map(p=>{const k=He[p.status]||He.offline;return e.jsxs("div",{className:`bg-slate-800 border ${k.border} rounded-lg p-6 shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden relative`,children:[e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${k.indicator}`})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("h3",{className:"text-lg font-bold text-white font-mono",children:p.name})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-2xl ${k.text}`,children:k.symbol}),e.jsx("span",{className:`text-xs font-bold font-mono ${k.text}`,children:k.label})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Oe,{onClick:async()=>{Ae(p),C({...p,shift_cycle_enabled:p.shift_cycle_enabled||!1,cycle_start_date:p.cycle_start_date||"",operators_per_shift:p.operators_per_shift==null?"":p.operators_per_shift,hopper_loaders_per_shift:p.hopper_loaders_per_shift==null?"":p.hopper_loaders_per_shift,packers_per_shift:p.packers_per_shift==null?"":p.packers_per_shift,specifications:p.specifications||{}}),await pe(p.id),Be(!0)},className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[e.jsx(Pt,{className:"w-4 h-4"}),"CONFIGURE"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(Oe,{onClick:()=>{Ae(p),Ee(!0)},className:"bg-slate-700 hover:bg-slate-600 text-white border-slate-600 text-xs py-2",children:e.jsx("span",{className:`text-lg ${k.text}`,children:k.symbol})}),e.jsx(Oe,{onClick:()=>{Ae(p),Se(p.id),ve(!0)},className:"bg-slate-700 hover:bg-slate-600 text-white border-slate-600 text-xs py-2",children:e.jsx(xs,{className:"w-3 h-3"})}),p.status!=="in_use"&&e.jsx(Oe,{onClick:()=>Re(p.id),className:"bg-red-600 hover:bg-red-700 text-white text-xs py-2",children:e.jsx(Da,{className:"w-3 h-3"})})]})]})]},p.id)})})]})]}),Z&&e.jsx(Mt,{title:"ADD NEW EQUIPMENT",onClose:()=>le(!1),children:e.jsx("div",{className:"bg-slate-900 rounded-lg",children:e.jsxs("form",{onSubmit:Qe,className:"space-y-6 p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-300 mb-3 uppercase tracking-wide",children:"Equipment Name"}),e.jsx("input",{type:"text",placeholder:"Enter equipment designation",value:$.name,onChange:p=>C({...$,name:p.target.value}),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white placeholder-slate-400 font-mono",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-300 mb-3 uppercase tracking-wide",children:"Production Area"}),e.jsxs("select",{value:$.environment,onChange:p=>C({...$,environment:p.target.value,type:""}),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white",required:!0,children:[e.jsx("option",{value:"",children:"Select Production Area"}),h.map(p=>e.jsx("option",{value:p.code,children:p.name.toUpperCase()},p.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-300 mb-3 uppercase tracking-wide",children:"Equipment Type"}),e.jsxs("select",{value:$.type,onChange:p=>C({...$,type:p.target.value}),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white",required:!0,children:[e.jsx("option",{value:"",children:"Select equipment type..."}),(Me[$.environment]||[]).map(p=>e.jsx("option",{value:p.name||p,children:p.name||p},p.id||p.name))]}),e.jsxs("div",{className:"mt-3 p-3 bg-slate-800 rounded-lg border border-slate-600",children:[e.jsx("input",{type:"text",placeholder:"Create new equipment type (press Enter)",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white placeholder-slate-400 text-sm",onKeyPress:p=>{if(p.key==="Enter"&&p.target.value.trim()){const k=p.target.value.trim();C({...$,type:k}),Le(k),p.target.value=""}}}),e.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Press Enter to create and select new equipment type"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-slate-800 p-4 rounded-lg border border-slate-600",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-300 mb-3 uppercase tracking-wide",children:"Capacity"}),e.jsx("input",{type:"number",placeholder:"100",value:$.capacity,onChange:p=>C({...$,capacity:parseInt(p.target.value)}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white font-mono",required:!0})]}),e.jsxs("div",{className:"bg-slate-800 p-4 rounded-lg border border-slate-600",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-300 mb-3 uppercase tracking-wide",children:"Rate (/hr)"}),e.jsx("input",{type:"number",placeholder:"60",value:$.production_rate,onChange:p=>C({...$,production_rate:parseInt(p.target.value)}),className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white font-mono"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t border-slate-600",children:[e.jsx(Oe,{type:"button",onClick:()=>le(!1),className:"bg-slate-700 hover:bg-slate-600 text-white border-slate-600 px-6 py-3",children:"CANCEL"}),e.jsxs(Oe,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 font-bold",children:[e.jsx(qt,{className:"w-4 h-4 mr-2"}),"ADD EQUIPMENT"]})]})]})})}),ke&&ee&&e.jsx(Mt,{title:`CONFIGURE EQUIPMENT - ${ee.name.toUpperCase()}`,onClose:()=>Be(!1),size:"large",children:e.jsxs("div",{className:"bg-slate-900 rounded-lg",children:[e.jsx("div",{className:"bg-slate-800 border-b border-slate-600 p-6 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-blue-600 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx(Pt,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"EQUIPMENT CONFIGURATION PANEL"}),e.jsxs("p",{className:"text-slate-400 flex items-center gap-2",children:[e.jsx(sh,{className:"w-4 h-4"}),"Advanced System Parameters  Production Settings"]})]}),e.jsx("div",{className:"ml-auto",children:e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-green-600/20 rounded-lg border border-green-500/30",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-green-400 text-sm font-mono",children:"ONLINE"})]})})]})}),e.jsxs("form",{onSubmit:Pe,className:"p-6 space-y-8",children:[e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6",children:[e.jsxs("h4",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"ID"})}),"EQUIPMENT IDENTIFICATION"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-slate-300 mb-3 uppercase tracking-wide",children:["Equipment Designation ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",placeholder:"Enter equipment designation",value:$.name,onChange:p=>C({...$,name:p.target.value}),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white font-mono text-lg font-bold",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-slate-300 mb-3 uppercase tracking-wide",children:["Production Area ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:$.environment,onChange:p=>C({...$,environment:p.target.value,type:""}),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white text-lg",required:!0,children:[e.jsx("option",{value:"",children:"Select Production Area"}),h.map(p=>e.jsx("option",{value:p.code,children:p.name.toUpperCase()},p.id))]}),e.jsx("p",{className:"text-xs text-slate-400 mt-2",children:" Changing area will reset equipment type"})]})]})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6",children:[e.jsxs("h4",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-orange-500 rounded flex items-center justify-center",children:e.jsx(Et,{className:"w-4 h-4 text-white"})}),"EQUIPMENT TYPE CONFIGURATION"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-300 mb-3 uppercase tracking-wide",children:"Equipment Classification"}),e.jsxs("select",{value:$.type,onChange:p=>C({...$,type:p.target.value}),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white",required:!0,children:[e.jsx("option",{value:"",children:"Select Equipment Type"}),(Me[$.environment]||[]).map(p=>e.jsx("option",{value:p.name||p,children:p.name||p},p.id||p.name))]}),e.jsxs("div",{className:"mt-4 p-4 bg-slate-700 rounded-lg border border-slate-600",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(qt,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{className:"text-slate-300 text-sm font-bold",children:"CREATE NEW TYPE"})]}),e.jsx("input",{type:"text",placeholder:"Enter new equipment type and press Enter",className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white placeholder-slate-400 text-sm",onKeyPress:p=>{if(p.key==="Enter"&&p.target.value.trim()){const k=p.target.value.trim();C({...$,type:k}),Le(k),p.target.value=""}}}),e.jsx("p",{className:"text-xs text-slate-400 mt-2",children:" Press Enter to create and select new equipment type"})]})]})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6",children:[e.jsxs("h4",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-green-500 rounded flex items-center justify-center",children:e.jsx(Gn,{className:"w-4 h-4 text-white"})}),"PERFORMANCE PARAMETERS"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-slate-700 border border-slate-600 rounded-lg p-4",children:[e.jsxs("label",{className:"block text-sm font-bold text-blue-400 mb-3 uppercase tracking-wide flex items-center gap-2",children:[e.jsx(Gn,{className:"w-4 h-4"}),"Maximum Capacity"]}),e.jsx("input",{type:"number",placeholder:"Production Capacity",value:$.capacity,onChange:p=>C({...$,capacity:parseInt(p.target.value)}),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white font-mono text-xl font-bold text-center",required:!0}),e.jsx("p",{className:"text-xs text-slate-400 mt-2 text-center",children:"Units per production cycle"})]}),e.jsxs("div",{className:"bg-slate-700 border border-slate-600 rounded-lg p-4",children:[e.jsxs("label",{className:"block text-sm font-bold text-green-400 mb-3 uppercase tracking-wide flex items-center gap-2",children:[e.jsx(Wt,{className:"w-4 h-4"}),"Production Rate"]}),e.jsx("input",{type:"number",placeholder:"Units per Hour",value:$.production_rate||"",onChange:p=>C({...$,production_rate:parseInt(p.target.value)}),className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white font-mono text-xl font-bold text-center"}),e.jsx("p",{className:"text-xs text-slate-400 mt-2 text-center",children:"Units per hour (optional)"})]})]}),e.jsx("div",{className:"mt-4 bg-gradient-to-r from-blue-600/20 to-green-600/20 border border-blue-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-white mb-1",children:"PERFORMANCE METRICS"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Equipment efficiency indicators"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-white",children:[$.production_rate&&$.capacity?Math.round($.production_rate/$.capacity*100):0,"%"]}),e.jsx("div",{className:"text-slate-400 text-sm",children:"Efficiency Rate"})]})]})})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6",children:[e.jsxs("h4",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-slate-600 rounded flex items-center justify-center",children:e.jsx(vt,{className:"w-4 h-4 text-white"})}),"WORKFORCE REQUIREMENTS"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-blue-600/20 border border-blue-500/30 p-4 rounded-lg",children:[e.jsxs("label",{className:"block text-sm font-bold text-blue-400 mb-3 uppercase tracking-wide flex items-center gap-2",children:[e.jsx(Pt,{className:"w-4 h-4"}),"Operators per Shift"]}),e.jsx("input",{type:"number",min:"0",max:"10",value:$.operators_per_shift??2,onChange:p=>{const k=p.target.value===""?"":Math.max(0,parseInt(p.target.value)||0);C({...$,operators_per_shift:k})},placeholder:"N/A",className:"w-full px-3 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-white font-mono text-center text-xl font-bold"}),e.jsx("p",{className:"text-xs text-blue-400 mt-2 text-center",children:"Equipment operators  0 = Automated"})]}),e.jsxs("div",{className:"bg-orange-600/20 border border-orange-500/30 p-4 rounded-lg",children:[e.jsxs("label",{className:"block text-sm font-bold text-orange-400 mb-3 uppercase tracking-wide flex items-center gap-2",children:[e.jsx(ts,{className:"w-4 h-4"}),"Hopper Loaders"]}),e.jsx("input",{type:"number",min:"0",max:"5",value:$.hopper_loaders_per_shift??1,onChange:p=>{const k=p.target.value===""?"":Math.max(0,parseInt(p.target.value)||0);C({...$,hopper_loaders_per_shift:k})},placeholder:"N/A",className:"w-full px-3 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-white font-mono text-center text-xl font-bold"}),e.jsx("p",{className:"text-xs text-orange-400 mt-2 text-center",children:"Material handlers  0 = Automated"})]}),e.jsxs("div",{className:"bg-green-600/20 border border-green-500/30 p-4 rounded-lg",children:[e.jsxs("label",{className:"block text-sm font-bold text-green-400 mb-3 uppercase tracking-wide flex items-center gap-2",children:[e.jsx(Nt,{className:"w-4 h-4"}),"Packers per Shift"]}),e.jsx("input",{type:"number",min:"0",max:"15",value:$.packers_per_shift??3,onChange:p=>{const k=p.target.value===""?"":Math.max(0,parseInt(p.target.value)||0);C({...$,packers_per_shift:k})},placeholder:"N/A",className:"w-full px-3 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-white font-mono text-center text-xl font-bold"}),e.jsx("p",{className:"text-xs text-green-400 mt-2 text-center",children:"Packaging staff  0 = Automated"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-slate-700 to-slate-600 border border-slate-500 p-4 rounded-lg mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-white mb-1",children:"TOTAL WORKFORCE PER SHIFT"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Combined staffing requirement"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-white",children:(()=>{const p=$.operators_per_shift===""?0:$.operators_per_shift??2,k=$.hopper_loaders_per_shift===""?0:$.hopper_loaders_per_shift??1,ne=$.packers_per_shift===""?0:$.packers_per_shift??3;return p+k+ne})()}),e.jsx("div",{className:"text-slate-400 text-sm",children:"PERSONNEL"})]})]})}),e.jsxs("div",{className:"bg-indigo-600/20 border border-indigo-500/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(fi,{className:"w-5 h-5 text-indigo-400"}),e.jsx("span",{className:"font-bold text-white",children:"2-2-2 SHIFT CYCLE SYSTEM"}),e.jsx("span",{className:"px-2 py-1 bg-indigo-500 text-white text-xs rounded-full font-bold",children:"ADVANCED"})]}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Automated crew rotation with continuous coverage"}),e.jsx("p",{className:"text-indigo-400 text-xs mt-1",children:" Configure detailed scheduling in Labor Planner"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"shift_cycle_enabled",checked:$.shift_cycle_enabled||!1,onChange:p=>C({...$,shift_cycle_enabled:p.target.checked}),className:"w-5 h-5 text-indigo-600 bg-slate-700 border-slate-600 rounded focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"shift_cycle_enabled",className:"text-sm font-bold text-white",children:"ENABLE"})]})]}),$.shift_cycle_enabled&&e.jsx("div",{className:"bg-slate-700 border border-slate-600 rounded-lg p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xs,{className:"w-8 h-8 text-indigo-400 mx-auto mb-3"}),e.jsx("p",{className:"text-white font-bold mb-2",children:"SHIFT CYCLE ACTIVATED"}),e.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Advanced crew scheduling system enabled"}),e.jsxs("button",{type:"button",onClick:()=>window.location.href="/labor-planner",className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors font-bold flex items-center gap-2 mx-auto",children:[e.jsx(sh,{className:"w-4 h-4"}),"OPEN LABOR PLANNER"]})]})})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-8 border-t border-slate-600",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-slate-400 text-sm font-mono",children:"Configuration Ready"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Oe,{type:"button",onClick:()=>Be(!1),className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white border border-slate-600 rounded-lg font-bold",children:"CANCEL"}),e.jsxs(Oe,{type:"submit",className:"px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-bold flex items-center gap-2 shadow-lg",children:[e.jsx(Pt,{className:"w-5 h-5"}),"UPDATE EQUIPMENT"]})]})]})]})]})}),je&&ee&&e.jsx(Mt,{title:"EQUIPMENT STATUS CONTROL",onClose:()=>Ee(!1),children:e.jsxs("div",{className:"bg-slate-900 rounded-lg p-6 space-y-6",children:[e.jsxs("div",{className:"text-center bg-slate-800 p-4 rounded-lg border border-slate-600",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:ee.name}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-slate-400",children:"CURRENT STATUS:"}),P(ee.status)]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(He).map(([p,k])=>e.jsxs(Oe,{onClick:()=>et(p),className:`${ee.status===p?"bg-blue-600 border-blue-500":"bg-slate-800 hover:bg-slate-700 border-slate-600"} border-2 h-20 flex flex-col items-center justify-center text-white font-bold transition-all duration-200`,disabled:ee.status===p,children:[e.jsx("span",{className:`text-2xl mb-2 ${k.text}`,children:k.symbol}),e.jsx("span",{className:"text-xs font-bold",children:k.label}),e.jsx("div",{className:`w-2 h-2 rounded-full mt-1 ${k.indicator}`})]},p))}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-600",children:e.jsx(Oe,{onClick:()=>Ee(!1),className:"bg-slate-700 hover:bg-slate-600 text-white border-slate-600 px-6 py-3",children:"CLOSE"})})]})}),D&&ee&&e.jsx(Mt,{title:`PRODUCTION SCHEDULE - ${ee.name.toUpperCase()}`,onClose:()=>ve(!1),size:"large",children:e.jsx("div",{className:"bg-slate-900 rounded-none",children:e.jsx("div",{className:"p-8",children:Q?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading schedule..."})]}):e.jsxs("div",{className:"space-y-6 bg-slate-800 p-6 border-4 border-slate-600",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-white uppercase font-mono",children:[new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"})," Production Schedule"]}),e.jsxs("div",{className:"flex items-center gap-6 text-slate-300",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-400 rounded-full"}),e.jsx("span",{className:"font-mono font-bold",children:"PRODUCTION ORDERS"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-400 rounded-full"}),e.jsx("span",{className:"font-mono font-bold",children:"DAY SHIFT"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-400 rounded-full"}),e.jsx("span",{className:"font-mono font-bold",children:"NIGHT SHIFT"})]})]})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-xs",children:(()=>{const p=new Date,k=p.getFullYear(),ne=p.getMonth(),Ne=new Date(k,ne,1),B=new Date(k,ne+1,0),ue=new Date(Ne);ue.setDate(ue.getDate()-Ne.getDay());const Ge=[];for(let Ze=0;Ze<42;Ze++){const ht=new Date(ue);if(ht.setDate(ue.getDate()+Ze),ht>B&&ht.getDate()>7)break;Ge.push(ht)}return Ge})().map((p,k)=>{const ne=p.toISOString().split("T")[0],Ne=E[ne]||{day:[],night:[]},B=ne===new Date().toISOString().split("T")[0];p<new Date(new Date().toDateString());const ue=p.getMonth()===new Date().getMonth();if(k<7){const Ze=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];if(k===0)return[...Ze.map(ht=>e.jsx("div",{className:"h-6 text-center font-bold text-slate-400 text-xs uppercase leading-6",children:ht.charAt(0)},`header-${ht}`))]}Ne.day.length>0,Ne.night.length>0;const Ge=Ne.orders&&Ne.orders.length>0;return e.jsx("div",{className:`h-8 w-8 border text-center text-xs font-mono transition-all ${B?"bg-blue-500 border-blue-400 text-white":ue?Ge?"bg-green-500 border-green-400 text-white":"bg-slate-800 border-slate-600 text-slate-300":"bg-slate-700 border-slate-600 text-slate-500"}`,title:`${p.toLocaleDateString()} - ${Ge?Ne.orders.map(Ze=>`${Ze.order_number}: ${Ze.product_name}`).join(", "):"No production scheduled"}`,children:e.jsx("div",{className:"leading-8",children:p.getDate()})},ne)})}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Production Schedule Legend"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Et,{className:"w-4 h-4 text-green-600"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(th,{className:"w-3 h-3 text-yellow-500"}),e.jsx(eh,{className:"w-3 h-3 text-blue-500"})]})]}),e.jsx("span",{className:"text-gray-700",children:"Production both shifts"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Et,{className:"w-4 h-4 text-green-600"}),e.jsx(th,{className:"w-3 h-3 text-yellow-500"})]}),e.jsx("span",{className:"text-gray-700",children:"Day shift production"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Et,{className:"w-4 h-4 text-green-600"}),e.jsx(eh,{className:"w-3 h-3 text-blue-500"})]}),e.jsx("span",{className:"text-gray-700",children:"Night shift production"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-200"}),e.jsx("span",{className:"text-gray-700",children:"No production scheduled"})]})]}),e.jsx("div",{className:"mt-3 text-xs text-gray-600",children:e.jsx("p",{children:" Shows production orders scheduled on this machine"})})]})]})})})})]})})}function Bb(){const[o,i]=u.useState(null),[h,c]=u.useState(!0),[x,y]=u.useState(""),[S,A]=u.useState({start_date:ks.formatSASTDate(new Date(Date.now()-10080*60*1e3)),end_date:ks.formatSASTDate(new Date),machine_id:"",category:""}),j=async()=>{c(!0),y("");try{const N=new URLSearchParams;Object.entries(S).forEach(([M,Y])=>{Y&&N.append(M,Y)});const g=await fe.get(`/reports/downtime?${N}`);i(g?.data||g)}catch(N){y("Failed to load downtime data"),console.error("Downtime report error:",N)}finally{c(!1)}};u.useEffect(()=>{j()},[]);const f=(N,g)=>{A(M=>({...M,[N]:g}))},v=()=>{j()},F=()=>{if(!o)return;const N=[["Start Time","End Time","Duration (min)","Reason","Category","Order","Machine","Stopped By","Status"],...o.records.map(Z=>[ks.formatSASTDateTime(Z.start_time),Z.end_time?ks.formatSASTDateTime(Z.end_time):"Active",Z.duration||"N/A",Z.reason,Z.category,Z.order_number,Z.machine_name,Z.stopped_by,Z.status])].map(Z=>Z.join(",")).join(`
`),g=new Blob([N],{type:"text/csv"}),M=window.URL.createObjectURL(g),Y=document.createElement("a");Y.href=M,Y.download=`downtime-report-${S.start_date}-to-${S.end_date}.csv`,Y.click(),window.URL.revokeObjectURL(M)},U=N=>({machine_breakdown:"danger",material_shortage:"warning",quality_issue:"danger",operator_break:"info",shift_change:"info",maintenance:"warning",safety_incident:"danger",power_outage:"danger",other:"default"})[N]||"default";if(h)return e.jsx("div",{className:"p-6 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-500",children:[e.jsx(Zt,{className:"w-5 h-5 animate-spin"}),"Loading downtime report..."]})});if(x)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-100 text-red-800 p-4 rounded-lg",children:[e.jsx(gt,{className:"w-5 h-5 inline mr-2"}),x]})});const{summary:se,category_breakdown:G,records:W}=o||{};return e.jsxs("div",{className:"p-6 space-y-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Downtime Report"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Production stop analysis and tracking"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(Oe,{onClick:v,disabled:h,children:[e.jsx(Qn,{className:"w-4 h-4 mr-2"}),"Apply Filters"]}),e.jsxs(Oe,{onClick:F,variant:"outline",disabled:!o,children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),"Export CSV"]})]})]}),e.jsxs(tt,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:S.start_date,onChange:N=>f("start_date",N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:S.end_date,onChange:N=>f("end_date",N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:S.category,onChange:N=>f("category",N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"Equipment",children:"Equipment"}),e.jsx("option",{value:"Material",children:"Material"}),e.jsx("option",{value:"Quality",children:"Quality"}),e.jsx("option",{value:"Planned",children:"Planned"}),e.jsx("option",{value:"Maintenance",children:"Maintenance"}),e.jsx("option",{value:"Safety",children:"Safety"}),e.jsx("option",{value:"Utilities",children:"Utilities"}),e.jsx("option",{value:"Other",children:"Other"})]})]})]})]}),se&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[e.jsx(tt,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Jc,{className:"w-8 h-8 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Stops"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:se.total_stops})]})]})}),e.jsx(tt,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Zt,{className:"w-8 h-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Active Stops"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:se.active_stops})]})]})}),e.jsx(tt,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ts,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Downtime"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[se.total_downtime_hours,"h"]})]})]})}),e.jsx(tt,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Zt,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Avg Duration"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[se.average_downtime_minutes,"m"]})]})]})}),e.jsx(tt,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xs,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Resolved"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:se.resolved_stops})]})]})})]}),G&&e.jsxs(tt,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Breakdown by Category"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Object.entries(G).map(([N,g])=>e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:N}),e.jsxs("p",{className:"text-sm text-gray-600",children:[g.count," stops"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[Math.round(g.total_minutes)," minutes"]})]},N))})]}),e.jsxs(tt,{children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Downtime Records"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["Start Time","Duration","Reason","Category","Order","Machine","Status","Stopped By"].map(N=>e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:N},N))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:W?.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-10 text-gray-500",children:"No downtime records found for the selected period"})}):W?.map(N=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ks.formatSASTDateTime(N.start_time)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:N.duration?`${N.duration}m`:"Active"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(at,{variant:U(N.reason),size:"sm",children:N.reason.replace("_"," ").toUpperCase()})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:N.category}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:N.order_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:N.machine_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(at,{variant:N.status==="Active"?"warning":"success",size:"sm",children:N.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:N.stopped_by})]},N.id))})]})})]})]})}function kb(){const o=(C,O="data")=>Array.isArray(C)?C:C?.data&&Array.isArray(C.data)?C.data:(console.warn(` ${O} is not an array:`,C),[]);sl();const[i,h]=u.useState({orders:[],machines:[],assignments:[],employees:[],summary:{},archivedOrders:[]}),[c,x]=u.useState(!0),[y,S]=u.useState(!1),[A,j]=u.useState(null),[f,v]=u.useState("overview"),[F,U]=u.useState([]),[se,G]=u.useState(null),[W,N]=u.useState(!1),[g,M]=u.useState(()=>{const C=new Date,O=C.getFullYear(),q=C.getMonth()+1,z=`${O}-${q.toString().padStart(2,"0")}-01`,H=C.toISOString().split("T")[0];return{start_date:z,end_date:H}}),Y=(C,O="success")=>{j({message:C,type:O}),setTimeout(()=>j(null),3e3)},Z=async(C=!1)=>{C?S(!0):x(!0);try{const O=`${g.start_date}T00:00:00`,q=`${g.end_date}T23:59:59`,z=new URLSearchParams({start_date:O,end_date:q}).toString(),[H,d,T,E,R,Q,Ce]=await Promise.all([fe.get("/orders"),fe.get("/machines"),fe.get(`/analytics/summary?${z}`),fe.get(`/analytics/downtime?${z}`),fe.get(`/reports/downtime?${z}`),fe.get("/users"),fe.get(`/planner/assignments?date=${g.end_date}`)]);h({orders:o(H,"orders"),machines:o(d,"machines"),employees:o(Q,"employees"),assignments:o(Ce,"assignments"),summary:T?.data?.summary||T?.summary||{},downtime:E?.data||E||{},downtimeRecords:R?.data?.records||R?.records||[],downtimeSummary:R?.data?.summary||R?.summary||{},categoryBreakdown:R?.data?.category_breakdown||R?.category_breakdown||{}})}catch(O){console.error("Failed to load analytics:",O),Y("Failed to load analytics data","danger")}finally{x(!1),S(!1)}},le=()=>{Z(!0)};u.useEffect(()=>{if(!localStorage.getItem("token")){console.warn(" No authentication token found - user needs to log in"),Y("Please log in to access analytics data","danger"),x(!1);return}Z()},[g]),u.useEffect(()=>{if(!localStorage.getItem("token")){console.warn(" No authentication token found - skipping waste data load");return}ke()},[g]);const ke=async()=>{try{const C=new URLSearchParams({start_date:g.start_date,end_date:g.end_date}).toString(),[O,q]=await Promise.all([fe.get(`/orders/archived?${C}`).catch(()=>[]),fe.get(`/reports/waste?${C}`).catch(()=>[])]),z=O?.data||O||[],H=q?.data||q||[];h(d=>({...d,archivedOrders:z})),U(H),console.log("Loaded archived orders:",z.length)}catch(C){console.error("Failed to load archived orders:",C);try{const O=new URLSearchParams({start_date:g.start_date,end_date:g.end_date,status:"completed"}).toString(),q=await fe.get(`/orders?${O}&archived=true`),z=q?.data||q||[];h(H=>({...H,archivedOrders:z})),console.log("Loaded completed orders from alternative endpoint:",z.length)}catch(O){console.error("Alternative archived orders endpoint also failed:",O)}}},Be=async C=>{try{const O=await fe.get(`/orders/${C.id}/waste`),q=O?.data||O||[];G({order:C,wasteData:q,metrics:q.length>0?{totalWeight:q.reduce((z,H)=>z+(H.weight||0),0),itemCount:q.length,categories:[...new Set(q.map(z=>z.item_type))]}:{totalWeight:0,itemCount:0,categories:[]}}),N(!0)}catch(O){console.error("Failed to load waste report:",O),Y("Failed to load waste report","danger")}},je=()=>{const C=i.orders.filter(q=>q.status==="completed"),O=i.archivedOrders||[];return[...C,...O]},Ee=()=>{try{const C=je();if(C.length===0){Y("No completed orders to export","warning");return}const O=[["Order Number","Product","Completion Date","Target Qty","Actual Qty","Waste Items","Total Waste Weight","Waste Types"],...C.map(d=>{const T=d.waste_data||[],E=T.reduce((Q,Ce)=>Q+(Ce.weight||0),0),R=[...new Set(T.map(Q=>Q.item_type))].join("; ");return[d.order_number||"N/A",d.product_name||"N/A",d.complete_time?ks.formatSASTDateTime(d.complete_time):"N/A",d.quantity||0,d.actual_quantity||0,T.length,E,R||"No waste recorded"]})].map(d=>d.join(",")).join(`
`),q=new Blob([O],{type:"text/csv"}),z=URL.createObjectURL(q),H=document.createElement("a");H.href=z,H.download=`waste-reports-${g.start_date}-to-${g.end_date}.csv`,H.click(),URL.revokeObjectURL(z),Y("Waste reports exported successfully","success")}catch(C){console.error("Export error:",C),Y("Failed to export waste reports","danger")}},D=u.useMemo(()=>{const{orders:C,machines:O}=i,q=C.length,z=C.filter(ze=>ze.status==="pending").length,H=C.filter(ze=>ze.status==="in_progress").length,d=C.filter(ze=>ze.status==="completed").length,T=C.filter(ze=>ze.status==="paused").length,E=q>0?Math.round(d/q*100):0,R=O.length,Q=O.filter(ze=>ze.status==="available").length,Ce=O.filter(ze=>ze.status==="in_use").length,Me=O.filter(ze=>ze.status==="maintenance").length,He=O.filter(ze=>ze.status==="offline").length,I=R>0?Math.round(Ce/R*100):0,ge=C.reduce((ze,Ye)=>ze+(parseInt(Ye.quantity)||0),0),oe=C.filter(ze=>ze.status==="completed").reduce((ze,Ye)=>ze+(parseInt(Ye.actual_quantity||Ye.quantity)||0),0),Le=C.reduce((ze,Ye)=>{const Qe=Ye.priority||"normal";return ze[Qe]=(ze[Qe]||0)+1,ze},{}),ye=C.reduce((ze,Ye)=>{const Qe=Ye.environment||"unknown";return ze[Qe]=(ze[Qe]||0)+1,ze},{}),Ue=C.reduce((ze,Ye)=>{const Qe=Ye.status||"unknown";return ze[Qe]=(ze[Qe]||0)+1,ze},{}),pe=O.reduce((ze,Ye)=>{const Qe=Ye.environment||"unknown";return ze[Qe]=(ze[Qe]||0)+1,ze},{}),Se=Array.from({length:7},(ze,Ye)=>{const Qe=new Date;Qe.setDate(Qe.getDate()-Ye);const Pe=Qe.toISOString().split("T")[0],Re=C.filter(et=>et.created_at?.startsWith(Pe)).length;return{date:Pe,count:Re}}).reverse();return{totalOrders:q,pendingOrders:z,inProgressOrders:H,completedOrders:d,pausedOrders:T,completionRate:E,totalMachines:R,availableMachines:Q,activeMachines:Ce,maintenanceMachines:Me,offlineMachines:He,utilizationRate:I,totalQuantityOrdered:ge,totalQuantityProduced:oe,priorityDistribution:Le,environmentDistribution:ye,statusDistribution:Ue,machineEnvDistribution:pe,recentTrend:Se}},[i]),ve=C=>{try{let O,q;if(C==="csv"){O=[["Metric","Value"],["Total Orders",D.totalOrders],["Completed Orders",D.completedOrders],["Completion Rate",`${D.completionRate}%`],["Total Machines",D.totalMachines],["Active Machines",D.activeMachines],["Utilization Rate",`${D.utilizationRate}%`],["Total Quantity Ordered",D.totalQuantityOrdered],["Total Quantity Produced",D.totalQuantityProduced]].map(E=>E.join(",")).join("\\n"),q=`analytics-${g.start_date}-to-${g.end_date}.csv`;const H=new Blob([O],{type:"text/csv"}),d=URL.createObjectURL(H),T=document.createElement("a");T.href=d,T.download=q,T.click(),URL.revokeObjectURL(d)}else{O=JSON.stringify({metrics:D,dateRange:g},null,2),q=`analytics-${g.start_date}-to-${g.end_date}.json`;const z=new Blob([O],{type:"application/json"}),H=URL.createObjectURL(z),d=document.createElement("a");d.href=H,d.download=q,d.click(),URL.revokeObjectURL(H)}Y(`Analytics exported as ${C.toUpperCase()}`,"success")}catch{Y("Failed to export data","danger")}},ee=({data:C,title:O,color:q="#3b82f6"})=>{const z=u.useRef(null);return u.useEffect(()=>{if(!z.current||!C)return;const H=z.current,d=H.getContext("2d"),T=Object.keys(C),E=Object.values(C),R=Math.max(...E,1);if(d.clearRect(0,0,H.width,H.height),T.length===0){d.font="16px sans-serif",d.fillStyle="#9ca3af",d.textAlign="center",d.fillText("No data available",H.width/2,H.height/2),d.font="12px sans-serif",d.fillText("Adjust date range to view data",H.width/2,H.height/2+25);return}const Q=H.height-80,Ce=H.width-80,Me=Math.min(60,Ce/(T.length*1.5));d.strokeStyle="#f3f4f6",d.lineWidth=1;for(let He=0;He<=5;He++){const I=40+He/5*Q;d.beginPath(),d.moveTo(50,I),d.lineTo(H.width-20,I),d.stroke(),d.font="bold 11px sans-serif",d.fillStyle="#6b7280",d.textAlign="right",d.fillText(Math.round((5-He)/5*R),45,I+4)}T.forEach((He,I)=>{const ge=E[I],oe=ge/R*Q,Le=60+I*(Ce/T.length),ye=40+Q-oe,Ue=d.createLinearGradient(0,ye,0,ye+oe);Ue.addColorStop(0,q),Ue.addColorStop(1,q+"80"),d.fillStyle=Ue,d.fillRect(Le,ye,Me,oe),d.strokeStyle=q,d.lineWidth=1,d.strokeRect(Le,ye,Me,oe),oe>20?(d.font="bold 11px sans-serif",d.fillStyle="#ffffff",d.textAlign="center",d.fillText(ge,Le+Me/2,ye+oe/2+4)):(d.font="bold 11px sans-serif",d.fillStyle="#374151",d.textAlign="center",d.fillText(ge,Le+Me/2,ye-8)),d.save(),d.translate(Le+Me/2,H.height-15),d.rotate(-Math.PI/8),d.font="12px sans-serif",d.fillStyle="#4b5563",d.textAlign="center",d.fillText(He.charAt(0).toUpperCase()+He.slice(1),0,0),d.restore()})},[C,q]),e.jsxs(tt,{className:"p-6 hover:shadow-lg transition-shadow duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:q}}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:O})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("canvas",{ref:z,width:"400",height:"300",className:"w-full h-auto max-w-full"})})]})},Ae=({data:C,title:O})=>{const q=u.useRef(null),z=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#f97316","#84cc16"];u.useEffect(()=>{if(!q.current||!C)return;const E=q.current,R=E.getContext("2d"),Q=E.width/2,Ce=E.height/2-10,Me=Math.min(Q,Ce)-50;R.clearRect(0,0,E.width,E.height);const He=Object.values(C),I=He.reduce((oe,Le)=>oe+Le,0);if(I===0){R.font="16px sans-serif",R.fillStyle="#9ca3af",R.textAlign="center",R.fillText("No data available",Q,Ce),R.font="12px sans-serif",R.fillText("Adjust date range to view data",Q,Ce+25);return}let ge=-Math.PI/2;He.forEach((oe,Le)=>{const ye=oe/I*2*Math.PI;R.beginPath(),R.moveTo(Q+3,Ce+3),R.arc(Q+3,Ce+3,Me,ge,ge+ye),R.closePath(),R.fillStyle="rgba(0,0,0,0.1)",R.fill(),ge+=ye}),ge=-Math.PI/2,He.forEach((oe,Le)=>{const ye=oe/I*2*Math.PI,Ue=z[Le%z.length],pe=R.createRadialGradient(Q,Ce,0,Q,Ce,Me);pe.addColorStop(0,Ue+"cc"),pe.addColorStop(1,Ue),R.beginPath(),R.moveTo(Q,Ce),R.arc(Q,Ce,Me,ge,ge+ye),R.closePath(),R.fillStyle=pe,R.fill(),R.strokeStyle="#ffffff",R.lineWidth=3,R.stroke();const Se=ge+ye/2,ze=Q+Math.cos(Se)*(Me*.75),Ye=Ce+Math.sin(Se)*(Me*.75),Qe=Math.round(oe/I*100);Qe>8&&(R.beginPath(),R.arc(ze,Ye,18,0,2*Math.PI),R.fillStyle="rgba(255,255,255,0.9)",R.fill(),R.strokeStyle=Ue,R.lineWidth=2,R.stroke(),R.font="bold 11px sans-serif",R.fillStyle=Ue,R.textAlign="center",R.fillText(`${Qe}%`,ze,Ye+4)),ge+=ye})},[C]);const H=Object.values(C||{}),d=Object.keys(C||{}),T=H.reduce((E,R)=>E+R,0);return e.jsxs(tt,{className:"p-6 hover:shadow-lg transition-shadow duration-300",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:O}),e.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 flex-shrink-0",children:e.jsx("canvas",{ref:q,width:"300",height:"250",className:"max-w-full h-auto"})}),T>0&&e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-700 text-sm uppercase tracking-wide",children:"Distribution"}),d.map((E,R)=>{const Q=H[R],Ce=Math.round(Q/T*100),Me=z[R%z.length];return e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full shadow-sm",style:{backgroundColor:Me}}),e.jsx("span",{className:"font-medium text-gray-700 capitalize",children:E})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-gray-800",children:Q}),e.jsxs("div",{className:"text-xs text-gray-500",children:[Ce,"%"]})]})]},E)})]})]})]})},$=({title:C,value:O,change:q,icon:z,color:H="gray"})=>{const T={blue:{bg:"bg-blue-50",text:"text-blue-600",border:"border-blue-200",icon:"text-blue-500",gradient:"from-blue-500 to-blue-600"},green:{bg:"bg-green-50",text:"text-green-600",border:"border-green-200",icon:"text-green-500",gradient:"from-green-500 to-green-600"},yellow:{bg:"bg-yellow-50",text:"text-yellow-600",border:"border-yellow-200",icon:"text-yellow-500",gradient:"from-yellow-500 to-yellow-600"},red:{bg:"bg-red-50",text:"text-red-600",border:"border-red-200",icon:"text-red-500",gradient:"from-red-500 to-red-600"},steel:{bg:"bg-slate-50",text:"text-slate-600",border:"border-slate-200",icon:"text-slate-500",gradient:"from-slate-600 to-slate-700"},orange:{bg:"bg-orange-50",text:"text-orange-600",border:"border-orange-200",icon:"text-orange-500",gradient:"from-orange-500 to-orange-600"},gray:{bg:"bg-gray-50",text:"text-gray-600",border:"border-gray-200",icon:"text-gray-500",gradient:"from-gray-500 to-gray-600"}}[H];return e.jsx(tt,{className:`p-6 border-l-4 ${T.bg} ${T.border} hover:shadow-lg transition-all duration-300 group`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-2 font-medium",children:C}),e.jsx("p",{className:"text-3xl font-bold text-gray-800 mb-1 group-hover:scale-105 transition-transform duration-200",children:O}),q!==void 0&&e.jsxs("div",{className:"flex items-center mt-2",children:[q>=0?e.jsx(la,{className:"w-4 h-4 text-green-500 mr-1"}):e.jsx(Jc,{className:"w-4 h-4 text-red-500 mr-1"}),e.jsxs("span",{className:`text-sm font-medium ${q>=0?"text-green-600":"text-red-600"}`,children:[Math.abs(q),"% from last period"]})]})]}),e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${T.gradient} shadow-md group-hover:shadow-lg transition-shadow duration-300`,children:e.jsx(z,{className:"w-8 h-8 text-white"})})]})})};return c&&Object.keys(i).length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Tt,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto"}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 border-4 border-blue-200 rounded-full animate-ping mx-auto"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Loading Analytics Dashboard"}),e.jsx("p",{className:"text-gray-600 max-w-md",children:"Gathering insights from your production data..."}),e.jsx("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-500",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})]})}):e.jsxs("div",{className:"p-6 space-y-6 bg-gray-50 min-h-screen",children:[A&&e.jsx("div",{className:`fixed top-4 right-4 p-4 rounded-lg shadow-xl z-50 transform transition-all duration-300 ease-in-out ${A.type==="success"?"bg-green-100 text-green-800 border border-green-200":A.type==="danger"?"bg-red-100 text-red-800 border border-red-200":A.type==="warning"?"bg-yellow-100 text-yellow-800 border border-yellow-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`p-1 rounded-full ${A.type==="success"?"bg-green-200":A.type==="danger"?"bg-red-200":A.type==="warning"?"bg-yellow-200":"bg-blue-200"}`,children:[A.type==="success"&&e.jsx(Nt,{className:"w-4 h-4 text-green-600"}),A.type==="danger"&&e.jsx(gt,{className:"w-4 h-4 text-red-600"}),A.type==="warning"&&e.jsx(gt,{className:"w-4 h-4 text-yellow-600"}),(!A.type||A.type==="info")&&e.jsx(Tt,{className:"w-4 h-4 text-blue-600"})]}),e.jsx("span",{className:"font-medium",children:A.message}),e.jsx("button",{onClick:()=>j(null),className:"ml-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(rs,{className:"w-4 h-4"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-slate-700 rounded-lg shadow-md",children:e.jsx(ts,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:"Analytics & Reports"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Production insights and real-time performance metrics"})]}),e.jsx(vi,{})]}),e.jsxs("div",{className:"flex gap-4 mt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:"text-gray-600",children:[D.totalOrders," Total Orders"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("span",{className:"text-gray-600",children:[D.activeMachines," Active Machines"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-slate-500 rounded-full"}),e.jsxs("span",{className:"text-gray-600",children:[D.completionRate,"% Completion Rate"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Oe,{onClick:le,disabled:y,variant:"outline",className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(Tt,{className:`w-4 h-4 mr-2 ${y?"animate-spin":""}`}),y?"Updating...":"Refresh"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Oe,{onClick:()=>ve("csv"),variant:"outline",size:"sm",className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),"CSV"]}),e.jsxs(Oe,{onClick:()=>ve("json"),variant:"outline",size:"sm",className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),"JSON"]})]})]})]})}),e.jsx(tt,{className:"p-6 shadow-sm",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(xs,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Date Range Filter"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Select reporting period"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date"}),e.jsx("input",{type:"date",value:g.start_date,onChange:C=>M({...g,start_date:C.target.value}),className:"px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date"}),e.jsx("input",{type:"date",value:g.end_date,onChange:C=>M({...g,end_date:C.target.value}),className:"px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm"})]})]}),e.jsxs("div",{className:"flex flex-col items-start lg:items-end gap-2",children:[e.jsxs("div",{className:"px-3 py-2 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"text-sm font-medium text-blue-800",children:[Math.ceil((new Date(g.end_date)-new Date(g.start_date))/(1e3*60*60*24))," days"]}),e.jsx("div",{className:"text-xs text-blue-600",children:"Analysis Period"})]}),y&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-600",children:[e.jsx(Tt,{className:"w-3 h-3 animate-spin"}),e.jsx("span",{children:"Updating data..."})]})]})]})}),e.jsx(tt,{className:"p-1 shadow-sm",children:e.jsx("div",{className:"flex gap-1 overflow-x-auto scrollbar-hide",children:[{id:"overview",label:"Overview",icon:ts,color:"blue"},{id:"orders",label:"Order Analytics",icon:cs,color:"green"},{id:"machines",label:"Machine Analytics",icon:Et,color:"steel"},{id:"labor",label:"Labor Analytics",icon:vt,color:"indigo"},{id:"performance",label:"Performance",icon:la,color:"emerald"},{id:"downtime",label:"Downtime Report",icon:gt,color:"red"},{id:"waste-reports",label:"Waste Reports",icon:Kc,color:"orange"}].map(C=>{const O=C.icon,q=f===C.id;return e.jsxs("button",{onClick:()=>v(C.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 whitespace-nowrap ${q?`bg-${C.color}-600 text-white shadow-md scale-105`:`text-gray-600 hover:bg-${C.color}-50 hover:text-${C.color}-700 hover:shadow-sm`}`,children:[e.jsx(O,{className:`w-4 h-4 ${q?"animate-pulse":""}`}),C.label]},C.id)})})}),f==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx($,{title:"Total Orders",value:D.totalOrders,icon:cs,color:"blue"}),e.jsx($,{title:"Completion Rate",value:`${D.completionRate}%`,icon:Nt,color:"green"}),e.jsx($,{title:"Machine Utilization",value:`${D.utilizationRate}%`,icon:Et,color:"steel"}),e.jsx($,{title:"Active Machines",value:`${D.activeMachines}/${D.totalMachines}`,icon:Wt,color:"yellow"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Ae,{data:D.statusDistribution,title:"Order Status Distribution"}),e.jsx(ee,{data:D.environmentDistribution,title:"Orders by Environment",color:"#10b981"})]})]}),f==="orders"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsx($,{title:"Pending Orders",value:D.pendingOrders,icon:Zt,color:"gray"}),e.jsx($,{title:"In Progress",value:D.inProgressOrders,icon:Ta,color:"blue"}),e.jsx($,{title:"Completed",value:D.completedOrders,icon:Nt,color:"green"}),e.jsx($,{title:"Paused",value:D.pausedOrders,icon:Nh,color:"yellow"}),e.jsx($,{title:"Total Quantity",value:D.totalQuantityOrdered.toLocaleString(),icon:ra,color:"steel"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(ee,{data:D.priorityDistribution,title:"Order Priority Distribution",color:"#f59e0b"}),e.jsx(Ae,{data:D.environmentDistribution,title:"Orders by Environment"})]})]}),f==="machines"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsx($,{title:"Total Machines",value:D.totalMachines,icon:Et,color:"gray"}),e.jsx($,{title:"Available",value:D.availableMachines,icon:Nt,color:"green"}),e.jsx($,{title:"In Use",value:D.activeMachines,icon:Wt,color:"blue"}),e.jsx($,{title:"Maintenance",value:D.maintenanceMachines,icon:gt,color:"yellow"}),e.jsx($,{title:"Offline",value:D.offlineMachines,icon:vt,color:"red"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Ae,{data:{Available:D.availableMachines,"In Use":D.activeMachines,Maintenance:D.maintenanceMachines,Offline:D.offlineMachines},title:"Machine Status Distribution"}),e.jsx(ee,{data:D.machineEnvDistribution,title:"Machines by Environment",color:"#8b5cf6"})]})]}),f==="performance"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx($,{title:"Quantity Produced",value:D.totalQuantityProduced.toLocaleString(),icon:ra,color:"green"}),e.jsx($,{title:"Production Efficiency",value:`${Math.round(D.totalQuantityProduced/(D.totalQuantityOrdered||1)*100)}%`,icon:la,color:"blue"}),e.jsx($,{title:"Avg Orders/Day",value:Math.round(D.totalOrders/30),icon:cs,color:"steel"}),e.jsx($,{title:"Machine Efficiency",value:`${D.utilizationRate}%`,icon:Et,color:"yellow"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(ee,{data:Object.fromEntries(i.downtime?Object.entries(i.downtime):[["No Data",0]]),title:"Downtime by Reason (Minutes)",color:"#ef4444"})}),e.jsxs(tt,{className:"p-6 hover:shadow-lg transition-shadow duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-indigo-500 to-slate-700 rounded-lg",children:e.jsx(la,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Performance Summary"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Key metrics for current reporting period"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Performance Metric"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Current Value"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Target"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Performance Status"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-100",children:[e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:e.jsx(Nt,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"Order Completion Rate"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Completed vs Total Orders"})]})]})}),e.jsxs("td",{className:"px-6 py-5 whitespace-nowrap",children:[e.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[D.completionRate,"%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[D.completedOrders," of ",D.totalOrders," orders"]})]}),e.jsx("td",{className:"px-6 py-5 whitespace-nowrap text-sm font-medium text-gray-600",children:"85%"}),e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsx(at,{variant:D.completionRate>=85?"success":D.completionRate>=70?"warning":"danger",children:D.completionRate>=85?" Excellent":D.completionRate>=70?" Good":" Needs Improvement"})})]}),e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(Et,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"Machine Utilization"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Active vs Total Machines"})]})]})}),e.jsxs("td",{className:"px-6 py-5 whitespace-nowrap",children:[e.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[D.utilizationRate,"%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[D.activeMachines," of ",D.totalMachines," active"]})]}),e.jsx("td",{className:"px-6 py-5 whitespace-nowrap text-sm font-medium text-gray-600",children:"80%"}),e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsx(at,{variant:D.utilizationRate>=80?"success":D.utilizationRate>=60?"warning":"danger",children:D.utilizationRate>=80?" Excellent":D.utilizationRate>=60?" Good":" Needs Improvement"})})]}),e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-50 rounded-lg",children:e.jsx(ra,{className:"w-4 h-4 text-slate-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"Production Efficiency"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Produced vs Ordered Quantity"})]})]})}),e.jsxs("td",{className:"px-6 py-5 whitespace-nowrap",children:[e.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[Math.round(D.totalQuantityProduced/(D.totalQuantityOrdered||1)*100),"%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[D.totalQuantityProduced.toLocaleString()," / ",D.totalQuantityOrdered.toLocaleString()," units"]})]}),e.jsx("td",{className:"px-6 py-5 whitespace-nowrap text-sm font-medium text-gray-600",children:"90%"}),e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsx(at,{variant:D.totalQuantityProduced/(D.totalQuantityOrdered||1)*100>=90?"success":D.totalQuantityProduced/(D.totalQuantityOrdered||1)*100>=75?"warning":"danger",children:D.totalQuantityProduced/(D.totalQuantityOrdered||1)*100>=90?" Excellent":D.totalQuantityProduced/(D.totalQuantityOrdered||1)*100>=75?" Good":" Needs Improvement"})})]})]})]})})]})]}),f==="labor"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx($,{title:"Total Employees",value:i.employees.filter(C=>C.role!=="admin").length,icon:vt,color:"blue"}),e.jsx($,{title:"Assigned Today",value:i.assignments.length,icon:Nt,color:"green"}),e.jsx($,{title:"Unique Workers",value:new Set(i.assignments.map(C=>C.employee_id)).size,icon:Wt,color:"steel"}),e.jsx($,{title:"Utilization",value:`${Math.round(i.assignments.length/Math.max(i.machines.length,1)*100)}%`,icon:la,color:"orange"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(tt,{className:"p-6 hover:shadow-lg transition-shadow duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg",children:e.jsx(vt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Employee Roles Distribution"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Workforce composition by role"})]})]}),e.jsx("div",{className:"space-y-4",children:["operator","supervisor","packer"].map(C=>{const O=i.employees.filter(T=>T.role===C).length,q=i.employees.filter(T=>T.role!=="admin").length,z=Math.round(O/Math.max(q,1)*100),d={operator:{color:"bg-blue-500",icon:"",label:"Operators"},supervisor:{color:"bg-slate-600",icon:"",label:"Supervisors"},packer:{color:"bg-green-500",icon:"",label:"Packers"}}[C];return e.jsxs("div",{className:"p-4 rounded-lg border border-gray-200 hover:border-gray-300 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:d.icon}),e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:d.label})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-gray-800",children:O}),e.jsxs("div",{className:"text-xs text-gray-500",children:[z,"%"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-3 rounded-full ${d.color} transition-all duration-500 ease-out`,style:{width:`${z}%`}})})]},C)})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Workforce:"}),e.jsxs("span",{className:"font-semibold text-gray-800",children:[i.employees.filter(C=>C.role!=="admin").length," employees"]})]})})]}),e.jsxs(tt,{className:"p-6 hover:shadow-lg transition-shadow duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-orange-500 to-yellow-600 rounded-lg",children:e.jsx(Zt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Shift Distribution"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Current assignment coverage"})]})]}),e.jsx("div",{className:"space-y-4",children:["day","night"].map(C=>{const O=i.assignments.filter(d=>d.shift===C).length,q=Math.round(O/Math.max(i.assignments.length,1)*100),H={day:{color:"bg-gradient-to-r from-yellow-400 to-orange-500",icon:"",label:"Day Shift",time:"06:00 - 18:00",bgColor:"bg-yellow-50",textColor:"text-yellow-700"},night:{color:"bg-gradient-to-r from-blue-500 to-indigo-600",icon:"",label:"Night Shift",time:"18:00 - 06:00",bgColor:"bg-blue-50",textColor:"text-blue-700"}}[C];return e.jsxs("div",{className:`p-4 rounded-lg border border-gray-200 hover:border-gray-300 transition-colors ${H.bgColor}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-lg",children:H.icon}),e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-semibold ${H.textColor}`,children:H.label}),e.jsx("div",{className:"text-xs text-gray-500",children:H.time})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-lg font-bold ${H.textColor}`,children:O}),e.jsxs("div",{className:"text-xs text-gray-500",children:[q,"% coverage"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-3 rounded-full ${H.color} transition-all duration-500 ease-out`,style:{width:`${q}%`}})})]},C)})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Assignments:"}),e.jsxs("span",{className:"font-semibold text-gray-800",children:[i.assignments.length," active"]})]})})]})]}),e.jsxs(tt,{className:"p-6 hover:shadow-lg transition-shadow duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-lg",children:e.jsx(vt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Current Labor Assignments"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Active assignments for ",new Date().toLocaleDateString()]})]})]}),e.jsxs(at,{variant:"info",className:"px-3 py-1",children:[i.assignments.length," Active"]})]}),i.assignments.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(vt,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Active Assignments"}),e.jsx("p",{className:"text-gray-600",children:"No labor assignments found for the selected date."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Employee Details"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Assignment"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Shift Schedule"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:i.assignments.slice(0,10).map((C,O)=>{const q=i.employees.find(d=>d.id===C.employee_id),z=i.machines.find(d=>d.id==C.machine_id),H={operator:"bg-blue-50 text-blue-700",supervisor:"bg-slate-50 text-slate-700",packer:"bg-green-50 text-green-700"};return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-slate-700 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:(q?.fullName||q?.username||"U").charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:q?.fullName||q?.username||"Unknown Employee"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",C.employee_id]})]})]})}),e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx(at,{size:"sm",className:H[q?.role]||"bg-gray-50 text-gray-700",children:(q?.role||"N/A").charAt(0).toUpperCase()+(q?.role||"N/A").slice(1)})}),e.jsx("div",{className:"text-sm font-medium text-gray-800",children:z?.name||`Machine ${C.machine_id}`}),e.jsxs("div",{className:"text-xs text-gray-500",children:[z?.environment||"Unknown"," Environment"]})]})}),e.jsxs("td",{className:"px-6 py-5 whitespace-nowrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${C.shift==="day"?"bg-yellow-400":"bg-blue-500"}`}),e.jsxs("div",{className:"text-sm font-medium text-gray-800 capitalize",children:[C.shift," Shift"]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:C.shift==="day"?"06:00 - 18:00":"18:00 - 06:00"})]}),e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsxs(at,{variant:"success",className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Active"]})})]},O)})})]})}),i.assignments.length>10&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing 10 of ",i.assignments.length," assignments"]})})]})]}),f==="downtime"&&e.jsx(Bb,{}),f==="waste-reports"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Waste Reports"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View waste tracking data for completed production orders"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(Oe,{onClick:Ee,variant:"outline",children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),"Export Waste Data"]}),e.jsxs(Oe,{onClick:ke,variant:"outline",children:[e.jsx(Tt,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx($,{title:"Completed Orders",value:je().length,icon:Nt,color:"green"}),e.jsx($,{title:"Orders with Waste",value:je().filter(C=>C.waste_data&&C.waste_data.length>0).length,icon:gt,color:"yellow"}),e.jsx($,{title:"Total Waste Weight",value:`${je().reduce((C,O)=>O.waste_data?C+O.waste_data.reduce((q,z)=>q+(z.weight||0),0):C,0).toFixed(2)} kg`,icon:cs,color:"red"}),e.jsx($,{title:"Waste Tracking Rate",value:`${je().length>0?Math.round(je().filter(C=>C.waste_data&&C.waste_data.length>0).length/je().length*100):0}%`,icon:ra,color:"blue"})]}),e.jsxs(tt,{className:"hover:shadow-lg transition-shadow duration-300",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg",children:e.jsx(Nt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Completed Orders - Waste Tracking"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Comprehensive waste analysis for ",(i.archivedOrders||[]).length+i.orders.filter(C=>C.status==="completed").length," completed orders"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:i.orders.filter(C=>C.status==="completed").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Orders in period"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["Order","Product","Completion Date","Quantity","Waste Items","Total Waste","Actions"].map(C=>e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:C},C))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:i.orders.filter(C=>C.status==="completed").length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-16",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"p-4 bg-gray-100 rounded-full mb-4",children:e.jsx(Nt,{className:"w-16 h-16 text-gray-300"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Completed Orders Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No completed orders found for the selected period"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx(xs,{className:"w-4 h-4"}),e.jsx("span",{children:"Try adjusting the date range to view completed orders"})]})]})})}):i.orders.filter(C=>C.status==="completed").map((C,O)=>{const q=C.waste_data||[],z=q.reduce((d,T)=>d+(T.weight||0),0),H=q.length>0;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center text-white font-bold text-sm",children:(C.order_number||"O").charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:C.order_number}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Order ID: ",C.id]})]})]})}),e.jsxs("td",{className:"px-6 py-5 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800",children:C.product_name||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Product Information"})]}),e.jsxs("td",{className:"px-6 py-5 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800",children:C.complete_time?ks.formatSASTDateTime(C.complete_time):"N/A"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Completion Time"})]}),e.jsxs("td",{className:"px-6 py-5 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-bold text-gray-800",children:[C.actual_quantity||C.quantity||0," units"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Target: ",C.quantity||0," units"]}),C.actual_quantity&&C.quantity&&e.jsx("div",{className:`text-xs font-medium ${C.actual_quantity>=C.quantity?"text-green-600":"text-red-600"}`,children:C.actual_quantity>=C.quantity?" Target Met":" Under Target"})]}),e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-800",children:q.length}),H?e.jsxs(at,{variant:"warning",size:"sm",className:"flex items-center gap-1",children:[e.jsx(gt,{className:"w-3 h-3"}),"Has Waste"]}):e.jsxs(at,{variant:"success",size:"sm",className:"flex items-center gap-1",children:[e.jsx(Nt,{className:"w-3 h-3"}),"Clean"]})]})}),e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:H?e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-bold text-red-600",children:[z.toFixed(2)," kg"]}),e.jsx("div",{className:"text-xs text-gray-500 truncate max-w-32",children:[...new Set(q.map(d=>d.item_type))].join(", ")}),e.jsxs("div",{className:"text-xs text-red-500 font-medium",children:[q.length," waste ",q.length===1?"item":"items"]})]}):e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(Nt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"No waste recorded"})]})}),e.jsx("td",{className:"px-6 py-5 whitespace-nowrap",children:e.jsxs(Oe,{onClick:()=>Be(C),variant:H?"default":"outline",size:"sm",disabled:!H,className:H?"bg-red-600 hover:bg-red-700 text-white":"",children:[e.jsx(Ps,{className:"w-4 h-4 mr-1"}),H?"View Details":"No Data"]})})]},C.id||O)})})]})})]}),i.orders.filter(C=>C.status==="completed"&&C.waste_data&&C.waste_data.length>0).length>0&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(tt,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Waste by Category"}),e.jsx("div",{className:"space-y-3",children:(()=>{const C={};return i.orders.filter(O=>O.status==="completed"&&O.waste_data).forEach(O=>{O.waste_data.forEach(q=>{const z=q.item_type||"Unknown";C[z]=(C[z]||0)+(q.weight||0)})}),Object.entries(C).map(([O,q])=>{const z=Object.values(C).reduce((H,d)=>H+d,0)>0?Math.round(q/Object.values(C).reduce((H,d)=>H+d,0)*100):0;return e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:O}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full bg-red-500",style:{width:`${z}%`}})}),e.jsxs("span",{className:"text-sm text-gray-500 w-16",children:[q.toFixed(2),"kg"]})]})]},O)})})()})]}),e.jsxs(tt,{className:"p-6 hover:shadow-lg transition-shadow duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-red-500 to-orange-600 rounded-lg",children:e.jsx(gt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"High-Waste Orders"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Orders with highest waste generation"})]})]}),e.jsx("div",{className:"space-y-3",children:i.orders.filter(C=>C.status==="completed"&&C.waste_data&&C.waste_data.length>0).sort((C,O)=>{const q=C.waste_data.reduce((H,d)=>H+(d.weight||0),0);return O.waste_data.reduce((H,d)=>H+(d.weight||0),0)-q}).slice(0,5).length>0?i.orders.filter(C=>C.status==="completed"&&C.waste_data&&C.waste_data.length>0).sort((C,O)=>{const q=C.waste_data.reduce((H,d)=>H+(d.weight||0),0);return O.waste_data.reduce((H,d)=>H+(d.weight||0),0)-q}).slice(0,5).map((C,O)=>{const q=C.waste_data.reduce((H,d)=>H+(d.weight||0),0),z=[...new Set(C.waste_data.map(H=>H.item_type))];return e.jsx("div",{className:"group p-4 border border-gray-200 rounded-lg hover:border-red-300 hover:bg-red-50 transition-all duration-200 cursor-pointer",onClick:()=>Be(C),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center justify-center w-8 h-8 bg-gradient-to-br from-red-500 to-orange-600 rounded-full text-white font-bold text-sm",children:["#",O+1]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 group-hover:text-red-800",children:C.order_number}),e.jsx("p",{className:"text-sm text-gray-600",children:C.product_name}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[z.slice(0,2).map(H=>e.jsx(at,{variant:"warning",size:"xs",children:H},H)),z.length>2&&e.jsxs(at,{variant:"warning",size:"xs",children:["+",z.length-2," more"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gt,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{className:"text-lg font-bold text-red-600",children:[q.toFixed(2)," kg"]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[C.waste_data.length," waste items"]}),e.jsx("div",{className:"text-xs text-red-600 font-medium",children:"Click to view details"})]})]})},C.id)}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Nt,{className:"w-12 h-12 mx-auto mb-3 text-green-400"}),e.jsx("p",{className:"text-gray-600",children:"No high-waste orders found"}),e.jsx("p",{className:"text-sm text-gray-500",children:"All completed orders have minimal waste generation"})]})})]})]})]}),se&&e.jsx(Mt,{title:"Waste Report Details",onClose:()=>G(null),size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:se.order.order_number}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-600",children:["Product: ",e.jsx("span",{className:"font-medium",children:se.order.product_name})]}),e.jsxs("p",{className:"text-gray-600",children:["Completed: ",e.jsx("span",{className:"font-medium",children:se.order.complete_time?ks.formatSASTDateTime(se.order.complete_time):"N/A"})]})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-600",children:["Quantity: ",e.jsxs("span",{className:"font-medium",children:[se.order.actual_quantity||se.order.quantity," units"]})]}),e.jsxs("p",{className:"text-gray-600",children:["Target: ",e.jsxs("span",{className:"font-medium",children:[se.order.quantity," units"]})]})]})]})]}),se.wasteData.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:se.metrics.totalWeight.toFixed(2)}),e.jsx("p",{className:"text-sm text-red-700",children:"Total Weight (kg)"})]}),e.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:se.metrics.itemCount}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Waste Items"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:se.metrics.categories.length}),e.jsx("p",{className:"text-sm text-blue-700",children:"Categories"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Waste Items Breakdown"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Weight"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:se.wasteData.map((C,O)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:e.jsx(at,{variant:"warning",size:"sm",children:C.item_type})}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:C.description||"No description"}),e.jsx("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:C.weight||0}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:C.unit})]},O))})]})})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Nt,{className:"w-16 h-16 mx-auto mb-4 text-green-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Waste Recorded"}),e.jsx("p",{className:"text-gray-600",children:"This order was completed without recorded waste."})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsx(Oe,{onClick:()=>G(null),variant:"outline",children:"Close"})})]})})]})}function Tb(){const[o,i]=u.useState(null),[h,c]=u.useState([]),[x,y]=u.useState([]),[S,A]=u.useState(!0),[j,f]=u.useState(null),[v,F]=u.useState("packaging"),[U,se]=u.useState([]),[G,W]=u.useState(!1),[N,g]=u.useState(null),[M,Y]=u.useState(!1),Z=(D,ve="success")=>{f({message:D,type:ve}),setTimeout(()=>f(null),3e3)},le=()=>{const D=new Date,ve=D.getHours(),ee=ve>=6&&ve<18?"day":"night",Ae=D.toISOString().split("T")[0];return{type:ee,date:Ae,...{day:{start:"06:00",end:"18:00",label:"Day Shift"},night:{start:"18:00",end:"06:00",label:"Night Shift"}}[ee]}},ke=async()=>{try{A(!0);const D=await fe.get("/environments"),ve=D?.data||D||[];se(Array.isArray(ve)?ve:[]);const ee=await fe.get("/production/floor-overview"),Ae=ee?.data||ee;if(Ae){const C=le(),O=v?Ae.activeOrders?.filter(z=>z.environment===v):Ae.activeOrders||[],q={shift_date:C.date,shift_type:C.type,environment:v||"all",total_orders:O.length,completed_orders:O.filter(z=>z.status==="completed").length,in_progress_orders:O.filter(z=>z.status==="in_progress").length,stopped_orders:O.filter(z=>z.status==="stopped"||z.status==="paused").length,total_quantity_produced:O.reduce((z,H)=>z+(H.actual_quantity||0),0),total_stops:0,total_downtime_minutes:0,oee_percentage:Ae.efficiency||0};i(q),y(O.slice(0,10).map((z,H)=>({id:H,order_number:z.order_number,product_name:z.product_name,machine_name:z.machine_name,updated_by_name:z.operator_name||"System",previous_quantity:Math.max(0,(z.actual_quantity||0)-10),new_quantity:z.actual_quantity||0,update_time:z.updated_at||z.created_at})))}const $=[];for(let C=0;C<5;C++){const O=new Date;O.setDate(O.getDate()-C),$.push({id:C,shift_date:O.toISOString().split("T")[0],shift_type:C%2===0?"day":"night",environment:v||"packaging",total_orders:Math.floor(Math.random()*20)+5,completed_orders:Math.floor(Math.random()*15)+3,in_progress_orders:Math.floor(Math.random()*5)+1,stopped_orders:Math.floor(Math.random()*3),total_quantity_produced:Math.floor(Math.random()*1e3)+500,oee_percentage:Math.random()*30+70,supervisor_name:"Shift Supervisor"})}c($)}catch(D){console.error("Failed to load shift data:",D),Z("Failed to load production data","danger")}finally{A(!1)}},Be=async()=>{try{Y(!0),await ke(),Z("Shift report updated successfully")}catch(D){console.error("Failed to generate shift report:",D),Z("Failed to update shift report","danger")}finally{Y(!1)}},je=D=>{const ee=[["Metric","Value"],["Shift Date",D.shift_date],["Shift Type",D.shift_type.toUpperCase()],["Environment",D.environment],["Total Orders",D.total_orders||0],["Completed Orders",D.completed_orders||0],["In Progress Orders",D.in_progress_orders||0],["Stopped Orders",D.stopped_orders||0],["Total Quantity Produced",D.total_quantity_produced||0],["Total Stops",D.total_stops||0],["Total Downtime (minutes)",D.total_downtime_minutes||0],["OEE Percentage",`${D.oee_percentage?.toFixed(1)||0}%`],["Efficiency Percentage",`${D.efficiency_percentage?.toFixed(1)||0}%`],["Quality Percentage",`${D.quality_percentage?.toFixed(1)||100}%`]].map(O=>O.join(",")).join("\\n"),Ae=new Blob([ee],{type:"text/csv"}),$=URL.createObjectURL(Ae),C=document.createElement("a");C.href=$,C.download=`shift-report-${D.shift_date}-${D.shift_type}-${D.environment}.csv`,C.click(),URL.revokeObjectURL($),Z("Shift report exported successfully")};u.useEffect(()=>{if(!localStorage.getItem("token")){console.warn(" No authentication token found - user needs to log in"),A(!1);return}ke();const ve=setInterval(()=>{console.log(" Periodic refresh - reloading shift reports"),ke()},3e4);return()=>clearInterval(ve)},[v]);const Ee=le();return S?e.jsx("div",{className:"p-6 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-500",children:[e.jsx(Tt,{className:"w-5 h-5 animate-spin"}),"Loading shift reports..."]})}):e.jsxs("div",{className:"p-6 space-y-6 bg-gray-50 min-h-screen",children:[j&&e.jsx("div",{className:`fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${j.type==="success"?"bg-green-100 text-green-800 border border-green-200":j.type==="danger"?"bg-red-100 text-red-800 border border-red-200":j.type==="warning"?"bg-yellow-100 text-yellow-800 border border-yellow-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:j.message}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Shift Reports"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Real-time production shift tracking and automated reporting"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:v,onChange:D=>F(D.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Environments"}),U.map(D=>e.jsx("option",{value:D.code,children:D.name},D.code))]}),e.jsxs(Oe,{onClick:ke,variant:"outline",children:[e.jsx(Tt,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),e.jsxs(tt,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),e.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["Current Shift - ",Ee.label]}),e.jsx(at,{variant:"info",children:Ee.date}),e.jsxs(at,{variant:"default",children:[Ee.start," - ",Ee.end]})]}),e.jsxs(Oe,{onClick:Be,disabled:M,className:"bg-blue-600 text-white hover:bg-blue-700",children:[M?e.jsx(Tt,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(ts,{className:"w-4 h-4 mr-2"}),"Generate Report"]})]}),o&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:o.total_orders||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Orders"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o.completed_orders||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Completed"})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:o.in_progress_orders||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"In Progress"})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:o.stopped_orders||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Stopped"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:(o.total_quantity_produced||0).toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-600",children:"Quantity Produced"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:o.oee_percentage?`${o.oee_percentage.toFixed(1)}%`:"0%"}),e.jsx("div",{className:"text-sm text-gray-600",children:"OEE"})]})]})]}),e.jsxs(tt,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Wt,{className:"w-5 h-5"}),"Recent Quantity Updates (",x.length,")"]}),x.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(ra,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No quantity updates recorded for current shift"})]}):e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:x.map((D,ve)=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[D.order_number," - ",D.product_name]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[D.machine_name,"  ",D.updated_by_name]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-gray-900",children:[D.previous_quantity,"  ",D.new_quantity]}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date(D.update_time).toLocaleTimeString()})]})]},ve))})]}),e.jsxs(tt,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Kc,{className:"w-5 h-5"}),"Shift Reports History"]}),h.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(Zt,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No shift reports available"})]}):e.jsx("div",{className:"space-y-3",children:h.map(D=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[D.shift_date," - ",D.shift_type.toUpperCase()," Shift"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[D.environment,"  ",D.supervisor_name||"No supervisor assigned"]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-blue-600",children:D.total_orders||0}),e.jsx("div",{className:"text-gray-500",children:"Orders"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-green-600",children:D.completed_orders||0}),e.jsx("div",{className:"text-gray-500",children:"Completed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-purple-600",children:(D.total_quantity_produced||0).toLocaleString()}),e.jsx("div",{className:"text-gray-500",children:"Produced"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-orange-600",children:D.oee_percentage?`${D.oee_percentage.toFixed(1)}%`:"0%"}),e.jsx("div",{className:"text-gray-500",children:"OEE"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Oe,{onClick:()=>{g(D),W(!0)},variant:"outline",size:"sm",children:[e.jsx(Ps,{className:"w-4 h-4 mr-1"}),"View"]}),e.jsxs(Oe,{onClick:()=>je(D),variant:"outline",size:"sm",children:[e.jsx(Ns,{className:"w-4 h-4 mr-1"}),"Export"]})]})]})},D.id))})]}),G&&N&&e.jsx(Mt,{isOpen:G,onClose:()=>W(!1),title:`Shift Report - ${N.shift_date} ${N.shift_type.toUpperCase()}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:N.total_orders||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Orders"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:N.completed_orders||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Completed"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-yellow-600",children:N.in_progress_orders||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"In Progress"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:N.stopped_orders||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Stopped"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:(N.total_quantity_produced||0).toLocaleString()}),e.jsx("div",{className:"text-xs text-gray-600",children:"Quantity Produced"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:N.oee_percentage?`${N.oee_percentage.toFixed(1)}%`:"0%"}),e.jsx("div",{className:"text-xs text-gray-600",children:"OEE"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Downtime Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:["Total Stops: ",e.jsx("span",{className:"font-medium",children:N.total_stops||0})]}),e.jsxs("div",{children:["Total Downtime: ",e.jsxs("span",{className:"font-medium",children:[N.total_downtime_minutes||0," minutes"]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Machine Utilization"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:["Active Machines: ",e.jsx("span",{className:"font-medium",children:N.total_machines_active||0})]}),e.jsxs("div",{children:["Available Machines: ",e.jsx("span",{className:"font-medium",children:N.total_machines_available||0})]})]})]}),N.summary_notes&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Summary Notes"}),e.jsx("p",{className:"text-sm text-gray-700",children:N.summary_notes})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(Oe,{onClick:()=>je(N),variant:"outline",children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),e.jsx(Oe,{onClick:()=>W(!1),children:"Close"})]})]})})]})}const Ic=({title:o,children:i})=>e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-4 py-5 border-b border-gray-200 sm:px-6",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:o})}),e.jsx("div",{className:"px-4 py-5 sm:p-6",children:i})]}),Db=()=>{const{user:o,checkAuth:i}=ca(),[h,c]=u.useState({email:"",fullName:"",phone:""}),[x,y]=u.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[S,A]=u.useState({text:"",type:"success"}),[j,f]=u.useState(!1),[v,F]=u.useState({});u.useEffect(()=>{o&&c({email:o.email||"",fullName:o.fullName||"",phone:o.phone||""})},[o]);const U=u.useCallback(g=>{const M={};return g.email?.trim()||(M.email="Email is required"),g.fullName?.trim()||(M.fullName="Full name is required"),g.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g.email)&&(M.email="Please enter a valid email address"),M},[]),se=u.useCallback(async g=>{g.preventDefault(),A({text:"",type:"success"}),F({});const M=U(h);if(Object.keys(M).length>0){F(M);return}f(!0);try{await fe.put("/settings/profile",h),A({text:"Profile updated successfully!",type:"success"}),await i()}catch(Y){A({text:Y.response?.data?.message||"Failed to update profile",type:"error"})}finally{f(!1)}},[h,U,i]),G=u.useCallback(g=>{if(!g)return{score:0,text:"",color:""};let M=0;const Y={length:g.length>=8,lowercase:/[a-z]/.test(g),uppercase:/[A-Z]/.test(g),numbers:/\d/.test(g),special:/[!@#$%^&*(),.?":{}|<>]/.test(g)};return M=Object.values(Y).filter(Boolean).length,{score:M,...{0:{text:"",color:""},1:{text:"Very Weak",color:"text-red-600"},2:{text:"Weak",color:"text-red-500"},3:{text:"Fair",color:"text-yellow-500"},4:{text:"Good",color:"text-blue-500"},5:{text:"Strong",color:"text-green-500"}}[M],checks:Y}},[]),W=u.useCallback(g=>{const M={};g.currentPassword||(M.currentPassword="Current password is required"),g.newPassword||(M.newPassword="New password is required");const Y=G(g.newPassword);return g.newPassword&&Y.score<3&&(M.newPassword="Password is too weak. Please include uppercase, lowercase, numbers, and special characters."),g.newPassword!==g.confirmPassword&&(M.confirmPassword="Passwords do not match"),M},[G]),N=u.useCallback(async g=>{g.preventDefault(),A({text:"",type:"success"}),F({});const M=W(x);if(Object.keys(M).length>0){F(M);return}f(!0);try{await fe.post("/settings/change-password",{currentPassword:x.currentPassword,newPassword:x.newPassword}),A({text:"Password changed successfully!",type:"success"}),y({currentPassword:"",newPassword:"",confirmPassword:""})}catch(Y){A({text:Y.response?.data?.message||"Failed to change password",type:"error"})}finally{f(!1)}},[x,W]);return e.jsxs("div",{className:"space-y-6",children:[S.text&&e.jsx("div",{className:`p-3 rounded ${S.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:S.text}),e.jsx(Ic,{title:"Profile Information",children:e.jsxs("form",{onSubmit:se,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("input",{id:"fullName",type:"text",value:h.fullName,onChange:g=>c({...h,fullName:g.target.value}),className:`mt-1 block w-full border rounded-md shadow-sm px-3 py-2 ${v.fullName?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,"aria-describedby":v.fullName?"fullName-error":void 0,disabled:j}),v.fullName&&e.jsx("p",{id:"fullName-error",className:"mt-1 text-sm text-red-600",children:v.fullName})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),e.jsx("input",{id:"phone",type:"tel",value:h.phone,onChange:g=>c({...h,phone:g.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm px-3 py-2 focus:border-blue-500 focus:ring-blue-500",disabled:j})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),e.jsx("input",{id:"email",type:"email",value:h.email,onChange:g=>c({...h,email:g.target.value}),className:`mt-1 block w-full border rounded-md shadow-sm px-3 py-2 ${v.email?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,"aria-describedby":v.email?"email-error":void 0,disabled:j,required:!0}),v.email&&e.jsx("p",{id:"email-error",className:"mt-1 text-sm text-red-600",children:v.email})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"submit",disabled:j,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[j&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),j?"Updating...":"Update Profile"]})})]})}),e.jsx(Ic,{title:"Change Password",children:e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),e.jsx("input",{id:"currentPassword",type:"password",value:x.currentPassword,onChange:g=>y({...x,currentPassword:g.target.value}),className:`w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-500 ${v.currentPassword?"border-red-300":"border-gray-300"}`,"aria-describedby":v.currentPassword?"currentPassword-error":void 0,disabled:j,required:!0}),v.currentPassword&&e.jsx("p",{id:"currentPassword-error",className:"mt-1 text-sm text-red-600",children:v.currentPassword})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),e.jsx("input",{id:"newPassword",type:"password",value:x.newPassword,onChange:g=>y({...x,newPassword:g.target.value}),className:`w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-500 ${v.newPassword?"border-red-300":"border-gray-300"}`,"aria-describedby":v.newPassword?"newPassword-error":"newPassword-help",disabled:j,required:!0}),(()=>{const g=G(x.newPassword);return e.jsxs("div",{className:"mt-2",children:[x.newPassword&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Password strength:"}),e.jsx("span",{className:`text-xs font-medium ${g.color}`,children:g.text})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${g.score===1?"bg-red-400 w-1/5":g.score===2?"bg-red-400 w-2/5":g.score===3?"bg-yellow-400 w-3/5":g.score===4?"bg-blue-400 w-4/5":g.score===5?"bg-green-400 w-full":"w-0"}`})}),e.jsx("div",{className:"mt-2 text-xs text-gray-600",children:e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:g.checks?.length?"text-green-600":"text-gray-400",children:" 8+ characters"}),e.jsx("span",{className:g.checks?.uppercase?"text-green-600":"text-gray-400",children:" Uppercase"}),e.jsx("span",{className:g.checks?.lowercase?"text-green-600":"text-gray-400",children:" Lowercase"}),e.jsx("span",{className:g.checks?.numbers?"text-green-600":"text-gray-400",children:" Numbers"}),e.jsx("span",{className:g.checks?.special?"text-green-600":"text-gray-400",children:" Special chars"})]})})]}),e.jsx("p",{id:"newPassword-help",className:"text-xs text-gray-500",children:"Include uppercase, lowercase, numbers, and special characters"}),v.newPassword&&e.jsx("p",{id:"newPassword-error",className:"mt-1 text-sm text-red-600",children:v.newPassword})]})})()]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),e.jsx("input",{id:"confirmPassword",type:"password",value:x.confirmPassword,onChange:g=>y({...x,confirmPassword:g.target.value}),className:`w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-500 ${v.confirmPassword?"border-red-300":"border-gray-300"}`,"aria-describedby":v.confirmPassword?"confirmPassword-error":void 0,disabled:j,required:!0}),v.confirmPassword&&e.jsx("p",{id:"confirmPassword-error",className:"mt-1 text-sm text-red-600",children:v.confirmPassword})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"submit",disabled:j,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[j&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),j?"Changing...":"Change Password"]})})]})})]})},Lb=()=>{const[o,i]=u.useState({maintenanceMode:!1,sessionTimeout:30}),[h,c]=u.useState(!0),[x,y]=u.useState({text:"",type:"success"}),[S,A]=u.useState(!1);u.useEffect(()=>{(async()=>{try{const v=await fe.get("/settings/system"),F=v?.data||v||{};i(U=>({...U,...F}))}catch(v){console.error("Failed to load system settings:",v)}finally{c(!1)}})()},[]);const j=u.useCallback(async f=>{f.preventDefault(),y({text:"",type:"success"}),A(!0);try{await fe.put("/settings/system",o),y({text:"Settings saved successfully!",type:"success"})}catch(v){y({text:v.response?.data?.message||"Failed to save settings",type:"error"})}finally{A(!1)}},[o]);return h?e.jsxs("div",{className:"flex items-center justify-center p-8",role:"status","aria-label":"Loading system settings",children:[e.jsxs("svg",{className:"animate-spin h-6 w-6 text-blue-500 mr-2",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading system settings..."]}):e.jsxs(Ic,{title:"System Configuration",children:[x.text&&e.jsx("div",{className:`p-3 mb-4 rounded ${x.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,role:"alert","aria-live":"polite",children:x.text}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"maintenanceMode",className:"font-medium text-gray-700",children:"Maintenance Mode"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Prevents non-admins from accessing the system."})]}),e.jsx("input",{id:"maintenanceMode",type:"checkbox",checked:o.maintenanceMode,onChange:f=>i({...o,maintenanceMode:f.target.checked}),className:"h-4 w-4 rounded text-blue-600 border-gray-300"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sessionTimeout",className:"block text-sm font-medium text-gray-700",children:"Session Timeout (minutes)"}),e.jsx("input",{id:"sessionTimeout",type:"number",value:o.sessionTimeout,onChange:f=>i({...o,sessionTimeout:parseInt(f.target.value)||30}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsxs("button",{type:"submit",disabled:S,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[S&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),S?"Saving...":"Save System Settings"]})})]})]})};function Rb(){const[o,i]=u.useState("profile"),{user:h}=ca(),c=u.useMemo(()=>[{id:"profile",label:"Profile"},h?.role==="admin"&&{id:"system",label:"System"}].filter(Boolean),[h?.role]),x=u.useCallback(y=>{i(y)},[]);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Settings"}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:c.map(y=>e.jsx("button",{onClick:()=>x(y.id),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors ${o===y.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,role:"tab","aria-selected":o===y.id,"aria-controls":`${y.id}-panel`,children:y.label},y.id))})}),e.jsxs("div",{role:"tabpanel",children:[o==="profile"&&e.jsx("div",{id:"profile-panel","aria-labelledby":"profile-tab",children:e.jsx(Db,{})}),o==="system"&&h?.role==="admin"&&e.jsx("div",{id:"system-panel","aria-labelledby":"system-tab",children:e.jsx(Lb,{})})]})]})}function zb(){const[o,i]=u.useState([]),[h,c]=u.useState(!0),[x,y]=u.useState(!1),[S,A]=u.useState(null),[j,f]=u.useState(""),[v,F]=u.useState("all"),[U,se]=u.useState("overview"),[G,W]=u.useState([]),[N,g]=u.useState(!1),[M,Y]=u.useState(null),[Z,le]=u.useState({name:"",code:"",description:"",color:"blue",machine_types:[]}),[ke,Be]=u.useState([]),[je,Ee]=u.useState(!1),[D,ve]=u.useState(null),[ee,Ae]=u.useState({name:"",description:"",category:"Production",specifications:{}}),[$,C]=u.useState(!1),[O,q]=u.useState(!1),[z,H]=u.useState(null),[d,T]=u.useState({username:"",email:"",password:"",role:"operator",employee_code:"",company:"Workforce"}),[E,R]=u.useState({backup_frequency:"daily",session_timeout:24,max_login_attempts:5,maintenance_mode:!1}),Q=(B,ue="success")=>{A({message:B,type:ue}),setTimeout(()=>A(null),3e3)},Ce=async(B=!1)=>{B?y(!0):c(!0);try{const ue=await fe.get("/users"),Ge=ue?.data||ue;i(Array.isArray(Ge)?Ge:[])}catch(ue){console.error("Failed to load users:",ue),i([]),Q("Failed to load users","danger")}finally{c(!1),y(!1)}},Me=async()=>{try{const B=await fe.get("/environments"),ue=B?.data||B||[];console.log("Loaded environments:",ue),W(Array.isArray(ue)?ue:[])}catch(B){console.error("Failed to load environments:",B),Q("Failed to load environments","danger"),W([])}},He=async()=>{try{const B=await fe.get("/machine-types"),ue=B?.data||B||[];console.log("Loaded machine types:",ue),Be(Array.isArray(ue)?ue:[])}catch(B){console.error("Failed to load machine types:",B),Be([])}},I=async(B=!1)=>{B?y(!0):c(!0);try{await Promise.all([Ce(!1),Me(),He()])}catch(ue){console.error("Failed to load data:",ue)}finally{c(!1),y(!1)}},ge=()=>{Ce(!0)};u.useEffect(()=>{I()},[]);const oe=async B=>{B.preventDefault();try{await fe.post("/users",d),C(!1),T({username:"",email:"",password:"",role:"operator",employee_code:"",company:"Workforce"}),Me(),Q("User created successfully")}catch(ue){Q("Failed to create user: "+ue.message,"danger")}},Le=async B=>{B.preventDefault();try{await fe.put(`/users/${z.id}`,d),C(!1),H(null),T({username:"",email:"",password:"",role:"operator",employee_code:"",company:"Workforce"}),Me(),Q("User updated successfully")}catch(ue){Q("Failed to update user: "+ue.message,"danger")}},ye=async B=>{if(window.confirm("Are you sure you want to delete this user?"))try{await fe.delete(`/users/${B}`),Me(),Q("User deleted successfully")}catch(ue){Q("Failed to delete user: "+ue.message,"danger")}},Ue=B=>{H(B),T({username:B.username,email:B.email,password:"",role:B.role,employee_code:B.employee_code||"",company:B.company||"Workforce"}),C(!0)},pe=async B=>{B.preventDefault();try{await fe.post("/environments",Z),g(!1),le({name:"",code:"",description:"",color:"blue",machine_types:[]}),Me(),Q("Environment created successfully")}catch(ue){Q("Failed to create environment: "+ue.message,"danger")}},Se=async B=>{if(B.preventDefault(),!M||!M.id){Q("No environment selected for editing","danger");return}try{console.log("Editing environment:",M.id,Z),await fe.put(`/environments/${M.id}`,Z),g(!1),Y(null),le({name:"",code:"",description:"",color:"blue",machine_types:[]}),Me(),Q("Environment updated successfully")}catch(ue){console.error("Edit environment error:",ue),Q("Failed to update environment: "+(ue.response?.data?.error||ue.message),"danger")}},ze=async B=>{if(window.confirm("Are you sure you want to delete this environment? This action cannot be undone."))try{await fe.delete(`/environments/${B}`),Me(),Q("Environment deleted successfully")}catch(ue){Q("Failed to delete environment: "+ue.message,"danger")}},Ye=B=>{Y(B);let ue=[];try{ue=typeof B.machine_types=="string"?JSON.parse(B.machine_types):B.machine_types||[]}catch(Ge){console.error("Failed to parse machine types:",Ge),ue=[]}le({name:B.name,code:B.code,description:B.description||"",color:B.color||"blue",machine_types:ue}),g(!0)},Qe=async B=>{B.preventDefault();try{await fe.post("/machine-types",ee),Ee(!1),Ae({name:"",description:"",category:"Production",specifications:{}}),He(),Q("Machine type created successfully")}catch(ue){Q("Failed to create machine type: "+(ue.response?.data?.error||ue.message),"danger")}},Pe=async B=>{if(B.preventDefault(),!D?.id){Q("Invalid machine type selected","danger");return}try{await fe.put(`/machine-types/${D.id}`,ee),Ee(!1),ve(null),Ae({name:"",description:"",category:"Production",specifications:{}}),He(),Q("Machine type updated successfully")}catch(ue){console.error("Edit machine type error:",ue),Q("Failed to update machine type: "+(ue.response?.data?.error||ue.message),"danger")}},Re=async B=>{if(window.confirm("Are you sure you want to delete this machine type? This action cannot be undone."))try{await fe.delete(`/machine-types/${B}`),He(),Q("Machine type deleted successfully")}catch(ue){Q("Failed to delete machine type: "+(ue.response?.data?.error||ue.message),"danger")}},et=B=>{ve(B),Ae({name:B.name,description:B.description||"",category:B.category||"Production",specifications:B.specifications||{}}),Ee(!0)},Fe=async B=>{try{const ue={name:B,description:"Created for environment management",category:"Production"};await fe.post("/machine-types",ue),He(),Q(`Machine type "${B}" created successfully`)}catch(ue){console.error("Error creating machine type:",ue),Q(`Failed to create machine type "${B}": `+(ue.response?.data?.error||ue.message),"danger")}},Te=u.useMemo(()=>{let B=o;return v!=="all"&&(B=B.filter(ue=>ue.role===v)),j&&(B=B.filter(ue=>ue.username.toLowerCase().includes(j.toLowerCase())||ue.email.toLowerCase().includes(j.toLowerCase())||ue.employee_code&&ue.employee_code.toLowerCase().includes(j.toLowerCase()))),B},[o,v,j]),P=u.useMemo(()=>{const B=o.length,ue=o.filter(At=>At.is_active!==0).length,Ge=o.filter(At=>At.role==="admin").length,Ze=o.filter(At=>At.role==="supervisor").length,ht=o.filter(At=>At.role==="operator").length,It=o.filter(At=>At.role==="viewer").length;return{total:B,active:ue,admins:Ge,supervisors:Ze,operators:ht,viewers:It}},[o]),p=B=>{const Ge={admin:{variant:"danger",icon:ui},supervisor:{variant:"warning",icon:ia},operator:{variant:"info",icon:vt},viewer:{variant:"default",icon:Ps}}[B]||{variant:"default",icon:vt},Ze=Ge.icon;return e.jsxs(at,{variant:Ge.variant,children:[e.jsx(Ze,{className:"w-3 h-3 mr-1"}),B.toUpperCase()]})},k=B=>e.jsxs(at,{variant:B?"success":"danger",children:[B?e.jsx(ia,{className:"w-3 h-3 mr-1"}):e.jsx(Lp,{className:"w-3 h-3 mr-1"}),B?"ACTIVE":"INACTIVE"]}),ne=()=>e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[e.jsx(tt,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vt,{className:"w-5 h-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:P.total})]})]})}),e.jsx(tt,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ia,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:P.active})]})]})}),e.jsx(tt,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ui,{className:"w-5 h-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Admins"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:P.admins})]})]})}),e.jsx(tt,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ia,{className:"w-5 h-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Supervisors"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:P.supervisors})]})]})}),e.jsx(tt,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vt,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Operators"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:P.operators})]})]})}),e.jsx(tt,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"w-5 h-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Viewers"}),e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:P.viewers})]})]})})]}),Ne=({title:B,description:ue,icon:Ge,onClick:Ze,color:ht="gray"})=>{const It={blue:"border-blue-200 bg-blue-50 hover:bg-blue-100 text-blue-600",green:"border-green-200 bg-green-50 hover:bg-green-100 text-green-600",yellow:"border-yellow-200 bg-yellow-50 hover:bg-yellow-100 text-yellow-600",red:"border-red-200 bg-red-50 hover:bg-red-100 text-red-600",purple:"border-purple-200 bg-purple-50 hover:bg-purple-100 text-purple-600",gray:"border-gray-200 bg-gray-50 hover:bg-gray-100 text-gray-600"};return e.jsx(tt,{className:`p-6 border-l-4 cursor-pointer transition-all duration-300 hover:shadow-lg ${It[ht]}`,onClick:Ze,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ge,{className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:B}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:ue})]})]})})};return h&&o.length===0?e.jsx("div",{className:"p-6 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-500",children:[e.jsx(Tt,{className:"w-5 h-5 animate-spin"}),"Loading admin panel..."]})}):e.jsxs("div",{className:"p-6 space-y-6 bg-gray-50 min-h-screen",children:[S&&e.jsx("div",{className:`fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${S.type==="success"?"bg-green-100 text-green-800 border border-green-200":S.type==="danger"?"bg-red-100 text-red-800 border border-red-200":S.type==="warning"?"bg-yellow-100 text-yellow-800 border border-yellow-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:S.message}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Admin Panel"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage system settings, users, and administration"})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(Oe,{onClick:ge,disabled:x,variant:"outline",children:[e.jsx(Tt,{className:`w-4 h-4 mr-2 ${x?"animate-spin":""}`}),"Refresh"]})})]}),e.jsx(tt,{className:"p-1",children:e.jsx("div",{className:"flex gap-1",children:[{id:"overview",label:"Overview",icon:ts},{id:"users",label:"User Management",icon:vt},{id:"environments",label:"Environments",icon:Pt},{id:"machine-types",label:"Machine Types",icon:tl},{id:"settings",label:"System Settings",icon:Pt},{id:"tools",label:"Admin Tools",icon:tl}].map(B=>{const ue=B.icon;return e.jsxs("button",{onClick:()=>se(B.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${U===B.id?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(ue,{className:"w-4 h-4"}),B.label]},B.id)})})}),U==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(ne,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(Ne,{title:"User Management",description:"Add, edit, and manage user accounts",icon:vt,onClick:()=>se("users"),color:"blue"}),e.jsx(Ne,{title:"System Settings",description:"Configure system parameters",icon:Pt,onClick:()=>se("settings"),color:"green"}),e.jsx(Ne,{title:"Database Backup",description:"Backup and restore data",icon:_g,onClick:()=>Q("Backup functionality coming soon","info"),color:"yellow"}),e.jsx(Ne,{title:"Activity Logs",description:"View system activity and logs",icon:Wt,onClick:()=>Q("Activity logs coming soon","info"),color:"purple"}),e.jsx(Ne,{title:"System Reports",description:"Generate comprehensive reports",icon:ts,onClick:()=>Q("Reports functionality coming soon","info"),color:"red"}),e.jsx(Ne,{title:"Maintenance Tools",description:"System maintenance and utilities",icon:tl,onClick:()=>se("tools"),color:"gray"})]})]}),U==="users"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(ne,{}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"User Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage user accounts and permissions"})]}),e.jsxs(Oe,{onClick:()=>C(!0),children:[e.jsx(zc,{className:"w-4 h-4 mr-2"}),"Add User"]})]}),e.jsx(tt,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(oa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search users...",value:j,onChange:B=>f(B.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Qn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsxs("select",{value:v,onChange:B=>F(B.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"supervisor",children:"Supervisor"}),e.jsx("option",{value:"operator",children:"Operator"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsx("div",{className:"flex items-center justify-center md:justify-start",children:e.jsxs("span",{className:"text-sm text-gray-600",children:["Showing ",Te.length," of ",o.length," users"]})})]})}),e.jsx(tt,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["Username","Email","Employee Code","Role","Status","Last Login","Actions"].map(B=>e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:B},B))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Te.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"7",className:"text-center py-10",children:[e.jsx(vt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-2",children:"No users found"}),e.jsxs(Oe,{onClick:()=>C(!0),size:"sm",children:[e.jsx(zc,{className:"w-4 h-4 mr-2"}),"Add First User"]})]})}):Te.map(B=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:B.username})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:B.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 font-mono",children:Il(B.employee_code)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p(B.role)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:k(B.is_active)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:B.last_login?new Date(B.last_login).toLocaleDateString():"Never"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm space-x-2",children:[e.jsx(Oe,{onClick:()=>Ue(B),size:"sm",variant:"outline",children:e.jsx(di,{className:"w-4 h-4"})}),e.jsx(Oe,{onClick:()=>ye(B.id),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:e.jsx(Da,{className:"w-4 h-4"})})]})]},B.id))})]})})})]}),U==="environments"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Environment Management"}),e.jsx("p",{className:"text-gray-600",children:"Configure production environments and their machine types"})]}),e.jsxs(Oe,{onClick:()=>{le({name:"",code:"",description:"",color:"blue",machine_types:[]}),Y(null),g(!0)},children:[e.jsx(qt,{className:"w-4 h-4 mr-2"}),"Add Environment"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:G.length===0?e.jsxs(tt,{className:"col-span-full p-12 text-center",children:[e.jsx(Pt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"No environments configured"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first production environment to get started"}),e.jsxs(Oe,{onClick:()=>{le({name:"",code:"",description:"",color:"blue",machine_types:[]}),Y(null),g(!0)},children:[e.jsx(qt,{className:"w-4 h-4 mr-2"}),"Add First Environment"]})]}):G.map(B=>e.jsxs(tt,{className:`p-6 border-l-4 border-${B.color||"blue"}-200 hover:shadow-lg transition-all duration-300`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:B.name}),e.jsx("p",{className:"text-sm text-gray-500 mb-2 uppercase font-mono",children:B.code}),B.description&&e.jsx("p",{className:"text-sm text-gray-600",children:B.description})]}),e.jsx(at,{variant:B.color==="blue"?"info":B.color==="green"?"success":B.color==="yellow"?"warning":"default",children:B.code})]}),(()=>{let ue=[];try{ue=typeof B.machine_types=="string"?JSON.parse(B.machine_types):B.machine_types||[]}catch(Ge){console.error("Failed to parse machine types:",Ge),ue=[]}return ue&&ue.length>0&&e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Machine Types:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[ue.slice(0,3).map(Ge=>{const Ze=ke.find(ht=>ht.type===Ge);return e.jsxs("div",{className:"relative group",children:[e.jsxs(at,{variant:"default",size:"sm",className:"cursor-help",children:[Ge,Ze&&e.jsx("span",{className:"ml-1 px-1 py-0.5 text-xs bg-blue-200 text-blue-800 rounded-full",children:Ze.machine_count})]}),Ze&&Ze.machines&&Array.isArray(Ze.machines)&&e.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity z-10 whitespace-nowrap",children:Ze.machines.filter(ht=>ht&&ht!==null).join(", ")})]},Ge)}),ue.length>3&&e.jsxs(at,{variant:"default",size:"sm",children:["+",ue.length-3," more"]})]})]})})(),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(Oe,{onClick:()=>Ye(B),variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(di,{className:"w-4 h-4 mr-1"}),"Edit"]}),e.jsx(Oe,{onClick:()=>ze(B.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:border-red-300",children:e.jsx(Da,{className:"w-4 h-4"})})]})]},B.id))})]}),U==="machine-types"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Machine Types Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage machine types used throughout the production system"})]}),e.jsxs(Oe,{onClick:()=>{Ae({name:"",description:"",category:"Production",specifications:{}}),ve(null),Ee(!0)},children:[e.jsx(qt,{className:"w-4 h-4 mr-2"}),"Add Machine Type"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ke.length===0?e.jsxs(tt,{className:"col-span-full p-12 text-center",children:[e.jsx(tl,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"No machine types configured"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first machine type to get started"}),e.jsxs(Oe,{onClick:()=>{Ae({name:"",description:"",category:"Production",specifications:{}}),ve(null),Ee(!0)},children:[e.jsx(qt,{className:"w-4 h-4 mr-2"}),"Add First Machine Type"]})]}):ke.map(B=>e.jsxs(tt,{className:"p-6 hover:shadow-lg transition-all duration-300",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:B.name}),e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:B.category}),B.description&&e.jsx("p",{className:"text-sm text-gray-600",children:B.description})]}),e.jsxs(at,{variant:"info",children:[B.machine_count||0," machines"]})]}),B.machines&&Array.isArray(B.machines)&&B.machines.length>0&&e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Machines:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[B.machines.filter(ue=>ue&&ue!==null).slice(0,3).map((ue,Ge)=>e.jsx(at,{variant:"default",size:"sm",children:ue},Ge)),B.machines.length>3&&e.jsxs(at,{variant:"default",size:"sm",children:["+",B.machines.length-3," more"]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(Oe,{onClick:()=>et(B),variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(di,{className:"w-4 h-4 mr-1"}),"Edit"]}),e.jsx(Oe,{onClick:()=>Re(B.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:border-red-300",disabled:B.machine_count>0,children:e.jsx(Da,{className:"w-4 h-4"})})]}),B.machine_count>0&&e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Cannot delete: machines are using this type"})]},B.id))})]}),U==="settings"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"System Settings"}),e.jsx("p",{className:"text-gray-600",children:"Configure system parameters and preferences"})]}),e.jsx(tt,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Backup Frequency"}),e.jsxs("select",{value:E.backup_frequency,onChange:B=>R({...E,backup_frequency:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"hourly",children:"Hourly"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session Timeout (hours)"}),e.jsx("input",{type:"number",value:E.session_timeout,onChange:B=>R({...E,session_timeout:parseInt(B.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"72"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Login Attempts"}),e.jsx("input",{type:"number",value:E.max_login_attempts,onChange:B=>R({...E,max_login_attempts:parseInt(B.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"3",max:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maintenance Mode"}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("button",{onClick:()=>R({...E,maintenance_mode:!E.maintenance_mode}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${E.maintenance_mode?"bg-blue-600":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${E.maintenance_mode?"translate-x-6":"translate-x-1"}`})}),e.jsx("span",{className:"text-sm text-gray-600",children:E.maintenance_mode?"Enabled":"Disabled"})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(Oe,{onClick:()=>Q("Settings saved successfully"),children:[e.jsx(na,{className:"w-4 h-4 mr-2"}),"Save Settings"]})})]})})]}),U==="tools"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Admin Tools"}),e.jsx("p",{className:"text-gray-600",children:"System maintenance and administrative utilities"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(Ne,{title:"Export Users",description:"Export user data to CSV/Excel",icon:Ns,onClick:()=>Q("Export functionality coming soon","info"),color:"blue"}),e.jsx(Ne,{title:"Import Users",description:"Import users from CSV/Excel",icon:bi,onClick:()=>Q("Import functionality coming soon","info"),color:"green"}),e.jsx(Ne,{title:"Clear Cache",description:"Clear system cache and temporary files",icon:Tt,onClick:()=>Q("Cache cleared successfully"),color:"yellow"}),e.jsx(Ne,{title:"System Health",description:"Check system health and status",icon:Wt,onClick:()=>Q("System health check completed","success"),color:"purple"}),e.jsx(Ne,{title:"Security Audit",description:"Run security audit and checks",icon:ui,onClick:()=>Q("Security audit initiated","info"),color:"red"}),e.jsx(Ne,{title:"Log Analysis",description:"Analyze system logs and errors",icon:ts,onClick:()=>Q("Log analysis coming soon","info"),color:"gray"})]})]}),N&&e.jsx(Mt,{title:M?"Edit Environment":"Add New Environment",onClose:()=>{g(!1),Y(null),le({name:"",code:"",description:"",color:"blue",machine_types:[]})},children:e.jsxs("form",{onSubmit:M?Se:pe,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Environment Name"}),e.jsx("input",{type:"text",placeholder:"e.g. Blending Department",value:Z.name,onChange:B=>le({...Z,name:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Environment Code"}),e.jsx("input",{type:"text",placeholder:"e.g. blending",value:Z.code,onChange:B=>le({...Z,code:B.target.value.toLowerCase().replace(/\s+/g,"_")}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used internally (lowercase, no spaces)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),e.jsx("textarea",{placeholder:"Brief description of this environment",value:Z.description,onChange:B=>le({...Z,description:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color Theme"}),e.jsxs("select",{value:Z.color,onChange:B=>le({...Z,color:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"blue",children:"Blue"}),e.jsx("option",{value:"green",children:"Green"}),e.jsx("option",{value:"yellow",children:"Yellow"}),e.jsx("option",{value:"purple",children:"Purple"}),e.jsx("option",{value:"red",children:"Red"}),e.jsx("option",{value:"gray",children:"Gray"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Machine Types"}),e.jsx("div",{className:"space-y-3",children:ke.length>0?ke.map(B=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",id:`machine-type-${B.name||B.type}`,checked:Z.machine_types.includes(B.name||B.type),onChange:ue=>{const Ge=ue.target.checked,Ze=B.name||B.type,ht=Ge?[...Z.machine_types,Ze]:Z.machine_types.filter(It=>It!==Ze);le({...Z,machine_types:ht})},className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`machine-type-${B.name||B.type}`,className:"block text-sm font-medium text-gray-900 cursor-pointer",children:B.name||B.type}),e.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mr-2",children:[B.machine_count||0," machine",(B.machine_count||0)!==1?"s":""]}),e.jsx("span",{className:"text-gray-400",children:B.machines&&Array.isArray(B.machines)&&B.machines.length>0?e.jsxs(e.Fragment,{children:[B.machines.filter(ue=>ue&&ue!==null).slice(0,2).join(", "),B.machines.length>2&&` +${B.machines.length-2} more`]}):"No machines using this type"})]})]})]},B.name||B.type)):e.jsxs("div",{className:"text-center py-4 text-gray-500",children:[e.jsx(Pt,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm",children:"Loading machine types..."})]})}),e.jsx("div",{className:"mt-4 p-3 border-2 border-dashed border-gray-300 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"text",placeholder:"Type new machine type name and press Enter",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",onKeyPress:B=>{if(B.key==="Enter"&&B.target.value.trim()){const ue=B.target.value.trim();Z.machine_types.includes(ue)||le({...Z,machine_types:[...Z.machine_types,ue]}),Fe(ue),B.target.value=""}}}),e.jsx("span",{className:"text-xs text-gray-500",children:"Press Enter to add"})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Select existing machine types or add new ones by typing above"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(Oe,{type:"button",onClick:()=>{g(!1),Y(null),le({name:"",code:"",description:"",color:"blue",machine_types:[]})},variant:"outline",children:"Cancel"}),e.jsxs(Oe,{type:"submit",children:[M?e.jsx(na,{className:"w-4 h-4 mr-2"}):e.jsx(qt,{className:"w-4 h-4 mr-2"}),M?"Update Environment":"Create Environment"]})]})]})}),je&&e.jsx(Mt,{title:D?"Edit Machine Type":"Add New Machine Type",onClose:()=>{Ee(!1),ve(null),Ae({name:"",description:"",category:"Production",specifications:{}})},children:e.jsxs("form",{onSubmit:D?Pe:Qe,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Machine Type Name"}),e.jsx("input",{type:"text",placeholder:"e.g. Bulk Line, Processing Unit",value:ee.name,onChange:B=>Ae({...ee,name:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:ee.category,onChange:B=>Ae({...ee,category:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"Production",children:"Production"}),e.jsx("option",{value:"Processing",children:"Processing"}),e.jsx("option",{value:"Packaging",children:"Packaging"}),e.jsx("option",{value:"Quality Control",children:"Quality Control"}),e.jsx("option",{value:"Maintenance",children:"Maintenance"}),e.jsx("option",{value:"Utility",children:"Utility"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{placeholder:"Describe the machine type and its capabilities",value:ee.description,onChange:B=>Ae({...ee,description:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(Oe,{type:"button",onClick:()=>{Ee(!1),ve(null),Ae({name:"",description:"",category:"Production",specifications:{}})},variant:"outline",children:"Cancel"}),e.jsxs(Oe,{type:"submit",children:[D?e.jsx(na,{className:"w-4 h-4 mr-2"}):e.jsx(qt,{className:"w-4 h-4 mr-2"}),D?"Update Machine Type":"Create Machine Type"]})]})]})}),$&&e.jsx(Mt,{title:z?"Edit User":"Add New User",onClose:()=>{C(!1),H(null),T({username:"",email:"",password:"",role:"operator",employee_code:"",company:"Workforce"})},children:e.jsxs("form",{onSubmit:z?Le:oe,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),e.jsx("input",{type:"text",placeholder:"Username",value:d.username,onChange:B=>T({...d,username:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee Code"}),e.jsx("input",{type:"text",placeholder:"1234",value:d.employee_code,onChange:B=>T({...d,employee_code:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",placeholder:"user@example.com",value:d.email,onChange:B=>T({...d,email:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password ",z&&"(leave blank to keep current)"]}),e.jsx("input",{type:"password",placeholder:"Password",value:d.password,onChange:B=>T({...d,password:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!z})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsxs("select",{value:d.role,onChange:B=>T({...d,role:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"supervisor",children:"Supervisor"}),e.jsx("option",{value:"operator",children:"Operator"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company"}),e.jsx("input",{type:"text",placeholder:"Company name",value:d.company,onChange:B=>T({...d,company:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(Oe,{type:"button",onClick:()=>{C(!1),H(null),T({username:"",email:"",password:"",role:"operator",employee_code:"",company:"Workforce"})},variant:"outline",children:"Cancel"}),e.jsxs(Oe,{type:"submit",children:[z?e.jsx(na,{className:"w-4 h-4 mr-2"}):e.jsx(zc,{className:"w-4 h-4 mr-2"}),z?"Update User":"Create User"]})]})]})})]})}const Mh=(o,i)=>{const h=o.map(A=>Object.values(A).join(",")).join(`
`),x=Object.keys(o[0]||{}).join(",")+`
`+h,y=new Blob([x],{type:"text/csv;charset=utf-8;"}),S=document.createElement("a");S.href=URL.createObjectURL(y),S.download=i,S.click()},Yb=(o,i)=>{const h=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),c=document.createElement("a");c.href=URL.createObjectURL(h),c.download=i,c.click()},$b=(o,i)=>{if(!window.XLSX){console.warn("XLSX library not available, falling back to CSV export");const f=[...o.supervisors.map(v=>({Type:"Supervisor","Employee Code":v.employee_code||"N/A",Name:v.fullName||v.name,Machine:"N/A",Position:"Supervisor",Shift:v.shift,Company:"N/A",Status:v.status,Date:i})),...o.assignments.filter(v=>v.role!=="supervisor"&&v.position!=="Supervisor").map(v=>({Type:"Employee","Employee Code":v.employee_code||"N/A",Name:Ut(v),Machine:v.machine||"N/A",Position:v.position?v.position:v.role?v.role:"Operator",Shift:v.shift,Company:v.company||"N/A",Status:v.status,Date:i}))];Mh(f,`labour-layout-${i}.csv`);return}const h=window.XLSX.utils.book_new(),c=new Date(i),x=c.toLocaleDateString("en-US",{weekday:"long"}),y=c.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),S=[];S.push(["DAILY LABOUR LAYOUT REPORT"]),S.push([]),S.push(["Day of Week:",x]),S.push(["Date:",y]),S.push(["Total Supervisors:",o.summary.total_supervisors||0]),S.push(["Total Assignments:",o.summary.total_assignments||0]),S.push([]),o.supervisors.length>0&&(S.push(["SUPERVISORS ON DUTY"]),S.push(["Employee Code","Name","Area","Position","Shift","Status"]),o.supervisors.forEach(f=>{S.push([f.employee_code||"N/A",f.fullName||f.name,"Supervision","Supervisor",f.shift,f.status])})),o.assignments.length>0&&(S.push([]),S.push(["ASSIGNED EMPLOYEES"]),S.push(["Employee Code","Name","Machine","Position","Shift","Company","Status"]),o.assignments.filter(f=>f.role!=="supervisor"&&f.position!=="Supervisor").forEach(f=>{S.push([f.employee_code||"N/A",f.fullName||f.name,f.machine||"N/A",f.position?f.position:f.role?f.role:"Operator",f.shift,f.company||"N/A",f.status])}));const A=window.XLSX.utils.aoa_to_sheet(S),j=[{wch:20},{wch:18},{wch:15},{wch:10},{wch:12}];A["!cols"]=j,window.XLSX.utils.book_append_sheet(h,A,"Labour Layout"),window.XLSX.writeFile(h,`labour-layout-${i}.xlsx`)};function Ub(){const[o,i]=u.useState({supervisors:[],assignments:[],machinesInUse:[],summary:{total_supervisors:0,total_assignments:0,total_machines_in_use:0,day_supervisors:0,night_supervisors:0,day_assignments:0,night_assignments:0}}),[h,c]=u.useState(!0),[x,y]=u.useState(()=>{const M=new URLSearchParams(window.location.search).get("date");return M||new Date().toISOString().split("T")[0]}),[S,A]=u.useState(!1),[j,f]=u.useState("excel"),[v,F]=u.useState("all"),[U,se]=u.useState("all"),G=g=>{const M=new Date(x);M.setDate(M.getDate()+g);const Y=M.toISOString().split("T")[0];y(Y)},W=async g=>{c(!0);try{const M=await fe.get("/labour/roster?date="+g),Y=M?.data||M;console.log(" Labour roster loaded for",g,":",Y),i(Y)}catch(M){console.error(" Failed to fetch roster for "+g+":",M);try{const Y=await fe.get("/labour/today"),Z=Y?.data||Y;console.log(" Using today's labour data as fallback:",Z),i(Z||{supervisors:[],assignments:[],machinesInUse:[],summary:{total_supervisors:0,total_assignments:0,total_machines_in_use:0,day_supervisors:0,night_supervisors:0,day_assignments:0,night_assignments:0}})}catch(Y){console.error("Failed to fetch roster:",Y),alert("Failed to load roster. Please check the server connection."),i({supervisors:[],assignments:[],machinesInUse:[],summary:{total_supervisors:0,total_assignments:0,total_machines_in_use:0,day_supervisors:0,night_supervisors:0,day_assignments:0,night_assignments:0}})}}finally{c(!1)}};u.useEffect(()=>{W(x)},[x]);const N=async()=>{try{if(c(!0),j==="excel")$b(o,x),alert(`Exported labour layout for ${x}`);else{const g=[...o.supervisors.map(Y=>({Type:"Supervisor",Name:Y.fullName||Y.name,"Employee Code":Y.employee_code||"N/A",Machine:"N/A","Production Area":"Supervision",Position:Y.position,Shift:Y.shift,Status:Y.status,Date:x})),...o.assignments.filter(Y=>Y.role!=="supervisor"&&Y.position!=="Supervisor").map(Y=>({Type:"Employee",Name:Ut(Y),"Employee Code":Y.employee_code||"N/A",Machine:Y.machine||"N/A","Production Area":Y.production_area||"N/A",Position:Y.position,Shift:Y.shift,Status:Y.status,Date:x}))],M=`labour-layout-${x}.${j}`;j==="csv"?Mh(g,M):Yb(g,M),alert(`Exported ${g.length} records to ${j.toUpperCase()}`)}A(!1)}catch(g){console.error("Export error:",g),alert("Export failed: "+g.message)}finally{c(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 text-white shadow-lg",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-200 text-sm mb-2",children:[e.jsx("span",{className:"cursor-pointer hover:text-white transition-colors",onClick:()=>window.location.href="/labor-planner?date="+x,children:"Labor Planner"}),e.jsx("span",{children:">"}),e.jsx("span",{className:"text-white font-medium",children:"Layout View"}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-green-500 bg-opacity-20 text-green-200 rounded-full text-xs",children:"Live Data"})]}),e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(vt,{className:"w-8 h-8"}),"Daily Labour Layout"]}),e.jsx("p",{className:"text-blue-100 mt-1",children:"Real-time workforce management and reporting"})]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"bg-white bg-opacity-10 backdrop-blur-sm rounded-lg px-3 py-2 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>G(-1),className:"text-white hover:text-blue-200 transition-colors p-1 hover:bg-white hover:bg-opacity-10 rounded",title:"Previous day",children:e.jsx(Wc,{className:"w-4 h-4"})}),e.jsx(xs,{className:"w-4 h-4"}),e.jsx("input",{type:"date",value:x,onChange:g=>y(g.target.value),className:"bg-transparent text-white placeholder-blue-200 border-none outline-none text-sm font-medium"}),e.jsx("button",{onClick:()=>G(1),className:"text-white hover:text-blue-200 transition-colors p-1 hover:bg-white hover:bg-opacity-10 rounded",title:"Next day",children:e.jsx(Xc,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:()=>window.location.href="/labor-planner?date="+x,className:"bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg flex items-center gap-2 text-sm font-medium transition-colors",children:[e.jsx(jh,{className:"w-4 h-4"}),"Plan Workforce"]}),e.jsxs("button",{onClick:()=>A(!0),className:"bg-green-500 hover:bg-green-600 px-4 py-2 rounded-lg flex items-center gap-2 text-sm font-medium transition-colors",children:[e.jsx(Ns,{className:"w-4 h-4"}),"Export"]}),e.jsxs("button",{onClick:()=>W(x),className:"bg-white bg-opacity-10 hover:bg-white hover:bg-opacity-20 backdrop-blur-sm px-4 py-2 rounded-lg flex items-center gap-2 text-sm font-medium transition-colors",children:[e.jsx(Tt,{className:"w-4 h-4"}),"Refresh"]})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-blue-100 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Supervisors"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.summary?.total_supervisors||0})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(ia,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-green-100 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Assignments"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.summary?.total_assignments||0})]}),e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(Uc,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-orange-100 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Machines Active"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.summary?.total_machines_in_use||0})]}),e.jsx("div",{className:"bg-orange-100 p-3 rounded-full",children:e.jsx(Pt,{className:"w-6 h-6 text-orange-600"})})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Workforce Overview"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[x,"  ",(o.summary?.total_supervisors||0)+(o.summary?.total_assignments||0)+(o.summary?.total_machines_in_use||0)," total records"]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("select",{value:v,onChange:g=>F(g.target.value),className:"bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Shifts"}),e.jsx("option",{value:"day",children:"Day Shift"}),e.jsx("option",{value:"night",children:"Night Shift"})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("select",{value:U,onChange:g=>se(g.target.value),className:"bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Machine [all]"}),Array.from(new Set(o.assignments?.map(g=>g.machine).filter(g=>g))).sort().map((g,M)=>e.jsx("option",{value:g,children:g},M))]})})]})]})})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:e.jsx("div",{className:"p-6",children:h?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-3",children:"Loading workforce data..."})]}):e.jsxs("div",{className:"space-y-8",children:[o.supervisors&&o.supervisors.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(vt,{className:"w-5 h-5 text-blue-600"})}),"Supervisors on Duty"]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Employee Code"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Area"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Position"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Shift"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-blue-100",children:o.supervisors.filter(g=>v==="all"?!0:g.shift===v).map(g=>e.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-600 font-mono font-semibold",children:Il(g.employee_code)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-2 mr-3",children:e.jsx(vt,{className:"w-4 h-4 text-blue-600"})}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ut(g)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-600",children:"Supervision"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900 font-medium",children:"Supervisor"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ${g.shift==="day"?"bg-amber-100 text-amber-800":"bg-indigo-100 text-indigo-800"}`,children:g.shift==="day"?"Day Shift":"Night Shift"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-emerald-100 text-emerald-800",children:g.status})})]},`supervisor-${g.id}`))})]})})})]}),o.assignments&&o.assignments.filter(g=>{const M=v==="all"?!0:g.shift===v,Y=U==="all"?!0:g.machine===U,Z=g.role!=="supervisor"&&g.position!=="Supervisor";return M&&Y&&Z}).length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"bg-green-100 p-2 rounded-lg",children:e.jsx(Uc,{className:"w-5 h-5 text-green-600"})}),"Assigned Employees"]}),e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-green-600 to-emerald-600 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Employee Code"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Machine"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Position"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Shift"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Company"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-green-100",children:o.assignments.filter(g=>{const M=v==="all"?!0:g.shift===v,Y=U==="all"?!0:g.machine===U,Z=g.role!=="supervisor"&&g.position!=="Supervisor";return M&&Y&&Z}).map(g=>e.jsxs("tr",{className:"hover:bg-green-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-600 font-mono font-semibold",children:Il(g.employee_code)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-green-100 rounded-full p-2 mr-3",children:e.jsx(vt,{className:"w-4 h-4 text-green-600"})}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ut(g)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900 font-medium",children:g.machine||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-600",children:g.position?g.position:g.role?g.role:"Operator"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ${g.shift==="day"?"bg-amber-100 text-amber-800":"bg-indigo-100 text-indigo-800"}`,children:g.shift==="day"?"Day Shift":"Night Shift"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-600",children:g.company||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ${g.status==="present"?"bg-emerald-100 text-emerald-800":g.status==="absent"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:g.status})})]},`assignment-${g.id}`))})]})})})]}),(o.supervisors?o.supervisors.length:0)===0&&(o.assignments?o.assignments.length:0)===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(vt,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsxs("p",{children:["No labour data found for ",x]}),e.jsx("p",{className:"text-sm",children:"Try selecting a different date or check if data has been entered for this date."})]})]})})})]})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Export Labour Layout"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Export Format"}),e.jsxs("select",{value:j,onChange:g=>f(g.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("option",{value:"excel",children:"Excel (.xlsx)"}),e.jsx("option",{value:"csv",children:"CSV (.csv)"}),e.jsx("option",{value:"json",children:"JSON (.json)"})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),e.jsx("button",{onClick:N,className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:"Export"})]})]})})]})}const qb=(o,i,h)=>{const c=new Date(o),x=new Date(i),S=(Math.floor((x-c)/(1e3*60*60*24))+h)%6;return S===0||S===1?"day":S===2||S===3?"night":"rest"},ch=(o,i,h)=>i.map(c=>({...c,assignment:qb(o,h,c.offset)})),Pl=()=>{const{isConnected:o,isAuthenticated:i}=yi();return o?e.jsx("div",{className:`inline-block w-2 h-2 rounded-full ml-1 ${i?"bg-green-500":"bg-yellow-500"}`,title:i?"Connected":"Connecting..."}):null},Pb=({currentUser:o})=>{const[i,h]=u.useState(()=>new Date().toISOString().split("T")[0]),[c,x]=u.useState([]),[y,S]=u.useState(!1),[A,j]=u.useState(!1),[f,v]=u.useState(null),[F,U]=u.useState(""),[se,G]=u.useState([]),[W,N]=u.useState({}),[g,M]=u.useState({employee_id:"",role:"operator"}),[Y,Z]=u.useState(""),[le,ke]=u.useState(!1),[Be,je]=u.useState(!1),[Ee,D]=u.useState("day"),[ve,ee]=u.useState("day"),[Ae,$]=u.useState([]),[C,O]=u.useState(!1),[q,z]=u.useState(null),[H,d]=u.useState("manual"),[T,E]=u.useState(!1),[R,Q]=u.useState(null),[Ce,Me]=u.useState(""),He=async()=>{try{const P=await fe.get("/machines/shift-cycles"),p=Array.isArray(P)?P:P.data||[];for(const k of p)try{const ne=await fe.get(`/machines/${k.id}/crews`);k.crews=Array.isArray(ne)?ne:ne.data||[]}catch(ne){console.error(`Failed to load crews for machine ${k.id}:`,ne),k.crews=[]}$(p),console.log("Shift cycle machines:",p)}catch(P){console.error("Failed to fetch shift cycle machines:",P),$([])}},I=P=>{Q(P),E(!0)},ge=async(P,p,k)=>{try{const ne=await fe.post(`/machines/${P}/crews/${p}/employees`,{employee_id:k}),Ne=await fe.get(`/machines/${P}/crews`),B={...R,crews:Array.isArray(Ne)?Ne:Ne.data||[]};Q(B),He(),console.log("Employee added to crew successfully")}catch(ne){console.error("Failed to add employee to crew:",ne),alert("Failed to add employee to crew: "+(ne.response?.data?.error||ne.message))}},oe=async(P,p,k)=>{try{await fe.delete(`/machines/${P}/crews/${p}/employees/${k}`);const ne=await fe.get(`/machines/${P}/crews`),Ne={...R,crews:Array.isArray(ne)?ne:ne.data||[]};Q(Ne),He(),console.log("Employee removed from crew successfully")}catch(ne){console.error("Failed to remove employee from crew:",ne),alert("Failed to remove employee from crew: "+(ne.response?.data?.error||ne.message))}},Le=async P=>{if(!P.crews?.length){alert("Machine must have crews configured first. Please add crews to this machine.");return}if(!P.crews.some(ne=>ne.employees&&Array.isArray(ne.employees)&&ne.employees.length>0)){alert(`No employees assigned to crews for ${P.name}. Please assign employees to crews first.`),Q(P),E(!0);return}let k=P.cycle_start_date;if(!k){k=new Date().toISOString().split("T")[0];try{await fe.put(`/machines/${P.id}`,{cycle_start_date:k}),P.cycle_start_date=k,alert(`Cycle start date set to ${k} for ${P.name}`)}catch{alert("Failed to set cycle start date. Please try again.");return}}try{const ne=ch(k,P.crews,i);for(const Ne of ne)if(Ne.assignment!=="rest"&&Ne.employees?.length>0)for(const B of Ne.employees){const ue={employee_id:B.id,machine_id:P.id,assignment_date:i,shift_type:Ne.assignment,role:B.role||"operator",start_time:Ne.assignment==="day"?"06:00":"18:00",end_time:Ne.assignment==="day"?"18:00":"06:00",hourly_rate:150};await fe.post("/labor-assignments",ue)}alert(`Auto-assigned crews for ${P.name} based on 2-2-2 cycle`),Se()}catch(ne){console.error("Failed to auto-assign crews:",ne),alert("Failed to auto-assign crews: "+(ne.message||"Unknown error"))}},ye=P=>{const p=new Date(i);p.setDate(p.getDate()+P),h(p.toISOString().split("T")[0])},Ue=P=>new Date(P).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});u.useEffect(()=>{ze(),pe(),Se(),He()},[i]);const pe=async()=>{try{const P=await fe.get("/users");G(P?.data||P||[])}catch(P){console.error("Failed to fetch users:",P)}},Se=async()=>{try{const P=await fe.get(`/labor-assignments?start_date=${i}&end_date=${i}`),p={};(P?.data||P||[]).forEach(k=>{const ne=k.machine_id===null?`factory-wide-${k.role}-${k.shift_type}`:`${k.machine_id}-${k.shift_type}`;p[ne]||(p[ne]=[]),p[ne].push(k)}),N(p)}catch(P){console.error("Failed to fetch assignments:",P)}},ze=async()=>{try{S(!0),console.log(`Fetching machines for date: ${i}`),console.log("Current auth token:",localStorage.getItem("token")?"Present":"MISSING");const P=await fe.get("/labor-planner/machines",{date:i});console.log("API Response:",P);let p=[];Array.isArray(P)?p=P:(P.data&&Array.isArray(P.data)||P.success&&Array.isArray(P.data))&&(p=P.data),console.log(`Found ${p.length} machines for ${i}:`,p);const k=p.map(ne=>({id:ne.machine_id,name:ne.machine_name||`Machine ${ne.machine_id}`,order_number:ne.order_number||"No active order",product_name:ne.product_name||"N/A",order_status:ne.order_status||"N/A",environment:ne.environment,scheduled_shifts:Array.isArray(ne.scheduled_shifts)?ne.scheduled_shifts.filter(Ne=>Ne!==null):[],operators_per_shift:ne.operators_per_shift||1,hopper_loaders_per_shift:ne.hopper_loaders_per_shift||0,packers_per_shift:ne.packers_per_shift||0}));console.log(`Processed ${k.length} machines:`,k),x(k)}catch(P){console.error("Failed to fetch scheduled machines:",P),console.error("Error details:",{message:P.message,response:P.response,status:P.response?.status}),x([])}finally{S(!1)}},Ye=(P,p,k="operator")=>{v(P),U(p),M({employee_id:"",role:k}),Z(""),j(!0)},Qe=async()=>{try{const P={day:{start_time:"06:00",end_time:"18:00"},night:{start_time:"18:00",end_time:"06:00"}},p={employee_id:parseInt(g.employee_id),machine_id:g.role==="supervisor"||g.role==="forklift_driver"?null:f.id,assignment_date:i,shift_type:F,role:g.role,start_time:P[F]?.start_time||"08:00",end_time:P[F]?.end_time||"17:00",hourly_rate:150};await fe.post("/labor-assignments",p),Se(),j(!1)}catch(P){console.error("Failed to create assignment:",P),alert("Failed to assign worker: "+(P.response?.data?.error||P.message))}},Pe=async P=>{try{await fe.delete(`/labor-assignments/${P}`),Se()}catch(p){console.error("Failed to remove assignment:",p),alert("Failed to remove assignment: "+(p.response?.data?.error||p.message))}},Re=()=>{let P=se.filter(k=>k.role==="admin"?!1:!Object.values(W).some(Ne=>Ne.some(B=>B.employee_id===k.id)));if(!Y.trim())return P;const p=Y.toLowerCase();return P.filter(k=>k.username?.toLowerCase().includes(p)||k.first_name?.toLowerCase().includes(p)||k.last_name?.toLowerCase().includes(p)||`${k.first_name} ${k.last_name}`.toLowerCase().includes(p))},et=()=>Re().filter(P=>P.role!=="supervisor"),Fe=P=>[{role:"operator",required:P.operators_per_shift||2,label:"Operators"},{role:"hopper_loader",required:P.hopper_loaders_per_shift||1,label:"Hopper Loaders"},{role:"packer",required:P.packers_per_shift||3,label:"Packers"}].filter(p=>p.required>0),Te=(P,p)=>{const k=`${P}-${p}`,ne=(W[k]||[]).filter(B=>B.role!=="supervisor"),Ne={};return ne.forEach(B=>{Ne[B.role]=(Ne[B.role]||0)+1}),Ne};return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Labor Planning System"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{onClick:()=>ke(!0),size:"sm",variant:"outline",className:"bg-gradient-to-r from-slate-50 to-indigo-50 border-slate-200 text-slate-700 hover:from-slate-100 hover:to-indigo-100",leftIcon:e.jsx(ia,{className:"w-4 h-4"}),children:"Assign Supervisors"}),e.jsx(Oe,{onClick:()=>je(!0),size:"sm",variant:"outline",className:"bg-gradient-to-r from-orange-50 to-yellow-50 border-orange-200 text-orange-700 hover:from-orange-100 hover:to-yellow-100",leftIcon:e.jsx(Rc,{className:"w-4 h-4"}),children:"Assign Forklift Driver"}),e.jsxs("div",{className:"flex items-center gap-2 bg-white border border-gray-300 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>d("manual"),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${H==="manual"?"bg-blue-500 text-white":"text-gray-600 hover:bg-gray-100"}`,children:"Manual"}),e.jsx("button",{onClick:()=>d("cycle"),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${H==="cycle"?"bg-green-500 text-white":"text-gray-600 hover:bg-gray-100"}`,children:"2-2-2 Cycle"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{onClick:()=>ye(-1),size:"sm",variant:"outline",className:"p-2",children:e.jsx(Wc,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-center gap-2 bg-white border border-gray-300 rounded-lg px-4 py-2 shadow-sm",children:[e.jsx(xs,{className:"w-5 h-5 text-gray-600"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Ue(i)}),e.jsx("input",{type:"date",value:i,onChange:P=>h(P.target.value),className:"text-xs text-gray-500 border-none p-0 bg-transparent focus:outline-none"})]})]}),e.jsx(Oe,{onClick:()=>ye(1),size:"sm",variant:"outline",className:"p-2",children:e.jsx(Xc,{className:"w-4 h-4"})})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Factory-Wide Assignments"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-100 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-slate-100 p-3 rounded-full",children:e.jsx(ia,{className:"w-6 h-6 text-slate-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Supervisors"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Factory oversight"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["day","night"].map(P=>{const p=Object.values(W).flat().filter(k=>k.role==="supervisor"&&k.shift_type===P);return e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${P==="day"?"bg-yellow-100 text-yellow-800":"bg-slate-100 text-slate-800"}`,children:[P.charAt(0).toUpperCase()+P.slice(1)," Shift"]})}),p.length>0?p.map(k=>e.jsxs("div",{className:"flex items-center justify-between bg-slate-50 rounded-lg p-3 border border-slate-100",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Ut(k)})}),e.jsx("button",{onClick:()=>Pe(k.id),className:"w-6 h-6 p-0 text-red-500 hover:text-red-700 hover:bg-red-50 border border-red-200 rounded-full flex items-center justify-center",title:"Remove supervisor",children:e.jsx(rs,{className:"w-3 h-3"})})]},k.id)):e.jsx("p",{className:"text-xs italic text-gray-400 text-center py-2",children:"No supervisor assigned"})]},P)})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-orange-100 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-orange-100 p-3 rounded-full",children:e.jsx(Rc,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-orange-900",children:"Forklift Drivers"}),e.jsx("p",{className:"text-sm text-orange-600",children:"Material handling"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["day","night"].map(P=>{const p=Object.values(W).flat().filter(k=>k.role==="forklift_driver"&&k.shift_type===P);return e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${P==="day"?"bg-yellow-100 text-yellow-800":"bg-slate-100 text-slate-800"}`,children:[P.charAt(0).toUpperCase()+P.slice(1)," Shift"]})}),p.length>0?p.map(k=>e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-3 border border-orange-100",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Ut(k)})}),e.jsx("button",{onClick:()=>Pe(k.id),className:"w-6 h-6 p-0 text-red-500 hover:text-red-700 hover:bg-red-50 border border-red-200 rounded-full flex items-center justify-center",title:"Remove forklift driver",children:e.jsx(rs,{className:"w-3 h-3"})})]},k.id)):e.jsx("p",{className:"text-xs italic text-gray-400 text-center py-2",children:"No forklift driver assigned"})]},P)})})]})]})]}),H==="manual"?e.jsx("div",{children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:["Scheduled Machines for ",i]})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["2-2-2 Shift Cycle Management for ",i]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(fi,{className:"w-4 h-4"}),e.jsx("span",{children:"Automatic crew rotation every 6 days"})]})]}),Ae.length===0?e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx(fi,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No machines have 2-2-2 shift cycles enabled"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Enable shift cycles in Machine Management to use this feature"})]}):e.jsx("div",{className:"space-y-6",children:Ae.map(P=>{const p=P.cycle_start_date?ch(P.cycle_start_date,P.crews||[],i):(P.crews||[]).map(k=>({...k,assignment:"rest"}));return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:P.name}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Environment: ",P.environment]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Cycle started: ",P.cycle_start_date?new Date(P.cycle_start_date).toLocaleDateString():"Not set - Click to configure"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Oe,{onClick:()=>I(P),size:"sm",variant:"outline",className:"bg-blue-50 border-blue-200 text-blue-700 hover:bg-blue-100",leftIcon:e.jsx(vt,{className:"w-4 h-4"}),children:"Manage Crews"}),e.jsx(Oe,{onClick:()=>Le(P),size:"sm",className:"bg-green-500 hover:bg-green-600 text-white",leftIcon:e.jsx(Ta,{className:"w-4 h-4"}),children:"Auto Assign"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:p.map(k=>{const ne={day:"bg-yellow-100 text-yellow-800 border-yellow-200",night:"bg-slate-100 text-slate-800 border-slate-200",rest:"bg-gray-100 text-gray-600 border-gray-200"};return e.jsxs("div",{className:`p-4 rounded-lg border-2 ${ne[k.assignment]}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-semibold",children:["Crew ",k.letter]}),e.jsx("span",{className:"text-xs font-medium px-2 py-1 rounded-full bg-white bg-opacity-60",children:k.assignment.toUpperCase()})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:["Employees: ",k.employees?.length||0]}),k.assignment!=="rest"&&e.jsx("p",{className:"text-xs",children:k.assignment==="day"?"06:00 - 18:00":"18:00 - 06:00"})]})]},k.letter)})})]},P.id)})})]}),H==="manual"&&e.jsx("div",{children:y?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading scheduled machines..."})]}):c.length===0?e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx(Et,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsxs("p",{className:"text-gray-600",children:["No machines scheduled for ",i]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select a different date or schedule machines for this date."})]}):e.jsx("div",{className:"space-y-4",children:c.map(P=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:P.name}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Order: ",P.order_number]}),P.product_name&&P.product_name!=="N/A"&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Product: ",P.product_name]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Status: ",P.order_status]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Shifts:"}),P.scheduled_shifts.map(p=>e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${p==="day"?"bg-yellow-100 text-yellow-800":p==="night"?"bg-slate-100 text-slate-800":"bg-green-100 text-green-800"}`,children:p},p)),P.scheduled_shifts.length===0&&e.jsx("span",{className:"text-xs text-red-500",children:"No shifts assigned"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Required per shift:"}),e.jsx("div",{className:"text-xs text-gray-600 space-y-1",children:Fe(P).map(p=>e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("span",{className:"text-gray-500",children:p.required}),e.jsx("span",{className:"font-medium",children:p.label})]},p.role))})]})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:["day","night"].map(p=>{const k=P.scheduled_shifts.includes(p),ne=`${P.id}-${p}`,Ne=(W[ne]||[]).filter(ue=>ue.role!=="supervisor"),B=Fe(P);return Te(P.id,p),e.jsxs("div",{className:`bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-5 border shadow-sm ${k?"border-gray-200":"border-gray-100 opacity-60"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:`px-4 py-2 rounded-full text-sm font-semibold shadow-sm ${p==="day"?"bg-gradient-to-r from-yellow-100 to-amber-100 text-yellow-800 border border-yellow-200":"bg-gradient-to-r from-slate-100 to-indigo-100 text-slate-800 border border-slate-200"}`,children:[p.charAt(0).toUpperCase()+p.slice(1)," Shift"]}),!k&&e.jsx("span",{className:"px-2 py-1 text-xs bg-gray-200 text-gray-600 rounded-full",children:"Not Scheduled"})]})}),e.jsx("div",{className:"space-y-3",children:B.map(ue=>{const Ge=Ne.filter(Ze=>Ze.role===ue.role);return Math.max(0,ue.required-Ge.length),e.jsxs("div",{className:`bg-white rounded-lg p-3 border shadow-sm ${k?"border-gray-100":"border-gray-50 bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`font-medium ${k?"text-gray-900":"text-gray-500"}`,children:ue.label})}),k&&e.jsx(Oe,{onClick:()=>Ye(P,p,ue.role),size:"sm",variant:"outline",className:"w-8 h-8 p-0 bg-gradient-to-r from-green-50 to-emerald-50 border-green-200 text-green-600 hover:from-green-100 hover:to-emerald-100 shadow-sm rounded-full",children:e.jsx(qt,{className:"w-4 h-4"})})]}),Ge.length>0?e.jsx("div",{className:"space-y-2",children:Ge.map(Ze=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:Ut(Ze)||`Employee #${Ze.employee_id}`}),e.jsx(Pl,{})]}),k&&e.jsx(Oe,{onClick:()=>Pe(Ze.id),size:"sm",variant:"outline",className:"w-7 h-7 p-0 text-red-500 hover:text-red-700 hover:bg-red-50 border-red-200 rounded-full",children:e.jsx(rs,{className:"w-3 h-3"})})]},Ze.id))}):e.jsxs("p",{className:`text-xs italic text-center py-2 ${k?"text-gray-400":"text-gray-300"}`,children:["No ",ue.label.toLowerCase()," assigned"]})]},ue.role)})})]},p)})})})]},P.id))})}),A&&e.jsxs(Mt,{isOpen:A,onClose:()=>j(!1),title:`Assign ${g.role.replace("_"," ").replace(/\b\w/g,P=>P.toUpperCase())} to ${f?.name||"Machine"}`,size:"md",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900",children:"Assignment Details"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Machine: ",e.jsx("span",{className:"font-medium",children:f?.name}),"  Shift: ",e.jsx("span",{className:"font-medium",children:F.charAt(0).toUpperCase()+F.slice(1)}),"  Date: ",e.jsx("span",{className:"font-medium",children:i})]})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(Et,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"space-y-5",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"employee-search",className:"block text-sm font-semibold text-gray-700 mb-3",children:"Search Employee *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"employee-search",type:"text",value:Y||(g.employee_id?Ut(se.find(P=>P.id.toString()===g.employee_id))||`Employee #${g.employee_id}`:""),onChange:P=>Z(P.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-3 focus:ring-blue-500/20 focus:border-blue-500 shadow-sm transition-all duration-200",placeholder:"Type to search employees..."}),e.jsx(vt,{className:"absolute right-3 top-3 w-5 h-5 text-gray-400"})]}),e.jsxs("div",{className:"mt-3 max-h-60 overflow-y-auto border-2 border-gray-100 rounded-xl bg-white shadow-sm",children:[(g.role==="supervisor"?Re().filter(P=>P.role==="supervisor"):g.role==="forklift_driver"?Re():et()).map(P=>e.jsx("div",{onClick:()=>{M({...g,employee_id:P.id.toString()}),Z(`${P.username} ${P.first_name?`(${P.first_name} ${P.last_name})`:""}`)},className:`p-3 cursor-pointer transition-all duration-150 hover:bg-blue-50 border-b border-gray-50 last:border-b-0 ${g.employee_id===P.id.toString()?"bg-blue-50 border-l-4 border-l-blue-500":""}`,children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:Ut(P)}),e.jsx(Pl,{})]}),P.first_name&&e.jsxs("p",{className:"text-xs text-gray-500",children:[P.first_name," ",P.last_name]})]})})},P.id)),(g.role==="supervisor"?Re().filter(P=>P.role==="supervisor"):g.role==="forklift_driver"?Re():et()).length===0&&e.jsxs("p",{className:"p-4 text-gray-500 text-sm text-center",children:["No available ",g.role==="supervisor"?"supervisors":g.role==="forklift_driver"?"drivers":"workers"," found"]})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8",children:[e.jsx(Oe,{onClick:()=>j(!1),variant:"outline",className:"px-6 py-2.5 border-2 border-gray-200 hover:border-gray-300 rounded-xl font-medium transition-all duration-200",children:"Cancel"}),e.jsx(Oe,{onClick:Qe,disabled:!g.employee_id,className:"px-6 py-2.5 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white rounded-xl font-medium shadow-lg shadow-blue-500/25 transition-all duration-200 disabled:opacity-50 disabled:shadow-none",children:"Assign Worker"})]})]}),le&&e.jsx(Mt,{isOpen:le,onClose:()=>ke(!1),title:"Assign Supervisors",size:"md",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-indigo-50 border border-slate-200 rounded-xl p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:"Supervisor Assignment"}),e.jsxs("p",{className:"text-sm text-slate-700 mt-1",children:["Select supervisors for day and night shifts on ",Ue(i)]})]}),e.jsx("div",{className:"bg-slate-100 p-3 rounded-full",children:e.jsx(ia,{className:"w-6 h-6 text-slate-600"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-medium text-gray-900 flex items-center gap-2",children:e.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-semibold",children:"Day Shift"})}),e.jsx("div",{className:"space-y-2",children:Re().filter(P=>P.role==="supervisor").map(P=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:Ut(P)}),e.jsx(Pl,{})]}),e.jsx(Oe,{onClick:async()=>{try{const p={employee_id:parseInt(P.id),machine_id:null,assignment_date:i,shift_type:"day",role:"supervisor",start_time:"06:00",end_time:"18:00",hourly_rate:150};await fe.post("/labor-assignments",p),Se(),ke(!1)}catch(p){console.error("Failed to assign supervisor:",p),alert("Failed to assign supervisor: "+(p.response?.data?.error||p.message))}},size:"sm",className:"w-7 h-7 p-0 bg-green-500 text-white rounded-full hover:bg-green-600",children:e.jsx(qt,{className:"w-3 h-3"})})]},P.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-medium text-gray-900 flex items-center gap-2",children:e.jsx("span",{className:"px-3 py-1 bg-slate-100 text-slate-800 rounded-full text-sm font-semibold",children:"Night Shift"})}),e.jsx("div",{className:"space-y-2",children:Re().filter(P=>P.role==="supervisor").map(P=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:Ut(P)}),e.jsx(Pl,{})]}),e.jsx(Oe,{onClick:async()=>{try{const p={employee_id:parseInt(P.id),machine_id:null,assignment_date:i,shift_type:"night",role:"supervisor",start_time:"18:00",end_time:"06:00",hourly_rate:150};await fe.post("/labor-assignments",p),Se(),ke(!1)}catch(p){console.error("Failed to assign supervisor:",p),alert("Failed to assign supervisor: "+(p.response?.data?.error||p.message))}},size:"sm",className:"w-7 h-7 p-0 bg-green-500 text-white rounded-full hover:bg-green-600",children:e.jsx(qt,{className:"w-3 h-3"})})]},P.id))})]})]})]})}),Be&&e.jsx(Mt,{isOpen:Be,onClose:()=>je(!1),title:"Assign Forklift Driver",size:"md",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 border border-orange-200 rounded-xl p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-orange-900",children:"Forklift Driver Assignment"}),e.jsxs("p",{className:"text-sm text-orange-700 mt-1",children:["Select forklift drivers for day and night shifts on ",Ue(i)]})]}),e.jsx("div",{className:"bg-orange-100 p-3 rounded-full",children:e.jsx(Rc,{className:"w-6 h-6 text-orange-600"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-medium text-gray-900 flex items-center gap-2",children:e.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-semibold",children:"Day Shift"})}),e.jsx("div",{className:"space-y-2",children:Re().filter(P=>P.role==="operator").map(P=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:Ut(P)}),e.jsx(Pl,{})]}),e.jsx(Oe,{onClick:async()=>{try{const p={employee_id:parseInt(P.id),machine_id:null,assignment_date:i,shift_type:"day",role:"forklift_driver",start_time:"06:00",end_time:"18:00",hourly_rate:150};await fe.post("/labor-assignments",p),Se(),je(!1)}catch(p){console.error("Failed to assign forklift driver:",p),alert("Failed to assign forklift driver: "+(p.response?.data?.error||p.message))}},size:"sm",className:"w-7 h-7 p-0 bg-green-500 text-white rounded-full hover:bg-green-600",children:e.jsx(qt,{className:"w-3 h-3"})})]},P.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-medium text-gray-900 flex items-center gap-2",children:e.jsx("span",{className:"px-3 py-1 bg-slate-100 text-slate-800 rounded-full text-sm font-semibold",children:"Night Shift"})}),e.jsx("div",{className:"space-y-2",children:Re().filter(P=>P.role==="operator").map(P=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:Ut(P)}),e.jsx(Pl,{})]}),e.jsx(Oe,{onClick:async()=>{try{const p={employee_id:parseInt(P.id),machine_id:null,assignment_date:i,shift_type:"night",role:"forklift_driver",start_time:"18:00",end_time:"06:00",hourly_rate:150};await fe.post("/labor-assignments",p),Se(),je(!1)}catch(p){console.error("Failed to assign forklift driver:",p),alert("Failed to assign forklift driver: "+(p.response?.data?.error||p.message))}},size:"sm",className:"w-7 h-7 p-0 bg-green-500 text-white rounded-full hover:bg-green-600",children:e.jsx(qt,{className:"w-3 h-3"})})]},P.id))})]})]})]})}),T&&R&&e.jsxs(Mt,{isOpen:T,onClose:()=>E(!1),title:`Manage Crews - ${R.name}`,size:"lg",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900",children:"2-2-2 Shift Cycle Crews"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Assign employees to crews for automatic shift rotation"})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(vt,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:R.crews?.map(P=>e.jsxs("div",{className:"bg-white border-2 border-gray-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"font-semibold text-gray-900",children:["Crew ",P.crew_letter]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Offset: ",P.cycle_offset," days"]})]}),e.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:[P.employees?.length||0," members"]})]}),e.jsx("div",{className:"space-y-2 mb-4",children:P.employees&&P.employees.length>0?P.employees.map(p=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Ut(p)}),e.jsx("button",{onClick:()=>oe(R.id,P.crew_letter,p.id),className:"w-5 h-5 p-0 text-red-500 hover:text-red-700 hover:bg-red-50 border border-red-200 rounded-full flex items-center justify-center",title:"Remove from crew",children:e.jsx(rs,{className:"w-3 h-3"})})]},p.id)):e.jsx("p",{className:"text-xs text-gray-400 text-center py-2",children:"No employees assigned"})}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h6",{className:"text-xs font-medium text-gray-700",children:"Add Employee"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[Re().filter(p=>p.role!=="supervisor"&&p.role!=="admin").filter(p=>!R.crews?.some(k=>k.employees?.some(ne=>ne.id===p.id))).length," available"]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("input",{type:"text",placeholder:"Search employees...",value:Ce,onChange:p=>Me(p.target.value),className:"w-full px-3 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})}),e.jsxs("div",{className:"space-y-2 max-h-40 overflow-y-auto border border-gray-200 rounded p-2",children:[" ",Re().filter(p=>p.role!=="supervisor"&&p.role!=="admin").filter(p=>!R.crews?.some(k=>k.employees?.some(ne=>ne.id===p.id))).filter(p=>{if(!Ce)return!0;const k=Ce.toLowerCase();return Ut(p).toLowerCase().includes(k)||p.username?.toLowerCase().includes(k)||p.role?.toLowerCase().includes(k)}).slice(0,25).map(p=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-green-50 rounded-lg border border-green-100",children:[e.jsx("span",{className:"text-xs font-medium text-gray-900",children:Ut(p)}),e.jsx("button",{onClick:()=>ge(R.id,P.crew_letter,p.id),className:"w-5 h-5 p-0 bg-green-500 text-white rounded-full hover:bg-green-600 flex items-center justify-center",title:"Add to crew",children:e.jsx(qt,{className:"w-3 h-3"})})]},p.id)),Re().filter(p=>p.role!=="supervisor"&&p.role!=="admin").filter(p=>!R.crews?.some(k=>k.employees?.some(ne=>ne.id===p.id))).filter(p=>{if(!Ce)return!0;const k=Ce.toLowerCase();return Ut(p).toLowerCase().includes(k)||p.username?.toLowerCase().includes(k)||p.role?.toLowerCase().includes(k)}).length===0&&e.jsx("p",{className:"text-xs text-gray-400 text-center py-1",children:Ce?"No employees match your search":"No available employees"})]})]})]},P.crew_letter))}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h6",{className:"font-medium text-yellow-900 mb-2",children:"2-2-2 Cycle Instructions"}),e.jsxs("div",{className:"text-sm text-yellow-800 space-y-1",children:[e.jsxs("p",{children:[" ",e.jsx("strong",{children:"Crew A:"})," Starts on Day shift (0 offset)"]}),e.jsxs("p",{children:[" ",e.jsx("strong",{children:"Crew B:"})," Starts on Night shift (2 offset)"]}),e.jsxs("p",{children:[" ",e.jsx("strong",{children:"Crew C:"})," Starts on Rest (4 offset)"]}),e.jsx("p",{children:" Each crew works 2 days, then 2 nights, then 2 rest days"})]})]})]}),e.jsx("div",{className:"flex justify-end gap-3 mt-6",children:e.jsx(Oe,{onClick:()=>E(!1),variant:"outline",className:"px-6 py-2.5 border-2 border-gray-200 hover:border-gray-300 rounded-xl font-medium",children:"Close"})})]})]})},Hb=Pb;function Vb(){const{user:o}=ca(),[i,h]=u.useState(new Date().toISOString().split("T")[0]),[c,x]=u.useState("day"),[y,S]=u.useState([]),[A,j]=u.useState([]),[f,v]=u.useState("all"),[F,U]=u.useState(!1),[se,G]=u.useState(!1),[W,N]=u.useState(null),[g,M]=u.useState(""),Y=[{value:"present",label:"Present",color:"green",icon:xg},{value:"absent",label:"Absent",color:"red",icon:rs},{value:"late",label:"Late",color:"yellow",icon:Zt},{value:"sick",label:"Sick Leave",color:"blue",icon:gt},{value:"leave",label:"Authorized Leave",color:"purple",icon:xs}];u.useEffect(()=>{Z()},[i,c]);const Z=async()=>{U(!0);try{console.log(" ATTENDANCE REGISTER DEBUG:"),console.log(` Date: ${i},  Shift: ${c}`),console.log(" Auth token exists:",!!localStorage.getItem("token"));const D=new URLSearchParams({date:i,shift:c});console.log(` API call: /attendance-register?${D}`);const ve=await fe.get(`/attendance-register?${D}`);console.log(" Raw API response:",ve),console.log(" Response type:",typeof ve),console.log(" Response keys:",ve?Object.keys(ve):"null");let ee=[];ve&&ve.success&&Array.isArray(ve.data)?(ee=ve.data,console.log(" Using response.data array")):ve&&ve.success&&ve.data===null?(ee=[],console.log(" Response data is null, treating as empty array")):Array.isArray(ve)?(ee=ve,console.log(" Using direct response array")):(console.log(" Unexpected response structure"),console.log("   Response:",ve)),console.log(` Found ${ee.length} scheduled workers:`,ee),ee.forEach(($,C)=>{console.log(`   ${C+1}. ${$.employee_name} (${$.employee_code}) - ${$.machine_name}`)}),S(ee);const Ae=[...new Set(ee.map($=>$.machine_name).filter(Boolean))];console.log(" Available machines:",Ae),j(["all",...Ae])}catch(D){console.error(" Failed to load scheduled workers:",D),console.error(" Error details:",D.response?.data||D.message),S([]),j(["all"])}finally{U(!1)}},le=async(D,ve,ee=null,Ae="")=>{try{const $={date:i,machine_id:parseInt(D.machine_id),employee_id:parseInt(D.employee_id),shift_type:c,status:ve,check_in_time:ee,notes:Ae,marked_by:o?.id||null};console.log("Marking attendance:",$),await fe.post("/attendance-register",$),Z(),G(!1),N(null)}catch($){console.error("Failed to mark attendance:",$),alert("Failed to mark attendance: "+($.response?.data?.message||$.message))}},ke=()=>{const D=new Date(i);D.setDate(D.getDate()-1),h(D.toISOString().split("T")[0])},Be=()=>{const D=new Date(i);D.setDate(D.getDate()+1),h(D.toISOString().split("T")[0])},je=D=>{const ve=Y.find(Ae=>Ae.value===D)||Y[0],ee=ve.icon;return D?e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-${ve.color}-100 text-${ve.color}-800`,children:[e.jsx(ee,{className:"w-4 h-4 mr-1"}),ve.label]}):e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-gray-100 text-gray-800",children:[e.jsx(Zt,{className:"w-4 h-4 mr-1"}),"Not Marked"]})},Ee=y.filter(D=>{const ve=!g||D.employee_name?.toLowerCase().includes(g.toLowerCase())||D.employee_code?.toLowerCase().includes(g.toLowerCase())||D.machine_name?.toLowerCase().includes(g.toLowerCase()),ee=f==="all"||D.machine_name===f,Ae=D.assignment_role!=="supervisor";return ve&&ee&&Ae});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 text-white shadow-lg",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(vt,{className:"w-8 h-8"}),"Daily Attendance Register"]}),e.jsx("p",{className:"text-blue-100 mt-1",children:"Mark attendance for scheduled workers"})]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4 text-blue-300"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:ke,className:"bg-white bg-opacity-20 text-white p-2 rounded-lg border border-white border-opacity-20 hover:bg-opacity-30 transition-colors",title:"Previous day",children:e.jsx(Wc,{className:"w-4 h-4"})}),e.jsx("input",{type:"date",value:i,onChange:D=>h(D.target.value),className:"bg-white bg-opacity-20 text-white px-3 py-2 rounded-lg border border-white border-opacity-20 focus:border-opacity-40 min-w-[140px]"}),e.jsx("button",{onClick:Be,className:"bg-white bg-opacity-20 text-white p-2 rounded-lg border border-white border-opacity-20 hover:bg-opacity-30 transition-colors",title:"Next day",children:e.jsx(Xc,{className:"w-4 h-4"})})]})]}),e.jsxs("select",{value:c,onChange:D=>x(D.target.value),className:"bg-white bg-opacity-20 text-white rounded-lg px-3 py-2",children:[e.jsx("option",{value:"day",className:"text-black",children:"Day Shift"}),e.jsx("option",{value:"night",className:"text-black",children:"Night Shift"})]}),e.jsx("select",{value:f,onChange:D=>v(D.target.value),className:"bg-white bg-opacity-20 text-white rounded-lg px-3 py-2",children:A.map(D=>e.jsx("option",{value:D,className:"text-black",children:D==="all"?"All Machines":D},D))}),e.jsxs("div",{className:"relative",children:[e.jsx(oa,{className:"absolute left-3 top-2.5 w-4 h-4 text-blue-300"}),e.jsx("input",{type:"text",placeholder:"Search workers...",value:g,onChange:D=>M(D.target.value),className:"bg-white bg-opacity-20 text-white placeholder-blue-200 pl-10 pr-4 py-2 rounded-lg border border-white border-opacity-20 focus:border-opacity-40"})]})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Scheduled Workers - ",i," (",c==="day"?"Day":"Night"," Shift)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:y.filter(D=>D.assignment_role!=="supervisor").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Scheduled"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:y.filter(D=>D.status==="present"&&D.assignment_role!=="supervisor").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Present"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:y.filter(D=>D.status==="absent"&&D.assignment_role!=="supervisor").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Absent"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:y.filter(D=>!D.status&&D.assignment_role!=="supervisor").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Not Marked"})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:e.jsx("div",{className:"p-6",children:F?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-3",children:"Loading scheduled workers..."})]}):Ee.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(vt,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"No scheduled workers found"}),e.jsx("p",{className:"text-sm text-gray-400",children:y.length===0?`No workers scheduled for ${c} shift on ${i}`:"Try adjusting your search or machine filter"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Machine"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check In"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ee.map(D=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-2 mr-3",children:e.jsx(vt,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:Ut(D)}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",Il(D.employee_code)]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:D.machine_name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:je(D.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:D.check_in_time||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm space-x-2",children:e.jsx("button",{onClick:()=>{N(D),G(!0)},className:"text-blue-600 hover:text-blue-800 font-medium",children:D.status?"Update":"Mark Attendance"})})]},`${D.employee_id}-${D.machine_id}`))})]})})})})]}),se&&W&&e.jsx(Mt,{title:"Mark Attendance",onClose:()=>{G(!1),N(null)},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Employee Details"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[Ut(W)," (",Il(W.employee_code),")"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Machine: ",W.machine_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Shift: ",c==="day"?"Day":"Night"]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Y.map(D=>{const ve=D.icon;return e.jsxs("button",{onClick:()=>le(W,D.value,new Date().toLocaleTimeString()),className:`flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors
                                            border-${D.color}-200 hover:border-${D.color}-400 hover:bg-${D.color}-50`,children:[e.jsx(ve,{className:`w-5 h-5 text-${D.color}-600`}),e.jsx("span",{className:`text-sm font-medium text-${D.color}-700`,children:D.label})]},D.value)})}),e.jsx("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:e.jsx(Oe,{variant:"secondary",onClick:()=>{G(!1),N(null)},children:"Cancel"})})]})})]})}function Ib(){const{user:o}=ca(),[i,h]=u.useState([]),[c,x]=u.useState([]),[y,S]=u.useState(!1),[A,j]=u.useState(!1),[f,v]=u.useState(!1),[F,U]=u.useState(null),[se,G]=u.useState(""),[W,N]=u.useState("all"),[g,M]=u.useState({production_order_id:"",blend_name:"",batch_number:"",quantity_produced:"",quantity_expected:"",unit_of_measurement:"kg",maturation_date:new Date().toISOString().split("T")[0],expected_maturation_days:30,storage_location:"",temperature:"",humidity:"",notes:""}),[Y,Z]=u.useState({temperature:"",humidity:"",visual_condition:"Good",notes:""}),le=[{value:"maturing",label:"Maturing",color:"blue",icon:Zt},{value:"ready",label:"Ready",color:"green",icon:mi},{value:"completed",label:"Completed",color:"purple",icon:cs},{value:"quality_check",label:"Quality Check",color:"yellow",icon:Ps},{value:"rejected",label:"Rejected",color:"red",icon:gt}],ke=["Excellent","Good","Fair","Poor","Concerning"];u.useEffect(()=>{Be()},[]),u.useEffect(()=>{i.length>=0&&je()},[i]);const Be=async()=>{S(!0);try{const d=await fe.get("/maturation-room");h(d.data||d)}catch(d){console.error("Failed to load maturation data:",d),h([])}finally{S(!1)}},je=async()=>{try{const d=await fe.get("/orders?status=completed&environment=blending&include_archived=true"),T=Array.isArray(d)?d:d.data||[];console.log(" Total completed orders found:",T.length),console.log(" Current maturation records:",i.length);const E=T.filter(R=>{const Q=i.some(Ce=>Ce.production_order_id===R.id||Ce.production_order_id===R.order_id);return Q&&console.log(` Order ${R.order_number} already in maturation, excluding`),!Q});console.log(" Available orders for maturation:",E.length),x(E)}catch(d){console.error("Failed to load completed blending orders:",d),x([])}},Ee=async d=>{d.preventDefault();try{const T={...g,quantity_produced:parseFloat(g.quantity_produced),quantity_expected:parseFloat(g.quantity_expected),temperature:g.temperature?parseFloat(g.temperature):null,humidity:g.humidity?parseFloat(g.humidity):null,confirmed_by:o.id};await fe.post("/maturation-room",T),j(!1),ee(),Be(),je()}catch(T){console.error("Failed to add to maturation:",T),alert("Failed to add blend to maturation: "+(T.response?.data?.message||T.message))}},D=async d=>{d.preventDefault();try{const T={maturation_room_id:F.id,check_date:new Date().toISOString().split("T")[0],temperature:Y.temperature?parseFloat(Y.temperature):null,humidity:Y.humidity?parseFloat(Y.humidity):null,visual_condition:Y.visual_condition,notes:Y.notes,checked_by:o.id};await fe.post("/maturation-room/daily-check",T),v(!1),U(null),Ae(),Be()}catch(T){console.error("Failed to add daily check:",T),alert("Failed to add daily check: "+(T.response?.data?.message||T.message))}},ve=async(d,T)=>{try{await fe.put(`/maturation-room/${d}/status`,{status:T,quality_checked:T==="ready",quality_check_date:T==="ready"?new Date().toISOString().split("T")[0]:null,quality_checked_by:T==="ready"?o.id:null}),Be()}catch(E){console.error("Failed to update status:",E),alert("Failed to update status: "+(E.response?.data?.message||E.message))}},ee=()=>{M({production_order_id:"",blend_name:"",batch_number:"",quantity_produced:"",quantity_expected:"",unit_of_measurement:"kg",maturation_date:new Date().toISOString().split("T")[0],expected_maturation_days:30,storage_location:"",temperature:"",humidity:"",notes:""})},Ae=()=>{Z({temperature:"",humidity:"",visual_condition:"Good",notes:""})},$=d=>{const T=le.find(R=>R.value===d)||le[0],E=T.icon;return e.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-${T.color}-100 text-${T.color}-800`,children:[e.jsx(E,{className:"w-4 h-4 mr-1"}),T.label]})},C=d=>{const T=new Date(d),R=Math.abs(new Date-T);return Math.ceil(R/(1e3*60*60*24))},O=d=>Math.abs(d)<5?"text-green-600":Math.abs(d)<15?"text-yellow-600":"text-red-600",q=()=>{let T=Array.isArray(i)?i:[];if(W!=="all"&&(T=T.filter(E=>E.status===W)),se.trim()){const E=se.toLowerCase();T=T.filter(R=>R.blend_name?.toLowerCase().includes(E)||R.batch_number?.toLowerCase().includes(E)||R.storage_location?.toLowerCase().includes(E))}return T},z=()=>{const d=[["Blend Name","Batch Number","Status","Qty Produced","Qty Expected","Variance %","Maturation Date","Days Maturing","Expected Ready","Storage Location","Temperature","Humidity"].join(","),...q().map(Q=>[Q.blend_name,Q.batch_number,Q.status,Q.quantity_produced,Q.quantity_expected,Q.variance_percentage&&typeof Q.variance_percentage=="number"?Q.variance_percentage.toFixed(2):"0.00",Q.maturation_date,C(Q.maturation_date),Q.estimated_completion_date,Q.storage_location||"N/A",Q.temperature||"N/A",Q.humidity||"N/A"].join(","))].join(`
`),T=new Blob([d],{type:"text/csv"}),E=URL.createObjectURL(T),R=document.createElement("a");R.href=E,R.download=`maturation-room-${new Date().toISOString().split("T")[0]}.csv`,R.click(),URL.revokeObjectURL(E)},H=q();return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-700 text-white shadow-lg",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-200 text-sm mb-2",children:[e.jsx("span",{className:"cursor-pointer hover:text-white transition-colors",children:"Daily Operations"}),e.jsx("span",{children:">"}),e.jsx("span",{className:"text-white font-medium",children:"Maturation Room"}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-green-500 bg-opacity-20 text-green-200 rounded-full text-xs",children:"Live"})]}),e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(cs,{className:"w-8 h-8"}),"Maturation Room"]}),e.jsx("p",{className:"text-purple-100 mt-1",children:"Track and confirm blending quantities during maturation"})]}),e.jsxs("button",{onClick:()=>j(!0),className:"bg-white bg-opacity-20 hover:bg-white hover:bg-opacity-30 px-4 py-2 rounded-lg flex items-center gap-2 text-sm font-medium transition-colors",children:[e.jsx(qt,{className:"w-4 h-4"}),"Add to Maturation"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(oa,{className:"absolute left-3 top-2.5 w-4 h-4 text-purple-300"}),e.jsx("input",{type:"text",placeholder:"Search blends...",value:se,onChange:d=>G(d.target.value),className:"bg-white bg-opacity-10 text-white placeholder-purple-200 pl-10 pr-4 py-2 rounded-lg border border-white border-opacity-20 focus:border-opacity-40 focus:bg-opacity-20"})]}),e.jsxs("select",{value:W,onChange:d=>N(d.target.value),className:"bg-white bg-opacity-10 text-white rounded-lg px-3 py-2 text-sm font-medium",children:[e.jsx("option",{value:"all",className:"text-black",children:"All Status"}),le.map(d=>e.jsx("option",{value:d.value,className:"text-black",children:d.label},d.value))]}),e.jsxs("button",{onClick:z,className:"bg-green-500 hover:bg-green-600 px-4 py-2 rounded-lg flex items-center gap-2 text-sm font-medium transition-colors",children:[e.jsx(Ns,{className:"w-4 h-4"}),"Export CSV"]})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:le.slice(0,4).map(d=>{const T=Array.isArray(i)?i.filter(R=>R.status===d.value).length:0,E=d.icon;return e.jsx("div",{className:`bg-white rounded-xl shadow-sm border border-${d.color}-100 p-6`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium text-${d.color}-600`,children:d.label}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:T})]}),e.jsx("div",{className:`bg-${d.color}-100 p-3 rounded-full`,children:e.jsx(E,{className:`w-6 h-6 text-${d.color}-600`})})]})},d.value)})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:e.jsx("div",{className:"p-6",children:y?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-3",children:"Loading maturation data..."})]}):H.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(cs,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"No blends in maturation"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Add completed blends to start tracking maturation"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Blend"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batch Number"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantities"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Variance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Days Maturing"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Conditions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.map(d=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:d.blend_name}),e.jsx("div",{className:"text-sm text-gray-500",children:d.storage_location})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-mono text-gray-900",children:d.batch_number})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$(d.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[d.quantity_produced," / ",d.quantity_expected," ",d.unit_of_measurement]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:`text-sm font-medium ${O(d.variance_percentage||0)}`,children:d.variance_percentage&&typeof d.variance_percentage=="number"?`${d.variance_percentage.toFixed(1)}%`:"0.0%"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:[C(d.maturation_date)," days"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Target: ",d.expected_maturation_days," days"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[d.temperature&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Pc,{className:"w-4 h-4"}),d.temperature,"C"]}),d.humidity&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Mg,{className:"w-4 h-4"}),d.humidity,"%"]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm space-x-2",children:[e.jsx("button",{onClick:()=>{U(d),v(!0)},className:"text-blue-600 hover:text-blue-800",children:"Daily Check"}),d.status==="maturing"&&C(d.maturation_date)>=d.expected_maturation_days&&e.jsx("button",{onClick:()=>ve(d.id,"ready"),className:"text-green-600 hover:text-green-800",children:"Mark Ready"})]})]},d.id))})]})})})})]}),A&&e.jsx(Mt,{title:"Add Blend to Maturation",onClose:()=>j(!1),size:"medium",children:e.jsxs("form",{onSubmit:Ee,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(cs,{className:"w-4 h-4 inline mr-2"}),"Production Order (Completed)"]}),e.jsxs("select",{value:g.production_order_id,onChange:d=>{const T=c.find(E=>E.id.toString()===d.target.value);M({...g,production_order_id:d.target.value,blend_name:T?.product_name||"",batch_number:T?.order_number||"",quantity_expected:T?.quantity||"",quantity_produced:T?.quantity||"",unit_of_measurement:T?.unit_of_measurement||"kg"})},className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Select Completed Order"}),c.map(d=>e.jsxs("option",{value:d.id,children:[d.order_number," - ",d.product_name," (",d.quantity," ",d.unit_of_measurement||"kg",")"]},d.id))]})]}),g.production_order_id&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-semibold text-green-800 mb-3 flex items-center",children:[e.jsx(mi,{className:"w-4 h-4 mr-2"}),"Confirmed Order Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Product:"}),e.jsx("p",{className:"font-medium text-gray-900",children:g.blend_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Batch Number:"}),e.jsx("p",{className:"font-mono font-medium text-gray-900",children:g.batch_number})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Quantity:"}),e.jsxs("p",{className:"font-medium text-gray-900",children:[g.quantity_produced," ",g.unit_of_measurement]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Unit:"}),e.jsx("p",{className:"font-medium text-gray-900",children:g.unit_of_measurement})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Maturation Configuration"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expected Maturation (days)"}),e.jsx("input",{type:"number",value:g.expected_maturation_days,onChange:d=>M({...g,expected_maturation_days:d.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",min:"1",max:"365",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Storage Location"}),e.jsx("input",{type:"text",value:g.storage_location,onChange:d=>M({...g,storage_location:d.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g., Room A1, Bay 3",required:!0})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Pc,{className:"w-4 h-4 mr-2"}),"Initial Conditions (Optional)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Initial Temperature (C)"}),e.jsx("input",{type:"number",step:"0.1",value:g.temperature,onChange:d=>M({...g,temperature:d.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g., 20.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Initial Humidity (%)"}),e.jsx("input",{type:"number",step:"0.1",value:g.humidity,onChange:d=>M({...g,humidity:d.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g., 65.0"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:g.notes,onChange:d=>M({...g,notes:d.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:"3",placeholder:"Any additional notes about the maturation process..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(Oe,{type:"button",variant:"secondary",onClick:()=>j(!1),children:"Cancel"}),e.jsx(Oe,{type:"submit",disabled:!g.production_order_id,children:"Add to Maturation"})]})]})}),f&&F&&e.jsx(Mt,{title:"Daily Maturation Check",onClose:()=>v(!1),children:e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Blend: ",F.blend_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Batch: ",F.batch_number]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Days maturing: ",C(F.maturation_date)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Temperature (C)"}),e.jsx("input",{type:"number",step:"0.1",value:Y.temperature,onChange:d=>Z({...Y,temperature:d.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Humidity (%)"}),e.jsx("input",{type:"number",step:"0.1",value:Y.humidity,onChange:d=>Z({...Y,humidity:d.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Visual Condition"}),e.jsx("select",{value:Y.visual_condition,onChange:d=>Z({...Y,visual_condition:d.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:ke.map(d=>e.jsx("option",{value:d,children:d},d))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:Y.notes,onChange:d=>Z({...Y,notes:d.target.value}),className:"w-full px-3 py-2 border rounded-lg",rows:"3",placeholder:"Any observations or notes..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(Oe,{type:"button",variant:"secondary",onClick:()=>v(!1),children:"Cancel"}),e.jsx(Oe,{type:"submit",children:"Save Check"})]})]})})]})}const Gb=({machines:o=[],environments:i=[],onMachineClick:h})=>{const[c,x]=u.useState(!1),[y,S]=u.useState(null),[A,j]=u.useState(null);let f=null,v=null;const F=async()=>{if(window.BABYLON&&window.BABYLON.Engine&&window.BABYLON.Scene&&window.BABYLON.ArcRotateCamera&&window.BABYLON.PBRMaterial&&window.BABYLON.NodeMaterial&&window.BABYLON.ProceduralTexture)return console.log(" Advanced Babylon.js already available"),!0;console.log(" Loading Ultra-Enhanced Babylon.js with advanced features for 100MB+ factory...");const N=g=>new Promise((M,Y)=>{const Z=document.createElement("script");Z.src=g,Z.async=!1,Z.onload=M,Z.onerror=Y,document.head.appendChild(Z)});try{return await N("https://cdn.babylonjs.com/babylon.js"),await N("https://cdn.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"),await N("https://cdn.babylonjs.com/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"),await N("https://cdn.babylonjs.com/nodeEditor/babylon.nodeEditor.js"),await N("https://cdn.babylonjs.com/postProcessesLibrary/babylonjs.postProcess.min.js"),await N("https://cdn.babylonjs.com/inspector/babylon.inspector.bundle.js"),await N("https://cdn.babylonjs.com/gui/babylon.gui.min.js"),console.log(" Ultra-Enhanced Babylon.js loaded with advanced features"),console.log(" Ready for 100MB+ ultra-high quality factory rendering"),!0}catch(g){throw console.error(" Failed to load enhanced Babylon.js:",g),new Error("Failed to load enhanced Babylon.js suite")}},U=async N=>{try{if(!N)throw new Error("Canvas element not provided");if(console.log(" Canvas found, creating Babylon engine..."),!window.BABYLON||!window.BABYLON.Engine||!window.BABYLON.ArcRotateCamera)throw new Error("Babylon.js not fully loaded");v=new window.BABYLON.Engine(N,!0,{preserveDrawingBuffer:!0,stencil:!0,antialias:!0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,alpha:!1,premultipliedAlpha:!1,depth:!0,desynchronized:!0,adaptToDeviceRatio:!0,xrCompatible:!0,audioEngine:!1,deterministicLockstep:!0,lockstepMaxSteps:4,timeStep:1/60,useHighPrecisionFloats:!0,useExactSrgbConversions:!0,disableWebGL2Support:!1,useReverseDepthBuffer:!0}),v.setHardwareScalingLevel(1),v.setSize(N.clientWidth,N.clientHeight,!0),v.enableOfflineSupport=!1,v.doNotHandleContextLost=!0,f=new window.BABYLON.Scene(v),console.log(" Ultra-enhanced engine and scene created for 100MB+ factory"),f.performancePriority=window.BABYLON.ScenePerformancePriority.BackwardCompatible,f.skipPointerMovePicking=!1,f.autoClear=!0,f.autoClearDepthAndStencil=!0,f.imageProcessingConfiguration.contrast=1.2,f.imageProcessingConfiguration.exposure=1.1,f.imageProcessingConfiguration.toneMappingEnabled=!0,f.imageProcessingConfiguration.toneMappingType=window.BABYLON.ImageProcessingConfiguration.TONEMAPPING_ACES,f.environmentIntensity=1,f.blockMaterialDirtyMechanism=!1,f.forceWireframe=!1,f.forcePointsCloud=!1,f.useGeometryUniqueIdsMap=!0,f.useMaterialMeshMap=!0,f.useClonedMeshMap=!0,f.getMeshes&&f.onNewMeshAddedObservable.add(I=>{I&&(I.renderOutline=!1,I.showBoundingBox=!1,I.checkCollisions=!1,I.isPickable=I.name.startsWith("machine_")||I.name.startsWith("platform_"),I.material&&(I.material.wireframe=!1,I.material.backFaceCulling=!0))}),console.log(" Creating enhanced ArcRotate camera for full-screen stretched coverage...");const g=new window.BABYLON.ArcRotateCamera("factoryCamera",-Math.PI/4,Math.PI/2.5,150,new window.BABYLON.Vector3(0,0,0),f);console.log(" Camera created:",g.constructor.name),g.lowerBetaLimit=.1,g.upperBetaLimit=Math.PI/2.1,g.lowerRadiusLimit=40,g.upperRadiusLimit=400,g.wheelPrecision=20,g.angularSensibilityX=1e3,g.angularSensibilityY=1e3,g.panningSensibility=50,g.pinchPrecision=100,g.useBouncingBehavior=!0,g.useAutoRotationBehavior=!1,g.useFramingBehavior=!1;const M=()=>{try{if(!N)return console.error("Canvas not available for camera controls"),!1;if(!g)return console.error("Camera not available for controls"),!1;if(typeof g.attachControls=="function")g.attachControls(N,!0),console.log(" Camera controls attached via attachControls");else if(typeof g.attachControl=="function")g.attachControl(N,!0),console.log(" Camera controls attached via attachControl");else return console.warn(" Native camera controls not available, setting up manual controls"),Y(),!0;return N.setAttribute("tabindex","0"),N.style.outline="none",N.style.touchAction="none",!0}catch(I){return console.error(" Camera controls failed:",I),Y(),!1}},Y=()=>{console.log(" Setting up manual camera controls...");let I=!1,ge=0,oe=0;const Le=Se=>{I=!0,ge=Se.clientX,oe=Se.clientY,N.setPointerCapture?.(Se.pointerId)},ye=Se=>{if(!I)return;const ze=Se.clientX-ge,Ye=Se.clientY-oe;g.alpha-=ze*.01,g.beta+=Ye*.01,g.beta=Math.max(g.lowerBetaLimit||.1,Math.min(g.upperBetaLimit||Math.PI/2,g.beta)),ge=Se.clientX,oe=Se.clientY},Ue=Se=>{I=!1,N.releasePointerCapture?.(Se.pointerId)},pe=Se=>{Se.preventDefault(),Se.stopPropagation();const ze=Se.deltaY*.05;g.radius+=ze,g.radius=Math.max(g.lowerRadiusLimit||5,Math.min(g.upperRadiusLimit||200,g.radius)),N.focus()};N.addEventListener("pointerdown",Le),N.addEventListener("pointermove",ye),N.addEventListener("pointerup",Ue),N.addEventListener("wheel",pe,{passive:!1}),N.addEventListener("scroll",Se=>{Se.preventDefault(),Se.stopPropagation()},{passive:!1}),N.addEventListener("mouseenter",()=>{N.focus(),document.body.style.overflow="hidden"}),N.addEventListener("mouseleave",()=>{document.body.style.overflow="auto"}),N.addEventListener("touchstart",Se=>{Se.touches.length===1&&Le({clientX:Se.touches[0].clientX,clientY:Se.touches[0].clientY,pointerId:0})}),N.addEventListener("touchmove",Se=>{Se.touches.length===1&&(Se.preventDefault(),ye({clientX:Se.touches[0].clientX,clientY:Se.touches[0].clientY}))}),N.addEventListener("touchend",()=>{Ue({pointerId:0})}),console.log(" Manual camera controls active")};f.activeCamera=g,M();const Z=I=>{console.log(" Creating ultra-enhanced lighting system for 100MB+ factory..."),console.log(" Using bright white skybox for maximum brightness");const ge=window.BABYLON.MeshBuilder.CreateSphere("skyBox",{diameter:1e3},I),oe=new window.BABYLON.StandardMaterial("skyBox",I);oe.diffuseColor=new window.BABYLON.Color3(.9,.9,.9),oe.emissiveColor=new window.BABYLON.Color3(.2,.2,.2),oe.disableLighting=!0,ge.material=oe,ge.infiniteDistance=!0;const Le=new window.BABYLON.HemisphericLight("ultraBrightAmbient",new window.BABYLON.Vector3(0,1,0),I);Le.intensity=1.5,Le.diffuse=new window.BABYLON.Color3(1,1,1),Le.groundColor=new window.BABYLON.Color3(.9,.9,.9);const ye=new window.BABYLON.DirectionalLight("ultraBrightMain",new window.BABYLON.Vector3(-.3,-1,.5),I);ye.intensity=2,ye.diffuse=new window.BABYLON.Color3(1,1,1),ye.specular=new window.BABYLON.Color3(1,1,1);const Ue=new window.BABYLON.DirectionalLight("floodLight1",new window.BABYLON.Vector3(.5,-1,-.5),I);Ue.intensity=1.5,Ue.diffuse=new window.BABYLON.Color3(1,1,1);const pe=new window.BABYLON.DirectionalLight("floodLight2",new window.BABYLON.Vector3(-.5,-1,.5),I);pe.intensity=1.5,pe.diffuse=new window.BABYLON.Color3(1,1,1);let Se=null;console.log(" Shadows disabled for maximum brightness and performance");const ze=new window.BABYLON.DirectionalLight("volumetricFillLight",new window.BABYLON.Vector3(.7,-.6,-.4),I);ze.intensity=.8,ze.diffuse=new window.BABYLON.Color3(1,1,1),[{pos:new window.BABYLON.Vector3(-15,12,0),color:new window.BABYLON.Color3(.4,.6,1)},{pos:new window.BABYLON.Vector3(15,12,0),color:new window.BABYLON.Color3(1,.8,.4)}].forEach((Re,et)=>{const Fe=new window.BABYLON.SpotLight(`zoneAccentLight_${et}`,Re.pos,new window.BABYLON.Vector3(0,-1,0),Math.PI/4,4,I);Fe.intensity=.8,Fe.diffuse=Re.color,Fe.specular=Re.color.scale(.3)});const Qe=()=>{const Re=new window.BABYLON.PointLight("dynamicMachineLight",new window.BABYLON.Vector3(0,5,0),I);return Re.intensity=0,Re.diffuse=new window.BABYLON.Color3(1,.8,.3),window.BABYLON.Animation.CreateAndStartAnimation("machineLightPulse",Re,"intensity",30,90,0,1.5,window.BABYLON.Animation.ANIMATIONLOOPMODE_YOYO),Re};console.log(" Post-processing disabled for maximum performance");let Pe=null;return console.log(" Ultra-enhanced cinematic lighting system initialized for 100MB+ factory"),{shadowGenerator:Se,defaultPipeline:Pe}},{shadowGenerator:le,defaultPipeline:ke}=Z(f);f.ultraShadowGenerator=le,f.ultraPipeline=ke,((I,ge)=>{const oe={overview:{alpha:-Math.PI/4,beta:Math.PI/2.5,radius:200,target:new window.BABYLON.Vector3(0,0,0)},blending:{alpha:-Math.PI,beta:Math.PI/3,radius:80,target:new window.BABYLON.Vector3(0,0,-14)},maturation:{alpha:-Math.PI*.75,beta:Math.PI/3,radius:70,target:new window.BABYLON.Vector3(-18,0,0)},processing:{alpha:-Math.PI*.25,beta:Math.PI/3,radius:70,target:new window.BABYLON.Vector3(18,0,0)},packaging:{alpha:0,beta:Math.PI/3,radius:90,target:new window.BABYLON.Vector3(0,0,14)},isometric:{alpha:Math.PI/4,beta:Math.PI/3,radius:180,target:new window.BABYLON.Vector3(0,0,0)},aerial:{alpha:-Math.PI/2,beta:Math.PI/6,radius:300,target:new window.BABYLON.Vector3(0,0,0)},factory_flow:{alpha:Math.PI/6,beta:Math.PI/2.8,radius:250,target:new window.BABYLON.Vector3(0,0,0)},quality_control:{alpha:-Math.PI/3,beta:Math.PI/2.2,radius:120,target:new window.BABYLON.Vector3(12,0,8)}};window.factoryCameraPresets={goTo:Le=>{const ye=oe[Le];if(!ye)return;const Ue=1e3;window.BABYLON.Animation.CreateAndStartAnimation("cameraAlpha",I,"alpha",60,60,I.alpha,ye.alpha,window.BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),window.BABYLON.Animation.CreateAndStartAnimation("cameraBeta",I,"beta",60,60,I.beta,ye.beta,window.BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),window.BABYLON.Animation.CreateAndStartAnimation("cameraRadius",I,"radius",60,60,I.radius,ye.radius,window.BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),ye.target&&(window.BABYLON.Animation.CreateAndStartAnimation("cameraTargetX",I,"target.x",60,60,I.target.x,ye.target.x,window.BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),window.BABYLON.Animation.CreateAndStartAnimation("cameraTargetZ",I,"target.z",60,60,I.target.z,ye.target.z,window.BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT)),console.log(` Camera moving to ${Le} preset`)},list:()=>Object.keys(oe)},console.log(' Camera presets available: window.factoryCameraPresets.goTo("overview")'),window.factoryDigitalTwin={updateMachineStatus:(Le,ye,Ue={})=>{const pe=ge.getMeshByName(`machine_${Le}`),Se=ge.getMeshByName(`status_${Le}`);if(pe&&Se){const ze={available:new window.BABYLON.Color3(0,1,.3),busy:new window.BABYLON.Color3(1,.6,0),offline:new window.BABYLON.Color3(.5,.5,.5),error:new window.BABYLON.Color3(1,.1,.1),maintenance:new window.BABYLON.Color3(1,1,0)},Ye=ze[ye]||ze.offline;Se.material.diffuseColor=Ye,Se.material.emissiveColor=Ye.scale(.8),console.log(` Machine ${Le} updated: ${ye}`,Ue)}},addEnvironmentalSensor:(Le,ye="temperature")=>{const Ue=window.BABYLON.MeshBuilder.CreateCylinder(`sensor_${Date.now()}`,{diameter:.3,height:1},ge);Ue.position=Le;const pe=new window.BABYLON.StandardMaterial(`sensorMat_${Date.now()}`,ge);return pe.diffuseColor=new window.BABYLON.Color3(.7,.7,.9),pe.emissiveColor=new window.BABYLON.Color3(.3,.3,.5),Ue.material=pe,console.log(` Environmental sensor added: ${ye}`),Ue}},console.log(" Industry 4.0 Digital Twin features enabled"),console.log(" Use window.factoryDigitalTwin for real-time monitoring")})(g,f);const je=80,Ee=60,D=6,ve=.3,ee=(I,ge,oe,Le,ye)=>{const Ue=window.BABYLON.MeshBuilder.CreateGround(I,{width:ge.width,height:ge.height,subdivisions:64,updatable:!0},ye);Ue.position=oe;const pe=new window.BABYLON.PBRMaterial(`${I}UltraMaterial`,ye);console.log(" Using procedural materials for better performance"),pe.metallicFactor=.1,pe.roughnessFactor=.8,pe.baseColor=Le,pe.environmentIntensity=.8,pe.enableSpecularAntiAliasing=!0,pe.useRadianceOverAlpha=!0,pe.useSpecularOverAlpha=!0;const Se=new window.BABYLON.WoodProceduralTexture(`${I}Procedural`,512,ye);return Se.ampScale=100,pe.emissiveTexture=Se,pe.emissiveColor=Le.scale(.05),pe.clearCoat.isEnabled=!0,pe.clearCoat.intensity=.3,pe.clearCoat.roughness=.2,Ue.material=pe,Ue.receiveShadows=!0,ye.ultraShadowGenerator&&ye.ultraShadowGenerator.addShadowCaster(Ue,!0),Ue},Ae=ee("factoryFloor",{width:je,height:Ee},new window.BABYLON.Vector3(0,0,0),new window.BABYLON.Color3(.7,.7,.7),f),$=ee("blendingFloor",{width:15,height:Ee},new window.BABYLON.Vector3(-32.5,.02,0),new window.BABYLON.Color3(.6,.65,.7),f),C=ee("packagingFloor1",{width:10,height:Ee},new window.BABYLON.Vector3(-20,.02,0),new window.BABYLON.Color3(.5,.7,.5),f),O=ee("preProductionFloor",{width:15,height:Ee},new window.BABYLON.Vector3(-7.5,.02,0),new window.BABYLON.Color3(.65,.65,.65),f),q=ee("mainProductionFloor",{width:25,height:Ee},new window.BABYLON.Vector3(12.5,.02,0),new window.BABYLON.Color3(.6,.65,.7),f),z=ee("auxiliaryFloor",{width:15,height:Ee},new window.BABYLON.Vector3(32.5,.02,0),new window.BABYLON.Color3(.7,.65,.6),f),H=I=>{[{name:"BLENDING ZONE",position:new window.BABYLON.Vector3(-16,.1,0),size:{width:2,height:.2,depth:Ee},color:"#4A5568"},{name:"PACKAGING ZONE",position:new window.BABYLON.Vector3(-10,.1,0),size:{width:2,height:.2,depth:Ee},color:"#2D5016"},{name:"PRE-PRODUCTION ZONE",position:new window.BABYLON.Vector3(0,.1,0),size:{width:2,height:.2,depth:Ee},color:"#4A4A4A"},{name:"MAIN PRODUCTION ZONE",position:new window.BABYLON.Vector3(20,.1,0),size:{width:2,height:.2,depth:Ee},color:"#3D4043"}].forEach(oe=>{const Le=window.BABYLON.MeshBuilder.CreateBox(`boundary_${oe.name}`,oe.size,I);Le.position=oe.position;const ye=new window.BABYLON.StandardMaterial(`boundaryMat_${oe.name}`,I);ye.diffuseColor=window.BABYLON.Color3.FromHexString(oe.color),ye.emissiveColor=window.BABYLON.Color3.FromHexString(oe.color).scale(.3),Le.material=ye;const Ue=4,pe=window.BABYLON.MeshBuilder.CreatePlane(`sign_${oe.name}`,{width:8,height:2},I);pe.position=new window.BABYLON.Vector3(oe.position.x,Ue,oe.position.z),pe.billboardMode=window.BABYLON.Mesh.BILLBOARDMODE_Y;const Se=new window.BABYLON.StandardMaterial(`signMat_${oe.name}`,I);Se.diffuseColor=new window.BABYLON.Color3(.9,.9,.9),Se.emissiveColor=window.BABYLON.Color3.FromHexString(oe.color).scale(.2),pe.material=Se})},d=I=>{const ge=window.BABYLON.MeshBuilder.CreateCylinder("flowArrow1",{diameterTop:0,diameterBottom:1,height:3,tessellation:6},I);ge.position=new window.BABYLON.Vector3(-15,1,-8),ge.rotation.z=-Math.PI/2;const oe=new window.BABYLON.StandardMaterial("flowMat1",I);oe.diffuseColor=new window.BABYLON.Color3(.9,.7,.1),oe.emissiveColor=new window.BABYLON.Color3(.45,.35,.05),ge.material=oe;const Le=window.BABYLON.MeshBuilder.CreateCylinder("flowArrow2",{diameterTop:0,diameterBottom:1,height:3,tessellation:6},I);Le.position=new window.BABYLON.Vector3(-15,1,5),Le.rotation.z=-Math.PI/2,Le.material=oe,window.BABYLON.Animation.CreateAndStartAnimation("flowPulse",oe,"emissiveColor",60,120,new window.BABYLON.Color3(.27,.21,.03),new window.BABYLON.Color3(.72,.56,.08),window.BABYLON.Animation.ANIMATIONLOOPMODE_YOYO)},T=I=>{console.log(" Creating ultra-detailed factory infrastructure for 100MB+ experience...");const ge=[{name:"factoryNorth",pos:[0,D/2,-Ee/2],size:[je,D,ve]},{name:"factorySouth",pos:[0,D/2,Ee/2],size:[je,D,ve]},{name:"factoryWest",pos:[-je/2,D/2,0],size:[ve,D,Ee]},{name:"factoryEast",pos:[je/2,D/2,0],size:[ve,D,Ee]}],oe=new window.BABYLON.PBRMaterial("ultraWallMaterial",I);oe.baseColor=new window.BABYLON.Color3(.7,.7,.7),oe.metallicFactor=.1,oe.roughnessFactor=.8;const Le=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/concrete-wall.jpg",I);Le.uScale=10,Le.vScale=3,oe.baseTexture=Le;const ye=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/concrete-normal.jpg",I);ye.uScale=10,ye.vScale=3,oe.bumpTexture=ye,ge.forEach(Ye=>{const Qe=window.BABYLON.MeshBuilder.CreateBox(Ye.name,{width:Ye.size[0],height:Ye.size[1],depth:Ye.size[2],subdivisions:4},I);Qe.position=new window.BABYLON.Vector3(...Ye.pos),Qe.material=oe,Qe.receiveShadows=!0;const Pe=Math.floor(Ye.size[0]/8)+Math.floor(Ye.size[2]/8);for(let Re=0;Re<Pe;Re++){const et=window.BABYLON.MeshBuilder.CreateCylinder(`wallLight_${Ye.name}_${Re}`,{diameter:.4,height:.2,tessellation:12},I),Fe=Re/Pe*(Ye.size[0]||Ye.size[2]);Ye.name.includes("North")||Ye.name.includes("South")?et.position=new window.BABYLON.Vector3(-Ye.size[0]/2+Fe,Ye.pos[1]+1,Ye.pos[2]):et.position=new window.BABYLON.Vector3(Ye.pos[0],Ye.pos[1]+1,-Ye.size[2]/2+Fe);const Te=new window.BABYLON.StandardMaterial(`wallLightMat_${Ye.name}_${Re}`,I);Te.diffuseColor=new window.BABYLON.Color3(.9,.9,.9),Te.emissiveColor=new window.BABYLON.Color3(.3,.3,.3),et.material=Te}});const Ue=()=>{for(let Re=-je/2;Re<=je/2;Re+=8){const et=window.BABYLON.MeshBuilder.CreateBox(`mainBeam_${Re}`,{width:.4,height:.6,depth:Ee,subdivisions:2},I);et.position=new window.BABYLON.Vector3(Re,D+.6/2,0);const Fe=new window.BABYLON.PBRMaterial(`beamMat_${Re}`,I);Fe.baseColor=new window.BABYLON.Color3(.3,.3,.3),Fe.metallicFactor=.9,Fe.roughnessFactor=.3,et.material=Fe,et.receiveShadows=!0}for(let Re=-Ee/2;Re<=Ee/2;Re+=8){const et=window.BABYLON.MeshBuilder.CreateBox(`crossBeam_${Re}`,{width:je,height:.6,depth:.4,subdivisions:2},I);et.position=new window.BABYLON.Vector3(0,D+.6/2,Re);const Fe=new window.BABYLON.PBRMaterial(`crossBeamMat_${Re}`,I);Fe.baseColor=new window.BABYLON.Color3(.3,.3,.3),Fe.metallicFactor=.9,Fe.roughnessFactor=.3,et.material=Fe,et.receiveShadows=!0}},pe=()=>{[-20,0,20].forEach((Qe,Pe)=>{const Re=window.BABYLON.MeshBuilder.CreateBox(`craneRail1_${Pe}`,{width:.3,height:.3,depth:Ee},I);Re.position=new window.BABYLON.Vector3(Qe-2,D+1,0);const et=window.BABYLON.MeshBuilder.CreateBox(`craneRail2_${Pe}`,{width:.3,height:.3,depth:Ee},I);et.position=new window.BABYLON.Vector3(Qe+2,D+1,0);const Fe=window.BABYLON.MeshBuilder.CreateBox(`craneBridge_${Pe}`,{width:4.6,height:.5,depth:1,subdivisions:2},I);Fe.position=new window.BABYLON.Vector3(Qe,D+1.2,0);const Te=window.BABYLON.MeshBuilder.CreateBox(`craneTrolley_${Pe}`,{width:1,height:.8,depth:.8,subdivisions:2},I);Te.position=new window.BABYLON.Vector3(Qe,D+.6,0);const P=window.BABYLON.MeshBuilder.CreateTorus(`craneHook_${Pe}`,{diameter:.3,thickness:.05,tessellation:16},I);P.position=new window.BABYLON.Vector3(Qe,D-1,0);const p=window.BABYLON.MeshBuilder.CreateCylinder(`craneCable_${Pe}`,{diameter:.02,height:2,tessellation:8},I);p.position=new window.BABYLON.Vector3(Qe,D-.5,0);const k=new window.BABYLON.PBRMaterial(`craneMat_${Pe}`,I);k.baseColor=new window.BABYLON.Color3(.8,.6,.1),k.metallicFactor=.8,k.roughnessFactor=.4,[Re,et,Fe,Te].forEach(B=>{B.material=k,B.receiveShadows=!0});const ne=new window.BABYLON.PBRMaterial(`hookMat_${Pe}`,I);ne.baseColor=new window.BABYLON.Color3(.2,.2,.2),ne.metallicFactor=.9,ne.roughnessFactor=.2,P.material=ne;const Ne=new window.BABYLON.StandardMaterial(`cableMat_${Pe}`,I);Ne.diffuseColor=new window.BABYLON.Color3(.1,.1,.1),p.material=Ne,window.BABYLON.Animation.CreateAndStartAnimation(`craneMovement_${Pe}`,Te,"position.z",15,450,0,Ee/3,window.BABYLON.Animation.ANIMATIONLOOPMODE_YOYO)})},Se=()=>{[{start:new window.BABYLON.Vector3(-je/2,4,10),end:new window.BABYLON.Vector3(je/2,4,10)},{start:new window.BABYLON.Vector3(-je/2,4,-10),end:new window.BABYLON.Vector3(je/2,4,-10)},{start:new window.BABYLON.Vector3(0,4,-Ee/2),end:new window.BABYLON.Vector3(0,4,Ee/2)}].forEach((Pe,Re)=>{const et=window.BABYLON.MeshBuilder.CreateTube(`mainPipe_${Re}`,{path:[Pe.start,Pe.end],radius:.3,tessellation:16},I),Fe=new window.BABYLON.PBRMaterial(`pipeMat_${Re}`,I);Fe.baseColor=new window.BABYLON.Color3(.4,.4,.4),Fe.metallicFactor=.8,Fe.roughnessFactor=.3,et.material=Fe;const Te=window.BABYLON.Vector3.Distance(Pe.start,Pe.end),P=Math.floor(Te/5);for(let p=0;p<=P;p++){const k=p/P,ne=window.BABYLON.Vector3.Lerp(Pe.start,Pe.end,k),Ne=window.BABYLON.MeshBuilder.CreateCylinder(`pipeSupport_${Re}_${p}`,{diameter:.2,height:ne.y,tessellation:12},I);Ne.position=new window.BABYLON.Vector3(ne.x,ne.y/2,ne.z),Ne.material=Fe}for(let p=0;p<3;p++){const k=window.BABYLON.Vector3.Lerp(Pe.start,Pe.end,.2+p*.3),ne=new window.BABYLON.Vector3(k.x,k.y-2,k.z+(p%2===0?5:-5)),Ne=window.BABYLON.MeshBuilder.CreateTube(`branchPipe_${Re}_${p}`,{path:[k,ne],radius:.15,tessellation:12},I);Ne.material=Fe}}),(()=>{[{start:new window.BABYLON.Vector3(-30,5,0),end:new window.BABYLON.Vector3(30,5,0)},{start:new window.BABYLON.Vector3(0,5,-25),end:new window.BABYLON.Vector3(0,5,25)}].forEach((Re,et)=>{const Fe=window.BABYLON.MeshBuilder.CreateBox(`cableTray_${et}`,{width:.6,height:.1,depth:window.BABYLON.Vector3.Distance(Re.start,Re.end)},I),Te=window.BABYLON.Vector3.Lerp(Re.start,Re.end,.5);Fe.position=Te,et===1&&(Fe.rotation.y=Math.PI/2);const P=new window.BABYLON.PBRMaterial(`trayMat_${et}`,I);P.baseColor=new window.BABYLON.Color3(.8,.8,.8),P.metallicFactor=.9,P.roughnessFactor=.2,Fe.material=P;for(let p=0;p<8;p++){const k=window.BABYLON.MeshBuilder.CreateCylinder(`cable_${et}_${p}`,{diameter:.03,height:window.BABYLON.Vector3.Distance(Re.start,Re.end),tessellation:8},I);k.position=new window.BABYLON.Vector3(Te.x+(-.25+p%4*.15),Te.y+.08,Te.z+(p<4?-.1:.1)),et===1&&(k.rotation.z=Math.PI/2);const ne=[new window.BABYLON.Color3(1,0,0),new window.BABYLON.Color3(0,1,0),new window.BABYLON.Color3(0,0,1),new window.BABYLON.Color3(1,1,0),new window.BABYLON.Color3(0,0,0),new window.BABYLON.Color3(1,1,1),new window.BABYLON.Color3(.5,.5,.5),new window.BABYLON.Color3(1,.5,0)],Ne=new window.BABYLON.StandardMaterial(`cableMat_${et}_${p}`,I);Ne.diffuseColor=ne[p],k.material=Ne}})})()},ze=()=>{[{start:new window.BABYLON.Vector3(-35,6,0),end:new window.BABYLON.Vector3(35,6,0)},{start:new window.BABYLON.Vector3(0,6,-25),end:new window.BABYLON.Vector3(0,6,25)}].forEach((Qe,Pe)=>{const Re=window.BABYLON.MeshBuilder.CreateBox(`mainDuct_${Pe}`,{width:1,height:.8,depth:window.BABYLON.Vector3.Distance(Qe.start,Qe.end),subdivisions:2},I),et=window.BABYLON.Vector3.Lerp(Qe.start,Qe.end,.5);Re.position=et,Pe===1&&(Re.rotation.y=Math.PI/2);const Fe=new window.BABYLON.PBRMaterial(`ductMat_${Pe}`,I);Fe.baseColor=new window.BABYLON.Color3(.7,.7,.7),Fe.metallicFactor=.9,Fe.roughnessFactor=.1,Re.material=Fe;const Te=6;for(let P=0;P<Te;P++){const p=window.BABYLON.MeshBuilder.CreateBox(`ventGrill_${Pe}_${P}`,{width:.8,height:.05,depth:.8,subdivisions:4},I),k=P/(Te-1),ne=window.BABYLON.Vector3.Lerp(Qe.start,Qe.end,k);p.position=new window.BABYLON.Vector3(ne.x,ne.y-.4,ne.z);const Ne=new window.BABYLON.PBRMaterial(`grillMat_${Pe}_${P}`,I);Ne.baseColor=new window.BABYLON.Color3(.3,.3,.3),Ne.metallicFactor=.8,Ne.roughnessFactor=.3,p.material=Ne}})};Ue(),pe(),Se(),ze(),console.log(" Ultra-detailed factory infrastructure completed")},E=I=>{[{name:"BLENDING ZONE",position:new window.BABYLON.Vector3(-21,3,15),color:"#4A5568",description:"Raw Material Processing",processes:["Material Receipt","Primary Blending","Batch Preparation"]},{name:"PACKAGING ZONE",position:new window.BABYLON.Vector3(-13,3,15),color:"#2D5016",description:"Packaging Operations",processes:["Stick Pack","Flexible Packaging","Universal Lines"]},{name:"PRE-PRODUCTION ZONE",position:new window.BABYLON.Vector3(-5,3,15),color:"#4A4A4A",description:"Pre-Production Processing",processes:["Pre-Batch","Material Preparation","Setup"]},{name:"MAIN PRODUCTION ZONE",position:new window.BABYLON.Vector3(10,3,15),color:"#3D4043",description:"Main Production Lines",processes:["Can Lines","5-Lane","Auger","Canister Lines"]},{name:"AUXILIARY ZONE",position:new window.BABYLON.Vector3(23,3,15),color:"#5D4E37",description:"Auxiliary Equipment",processes:["Ploughshare","MaxMix","Liquid Lines","Bulk Handling"]}].forEach(oe=>{const Le=window.BABYLON.MeshBuilder.CreatePlane(`infoPanel_${oe.name}`,{width:8,height:4},I);Le.position=oe.position,Le.billboardMode=window.BABYLON.Mesh.BILLBOARDMODE_ALL;const ye=new window.BABYLON.StandardMaterial(`infoPanelMat_${oe.name}`,I);ye.diffuseColor=new window.BABYLON.Color3(.1,.1,.1),ye.emissiveColor=window.BABYLON.Color3.FromHexString(oe.color).scale(.1),ye.alpha=.8,Le.material=ye;const Ue=window.BABYLON.MeshBuilder.CreatePlane(`title_${oe.name}`,{width:10,height:1.5},I);Ue.position=new window.BABYLON.Vector3(oe.position.x,oe.position.y+3,oe.position.z),Ue.billboardMode=window.BABYLON.Mesh.BILLBOARDMODE_ALL;const pe=new window.BABYLON.StandardMaterial(`titleMat_${oe.name}`,I);pe.diffuseColor=new window.BABYLON.Color3(1,1,1),pe.emissiveColor=window.BABYLON.Color3.FromHexString(oe.color).scale(.3),Ue.material=pe})};H(f),d(f),T(f),E(f),f.onPointerObservable.add(I=>{if(I.pickInfo.hit&&I.type===window.BABYLON.PointerEventTypes.POINTERDOWN){const ge=I.pickInfo.pickedMesh;if(ge&&ge.name.startsWith("machine_")){const oe=ge.name.split("_")[1],Le=o.find(ye=>ye.id==oe);if(Le){j(Le),h&&h(Le),console.log(" Machine clicked:",Le.name);const ye=ge.scaling.clone();ge.scaling=ye.scale(1.1),setTimeout(()=>{ge&&(ge.scaling=ye)},150)}}}});let R=0,Q=performance.now();v.runRenderLoop(()=>{if(f&&(f.render(),R++,R%60===0)){const I=performance.now(),ge=Math.round(6e4/(I-Q));Q=I;const oe=document.querySelector("#factory-performance");oe&&(oe.textContent=`${ge} FPS`),ge<30&&console.warn(` Factory performance: ${ge} FPS (low)`)}});const Ce=I=>{if(console.log(" Initializing ultra-enhanced factory audio system..."),!window.BABYLON.Engine.audioEngine){console.log(" Audio engine not available, skipping audio initialization");return}I.audioEnabled=!0,I.headphone=!1;const ge=[{name:"factoryHum",url:"https://www.soundjay.com/misc/sounds/industrial-hum.mp3",volume:.3,loop:!0,autoplay:!0,spatialSound:!1},{name:"ventilation",url:"https://www.soundjay.com/misc/sounds/air-conditioning.mp3",volume:.2,loop:!0,autoplay:!0,spatialSound:!1},{name:"electricalBuzz",url:"https://www.soundjay.com/misc/sounds/electrical-buzz.mp3",volume:.15,loop:!0,autoplay:!0,spatialSound:!1}],oe=[{type:"blender",sounds:[{name:"mixing",url:"https://www.soundjay.com/misc/sounds/blender.mp3",volume:.6},{name:"motorHum",url:"https://www.soundjay.com/misc/sounds/motor-hum.mp3",volume:.4}]},{type:"press",sounds:[{name:"compression",url:"https://www.soundjay.com/misc/sounds/hydraulic-press.mp3",volume:.7},{name:"pneumatic",url:"https://www.soundjay.com/misc/sounds/air-release.mp3",volume:.5}]},{type:"packaging",sounds:[{name:"conveyor",url:"https://www.soundjay.com/misc/sounds/conveyor-belt.mp3",volume:.4},{name:"packaging",url:"https://www.soundjay.com/misc/sounds/wrapping.mp3",volume:.3}]}];ge.forEach(ye=>{try{const Ue=new window.BABYLON.Sound(ye.name,ye.url,I,()=>{console.log(` Loaded ambient sound: ${ye.name}`),ye.autoplay&&Ue.play()},{loop:ye.loop,volume:ye.volume,spatialSound:ye.spatialSound,maxDistance:100})}catch(Ue){console.warn(` Could not load sound ${ye.name}:`,Ue)}});const Le=[{name:"blendingZone",position:new window.BABYLON.Vector3(-25,2,0),radius:15,ambientSound:"mechanical-whirring",volume:.4},{name:"packagingZone",position:new window.BABYLON.Vector3(-10,2,0),radius:12,ambientSound:"conveyor-movement",volume:.35},{name:"productionZone",position:new window.BABYLON.Vector3(15,2,0),radius:20,ambientSound:"heavy-machinery",volume:.5}];window.factoryAudioSystem={playMachineSound:(ye,Ue)=>{const pe=oe.find(Se=>Ue.includes(Se.type));pe&&pe.sounds.forEach(Se=>{try{const ze=I.getMeshByName(`machine_${ye}`);if(ze){const Ye=new window.BABYLON.Sound(`${ye}_${Se.name}`,Se.url,I,null,{loop:!0,volume:Se.volume,spatialSound:!0,maxDistance:30,refDistance:5,rolloffFactor:2});Ye.attachToMesh(ze),Ye.play()}}catch(ze){console.warn(" Could not create machine sound:",ze)}})},stopMachineSound:ye=>{I.soundTracks[0].soundCollection.forEach(Ue=>{Ue.name.startsWith(`${ye}_`)&&(Ue.stop(),Ue.dispose())})},setMasterVolume:ye=>{window.BABYLON.Engine.audioEngine.setGlobalVolume(ye)}},console.log(" Ultra-enhanced factory audio system initialized")},Me=I=>{console.log(" Creating simplified particle effects for better performance..."),[new window.BABYLON.Vector3(-15,3,0),new window.BABYLON.Vector3(15,3,0)].forEach((ye,Ue)=>{const pe=new window.BABYLON.ParticleSystem(`factorySteam_${Ue}`,50,I);pe.particleTexture=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/cloud.png",I);const Se=window.BABYLON.MeshBuilder.CreateBox(`steamEmitter_${Ue}`,{width:.5,height:.1,depth:.5},I);Se.position=ye,Se.isVisible=!1,pe.emitter=Se,pe.minEmitBox=new window.BABYLON.Vector3(-.2,0,-.2),pe.maxEmitBox=new window.BABYLON.Vector3(.2,0,.2),pe.color1=new window.BABYLON.Color4(1,1,1,.8),pe.color2=new window.BABYLON.Color4(.9,.9,.9,.6),pe.colorDead=new window.BABYLON.Color4(.8,.8,.8,0),pe.minSize=.5,pe.maxSize=2,pe.minLifeTime=2,pe.maxLifeTime=4,pe.emitRate=20,pe.blendMode=window.BABYLON.ParticleSystem.BLENDMODE_ONEONE,pe.gravity=new window.BABYLON.Vector3(0,-.5,0),pe.direction1=new window.BABYLON.Vector3(-.5,1,-.5),pe.direction2=new window.BABYLON.Vector3(.5,2,.5),pe.minAngularSpeed=0,pe.maxAngularSpeed=Math.PI/4,pe.minEmitPower=1,pe.maxEmitPower=3,pe.updateSpeed=.02,pe.start()}),console.log(" Heavy dust system disabled for better performance");const oe=()=>{o.forEach((ye,Ue)=>{if(ye.status==="available"){const pe=new window.BABYLON.ParticleSystem(`sparks_${ye.id}`,50,I);pe.particleTexture=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/spark.png",I);const Se=I.getMeshByName(`machine_${ye.id}`);Se&&(pe.emitter=Se,pe.minEmitBox=new window.BABYLON.Vector3(-1,2,-1),pe.maxEmitBox=new window.BABYLON.Vector3(1,3,1),pe.color1=new window.BABYLON.Color4(1,.8,.2,1),pe.color2=new window.BABYLON.Color4(1,.4,0,1),pe.colorDead=new window.BABYLON.Color4(.5,.1,0,0),pe.minSize=.05,pe.maxSize=.15,pe.minLifeTime=.2,pe.maxLifeTime=.8,pe.emitRate=15,pe.blendMode=window.BABYLON.ParticleSystem.BLENDMODE_ONEONE,pe.gravity=new window.BABYLON.Vector3(0,-5,0),pe.direction1=new window.BABYLON.Vector3(-2,0,-2),pe.direction2=new window.BABYLON.Vector3(2,1,2),pe.start())}})},Le=()=>{[new window.BABYLON.Vector3(-15,1,5),new window.BABYLON.Vector3(10,1,-8),new window.BABYLON.Vector3(20,1,12)].forEach((Ue,pe)=>{const Se=new window.BABYLON.ParticleSystem(`heatShimmer_${pe}`,100,I);Se.particleTexture=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/heat.png",I);const ze=window.BABYLON.MeshBuilder.CreateSphere(`heatEmitter_${pe}`,{diameter:.1},I);ze.position=Ue,ze.isVisible=!1,Se.emitter=ze,Se.minEmitBox=new window.BABYLON.Vector3(-.5,0,-.5),Se.maxEmitBox=new window.BABYLON.Vector3(.5,0,.5),Se.color1=new window.BABYLON.Color4(1,.8,.6,.1),Se.color2=new window.BABYLON.Color4(1,.6,.4,.05),Se.colorDead=new window.BABYLON.Color4(1,.4,.2,0),Se.minSize=.3,Se.maxSize=1.5,Se.minLifeTime=1,Se.maxLifeTime=2.5,Se.emitRate=25,Se.blendMode=window.BABYLON.ParticleSystem.BLENDMODE_STANDARD,Se.gravity=new window.BABYLON.Vector3(0,.5,0),Se.direction1=new window.BABYLON.Vector3(-.2,.5,-.2),Se.direction2=new window.BABYLON.Vector3(.2,1.5,.2),Se.start()})};setTimeout(oe,2e3),setTimeout(Le,3e3),console.log(" Ultra-enhanced particle effects system initialized")};Ce(f),Me(f);const He=()=>{v&&v.resize()};window.addEventListener("resize",He),o&&o.length>0&&(console.log(" Creating machines with scene..."),G(o)),x(!0),console.log(" 4D Digital Twin Factory initialized successfully")}catch(g){throw console.error(" Failed to initialize Babylon scene:",g),S(g.message),g}},se=(N,g)=>{const M=N.name.toLowerCase();console.log(` Creating ultra-detailed machine model for: ${N.name}`);const Y=window.BABYLON.MeshBuilder.CreateBox(`platform_${N.id}`,{width:6,height:.4,depth:5,subdivisions:4},g);Y.position.y=.2;const Z=new window.BABYLON.PBRMaterial(`platformUltraMat_${N.id}`,g);Z.baseColor=new window.BABYLON.Color3(.25,.25,.25),Z.metallicFactor=.8,Z.roughnessFactor=.3;const le=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/metal.jpg",g);le.uScale=2,le.vScale=2,Z.baseTexture=le;const ke=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/metalNormal.jpg",g);ke.uScale=2,ke.vScale=2,Z.bumpTexture=ke,Y.material=Z,Y.receiveShadows=!0,(()=>{for(let C=-2.5;C<=2.5;C+=5)for(let O=-2;O<=2;O+=4){const q=window.BABYLON.MeshBuilder.CreateCylinder(`bolt_${N.id}_${C}_${O}`,{diameter:.2,height:.1,tessellation:12},g);q.position=new window.BABYLON.Vector3(C,.45,O);const z=new window.BABYLON.PBRMaterial(`boltMat_${N.id}_${C}_${O}`,g);z.baseColor=new window.BABYLON.Color3(.7,.7,.7),z.metallicFactor=.9,z.roughnessFactor=.1,q.material=z}const $=window.BABYLON.MeshBuilder.CreateBox(`accessPanel_${N.id}`,{width:1.5,height:.05,depth:1,subdivisions:2},g);$.position=new window.BABYLON.Vector3(2,.43,0),$.material=Z;for(let C=0;C<4;C++){const O=window.BABYLON.MeshBuilder.CreateBox(`stripe_${N.id}_${C}`,{width:.2,height:.02,depth:5},g);O.position=new window.BABYLON.Vector3(-2.5+C*1.67,.42,0);const q=new window.BABYLON.StandardMaterial(`stripeMat_${N.id}_${C}`,g);q.diffuseColor=new window.BABYLON.Color3(1,.8,0),q.emissiveColor=new window.BABYLON.Color3(.5,.4,0),O.material=q}})();let je=null,Ee=[];if(M.includes("blender")||M.includes("mixer")){je=window.BABYLON.MeshBuilder.CreateCylinder(`machine_${N.id}`,{diameter:4,height:5,tessellation:32,subdivisions:8},g),je.position.y=2.8;const $=new window.BABYLON.PBRMaterial(`tankUltraMat_${N.id}`,g);$.baseColor=new window.BABYLON.Color3(.8,.85,.9),$.metallicFactor=.9,$.roughnessFactor=.2;const C=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/steel.jpg",g);C.uScale=4,C.vScale=2,$.baseTexture=C,je.material=$;const O=window.BABYLON.MeshBuilder.CreateCylinder(`agitatorShaft_${N.id}`,{diameter:.3,height:6,tessellation:16},g);O.position.y=5.5;for(let d=0;d<3;d++){const T=2+d*1.5;for(let E=0;E<4;E++){const R=E*Math.PI/2,Q=window.BABYLON.MeshBuilder.CreateBox(`blade_${N.id}_${d}_${E}`,{width:1.5,height:.2,depth:.1},g);Q.position=new window.BABYLON.Vector3(Math.cos(R)*.8,T,Math.sin(R)*.8),Q.rotation.y=R;const Ce=new window.BABYLON.PBRMaterial(`bladeMat_${N.id}_${d}_${E}`,g);Ce.baseColor=new window.BABYLON.Color3(.9,.9,.9),Ce.metallicFactor=.95,Ce.roughnessFactor=.1,Q.material=Ce,Ee.push(Q)}}const q=window.BABYLON.MeshBuilder.CreateBox(`motor_${N.id}`,{width:1.5,height:1.2,depth:1.5,subdivisions:2},g);q.position.y=6.5,q.material=$;const z=window.BABYLON.MeshBuilder.CreateBox(`controlPanel_${N.id}`,{width:1,height:1.5,depth:.3,subdivisions:2},g);z.position=new window.BABYLON.Vector3(2.5,3,0);for(let d=0;d<6;d++){const T=window.BABYLON.MeshBuilder.CreateCylinder(`button_${N.id}_${d}`,{diameter:.15,height:.05,tessellation:12},g);T.position=new window.BABYLON.Vector3(2.65,3.5-d%3*.3,-.4+Math.floor(d/3)*.8);const E=new window.BABYLON.StandardMaterial(`buttonMat_${N.id}_${d}`,g);E.diffuseColor=d<3?new window.BABYLON.Color3(0,1,0):new window.BABYLON.Color3(1,0,0),E.emissiveColor=E.diffuseColor.scale(.3),T.material=E}if((()=>{[{start:new window.BABYLON.Vector3(1.8,4,0),end:new window.BABYLON.Vector3(3,4,0)},{start:new window.BABYLON.Vector3(-1.8,3,0),end:new window.BABYLON.Vector3(-3,3,0)},{start:new window.BABYLON.Vector3(0,1,1.8),end:new window.BABYLON.Vector3(0,1,3)}].forEach((T,E)=>{const R=window.BABYLON.MeshBuilder.CreateTube(`pipe_${N.id}_${E}`,{path:[T.start,T.end],radius:.1,tessellation:16},g),Q=new window.BABYLON.PBRMaterial(`pipeMat_${N.id}_${E}`,g);Q.baseColor=new window.BABYLON.Color3(.4,.4,.4),Q.metallicFactor=.8,Q.roughnessFactor=.4,R.material=Q})})(),N.status==="available"){window.BABYLON.Animation.CreateAndStartAnimation("shaftRotation",O,"rotation.y",30,180,0,Math.PI*2,window.BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),Ee.forEach(T=>{window.BABYLON.Animation.CreateAndStartAnimation(`bladeRotation_${T.name}`,T,"rotation.y",30,180,T.rotation.y,T.rotation.y+Math.PI*2,window.BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE)});const d=new window.BABYLON.ParticleSystem(`mixParticles_${N.id}`,200,g);d.particleTexture=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/flare.png",g),d.emitter=je,d.minEmitBox=new window.BABYLON.Vector3(-1,0,-1),d.maxEmitBox=new window.BABYLON.Vector3(1,1,1),d.color1=new window.BABYLON.Color4(.7,.8,1,1),d.color2=new window.BABYLON.Color4(.2,.5,1,1),d.minSize=.1,d.maxSize=.5,d.minLifeTime=.3,d.maxLifeTime=1.5,d.emitRate=50,d.start()}}else if(M.includes("tablet")||M.includes("press")){je=window.BABYLON.MeshBuilder.CreateBox(`machine_${N.id}`,{width:5,height:3.5,depth:3,subdivisions:4},g),je.position.y=2.1;const $=new window.BABYLON.PBRMaterial(`pressUltraMat_${N.id}`,g);$.baseColor=new window.BABYLON.Color3(.1,.3,.6),$.metallicFactor=.8,$.roughnessFactor=.3;const C=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/industrial.jpg",g);C.uScale=3,C.vScale=2,$.baseTexture=C,je.material=$;const O=window.BABYLON.MeshBuilder.CreateBox(`compressSystem_${N.id}`,{width:4,height:1,depth:2.5,subdivisions:2},g);O.position.y=4.2,O.material=$;const q=[];for(let E=0;E<3;E++){const R=window.BABYLON.MeshBuilder.CreateCylinder(`compressHead_${N.id}_${E}`,{diameter:.8,height:.6,tessellation:16},g);R.position=new window.BABYLON.Vector3(-1.5+E*1.5,3.8,0);const Q=new window.BABYLON.PBRMaterial(`headMat_${N.id}_${E}`,g);Q.baseColor=new window.BABYLON.Color3(.9,.9,.9),Q.metallicFactor=.95,Q.roughnessFactor=.05,R.material=Q,q.push(R)}for(let E=0;E<2;E++){const R=window.BABYLON.MeshBuilder.CreateCylinder(`hydraulic_${N.id}_${E}`,{diameter:.4,height:2,tessellation:16},g);R.position=new window.BABYLON.Vector3(-1.5+E*3,5.5,1);const Q=new window.BABYLON.PBRMaterial(`hydraulicMat_${N.id}_${E}`,g);Q.baseColor=new window.BABYLON.Color3(.8,.6,.1),Q.metallicFactor=.7,Q.roughnessFactor=.4,R.material=Q}const z=window.BABYLON.MeshBuilder.CreateBox(`dieTable_${N.id}`,{width:4.5,height:.3,depth:3,subdivisions:3},g);z.position.y=.8,z.material=$;for(let E=0;E<6;E++)for(let R=0;R<4;R++){const Q=window.BABYLON.MeshBuilder.CreateCylinder(`die_${N.id}_${E}_${R}`,{diameter:.3,height:.1,tessellation:12},g);Q.position=new window.BABYLON.Vector3(-1.5+E*.6,.95,-.9+R*.6);const Ce=new window.BABYLON.PBRMaterial(`dieMat_${N.id}_${E}_${R}`,g);Ce.baseColor=new window.BABYLON.Color3(.3,.3,.3),Ce.metallicFactor=.9,Ce.roughnessFactor=.1,Q.material=Ce}const H=window.BABYLON.MeshBuilder.CreateBox(`controlCabinet_${N.id}`,{width:1.5,height:2,depth:.8,subdivisions:2},g);H.position=new window.BABYLON.Vector3(3.5,1.5,0),H.material=$;const d=window.BABYLON.MeshBuilder.CreateBox(`display_${N.id}`,{width:.8,height:.6,depth:.05},g);d.position=new window.BABYLON.Vector3(3.85,2.2,0);const T=new window.BABYLON.StandardMaterial(`displayMat_${N.id}`,g);if(T.diffuseColor=new window.BABYLON.Color3(0,0,0),T.emissiveColor=new window.BABYLON.Color3(0,.3,.6),d.material=T,N.status==="available"){q.forEach((R,Q)=>{window.BABYLON.Animation.CreateAndStartAnimation(`compressionMove_${Q}`,R,"position.y",45,90,R.position.y,R.position.y-.4,window.BABYLON.Animation.ANIMATIONLOOPMODE_YOYO)});const E=new window.BABYLON.ParticleSystem(`pressParticles_${N.id}`,100,g);E.particleTexture=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/spark.png",g),E.emitter=z,E.minEmitBox=new window.BABYLON.Vector3(-2,0,-1),E.maxEmitBox=new window.BABYLON.Vector3(2,.5,1),E.color1=new window.BABYLON.Color4(1,.8,.4,1),E.color2=new window.BABYLON.Color4(1,.4,.1,1),E.minSize=.05,E.maxSize=.2,E.minLifeTime=.1,E.maxLifeTime=.3,E.emitRate=30,E.start()}}else if(M.includes("cube")||M.includes("granulator")){je=window.BABYLON.MeshBuilder.CreateBox(`machine_${N.id}`,{width:3.5,height:3.5,depth:3.5},g),je.position.y=2.05;const $=window.BABYLON.MeshBuilder.CreateCylinder(`rotor_${N.id}`,{diameter:2,height:3,tessellation:12},g);$.position.y=2.05,$.rotation.z=Math.PI/2,N.status==="available"&&window.BABYLON.Animation.CreateAndStartAnimation("rotorSpin",$,"rotation.x",45,180,0,Math.PI*2,window.BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE)}else if(M.includes("packaging")||M.includes("filler")||M.includes("bottling")){je=window.BABYLON.MeshBuilder.CreateBox(`machine_${N.id}`,{width:6,height:2,depth:2},g),je.position.y=1.3;const $=window.BABYLON.MeshBuilder.CreateBox(`conveyor_${N.id}`,{width:6.5,height:.1,depth:1},g);$.position.y=2.4;const C=new window.BABYLON.StandardMaterial(`conveyorMat_${N.id}`,g);C.diffuseColor=new window.BABYLON.Color3(.2,.2,.2),$.material=C}else if(M.includes("dryer")||M.includes("oven")){je=window.BABYLON.MeshBuilder.CreateBox(`machine_${N.id}`,{width:4,height:3.5,depth:3},g),je.position.y=2.05;const $=window.BABYLON.MeshBuilder.CreateCylinder(`exhaust_${N.id}`,{diameter:.5,height:2,tessellation:8},g);$.position.y=5,$.position.x=1.5}else if(M.includes("sifter")||M.includes("screen"))je=window.BABYLON.MeshBuilder.CreateCylinder(`machine_${N.id}`,{diameter:2.5,height:4,tessellation:16},g),je.position.y=2.3,je.rotation.z=Math.PI/8,N.status==="available"&&window.BABYLON.Animation.CreateAndStartAnimation("sifterVibration",je,"rotation.z",60,120,Math.PI/8,Math.PI/8+.1,window.BABYLON.Animation.ANIMATIONLOOPMODE_YOYO);else{je=window.BABYLON.MeshBuilder.CreateBox(`machine_${N.id}`,{width:4,height:3.5,depth:3.5,subdivisions:4},g),je.position.y=2;const $=new window.BABYLON.PBRMaterial(`genericUltraMat_${N.id}`,g);$.baseColor=new window.BABYLON.Color3(.4,.5,.6),$.metallicFactor=.7,$.roughnessFactor=.4;const C=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/machine.jpg",g);C.uScale=2,C.vScale=2,$.baseTexture=C,je.material=$;const O=window.BABYLON.MeshBuilder.CreateBox(`panel_${N.id}`,{width:2,height:1.5,depth:.3,subdivisions:2},g);O.position=new window.BABYLON.Vector3(0,3.5,1.9),O.material=$;for(let H=0;H<8;H++){const d=window.BABYLON.MeshBuilder.CreateSphere(`indicator_${N.id}_${H}`,{diameter:.1,segments:16},g);d.position=new window.BABYLON.Vector3(-.7+H%4*.35,3.8,2.05);const T=new window.BABYLON.StandardMaterial(`lightMat_${N.id}_${H}`,g),E=[new window.BABYLON.Color3(1,0,0),new window.BABYLON.Color3(0,1,0),new window.BABYLON.Color3(0,0,1),new window.BABYLON.Color3(1,1,0)];T.diffuseColor=E[H%4],T.emissiveColor=E[H%4].scale(.5),d.material=T,N.status==="available"&&window.BABYLON.Animation.CreateAndStartAnimation(`lightBlink_${H}`,T,"emissiveColor",60,120,E[H%4].scale(.1),E[H%4].scale(.8),window.BABYLON.Animation.ANIMATIONLOOPMODE_YOYO)}for(let H=0;H<2;H++){const d=window.BABYLON.MeshBuilder.CreateCylinder(`fan_${N.id}_${H}`,{diameter:.8,height:.2,tessellation:8},g);d.position=new window.BABYLON.Vector3(-1.5+H*3,3.8,-1.8);for(let T=0;T<6;T++){const E=window.BABYLON.MeshBuilder.CreateBox(`fanBlade_${N.id}_${H}_${T}`,{width:.6,height:.05,depth:.1},g);E.position=new window.BABYLON.Vector3(d.position.x+Math.cos(T*Math.PI/3)*.3,d.position.y,d.position.z+Math.sin(T*Math.PI/3)*.3),E.rotation.y=T*Math.PI/3,E.material=$,N.status==="available"&&window.BABYLON.Animation.CreateAndStartAnimation(`fanRotation_${H}_${T}`,E,"rotation.y",120,720,E.rotation.y,E.rotation.y+Math.PI*2,window.BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE)}}const q=window.BABYLON.MeshBuilder.CreateBox(`accessDoor_${N.id}`,{width:1,height:1.5,depth:.1,subdivisions:2},g);q.position=new window.BABYLON.Vector3(-2.05,2.2,0),q.material=$;const z=window.BABYLON.MeshBuilder.CreateTorus(`handle_${N.id}`,{diameter:.2,thickness:.03,tessellation:16},g);z.position=new window.BABYLON.Vector3(-2.1,2.2,0),z.rotation.z=Math.PI/2,z.material=$}(()=>{[{type:"temperature",pos:new window.BABYLON.Vector3(2.5,4,0),color:new window.BABYLON.Color3(1,.5,0)},{type:"pressure",pos:new window.BABYLON.Vector3(-2.5,4,0),color:new window.BABYLON.Color3(0,.5,1)},{type:"vibration",pos:new window.BABYLON.Vector3(0,4.5,2),color:new window.BABYLON.Color3(1,0,.5)}].forEach((C,O)=>{const q=window.BABYLON.MeshBuilder.CreateCylinder(`sensor_${N.id}_${O}`,{diameter:.2,height:.5,tessellation:12},g);q.position=C.pos;const z=new window.BABYLON.PBRMaterial(`sensorMat_${N.id}_${O}`,g);z.baseColor=C.color,z.metallicFactor=.8,z.roughnessFactor=.2,z.emissiveColor=C.color.scale(.3),q.material=z;const H=window.BABYLON.MeshBuilder.CreateTube(`cable_${N.id}_${O}`,{path:[C.pos,new window.BABYLON.Vector3(C.pos.x,1,C.pos.z)],radius:.02,tessellation:8},g),d=new window.BABYLON.StandardMaterial(`cableMat_${N.id}_${O}`,g);d.diffuseColor=new window.BABYLON.Color3(.1,.1,.1),H.material=d})})(),(()=>{const $=window.BABYLON.MeshBuilder.CreateCylinder(`emergencyStop_${N.id}`,{diameter:.3,height:.1,tessellation:16},g);$.position=new window.BABYLON.Vector3(0,4.2,2.2);const C=new window.BABYLON.StandardMaterial(`emergencyMat_${N.id}`,g);C.diffuseColor=new window.BABYLON.Color3(1,0,0),C.emissiveColor=new window.BABYLON.Color3(.5,0,0),$.material=C;const O=window.BABYLON.MeshBuilder.CreateCylinder(`lightTower_${N.id}`,{diameter:.15,height:1.5,tessellation:12},g);O.position=new window.BABYLON.Vector3(2.5,5,2.5),[new window.BABYLON.Color3(1,0,0),new window.BABYLON.Color3(1,1,0),new window.BABYLON.Color3(0,1,0)].forEach((z,H)=>{const d=window.BABYLON.MeshBuilder.CreateSphere(`towerLight_${N.id}_${H}`,{diameter:.2,segments:16},g);d.position=new window.BABYLON.Vector3(2.5,5.5-H*.4,2.5);const T=new window.BABYLON.StandardMaterial(`towerLightMat_${N.id}_${H}`,g);T.diffuseColor=z,T.emissiveColor=z.scale(N.status==="available"?.8:.1),d.material=T})})(),(()=>{if(je&&je.material){const $=new window.BABYLON.Texture("https://www.babylonjs-playground.com/textures/rust.jpg",g);$.uScale=4,$.vScale=4,je.material.emissiveTexture&&(je.material.emissiveTexture=$,je.material.emissiveColor=new window.BABYLON.Color3(.1,.05,.02))}})();const Ae=g.meshes.filter($=>$.name.includes(`_${N.id}`)||$.name.includes(`${N.id}_`));return Ae.forEach($=>{$.receiveShadows=!0,g.ultraShadowGenerator&&g.ultraShadowGenerator.addShadowCaster($,!0)}),console.log(` Ultra-detailed machine model created for ${N.name} with ${Ae.length} components`),{mainBody:je,basePlatform:Y,auxiliaryComponents:Ee,componentCount:Ae.length}},G=N=>{if(!f||!Array.isArray(N)||N.length===0)return;console.log(" Creating realistic 3D machine models for",N.length,"equipment units");const g={available:new window.BABYLON.Color3(.2,.6,.3),busy:new window.BABYLON.Color3(.8,.5,.1),offline:new window.BABYLON.Color3(.5,.5,.5),error:new window.BABYLON.Color3(.7,.2,.1)};f.meshes.filter(Y=>Y.name.startsWith("machine_")||Y.name.startsWith("platform_")||Y.name.startsWith("agitator_")||Y.name.startsWith("conveyor_")).forEach(Y=>Y.dispose()),N.forEach((Y,Z)=>{try{const{mainBody:le,auxiliaryComponents:ke,componentCount:Be}=se(Y,f);console.log(` Created ultra-detailed machine ${Y.name} with ${Be} components`);let je,Ee;const ve=N.filter(z=>z.environment===Y.environment).indexOf(Y),Ae=(z=>{const H=z.name.toUpperCase(),Me={...{"BLENDER LEAL":{x:-30,z:20},LEAL:{x:-30,z:20},MATURATION:{x:-30,z:10},"CORAZZA TABLET":{x:-30,z:-10},TABLET:{x:-30,z:-10},CORAZZA:{x:-30,z:-10}},...{WINKWORK:{x:-20,z:20},"BLENDER WINKWORK":{x:-20,z:20},"CORAZZA CUBE":{x:-20,z:-10},CUBE:{x:-20,z:-10}},...{"NPS STICK PACK":{x:-10,z:22},"STICK PACK":{x:-10,z:22},STICKPACK:{x:-10,z:22},ENFLEX:{x:-10,z:15},"FB-10":{x:-10,z:15},"FB 10":{x:-10,z:15},ILAPACK:{x:-10,z:5},ILAPAK:{x:-10,z:5},"STOCK POWDER":{x:-10,z:-5},POWDER:{x:-10,z:-5},UNIVERSAL:{x:-10,z:-15}},...{"PRE-BATCH":{x:0,z:15},BATCH:{x:0,z:15},PRE:{x:0,z:15}},...{CANLINE:{x:15,z:5},"CAN LINE":{x:15,z:5},"OLD CAN LINE":{x:15,z:5},CAN:{x:15,z:5},"NPS 5 LANE":{x:15,z:-5},"5LANES":{x:15,z:-5},"NPS AUGER":{x:15,z:-12},AUGER:{x:15,z:-12},"ENFLEX F14":{x:15,z:-18},CANISTER:{x:15,z:-25},"CANISTER LINE":{x:15,z:-25}},...{PLOUGHSHARE:{x:30,z:20},PLOUGH:{x:30,z:20},"BLENDER MAXMIX":{x:30,z:12},MAXMIX:{x:30,z:12},"MAX MIX":{x:30,z:12},DRUMBLENDER:{x:30,z:6},"DRUM BLENDER":{x:30,z:6},DRUM:{x:30,z:6},BULKLINE:{x:30,z:0},"BULK LINE":{x:30,z:0},BULK:{x:30,z:0},"LIQUID LINE":{x:30,z:-10},LIQUID:{x:30,z:-10}}};if(Me[H])return Me[H];for(const[I,ge]of Object.entries(Me))if(H.includes(I)||I.includes(H))return ge;if(z.environment==="blending")return{x:-32.5+ve%2*7.5,z:20-Math.floor(ve/2)*10};if(z.environment==="maturation")return{x:-32.5,z:12-ve*6};if(z.environment==="processing")return{x:32.5,z:20-ve*8};if(z.environment==="packaging")return{x:-20+ve%3*17.5,z:22-Math.floor(ve/3)*10};let He="general";return H.includes("BLEND")||H.includes("MIX")||H.includes("BATCH")?(He="blending",{x:-15+ve%3*10,z:-16+Math.floor(ve/3)*3}):H.includes("FLUID")||H.includes("MATURE")||H.includes("AGE")?(He="maturation",{x:-20+ve%2*4,z:-4+Math.floor(ve/2)*4}):H.includes("GRANUL")||H.includes("DRY")||H.includes("SIFT")||H.includes("CUBE")?(He="processing",{x:15+ve%2*6,z:-4+Math.floor(ve/2)*4}):H.includes("PACK")||H.includes("TABLET")||H.includes("CAN")||H.includes("FILL")?(He="packaging",{x:-18+ve%5*8,z:14+Math.floor(ve/5)*3}):{x:-10+ve%4*6,z:-8+Math.floor(ve/4)*4}})(Y);je=Ae.x,Ee=Ae.z,le&&(le.position.x=je,le.position.z=Ee);const $=f.getMeshByName(`platform_${Y.id}`);$&&($.position.x=je,$.position.z=Ee);const C=(z,H,d)=>{const T=window.BABYLON.MeshBuilder.CreateSphere(`status_${z.id}`,{diameter:.5},d);T.position=new window.BABYLON.Vector3(H.x,8,H.z);const E={available:new window.BABYLON.Color3(0,1,.3),busy:new window.BABYLON.Color3(1,.6,0),offline:new window.BABYLON.Color3(.5,.5,.5),error:new window.BABYLON.Color3(1,.1,.1)},R=new window.BABYLON.StandardMaterial(`statusMat_${z.id}`,d);R.diffuseColor=E[z.status]||E.offline,R.emissiveColor=(E[z.status]||E.offline).scale(.8),T.material=R,z.status==="busy"&&window.BABYLON.Animation.CreateAndStartAnimation("statusPulse",R,"emissiveColor",60,120,(E[z.status]||E.offline).scale(.3),(E[z.status]||E.offline).scale(1),window.BABYLON.Animation.ANIMATIONLOOPMODE_YOYO)};if(le){const z=new window.BABYLON.PBRMaterial(`machineMat_${Y.id}`,f),H=g[Y.status]||g.offline;z.baseColor=H,z.emissiveColor=H.scale(.1),z.metallicFactor=.3,z.roughnessFactor=.4,z.wireframe=!1,le.material=z,le.renderOutline=!1,le.showBoundingBox=!1,C(Y,{x:je,z:Ee},f)}((z,H,d)=>{const T=window.BABYLON.MeshBuilder.CreatePlane(`label_${z.id}`,{width:6,height:1.2},d);T.position=new window.BABYLON.Vector3(H.x,6,H.z),T.billboardMode=window.BABYLON.Mesh.BILLBOARDMODE_Y;const E=new window.BABYLON.StandardMaterial(`labelMat_${z.id}`,d);E.diffuseColor=new window.BABYLON.Color3(.9,.9,.9),E.emissiveColor=new window.BABYLON.Color3(.6,.6,.6),z.environment==="blending"?E.emissiveColor=new window.BABYLON.Color3(.09,.15,.27):z.environment==="maturation"?E.emissiveColor=new window.BABYLON.Color3(.27,.21,.09):z.environment==="packaging"&&(E.emissiveColor=new window.BABYLON.Color3(.09,.24,.12)),T.material=E;const R=window.BABYLON.MeshBuilder.CreateBox(`perfBar_${z.id}`,{width:5,height:.1,depth:.1},d);R.position=new window.BABYLON.Vector3(H.x,5.5,H.z);const Q=new window.BABYLON.StandardMaterial(`perfMat_${z.id}`,d);z.status==="available"?(Q.diffuseColor=new window.BABYLON.Color3(0,.8,.3),Q.emissiveColor=new window.BABYLON.Color3(0,.4,.15)):z.status==="busy"?(Q.diffuseColor=new window.BABYLON.Color3(1,.6,0),Q.emissiveColor=new window.BABYLON.Color3(.5,.3,0)):(Q.diffuseColor=new window.BABYLON.Color3(.3,.3,.3),Q.emissiveColor=new window.BABYLON.Color3(.1,.1,.1)),R.material=Q})(Y,{x:je,z:Ee},f),f.meshes.filter(z=>z.name.includes(`_${Y.id}`)&&!z.name.startsWith("machine_")&&!z.name.startsWith("platform_")).forEach(z=>{z.position.x+=je,z.position.z+=Ee})}catch(le){console.error(` Failed to create 3D machine ${Y.name}:`,le)}})},W=u.useCallback(N=>{if(!N){v&&v.dispose();return}(async()=>{try{S(null),console.log(" Starting factory initialization..."),await F(),await U(N),console.log(" Factory ready")}catch(M){console.error(" Factory initialization failed:",M),S(M.message)}})()},[o]);return y?e.jsx("div",{className:"flex items-center justify-center h-64 bg-red-50 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-600 mb-2",children:" Babylon.js Error"}),e.jsx("div",{className:"text-sm text-red-500",children:y}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Reload Page"})]})}):e.jsxs("div",{className:"fixed inset-0 bg-gray-900 overflow-hidden relative z-50",style:{height:"100vh",width:"100vw"},children:[e.jsx("div",{className:"absolute top-4 right-4 z-20",children:e.jsx("button",{onClick:()=>{document.body.style.overflow="auto";const N=document.querySelector(".fixed.inset-0.bg-gray-900");N&&N.remove(),h&&h(null)},className:"bg-red-600 hover:bg-red-700 text-white p-2 rounded-full shadow-lg transition-colors",title:"Close Digital Twin",children:""})}),e.jsxs("div",{className:"absolute top-4 left-4 z-10 bg-black/80 backdrop-blur-sm rounded-lg p-4 text-white",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:" Factory Controls"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsx("button",{onClick:()=>window.factoryCameraPresets?.goTo("overview"),className:"w-full px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-left",children:" Overview"}),e.jsx("button",{onClick:()=>window.factoryCameraPresets?.goTo("blending"),className:"w-full px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-left",children:" Blending Zone"}),e.jsx("button",{onClick:()=>window.factoryCameraPresets?.goTo("packaging"),className:"w-full px-3 py-1 bg-green-600 hover:bg-green-700 rounded text-left",children:" Packaging Zone"}),e.jsx("button",{onClick:()=>window.factoryCameraPresets?.goTo("factory_flow"),className:"w-full px-3 py-1 bg-yellow-600 hover:bg-yellow-700 rounded text-left",children:" Process Flow"}),e.jsx("button",{onClick:()=>window.factoryCameraPresets?.goTo("aerial"),className:"w-full px-3 py-1 bg-indigo-600 hover:bg-indigo-700 rounded text-left",children:" Aerial View"}),e.jsx("button",{onClick:()=>{const N=document.querySelector("canvas");N.requestFullscreen&&N.requestFullscreen()},className:"w-full px-3 py-1 bg-slate-600 hover:bg-slate-700 rounded text-left",children:" Fullscreen"})]})]}),e.jsxs("div",{className:"absolute top-16 right-4 z-10 bg-black/80 backdrop-blur-sm rounded-lg p-4 text-white",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:" Live Status"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Active Machines:"}),e.jsx("span",{className:"text-green-400",children:o?.filter(N=>N.status==="available").length||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Busy Machines:"}),e.jsx("span",{className:"text-orange-400",children:o?.filter(N=>N.status==="busy").length||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Offline:"}),e.jsx("span",{className:"text-gray-400",children:o?.filter(N=>N.status==="offline").length||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Factory Efficiency:"}),e.jsxs("span",{className:"text-blue-400",children:[o?.length>0?Math.round(o.filter(N=>N.status==="available").length/o.length*100):0,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Performance:"}),e.jsx("span",{id:"factory-performance",className:"text-green-400",children:"-- FPS"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Factory Size:"}),e.jsx("span",{className:"text-slate-400",children:"52m  42m"})]})]})]}),e.jsxs("div",{className:"absolute bottom-4 left-4 z-10 bg-black/60 backdrop-blur-sm rounded-lg p-3 text-white text-xs",children:[e.jsx("div",{className:"font-semibold mb-1",children:" Navigation"}),e.jsx("div",{children:" Drag: Rotate   Wheel: Zoom   Click: Select Machine"})]}),e.jsx("canvas",{ref:W,className:"w-full h-full",style:{display:"block",touchAction:"none",outline:"none",imageRendering:"auto",filter:"contrast(1.1) brightness(1.05)",backfaceVisibility:"hidden",transform:"translate3d(0, 0, 0)"},tabIndex:0}),!c&&!y&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/90 backdrop-blur-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-blue-400 mb-2",children:" Loading 4D Digital Twin Factory..."}),e.jsx("div",{className:"text-sm text-blue-300",children:"Initializing Babylon.js engine"}),e.jsx("div",{className:"mt-2 w-8 h-8 border-2 border-blue-400 border-t-transparent rounded-full animate-spin mx-auto"})]})}),y&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-red-900/90 backdrop-blur-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-400 mb-2",children:" Babylon.js Error"}),e.jsx("div",{className:"text-sm text-red-300",children:y}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Reload Page"})]})})]})},Fb=({machines:o=[],environments:i=[],onMachineClick:h,onLayoutChange:c,readOnly:x=!1})=>{const y=u.useRef(null),S=u.useRef(null),[A,j]=u.useState(!1),[f,v]=u.useState("select"),[F,U]=u.useState(null),[se,G]=u.useState(!1),[W,N]=u.useState({x:0,y:0}),[g,M]=u.useState({scale:1,offsetX:0,offsetY:0}),[Y,Z]=u.useState(!0),[le,ke]=u.useState(!0),[Be,je]=u.useState({width:2e3,height:1500,gridSize:20,backgroundColor:"#f8fafc",borderColor:"#e2e8f0",rooms:[],screens:[],customElements:[]}),[Ee,D]=u.useState(new Map),[ve,ee]=u.useState(new Map),[Ae,$]=u.useState(!1),[C,O]=u.useState("machines"),[q,z]=u.useState(!0),[H,d]=u.useState({enableShadows:!0,enableReflections:!0,enableAnimations:!0,quality:"ultra",renderScale:window.devicePixelRatio||1,antiAliasing:!0,texture:{floor:"polished-concrete",walls:"industrial-steel",machines:"brushed-metal"}}),T=u.useMemo(()=>({"polished-concrete":{pattern:"radial-gradient(circle at 30% 20%, #f1f5f9 0%, #e2e8f0 25%, #cbd5e1 50%, #94a3b8 100%)",roughness:.1,metallic:0},"industrial-steel":{pattern:"linear-gradient(45deg, #64748b 0%, #475569 25%, #334155 50%, #1e293b 75%, #0f172a 100%)",roughness:.3,metallic:.8},"brushed-metal":{pattern:"repeating-linear-gradient(90deg, #71717a 0px, #52525b 1px, #3f3f46 2px, #27272a 3px)",roughness:.2,metallic:.9},"safety-yellow":{pattern:"linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #d97706 100%)",roughness:.4,metallic:.1},"emergency-red":{pattern:"radial-gradient(circle, #dc2626 0%, #991b1b 70%, #7f1d1d 100%)",roughness:.3,metallic:.2}}),[]),E=u.useMemo(()=>[{id:"production-floor",name:"Production Floor",width:800,height:600,color:"#f0f9ff",borderColor:"#0ea5e9",type:"production"},{id:"quality-control",name:"Quality Control",width:300,height:200,color:"#f0fdf4",borderColor:"#22c55e",type:"quality"},{id:"warehouse",name:"Warehouse",width:400,height:300,color:"#fffbeb",borderColor:"#f59e0b",type:"storage"},{id:"office-space",name:"Office Space",width:250,height:200,color:"#fdf4ff",borderColor:"#a855f7",type:"office"}],[]),R=u.useMemo(()=>({blending:{width:80,height:60,color:"#3b82f6",icon:"",shape:"rounded-rect",details:{pipes:!0,controls:!0,animations:["mixing","filling"]}},packaging:{width:100,height:40,color:"#10b981",icon:"",shape:"rect",details:{conveyor:!0,robotic:!0,animations:["conveyor-belt","packaging"]}},beverage:{width:70,height:70,color:"#f59e0b",icon:"",shape:"circle",details:{tanks:!0,fillers:!0,animations:["filling","carbonation"]}},"quality-station":{width:60,height:60,color:"#8b5cf6",icon:"",shape:"hexagon",details:{sensors:!0,displays:!0,animations:["scanning","testing"]}}}),[]),Q=u.useMemo(()=>[{id:"main-dashboard",name:"Main Dashboard",width:200,height:120,type:"dashboard",content:"production-overview"},{id:"machine-status",name:"Machine Status",width:150,height:100,type:"status",content:"machine-data"},{id:"kpi-display",name:"KPI Display",width:180,height:80,type:"metrics",content:"performance-kpis"},{id:"emergency-panel",name:"Emergency Panel",width:120,height:160,type:"emergency",content:"safety-controls"}],[]);u.useEffect(()=>{Be.rooms.length===0&&je(_=>({..._,rooms:[{id:"main-production",...E[0],x:100,y:100},{id:"quality-area",...E[1],x:1e3,y:100}]}))},[E]);const Ce=u.useCallback(_=>{if(!_)return;const{width:be,height:me}=Be,{scale:ce,offsetX:re,offsetY:we}=g;_.save(),_.setTransform(1,0,0,1,0,0),_.clearRect(0,0,_.canvas.width,_.canvas.height),_.scale(ce,ce),_.translate(re,we),_.imageSmoothingEnabled=!0,_.imageSmoothingQuality="high",_.textRenderingOptimization="optimizeQuality",Me(_),Y&&He(_),Be.rooms.forEach(_e=>I(_,_e)),Be.screens.forEach(_e=>Le(_,_e)),o.forEach(_e=>{const Ve=Ee.get(_e.id),b=ve.get(_e.id);Ve&&Qe(_,_e,Ve,b)}),Be.customElements.forEach(_e=>k(_,_e)),F&&A&&ne(_,F),_.restore()},[Be,g,Y,le,F,A,o,Ee,ve]),Me=u.useCallback(_=>{const{width:be,height:me,backgroundColor:ce}=Be,re=T[H.texture.floor],we=_.createLinearGradient(0,0,be,me);if(we.addColorStop(0,ce),we.addColorStop(.5,"#ffffff"),we.addColorStop(1,ce),_.fillStyle=we,_.fillRect(0,0,be,me),re&&H.quality!=="low"){_.globalAlpha=.1;const _e=_.createPattern(Ne(re.pattern,50,50),"repeat");_e&&(_.fillStyle=_e,_.fillRect(0,0,be,me)),_.globalAlpha=1}_.strokeStyle=Be.borderColor,_.lineWidth=2,_.strokeRect(0,0,be,me)},[Be,T,H]),He=u.useCallback(_=>{const{width:be,height:me,gridSize:ce}=Be,{scale:re}=g,we=Math.max(.1,Math.min(.5,re));_.globalAlpha=we,_.strokeStyle="#e2e8f0",_.lineWidth=1;for(let _e=0;_e<=be;_e+=ce)_.beginPath(),_.moveTo(_e,0),_.lineTo(_e,me),_.stroke();for(let _e=0;_e<=me;_e+=ce)_.beginPath(),_.moveTo(0,_e),_.lineTo(be,_e),_.stroke();_.globalAlpha=1},[Be,g]),I=u.useCallback((_,be)=>{const{x:me,y:ce,width:re,height:we,color:_e,borderColor:Ve,name:b,type:ie}=be;H.enableShadows&&(_.shadowColor="rgba(0, 0, 0, 0.15)",_.shadowBlur=10,_.shadowOffsetX=3,_.shadowOffsetY=3);const $e=_.createLinearGradient(me,ce,me+re,ce+we);$e.addColorStop(0,_e),$e.addColorStop(1,B(_e,-10)),_.fillStyle=$e,_.fillRect(me,ce,re,we),_.shadowColor="transparent",_.strokeStyle=Ve,_.lineWidth=3,_.setLineDash([]),_.strokeRect(me,ce,re,we),ge(_,be),le&&oe(_,be)},[H,le]),ge=u.useCallback((_,be)=>{const{x:me,y:ce,type:re}=be,we=20,_e=10,Ve={production:"",quality:"",storage:"",office:""};_.font=`${we}px Arial`,_.fillText(Ve[re]||"",me+_e,ce+we+_e)},[]),oe=u.useCallback((_,be)=>{const{x:me,y:ce,width:re,height:we,name:_e}=be,Ve=me+re/2,b=ce+we/2;_.font="bold 14px Arial",_.fillStyle="#1f2937",_.textAlign="center",_.textBaseline="middle";const $e=_.measureText(_e).width+20,ut=24;_.fillStyle="rgba(255, 255, 255, 0.9)",_.fillRect(Ve-$e/2,b-ut/2,$e,ut),_.strokeStyle="#d1d5db",_.lineWidth=1,_.strokeRect(Ve-$e/2,b-ut/2,$e,ut),_.fillStyle="#1f2937",_.fillText(_e,Ve,b)},[]),Le=u.useCallback((_,be)=>{const{x:me,y:ce,width:re,height:we,name:_e,type:Ve,content:b}=be,ie=8,$e=_.createLinearGradient(me,ce,me+re,ce+we);$e.addColorStop(0,"#4b5563"),$e.addColorStop(.5,"#374151"),$e.addColorStop(1,"#1f2937"),_.fillStyle=$e,_.fillRect(me-ie,ce-ie,re+ie*2,we+ie*2),_.fillStyle="#000000",_.fillRect(me,ce,re,we),ye(_,be),le&&(_.font="bold 12px Arial",_.fillStyle="#ffffff",_.textAlign="center",_.fillText(_e,me+re/2,ce+we+20))},[le]),ye=u.useCallback((_,be)=>{const{x:me,y:ce,width:re,height:we,type:_e,content:Ve}=be,b=10;switch(_e){case"dashboard":Ue(_,me+b,ce+b,re-b*2,we-b*2);break;case"status":pe(_,me+b,ce+b,re-b*2,we-b*2);break;case"metrics":Se(_,me+b,ce+b,re-b*2,we-b*2);break;case"emergency":ze(_,me+b,ce+b,re-b*2,we-b*2);break;default:Ye(_,me+b,ce+b,re-b*2,we-b*2)}},[]),Ue=u.useCallback((_,be,me,ce,re)=>{_.fillStyle="#10b981",_.fillRect(be,me,ce*.3,re*.4),_.fillStyle="#3b82f6",_.fillRect(be+ce*.35,me,ce*.3,re*.6),_.fillStyle="#f59e0b",_.fillRect(be+ce*.7,me,ce*.25,re*.3),_.fillStyle="#22c55e",_.beginPath(),_.arc(be+15,me+re-15,5,0,Math.PI*2),_.fill(),_.fillStyle="#ffffff",_.font="8px Arial",_.fillText("ONLINE",be+25,me+re-10)},[]),pe=u.useCallback((_,be,me,ce,re)=>{["M1: ONLINE","M2: ONLINE","M3: MAINT","M4: ONLINE"].forEach((_e,Ve)=>{const b=me+Ve*20+15,ie=_e.includes("ONLINE")?"#22c55e":_e.includes("MAINT")?"#f59e0b":"#ef4444";_.fillStyle=ie,_.beginPath(),_.arc(be+8,b,3,0,Math.PI*2),_.fill(),_.fillStyle="#ffffff",_.font="8px Arial",_.fillText(_e,be+20,b+3)})},[]),Se=u.useCallback((_,be,me,ce,re)=>{[{label:"OEE",value:.85,color:"#10b981"},{label:"Quality",value:.92,color:"#3b82f6"},{label:"Availability",value:.78,color:"#f59e0b"}].forEach((_e,Ve)=>{const b=me+Ve*20+10,ie=ce-40,$e=ie*_e.value;_.fillStyle="#374151",_.fillRect(be+30,b,ie,8),_.fillStyle=_e.color,_.fillRect(be+30,b,$e,8),_.fillStyle="#ffffff",_.font="8px Arial",_.fillText(_e.label,be,b+6)})},[]),ze=u.useCallback((_,be,me,ce,re)=>{const we=Math.min(ce,re)*.6,_e=be+(ce-we)/2,Ve=me+(re-we)/2,b=Date.now()/1e3,$e=`rgba(239, 68, 68, ${.7+(Math.sin(b*3)*.5+.5)*.3})`;_.fillStyle=$e,_.beginPath(),_.arc(_e+we/2,Ve+we/2,we/2,0,Math.PI*2),_.fill(),_.fillStyle="#ffffff",_.font="bold 10px Arial",_.textAlign="center",_.fillText("STOP",_e+we/2,Ve+we/2)},[]),Ye=u.useCallback((_,be,me,ce,re)=>{_.fillStyle="#4b5563",_.fillRect(be,me,ce,re),_.fillStyle="#9ca3af",_.font="10px Arial",_.textAlign="center",_.fillText("DISPLAY",be+ce/2,me+re/2)},[]),Qe=u.useCallback((_,be,me,ce={})=>{const re=R[be.type]||R.blending,{x:we,y:_e}=me,{width:Ve,height:b,color:ie,icon:$e,shape:ut}=re,St=ce.scale||1,Ke=ce.rotation||0;switch(_.save(),_.translate(we+Ve/2,_e+b/2),_.rotate(Ke),_.scale(St,St),H.enableShadows&&(_.shadowColor="rgba(0, 0, 0, 0.3)",_.shadowBlur=8,_.shadowOffsetX=2,_.shadowOffsetY=2),ut){case"circle":Pe(_,be,re,ce);break;case"hexagon":Re(_,be,re,ce);break;case"rounded-rect":et(_,be,re,ce);break;default:Fe(_,be,re,ce)}_.shadowColor="transparent",H.quality!=="low"&&Te(_,be,re,ce),P(_,be,re),le&&p(_,be,re),_.restore()},[R,H,le]),Pe=u.useCallback((_,be,me,ce)=>{const{width:re,height:we,color:_e}=me,Ve=Math.min(re,we)/2,b=_.createRadialGradient(0,0,0,0,0,Ve);b.addColorStop(0,B(_e,20)),b.addColorStop(.7,_e),b.addColorStop(1,B(_e,-20)),_.fillStyle=b,_.beginPath(),_.arc(0,0,Ve,0,Math.PI*2),_.fill(),_.strokeStyle=B(_e,-30),_.lineWidth=2,_.stroke()},[]),Re=u.useCallback((_,be,me,ce)=>{const{width:re,height:we,color:_e}=me,Ve=Math.min(re,we)/2;_.beginPath();for(let ie=0;ie<6;ie++){const $e=ie*Math.PI/3,ut=Ve*Math.cos($e),St=Ve*Math.sin($e);ie===0?_.moveTo(ut,St):_.lineTo(ut,St)}_.closePath();const b=_.createLinearGradient(-Ve,-Ve,Ve,Ve);b.addColorStop(0,B(_e,20)),b.addColorStop(1,B(_e,-20)),_.fillStyle=b,_.fill(),_.strokeStyle=B(_e,-30),_.lineWidth=2,_.stroke()},[]),et=u.useCallback((_,be,me,ce)=>{const{width:re,height:we,color:_e}=me,Ve=8;_.beginPath(),_.roundRect(-re/2,-we/2,re,we,Ve);const b=_.createLinearGradient(-re/2,-we/2,re/2,we/2);b.addColorStop(0,B(_e,20)),b.addColorStop(.5,_e),b.addColorStop(1,B(_e,-20)),_.fillStyle=b,_.fill(),_.strokeStyle=B(_e,-30),_.lineWidth=2,_.stroke()},[]),Fe=u.useCallback((_,be,me,ce)=>{const{width:re,height:we,color:_e}=me,Ve=_.createLinearGradient(-re/2,-we/2,re/2,we/2);Ve.addColorStop(0,B(_e,20)),Ve.addColorStop(.5,_e),Ve.addColorStop(1,B(_e,-20)),_.fillStyle=Ve,_.fillRect(-re/2,-we/2,re,we),_.strokeStyle=B(_e,-30),_.lineWidth=2,_.strokeRect(-re/2,-we/2,re,we)},[]),Te=u.useCallback((_,be,me,ce)=>{const{width:re,height:we,details:_e}=me;if(_e?.pipes&&(_.strokeStyle="#64748b",_.lineWidth=3,_.beginPath(),_.moveTo(-re/3,-we/2),_.lineTo(-re/3,we/2),_.moveTo(re/3,-we/2),_.lineTo(re/3,we/2),_.stroke()),_e?.controls&&(_.fillStyle="#1f2937",_.fillRect(re/4,-we/4,re/4,we/2),_.fillStyle="#22c55e",_.beginPath(),_.arc(re/3,-we/8,3,0,Math.PI*2),_.fill(),_.fillStyle="#ef4444",_.beginPath(),_.arc(re/3,we/8,3,0,Math.PI*2),_.fill()),_e?.conveyor){const Ve=Date.now()/500,b=we/3;_.strokeStyle="#374151",_.lineWidth=6,_.beginPath(),_.moveTo(-re/2,b),_.lineTo(re/2,b),_.stroke();for(let ie=0;ie<5;ie++){const $e=-re/2+(ie*20+Ve*20)%re;_.fillStyle="#4b5563",_.fillRect($e,b-2,8,4)}}},[]),P=u.useCallback((_,be,me)=>{const{width:ce,height:re}=me,we=12,_e=ce/2-we-5,Ve=-re/2+we+5,ie={available:"#22c55e",in_use:"#3b82f6",maintenance:"#f59e0b",offline:"#ef4444"}[be.status]||"#6b7280";if(H.enableAnimations){const $e=Date.now()/1e3,ut=be.status==="in_use"?Math.sin($e*2)*.2+.8:1;_.globalAlpha=ut}_.fillStyle=ie,_.beginPath(),_.arc(_e,Ve,we/2,0,Math.PI*2),_.fill(),_.globalAlpha=1,_.strokeStyle="#ffffff",_.lineWidth=2,_.stroke()},[H]),p=u.useCallback((_,be,me)=>{const{height:ce}=me;_.fillStyle="#ffffff",_.strokeStyle="#1f2937",_.lineWidth=3,_.font="bold 12px Arial",_.textAlign="center",_.textBaseline="top";const re=ce/2+10;_.strokeText(be.name,0,re),_.fillText(be.name,0,re)},[]),k=u.useCallback((_,be)=>{const{x:me,y:ce,width:re,height:we,type:_e,style:Ve}=be;switch(_e){case"wall":_.fillStyle=Ve.color||"#64748b",_.fillRect(me,ce,re,we);break;case"door":_.fillStyle=Ve.color||"#8b5cf6",_.fillRect(me,ce,re,we),_.fillStyle="#374151",_.beginPath(),_.arc(me+re-10,ce+we/2,3,0,Math.PI*2),_.fill();break;case"safety-zone":_.strokeStyle="#fbbf24",_.lineWidth=3,_.setLineDash([10,5]),_.strokeRect(me,ce,re,we),_.setLineDash([]);break}},[]),ne=u.useCallback((_,be)=>{if(!be)return;const{x:me,y:ce,width:re,height:we}=be;_.strokeStyle="#3b82f6",_.lineWidth=2,_.setLineDash([5,5]),_.strokeRect(me-5,ce-5,re+10,we+10),_.setLineDash([]);const _e=8,Ve=[{x:me-_e/2,y:ce-_e/2},{x:me+re-_e/2,y:ce-_e/2},{x:me-_e/2,y:ce+we-_e/2},{x:me+re-_e/2,y:ce+we-_e/2}];_.fillStyle="#3b82f6",Ve.forEach(b=>{_.fillRect(b.x,b.y,_e,_e)})},[]),Ne=u.useCallback((_,be,me)=>{const ce=document.createElement("canvas");ce.width=be,ce.height=me;const re=ce.getContext("2d");return re.createLinearGradient(0,0,be,me),re.fillStyle=_,re.fillRect(0,0,be,me),ce},[]),B=u.useCallback((_,be)=>{const me=_.replace("#",""),ce=Math.min(255,Math.max(0,parseInt(me.substr(0,2),16)+be)),re=Math.min(255,Math.max(0,parseInt(me.substr(2,2),16)+be)),we=Math.min(255,Math.max(0,parseInt(me.substr(4,2),16)+be));return`#${ce.toString(16).padStart(2,"0")}${re.toString(16).padStart(2,"0")}${we.toString(16).padStart(2,"0")}`},[]),ue=u.useCallback((_,be)=>{if(!q)return{x:_,y:be};const{gridSize:me}=Be;return{x:Math.round(_/me)*me,y:Math.round(be/me)*me}},[q,Be]),Ge=u.useCallback(_=>{if(!A)return;const be=y.current?.getBoundingClientRect();if(!be)return;const{scale:me,offsetX:ce,offsetY:re}=g,we=(_.clientX-be.left)/me-ce,_e=(_.clientY-be.top)/me-re;switch(f){case"room":Ze(we,_e);break;case"machine":ht(we,_e);break;case"screen":It(we,_e);break;case"select":At(we,_e);break}},[A,f,g]),Ze=u.useCallback((_,be)=>{const me=ue(_,be),ce={id:`room-${Date.now()}`,...E[0],x:me.x,y:me.y};je(re=>({...re,rooms:[...re.rooms,ce]}))},[E,ue]),ht=u.useCallback((_,be)=>{const me=ue(_,be);console.log("Add machine at:",me)},[ue]),It=u.useCallback((_,be)=>{const me=ue(_,be),ce={id:`screen-${Date.now()}`,...Q[0],x:me.x,y:me.y};je(re=>({...re,screens:[...re.screens,ce]}))},[Q,ue]),At=u.useCallback((_,be)=>{let me=null;for(const ce of Be.screens)if(_>=ce.x&&_<=ce.x+ce.width&&be>=ce.y&&be<=ce.y+ce.height){me={...ce,type:"screen"};break}if(!me){for(const ce of Be.rooms)if(_>=ce.x&&_<=ce.x+ce.width&&be>=ce.y&&be<=ce.y+ce.height){me={...ce,type:"room"};break}}if(!me)for(const ce of o){const re=Ee.get(ce.id);if(re){const we=R[ce.type]||R.blending;if(_>=re.x&&_<=re.x+we.width&&be>=re.y&&be<=re.y+we.height){me={...ce,...re,type:"machine"};break}}}U(me),$(!!me)},[Be,o,Ee,R]);u.useEffect(()=>{const _=y.current;if(!_)return;const be=_.getContext("2d"),me=S.current,ce=()=>{const re=me.getBoundingClientRect(),we=window.devicePixelRatio||1;_.width=re.width*we,_.height=re.height*we,_.style.width=re.width+"px",_.style.height=re.height+"px",be.scale(we,we),Ce(be)};return ce(),window.addEventListener("resize",ce),()=>{window.removeEventListener("resize",ce)}},[Ce]),u.useEffect(()=>{if(!H.enableAnimations)return;let _;const be=()=>{const me=y.current;if(me){const ce=me.getContext("2d");Ce(ce)}_=requestAnimationFrame(be)};return be(),()=>{_&&cancelAnimationFrame(_)}},[Ce,H.enableAnimations]),u.useEffect(()=>{if(o.length>0&&Ee.size===0){const _=new Map;o.forEach((be,me)=>{const ce=200+me*120;_.set(be.id,{x:ce,y:200})}),D(_)}},[o,Ee.size]);const is=()=>e.jsx("div",{className:"bg-white border-b border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>j(!A),className:`px-4 py-2 rounded-lg font-medium transition-colors ${A?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(di,{className:"w-4 h-4 inline mr-2"}),A?"Exit Edit":"Edit Layout"]}),A&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-l border-gray-300 pl-4",children:e.jsx("div",{className:"flex space-x-2",children:[{id:"select",icon:rp,label:"Select"},{id:"move",icon:Ug,label:"Move"},{id:"room",icon:Hl,label:"Add Room"},{id:"machine",icon:Pt,label:"Add Machine"},{id:"screen",icon:xi,label:"Add Screen"}].map(_=>e.jsx("button",{onClick:()=>v(_.id),className:`p-2 rounded-lg transition-colors ${f===_.id?"bg-blue-100 text-blue-600":"text-gray-600 hover:bg-gray-100"}`,title:_.label,children:e.jsx(_.icon,{className:"w-5 h-5"})},_.id))})}),e.jsx("div",{className:"border-l border-gray-300 pl-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>Z(!Y),className:`p-2 rounded-lg transition-colors ${Y?"bg-green-100 text-green-600":"text-gray-600 hover:bg-gray-100"}`,title:"Toggle Grid",children:e.jsx(Yg,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>ke(!le),className:`p-2 rounded-lg transition-colors ${le?"bg-green-100 text-green-600":"text-gray-600 hover:bg-gray-100"}`,title:"Toggle Labels",children:le?e.jsx(Ps,{className:"w-5 h-5"}):e.jsx(gh,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>z(!q),className:`p-2 rounded-lg transition-colors ${q?"bg-green-100 text-green-600":"text-gray-600 hover:bg-gray-100"}`,title:"Snap to Grid",children:e.jsx(vh,{className:"w-5 h-5"})})]})})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>M(_=>({..._,scale:Math.min(3,_.scale*1.2)})),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Zoom In",children:e.jsx(qt,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>M(_=>({..._,scale:Math.max(.1,_.scale/1.2)})),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Zoom Out",children:e.jsx(tp,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>M({scale:1,offsetX:0,offsetY:0}),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Reset View",children:e.jsx(Tt,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"border-l border-gray-300 pl-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Import Layout",children:e.jsx(bi,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Export Layout",children:e.jsx(Ns,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Save Layout",children:e.jsx(na,{className:"w-5 h-5"})})]})})]})]})}),Dt=()=>Ae&&F&&e.jsx("div",{className:"absolute top-0 right-0 w-80 h-full bg-white border-l border-gray-200 shadow-lg overflow-y-auto",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Properties"}),e.jsx("button",{onClick:()=>$(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:F.name||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md",readOnly:!A})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Width"}),e.jsx("input",{type:"number",value:F.width||0,className:"w-full px-3 py-2 border border-gray-300 rounded-md",readOnly:!A})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height"}),e.jsx("input",{type:"number",value:F.height||0,className:"w-full px-3 py-2 border border-gray-300 rounded-md",readOnly:!A})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"X Position"}),e.jsx("input",{type:"number",value:F.x||0,className:"w-full px-3 py-2 border border-gray-300 rounded-md",readOnly:!A})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Y Position"}),e.jsx("input",{type:"number",value:F.y||0,className:"w-full px-3 py-2 border border-gray-300 rounded-md",readOnly:!A})]})]}),F.type==="screen"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Screen Type"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"dashboard",children:"Dashboard"}),e.jsx("option",{value:"status",children:"Status Display"}),e.jsx("option",{value:"metrics",children:"Metrics"}),e.jsx("option",{value:"emergency",children:"Emergency Panel"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"production-overview",children:"Production Overview"}),e.jsx("option",{value:"machine-data",children:"Machine Data"}),e.jsx("option",{value:"performance-kpis",children:"Performance KPIs"}),e.jsx("option",{value:"safety-controls",children:"Safety Controls"})]})]})]}),F.type==="room"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Room Type"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"production",children:"Production"}),e.jsx("option",{value:"quality",children:"Quality Control"}),e.jsx("option",{value:"storage",children:"Storage"}),e.jsx("option",{value:"office",children:"Office"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Background Color"}),e.jsx("input",{type:"color",value:F.color||"#ffffff",className:"w-full h-10 border border-gray-300 rounded-md"})]})]}),F.type==="machine"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Machine Type"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"blending",children:"Blending"}),e.jsx("option",{value:"packaging",children:"Packaging"}),e.jsx("option",{value:"beverage",children:"Beverage"}),e.jsx("option",{value:"quality-station",children:"Quality Station"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"available",children:"Available"}),e.jsx("option",{value:"in_use",children:"In Use"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"offline",children:"Offline"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scale"}),e.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",defaultValue:"1",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rotation"}),e.jsx("input",{type:"range",min:"0",max:"360",step:"15",defaultValue:"0",className:"w-full"})]})]})]})]})});return e.jsxs("div",{className:"h-screen flex flex-col bg-gray-100",children:[e.jsx(is,{}),e.jsxs("div",{ref:S,className:"flex-1 relative overflow-hidden",children:[e.jsx("canvas",{ref:y,onClick:Ge,className:"absolute inset-0 cursor-crosshair",style:{cursor:f==="select"?"default":f==="move"?"move":"crosshair"}}),e.jsx(Dt,{}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-2",children:e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsxs("div",{children:["Zoom: ",Math.round(g.scale*100),"% | Layout: ",Be.width,"",Be.height," | Quality: ",H.quality.toUpperCase()]}),e.jsxs("div",{children:["Rooms: ",Be.rooms.length," | Screens: ",Be.screens.length," | Machines: ",o.length]})]})})]})]})},Qb=({onClose:o,initialMachines:i=[],initialEnvironments:h=[]})=>{const[c,x]=u.useState(i),[y,S]=u.useState(h),[A,j]=u.useState(!0),[f,v]=u.useState(null),[F,U]=u.useState([]),[se,G]=u.useState("Default Layout"),[W,N]=u.useState(!1),[g,M]=u.useState(!1),Y=u.useCallback(async()=>{try{j(!0),v(null);const ee=await fe.get("/machines"),Ae=ee?.data||ee||[],$=await fe.get("/environments"),C=$?.data||$||[];console.log(" Loaded factory data:",{machines:Ae.length,environments:C.length}),x(Ae),S(C);try{const O=await fe.get("/factory-layouts"),q=O?.data||O||[];U(q)}catch(O){console.log("No saved layouts found:",O.message),U([])}}catch(ee){console.error("Failed to load factory data:",ee),v(ee.message||"Failed to load factory data")}finally{j(!1)}},[]);u.useEffect(()=>{Y()},[Y]);const Z=u.useCallback(ee=>{console.log(" Machine clicked:",ee)},[]),le=u.useCallback(ee=>{console.log(" Layout changed:",ee)},[]),ke=u.useCallback(async(ee,Ae)=>{try{const $={name:ee,data:Ae,machines:c.map(O=>({id:O.id,position:O.position})),created_at:new Date().toISOString(),version:"2.0"};await fe.post("/factory-layouts",$),console.log(" Layout saved:",ee),G(ee),N(!1);const C=await fe.get("/factory-layouts");U(C?.data||[])}catch($){console.error("Failed to save layout:",$),alert("Failed to save layout: "+$.message)}},[c]),Be=u.useCallback(async ee=>{try{const Ae=await fe.get(`/factory-layouts/${ee}`),$=Ae?.data||Ae;console.log(" Layout loaded:",$.name),G($.name),M(!1)}catch(Ae){console.error("Failed to load layout:",Ae),alert("Failed to load layout: "+Ae.message)}},[]),je=u.useCallback(()=>{try{const ee={name:se,version:"2.0",exported_at:new Date().toISOString(),machines:c,environments:y},Ae=new Blob([JSON.stringify(ee,null,2)],{type:"application/json"}),$=URL.createObjectURL(Ae),C=document.createElement("a");C.href=$,C.download=`factory-layout-${se.toLowerCase().replace(/\s+/g,"-")}.json`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL($),console.log(" Layout exported")}catch(ee){console.error("Export failed:",ee),alert("Export failed: "+ee.message)}},[se,c,y]),Ee=u.useCallback(ee=>{const Ae=ee.target.files[0];if(!Ae)return;const $=new FileReader;$.onload=C=>{try{const O=JSON.parse(C.target.result);console.log(" Layout imported:",O),G(O.name||"Imported Layout")}catch(O){console.error("Import failed:",O),alert("Import failed: Invalid file format")}},$.readAsText(Ae)},[]),D=()=>W&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Save Layout"}),e.jsx("input",{type:"text",placeholder:"Layout name",className:"w-full px-3 py-2 border border-gray-300 rounded-md mb-4",defaultValue:se,id:"layout-name-input"}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),e.jsx("button",{onClick:()=>{const ee=document.getElementById("layout-name-input").value;ee.trim()&&ke(ee.trim(),{})},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Save"})]})]})}),ve=()=>g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-h-96 overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Load Layout"}),e.jsx("div",{className:"space-y-2",children:F.length>0?F.map(ee=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-md hover:bg-gray-50 cursor-pointer",onClick:()=>Be(ee.id),children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:ee.name}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date(ee.created_at).toLocaleDateString()})]}),e.jsx(hi,{className:"w-5 h-5 text-gray-400"})]},ee.id)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No saved layouts found"})}),e.jsx("div",{className:"flex justify-end space-x-3 mt-4",children:e.jsx("button",{onClick:()=>M(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"})})]})});return A?e.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-90 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-8 max-w-md mx-4 text-center",children:[e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Loading Digital Twin"}),e.jsx("p",{className:"text-gray-600",children:"Initializing high-quality 2D factory layout..."})]})}):f?e.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-90 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-8 max-w-md mx-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(rs,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Loading Failed"}),e.jsx("p",{className:"text-gray-600 mb-4",children:f}),e.jsxs("div",{className:"flex space-x-3 justify-center",children:[e.jsx("button",{onClick:Y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400",children:"Close"})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"fixed inset-0 bg-gray-900 z-40",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 bg-gray-800 border-b border-gray-700 px-6 py-4 z-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(Et,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"2D Digital Twin Factory"}),e.jsx("p",{className:"text-sm text-gray-300",children:se})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-300",children:[e.jsx(xi,{className:"w-4 h-4"}),e.jsx("span",{children:"Ultra Quality"}),e.jsx("span",{className:"text-gray-500",children:""}),e.jsxs("span",{children:[c.length," Machines"]}),e.jsx("span",{className:"text-gray-500",children:""}),e.jsxs("span",{children:[y.length," Environments"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:()=>N(!0),className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",title:"Save Layout",children:[e.jsx(na,{className:"w-4 h-4"}),e.jsx("span",{children:"Save"})]}),e.jsxs("button",{onClick:()=>M(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Load Layout",children:[e.jsx(hi,{className:"w-4 h-4"}),e.jsx("span",{children:"Load"})]}),e.jsxs("button",{onClick:je,className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",title:"Export Layout",children:[e.jsx(Ns,{className:"w-4 h-4"}),e.jsx("span",{children:"Export"})]}),e.jsxs("label",{className:"flex items-center space-x-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors cursor-pointer",children:[e.jsx(bi,{className:"w-4 h-4"}),e.jsx("span",{children:"Import"}),e.jsx("input",{type:"file",accept:".json",onChange:Ee,className:"hidden"})]}),e.jsx("div",{className:"w-px h-6 bg-gray-600"}),e.jsxs("button",{onClick:o,className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",title:"Exit Full Screen",children:[e.jsx(rs,{className:"w-4 h-4"}),e.jsx("span",{children:"Exit"})]})]})]})}),e.jsx("div",{className:"absolute inset-0 pt-20",children:e.jsx(Fb,{machines:c,environments:y,onMachineClick:Z,onLayoutChange:le,readOnly:!1})}),e.jsxs("div",{className:"absolute bottom-6 left-6 bg-black bg-opacity-50 rounded-lg p-4 text-white",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Advanced Features"}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-300",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),e.jsx("span",{children:"Customizable Screens & Displays"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsx("span",{children:"Variable Layout Sizing"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full"}),e.jsx("span",{children:"Precision Machine Placement"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full"}),e.jsx("span",{children:"Room & Zone Management"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-400 rounded-full"}),e.jsx("span",{children:"Ultra-High Quality Graphics"})]})]})]}),e.jsxs("div",{className:"absolute bottom-6 right-6 bg-black bg-opacity-50 rounded-lg p-4 text-white",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"System Status"}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-300",children:[e.jsx("div",{children:"Render Quality: Ultra"}),e.jsx("div",{children:"Canvas Size: High-DPI"}),e.jsx("div",{children:"Animations: Enabled"}),e.jsx("div",{children:"Real-time Updates: Active"}),e.jsx("div",{children:"Memory Usage: Optimized"})]})]})]}),e.jsx(D,{}),e.jsx(ve,{})]})};function Xb(){const[o,i]=u.useState([]),[h,c]=u.useState([]),[x,y]=u.useState(!0),[S,A]=u.useState(!1),[j,f]=u.useState(null),[v,F]=u.useState("3d"),[U,se]=u.useState(!1);u.useEffect(()=>{G()},[]);const G=async()=>{try{y(!0);const g=await fe.get("/machines"),M=g?.data||g||[];i(Array.isArray(M)?M:[]);try{const Y=await fe.get("/environments"),Z=Y?.data||Y||[];c(Array.isArray(Z)?Z:[])}catch{console.log("No environments endpoint available"),c([])}}catch(g){console.error("Failed to load factory data for digital twin:",g),i([]),c([])}finally{y(!1)}},W=g=>{f(g),console.log(" Digital Twin - Machine selected:",g.name,"- Status:",g.status)},N=()=>{A(!S)};return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 p-3 rounded-xl shadow-lg",children:e.jsx(Et,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Digital Twin Factory"}),e.jsx("p",{className:"text-gray-600 mt-1",children:v==="3d"?"Real-time 3D visualization of your production facility":"Advanced 2D layout design with ultra-high quality graphics"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>F("3d"),className:`flex items-center gap-2 px-4 py-2 rounded-md transition-colors ${v==="3d"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(hi,{className:"w-4 h-4"}),"3D View"]}),e.jsxs("button",{onClick:()=>F("2d"),className:`flex items-center gap-2 px-4 py-2 rounded-md transition-colors ${v==="2d"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(xi,{className:"w-4 h-4"}),"2D Layout"]})]}),e.jsxs("button",{onClick:G,disabled:x,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50",children:[e.jsx(fi,{className:`w-4 h-4 ${x?"animate-spin":""}`}),"Refresh"]}),v==="2d"?e.jsxs("button",{onClick:()=>se(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[e.jsx(Pt,{className:"w-4 h-4"}),"Advanced 2D Editor"]}):e.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:[S?e.jsx(K0,{className:"w-4 h-4"}):e.jsx(vh,{className:"w-4 h-4"}),S?"Exit Fullscreen":"Fullscreen"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl p-4 text-white shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm font-medium",children:"TOTAL MACHINES"}),e.jsx("p",{className:"text-3xl font-bold",children:o.length})]}),e.jsx(Et,{className:"w-8 h-8 text-green-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-cyan-600 rounded-xl p-4 text-white shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"ACTIVE"}),e.jsx("p",{className:"text-3xl font-bold",children:o.filter(g=>g.status==="in_use").length})]}),e.jsx(Xn,{className:"w-8 h-8 text-blue-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-green-600 rounded-xl p-4 text-white shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-emerald-100 text-sm font-medium",children:"AVAILABLE"}),e.jsx("p",{className:"text-3xl font-bold",children:o.filter(g=>g.status==="available").length})]}),e.jsx("div",{className:"w-8 h-8 bg-emerald-400 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-full"})})]})}),e.jsx("div",{className:"bg-gradient-to-r from-amber-500 to-orange-600 rounded-xl p-4 text-white shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-100 text-sm font-medium",children:"MAINTENANCE"}),e.jsx("p",{className:"text-3xl font-bold",children:o.filter(g=>g.status==="maintenance").length})]}),e.jsx("div",{className:"w-8 h-8 bg-amber-400 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-3 h-3 bg-white rounded-full animate-pulse"})})]})})]}),j&&e.jsx("div",{className:"mb-6 bg-gradient-to-r from-slate-800 to-slate-700 rounded-xl p-4 text-white shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:j.name}),e.jsxs("p",{className:"text-slate-300 text-sm",children:["Environment: ",j.environment,"  Status: ",j.status]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bh,{className:"w-5 h-5 text-blue-400"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Click machines in 3D view for details"})]})]})}),v==="3d"?e.jsx("div",{className:`transition-all duration-300 ${S?"fixed inset-0 z-50 bg-black":"relative"}`,children:e.jsx("div",{className:`bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-xl overflow-hidden shadow-2xl ${S?"h-full":"h-[800px]"}`,children:e.jsxs("div",{className:"relative w-full h-full",children:[x?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-800",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-white text-lg",children:"Loading 3D Digital Twin Factory..."}),e.jsx("p",{className:"text-slate-400 text-sm mt-2",children:"Initializing 3D visualization"})]})}):e.jsx(Gb,{machines:o,onMachineClick:W,className:"w-full h-full"}),S&&e.jsx("button",{onClick:N,className:"absolute top-4 right-4 bg-black/50 hover:bg-black/70 text-white p-3 rounded-lg transition-colors",children:e.jsx(K0,{className:"w-6 h-6"})})]})})}):e.jsx("div",{className:"bg-white rounded-xl shadow-2xl overflow-hidden h-[800px]",children:e.jsx("div",{className:"relative w-full h-full",children:x?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-800 text-lg",children:"Loading 2D Digital Twin Factory..."}),e.jsx("p",{className:"text-gray-600 text-sm mt-2",children:"Initializing advanced 2D layout system"})]})}):e.jsx("div",{className:"flex items-center justify-center h-full bg-gradient-to-br from-blue-50 to-green-50",children:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-green-500 to-blue-500 rounded-2xl flex items-center justify-center mx-auto mb-6",children:e.jsx(xi,{className:"w-12 h-12 text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Advanced 2D Factory Layout"}),e.jsx("p",{className:"text-gray-600 mb-6 max-w-md",children:"Create and customize your factory layout with ultra-high quality 2D graphics. Replace screens, adjust room sizes, and precisely position machines."}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Customizable screens and displays"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Variable layout and room sizing"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{children:"Precision machine placement"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{children:"Ultra-high quality graphics (>15MB)"})]})]}),e.jsxs("button",{onClick:()=>se(!0),className:"px-8 py-4 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl hover:from-green-600 hover:to-blue-600 transition-all transform hover:scale-105 shadow-lg",children:[e.jsx(Pt,{className:"w-5 h-5 inline mr-2"}),"Launch Advanced 2D Editor"]})]})})})}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:v==="3d"?"Factory Layout":"2D Layout Features"}),e.jsx("div",{className:"space-y-2 text-sm text-gray-600",children:v==="3d"?e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Main Factory:"})," 80m  33m"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Inbound Warehouse:"})," 42.4m  37m (Left)"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Outbound Warehouse:"})," 80m  29m (Right)"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Rebate Store:"})," 37.6m  37m (Far Left)"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Screen Replacement:"})," Custom displays"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Layout Sizing:"})," Variable dimensions"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Room Management:"})," Customizable zones"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Machine Placement:"})," Precision positioning"]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Machine Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Available"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium",children:o.filter(g=>g.status==="available").length})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Active"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium",children:o.filter(g=>g.status==="in_use").length})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Maintenance"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium",children:o.filter(g=>g.status==="maintenance").length})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Environments"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium",children:h.length})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:v==="3d"?"Interaction":"Capabilities"}),e.jsx("div",{className:"space-y-2 text-sm text-gray-600",children:v==="3d"?e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Click:"})," Select machine for details"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Drag:"})," Rotate camera view"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Scroll:"})," Zoom in/out"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Colors:"})," Indicate machine status"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Ultra Quality:"})," >15MB graphics"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Real-time:"})," Live data integration"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Export/Import:"})," Layout management"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Professional:"})," Industrial design"]})]})})]})]}),U&&e.jsx(Qb,{onClose:()=>se(!1),initialMachines:o,initialEnvironments:h})]})}const Wb=({onFiltersChange:o,machines:i=[],orders:h=[],categories:c=[]})=>{const[x,y]=u.useState({start_date:new Date(Date.now()-2592e6).toISOString().split("T")[0],end_date:new Date().toISOString().split("T")[0],machine_id:"",order_id:"",category_id:"",waste_type:"",status:""}),S=["Material Spillage","Defective Products","Packaging Waste","Raw Material Spoilage","Processing Loss","Quality Rejection","Overproduction","Setup Waste","Other"],A=["active","investigating","resolving","resolved","approved"],j=u.useCallback((f,v)=>{const F={...x,[f]:v};y(F),o(F)},[x,o]);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"p-3 bg-blue-600 rounded-xl",children:e.jsx(Qn,{className:"w-6 h-6 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Report Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:x.start_date,onChange:f=>j("start_date",f.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:x.end_date,onChange:f=>j("end_date",f.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Machine"}),e.jsxs("select",{value:x.machine_id,onChange:f=>j("machine_id",f.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:[e.jsx("option",{value:"",children:"All Machines"}),i.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Order"}),e.jsxs("select",{value:x.order_id,onChange:f=>j("order_id",f.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:[e.jsx("option",{value:"",children:"All Orders"}),h.map(f=>e.jsxs("option",{value:f.id,children:[f.order_number," - ",f.product_name]},f.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Waste Type"}),e.jsxs("select",{value:x.waste_type,onChange:f=>j("waste_type",f.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:[e.jsx("option",{value:"",children:"All Types"}),S.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Downtime Category"}),e.jsxs("select",{value:x.category_id,onChange:f=>j("category_id",f.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:[e.jsx("option",{value:"",children:"All Categories"}),c.map(f=>e.jsx("option",{value:f.id,children:f.category_name},f.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:x.status,onChange:f=>j("status",f.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:[e.jsx("option",{value:"",children:"All Statuses"}),A.map(f=>e.jsx("option",{value:f,children:f.charAt(0).toUpperCase()+f.slice(1)},f))]})]})]})]})},Zb=({wasteData:o=[],downtimeData:i=[]})=>{const h=u.useMemo(()=>{const x=o.length,y=o.reduce((A,j)=>A+(parseFloat(j.total_cost)||0),0),S=o.reduce((A,j)=>A+(parseFloat(j.quantity)||0),0);return{totalRecords:x,totalCost:y,totalQuantity:S}},[o]),c=u.useMemo(()=>{const x=i.length,y=i.reduce((A,j)=>A+(parseInt(j.duration_minutes)||0),0),S=i.reduce((A,j)=>A+(parseFloat(j.cost_impact)||0),0);return{totalIncidents:x,totalDuration:y,totalCost:S}},[i]);return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-red-600 to-orange-600 rounded-2xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Waste Records"}),e.jsx(ts,{className:"w-8 h-8"})]}),e.jsx("div",{className:"text-3xl font-bold",children:h.totalRecords}),e.jsx("div",{className:"text-red-100",children:"Total incidents"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-600 to-amber-600 rounded-2xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Waste Cost"}),e.jsx(la,{className:"w-8 h-8"})]}),e.jsxs("div",{className:"text-3xl font-bold",children:["R",h.totalCost.toFixed(2)]}),e.jsx("div",{className:"text-orange-100",children:"Total cost impact"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-600 to-indigo-600 rounded-2xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Downtime Events"}),e.jsx(fh,{className:"w-8 h-8"})]}),e.jsx("div",{className:"text-3xl font-bold",children:c.totalIncidents}),e.jsx("div",{className:"text-purple-100",children:"Total incidents"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-cyan-600 rounded-2xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Downtime Duration"}),e.jsx(xs,{className:"w-8 h-8"})]}),e.jsxs("div",{className:"text-3xl font-bold",children:[Math.round(c.totalDuration/60),"h"]}),e.jsxs("div",{className:"text-blue-100",children:[c.totalDuration," minutes"]})]})]})},Kb=({data:o=[],type:i="waste",onExport:h})=>{const[c,x]=u.useState(""),[y,S]=u.useState("desc"),A=u.useCallback(F=>{c===F?S(y==="asc"?"desc":"asc"):(x(F),S("desc"))},[c,y]),j=u.useMemo(()=>c?[...o].sort((F,U)=>{let se=F[c],G=U[c];return typeof se=="string"&&(se=se.toLowerCase(),G=G.toLowerCase()),y==="asc"?se>G?1:-1:se<G?1:-1}):o,[o,c,y]),f=({field:F})=>c!==F?e.jsx($c,{className:"w-4 h-4 opacity-30"}):y==="desc"?e.jsx($c,{className:"w-4 h-4"}):e.jsx(xh,{className:"w-4 h-4"}),v=u.useCallback(()=>{if(o.length===0)return;const F=Object.keys(o[0]),U=[F.join(","),...o.map(N=>F.map(g=>`"${N[g]||""}"`).join(","))].join(`
`),se=new Blob([U],{type:"text/csv"}),G=window.URL.createObjectURL(se),W=document.createElement("a");W.href=G,W.download=`${i}_report_${new Date().toISOString().split("T")[0]}.csv`,W.click(),window.URL.revokeObjectURL(G)},[o,i]);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-green-600 rounded-xl",children:e.jsx(Kc,{className:"w-6 h-6 text-white"})}),e.jsxs("h2",{className:"text-2xl font-bold text-gray-800",children:[i==="waste"?"Waste":"Downtime"," Report Data"]})]}),e.jsxs("button",{onClick:v,className:"flex items-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors",children:[e.jsx(Ns,{className:"w-5 h-5"}),e.jsx("span",{children:"Export CSV"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:i==="waste"?e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("recorded_at"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Date"}),e.jsx(f,{field:"recorded_at"})]})}),e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("order_number"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Order"}),e.jsx(f,{field:"order_number"})]})}),e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("waste_type"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Type"}),e.jsx(f,{field:"waste_type"})]})}),e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("quantity"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Quantity"}),e.jsx(f,{field:"quantity"})]})}),e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("total_cost"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Cost"}),e.jsx(f,{field:"total_cost"})]})}),e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("recorded_by_name"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Recorded By"}),e.jsx(f,{field:"recorded_by_name"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("start_time"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Start Time"}),e.jsx(f,{field:"start_time"})]})}),e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("machine_name"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Machine"}),e.jsx(f,{field:"machine_name"})]})}),e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("category_name"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Category"}),e.jsx(f,{field:"category_name"})]})}),e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("duration_minutes"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Duration"}),e.jsx(f,{field:"duration_minutes"})]})}),e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("status"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Status"}),e.jsx(f,{field:"status"})]})}),e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsxs("button",{onClick:()=>A("reported_by_name"),className:"flex items-center space-x-2 font-semibold text-gray-700",children:[e.jsx("span",{children:"Reported By"}),e.jsx(f,{field:"reported_by_name"})]})})]})})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:j.map((F,U)=>e.jsx("tr",{className:"hover:bg-gray-50",children:i==="waste"?e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ks.format(new Date(F.recorded_at),"datetime")}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:F.order_number}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:F.waste_type}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[F.quantity," ",F.unit]}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:["R",parseFloat(F.total_cost||0).toFixed(2)]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:F.recorded_by_name||F.recorded_by_username})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ks.format(new Date(F.start_time),"datetime")}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:F.machine_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:F.category_name}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[F.duration_minutes||F.estimated_duration||0," min"]}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${F.status==="resolved"?"bg-green-100 text-green-800":F.status==="active"?"bg-red-100 text-red-800":F.status==="investigating"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:F.status})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:F.reported_by_name})]})},U))})]})}),j.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-gray-500 text-lg",children:"No data found for the selected filters"})})]})},Jb=()=>{const[o,i]=u.useState("waste"),[h,c]=u.useState(!1),[x,y]=u.useState([]),[S,A]=u.useState([]),[j,f]=u.useState([]),[v,F]=u.useState([]),[U,se]=u.useState([]),[G,W]=u.useState({});u.useEffect(()=>{(async()=>{try{const[Y,Z,le]=await Promise.all([fe.get("/api/machines"),fe.get("/api/orders"),fe.get("/api/downtime-categories")]);f(Y.data||[]),F(Z.data||[]),se(le.data||[])}catch(Y){console.error("Error loading reference data:",Y)}})()},[]);const N=u.useCallback(async(M=G)=>{try{c(!0);const Y=new URLSearchParams;Object.entries(M).forEach(([ke,Be])=>{Be&&Y.append(ke,Be)});const[Z,le]=await Promise.all([fe.get(`/api/waste/reports?${Y.toString()}`),fe.get(`/api/downtime/reports?${Y.toString()}`)]);y(Z.data||[]),A(le.data||[])}catch(Y){console.error("Error loading report data:",Y)}finally{c(!1)}},[G]),g=u.useCallback(M=>{W(M),N(M)},[N]);return u.useEffect(()=>{N()},[]),e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"p-4 bg-indigo-600 rounded-2xl",children:e.jsx(ts,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-800",children:"Waste & Downtime Reports"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Comprehensive analysis and data export"})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>i("waste"),className:`px-8 py-4 rounded-xl font-semibold text-lg transition-all ${o==="waste"?"bg-indigo-600 text-white shadow-lg":"bg-white text-gray-600 hover:bg-gray-100"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ts,{className:"w-6 h-6"}),e.jsx("span",{children:"Waste Reports"})]})}),e.jsx("button",{onClick:()=>i("downtime"),className:`px-8 py-4 rounded-xl font-semibold text-lg transition-all ${o==="downtime"?"bg-indigo-600 text-white shadow-lg":"bg-white text-gray-600 hover:bg-gray-100"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(fh,{className:"w-6 h-6"}),e.jsx("span",{children:"Downtime Reports"})]})})]})]}),e.jsx(Wb,{onFiltersChange:g,machines:j,orders:v,categories:U}),h&&e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Tt,{className:"w-8 h-8 text-blue-600 animate-spin mr-4"}),e.jsx("span",{className:"text-xl text-gray-600",children:"Loading report data..."})]}),!h&&e.jsxs(e.Fragment,{children:[e.jsx(Zb,{wasteData:x,downtimeData:S}),e.jsx(Kb,{data:o==="waste"?x:S,type:o})]})]})},Oh=({title:o,icon:i,children:h,className:c=""})=>e.jsxs("div",{className:`bg-white rounded-2xl shadow-lg p-8 ${c}`,children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"p-3 bg-blue-600 rounded-xl",children:e.jsx(i,{className:"w-6 h-6 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:o})]}),h]}),ns=({label:o,type:i="text",value:h,onChange:c,placeholder:x,required:y=!1,options:S=[],className:A=""})=>i==="select"?e.jsxs("div",{className:`space-y-2 ${A}`,children:[e.jsxs("label",{className:"block text-lg font-semibold text-gray-700",children:[o," ",y&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:h,onChange:j=>c(j.target.value),className:"w-full p-4 text-lg border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all",required:y,children:[e.jsx("option",{value:"",children:x||`Select ${o}`}),S.map((j,f)=>e.jsx("option",{value:j.value||j,children:j.label||j},f))]})]}):i==="textarea"?e.jsxs("div",{className:`space-y-2 ${A}`,children:[e.jsxs("label",{className:"block text-lg font-semibold text-gray-700",children:[o," ",y&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:h,onChange:j=>c(j.target.value),placeholder:x,rows:4,className:"w-full p-4 text-lg border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all resize-none",required:y})]}):e.jsxs("div",{className:`space-y-2 ${A}`,children:[e.jsxs("label",{className:"block text-lg font-semibold text-gray-700",children:[o," ",y&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:i,value:h,onChange:j=>c(j.target.value),placeholder:x,className:"w-full p-4 text-lg border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all",required:y})]}),gi=({onClick:o,icon:i,label:h,color:c="blue",disabled:x=!1,size:y="large"})=>{const S={blue:"bg-blue-600 hover:bg-blue-700 active:bg-blue-800",green:"bg-green-600 hover:bg-green-700 active:bg-green-800",red:"bg-red-600 hover:bg-red-700 active:bg-red-800",orange:"bg-orange-600 hover:bg-orange-700 active:bg-orange-800",gray:"bg-gray-600 hover:bg-gray-700 active:bg-gray-800"},A={large:"px-8 py-4 text-lg min-h-[70px]",medium:"px-6 py-3 text-base min-h-[60px]",small:"px-4 py-2 text-sm min-h-[50px]"};return e.jsxs("button",{onClick:o,disabled:x,className:`${A[y]} ${S[c]} text-white rounded-xl font-semibold flex items-center justify-center space-x-3 shadow-lg transform transition-all duration-200 hover:scale-105 active:scale-95 ${x?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(i,{className:"w-6 h-6"}),e.jsx("span",{children:h})]})},ey=({onSave:o,onCancel:i,orders:h=[],machines:c=[],users:x=[],categories:y=[],laborData:S=[]})=>{const[A,j]=u.useState({order_number:"",machine_id:"",downtime_category_id:"",primary_cause:"",description:"",reported_by:"",assigned_to:"",start_time:new Date().toISOString().slice(0,16),estimated_duration:"",severity:"medium",notes:""}),f=u.useCallback(async()=>{try{await o(A),j({order_number:"",machine_id:"",downtime_category_id:"",primary_cause:"",description:"",reported_by:"",assigned_to:"",start_time:new Date().toISOString().slice(0,16),estimated_duration:"",severity:"medium",notes:""})}catch(v){console.error("Error saving downtime:",v)}},[A,o]);return e.jsxs(Oh,{title:"Record Downtime Event",icon:gt,children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(ns,{label:"Order Number",value:A.order_number,onChange:v=>j({...A,order_number:v}),placeholder:"Enter order number (e.g. ORD-2024-001)",required:!0}),e.jsx(ns,{label:"Machine Name",type:"select",value:A.machine_id,onChange:v=>j({...A,machine_id:v}),placeholder:"Select Machine",required:!0,options:c.map(v=>({value:v.id,label:v.name}))}),e.jsx(ns,{label:"Downtime Reason",type:"select",value:A.downtime_category_id,onChange:v=>j({...A,downtime_category_id:v}),placeholder:"Select Downtime Category",required:!0,options:y.map(v=>({value:v.id,label:v.category_name}))}),e.jsx(ns,{label:"Start Time",type:"datetime-local",value:A.start_time,onChange:v=>j({...A,start_time:v}),required:!0}),e.jsx(ns,{label:"Supervisor on Duty",type:"select",value:A.reported_by,onChange:v=>j({...A,reported_by:v}),placeholder:"Select Supervisor",required:!0,options:S.filter(v=>v.role==="supervisor"||v.position==="Supervisor").map(v=>({value:v.user_id||v.id,label:v.full_name||v.name||v.employee_name}))}),e.jsx(ns,{label:"Operator on Duty",type:"select",value:A.assigned_to,onChange:v=>j({...A,assigned_to:v}),placeholder:"Select Operator",options:S.filter(v=>v.role==="operator"||v.position==="Operator").map(v=>({value:v.user_id||v.id,label:v.full_name||v.name||v.employee_name}))}),e.jsx(ns,{label:"Primary Cause",value:A.primary_cause,onChange:v=>j({...A,primary_cause:v}),placeholder:"Brief description of the cause",required:!0}),e.jsx(ns,{label:"Estimated Duration (minutes)",type:"number",value:A.estimated_duration,onChange:v=>j({...A,estimated_duration:v}),placeholder:"Expected downtime in minutes"})]}),e.jsx("div",{className:"mt-6",children:e.jsx(ns,{label:"Detailed Description",type:"textarea",value:A.notes,onChange:v=>j({...A,notes:v}),placeholder:"Detailed description of the downtime event, actions taken, etc."})}),e.jsxs("div",{className:"flex space-x-4 mt-8",children:[e.jsx(gi,{onClick:f,icon:na,label:"Save Downtime",color:"green",size:"large"}),e.jsx(gi,{onClick:i,icon:rs,label:"Cancel",color:"gray",size:"large"})]})]})},ty=({onSave:o,onCancel:i,orders:h=[],users:c=[],laborData:x=[]})=>{const[y,S]=u.useState({order_number:"",waste_type:"",quantity:"",unit:"kg",reason:"",recorded_by:"",cost_per_unit:"",total_cost:""}),A=["Material Spillage","Defective Products","Packaging Waste","Raw Material Spoilage","Processing Loss","Quality Rejection","Overproduction","Setup Waste","Other"],j=["kg","g","tons","liters","ml","pieces","boxes","bags"],f=u.useCallback(async()=>{try{const v=y.cost_per_unit&&y.quantity?(parseFloat(y.cost_per_unit)*parseFloat(y.quantity)).toFixed(2):y.total_cost;await o({...y,total_cost:v}),S({order_number:"",waste_type:"",quantity:"",unit:"kg",reason:"",recorded_by:"",cost_per_unit:"",total_cost:""})}catch(v){console.error("Error saving waste:",v)}},[y,o]);return e.jsxs(Oh,{title:"Record Waste",icon:Da,children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(ns,{label:"Order Number",value:y.order_number,onChange:v=>S({...y,order_number:v}),placeholder:"Enter order number (e.g. ORD-2024-001)",required:!0}),e.jsx(ns,{label:"Waste Type",type:"select",value:y.waste_type,onChange:v=>S({...y,waste_type:v}),placeholder:"Select Waste Type",required:!0,options:A}),e.jsx(ns,{label:"Quantity",type:"number",step:"0.001",value:y.quantity,onChange:v=>S({...y,quantity:v}),placeholder:"Enter quantity",required:!0}),e.jsx(ns,{label:"Unit",type:"select",value:y.unit,onChange:v=>S({...y,unit:v}),options:j,required:!0}),e.jsx(ns,{label:"Recorded By",type:"select",value:y.recorded_by,onChange:v=>S({...y,recorded_by:v}),placeholder:"Select Supervisor/Operator",required:!0,options:x.map(v=>({value:v.user_id||v.id,label:v.full_name||v.name||v.employee_name}))}),e.jsx(ns,{label:"Cost per Unit (Optional)",type:"number",step:"0.01",value:y.cost_per_unit,onChange:v=>S({...y,cost_per_unit:v}),placeholder:"Cost per unit in currency"})]}),e.jsx("div",{className:"mt-6",children:e.jsx(ns,{label:"Reason/Description",type:"textarea",value:y.reason,onChange:v=>S({...y,reason:v}),placeholder:"Describe the reason for waste and any relevant details",required:!0})}),y.cost_per_unit&&y.quantity&&e.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-xl",children:e.jsxs("div",{className:"text-lg font-semibold text-blue-800",children:["Calculated Total Cost: R",(parseFloat(y.cost_per_unit)*parseFloat(y.quantity)).toFixed(2)]})}),e.jsxs("div",{className:"flex space-x-4 mt-8",children:[e.jsx(gi,{onClick:f,icon:na,label:"Save Waste Record",color:"green",size:"large"}),e.jsx(gi,{onClick:i,icon:rs,label:"Cancel",color:"gray",size:"large"})]})]})},sy=()=>{const[o,i]=u.useState("downtime"),[h,c]=u.useState(!0),[x,y]=u.useState([]),[S,A]=u.useState([]),[j,f]=u.useState([]),[v,F]=u.useState([]),[U,se]=u.useState([]),G=u.useCallback(async()=>{try{c(!0);const[g,M,Y,Z,le]=await Promise.all([fe.get("/api/orders"),fe.get("/api/machines"),fe.get("/api/users"),fe.get("/api/downtime-categories"),fe.get("/api/labor/assignments")]);y(g.data||[]),A(M.data||[]),f(Y.data||[]),F(Z.data||[]),se(le.data||[])}catch(g){console.error("Error loading data:",g)}finally{c(!1)}},[]);u.useEffect(()=>{G()},[]);const W=u.useCallback(async g=>{try{await fe.post("/api/downtime",g),console.log("Downtime saved successfully")}catch(M){throw console.error("Error saving downtime:",M),M}},[]),N=u.useCallback(async g=>{try{await fe.post("/api/waste",g),console.log("Waste saved successfully")}catch(M){throw console.error("Error saving waste:",M),M}},[]);return h?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Tt,{className:"w-16 h-16 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-700",children:"Loading Management System..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"p-4 bg-red-600 rounded-2xl",children:e.jsx(gt,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-800",children:"Waste & Downtime Management"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Supervisor Dashboard - Record and Track Production Issues"})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>i("downtime"),className:`px-8 py-4 rounded-xl font-semibold text-lg transition-all ${o==="downtime"?"bg-red-600 text-white shadow-lg":"bg-white text-gray-600 hover:bg-gray-100"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Zt,{className:"w-6 h-6"}),e.jsx("span",{children:"Downtime Recording"})]})}),e.jsx("button",{onClick:()=>i("waste"),className:`px-8 py-4 rounded-xl font-semibold text-lg transition-all ${o==="waste"?"bg-red-600 text-white shadow-lg":"bg-white text-gray-600 hover:bg-gray-100"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Da,{className:"w-6 h-6"}),e.jsx("span",{children:"Waste Recording"})]})}),e.jsx("button",{onClick:()=>i("reports"),className:`px-8 py-4 rounded-xl font-semibold text-lg transition-all ${o==="reports"?"bg-red-600 text-white shadow-lg":"bg-white text-gray-600 hover:bg-gray-100"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ts,{className:"w-6 h-6"}),e.jsx("span",{children:"Reports & Analytics"})]})})]})]}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[o==="downtime"&&e.jsx(ey,{onSave:W,onCancel:()=>{},orders:x,machines:S,users:j,categories:v,laborData:U}),o==="waste"&&e.jsx(ty,{onSave:N,onCancel:()=>{},orders:x,users:j,laborData:U}),o==="reports"&&e.jsx(Jb,{})]})]})},ay=()=>(sl(),e.jsx(sy,{})),Eh=[{path:"/",component:_h,title:"Dashboard"},{path:"/production",component:_b,title:"Production Monitor"},{path:"/labour-layout",component:Ub,title:"Labour Layout"},{path:"/labor-planner",component:Hb,name:"Labor Planner"},{path:"/orders",component:Ob,title:"Production Orders"},{path:"/machines",component:Eb,title:"Machine Management"},{path:"/digital-twin",component:Xb,title:"4D Digital Twin Factory"},{path:"/analytics",component:kb,title:"Analytics & Reports"},{path:"/shift-reports",component:Tb,title:"Shift Reports"},{path:"/settings",component:Rb,title:"Settings"},{path:"/admin",component:zb,title:"Admin Panel & User Management"},{path:"/attendance-register",component:Vb,title:"Attendance Register"},{path:"/maturation-room",component:Ib,title:"Maturation Room"},{path:"/supervisor-ipad",component:ay,title:"Supervisor iPad View"}];Eh.forEach(o=>Qc.addRoute(o));Qc.init();function ly(){const{isAuthenticated:o,loading:i,user:h}=ca(),[c,x]=u.useState(window.location.pathname),{handleSessionExpiring:y,handleSessionExpired:S}=eb();if(u.useRef(!1),sl(),u.useEffect(()=>{const v=U=>x(U.path),F=window.EventBus.on("router:navigation",v);return()=>{F()}},[]),i)return e.jsx("div",{className:"h-screen flex items-center justify-center text-xl bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading Production Management System..."})]})});if(!o)return e.jsx(Yc,{children:e.jsx(Zp,{})});const A=Eh.find(v=>v.path===c),j=A?A.component:_h,f=A?A.name||A.title:"Dashboard";return c==="/supervisor-ipad"?e.jsxs(Yc,{children:[e.jsx(j,{}),e.jsx(lh,{}),o&&e.jsx(nh,{onSessionExpiring:y,onSessionExpired:S}),e.jsx(rh,{}),e.jsx(ih,{})]}):e.jsx(Yc,{children:e.jsxs(Wp,{title:f,children:[e.jsx(j,{}),e.jsx(lh,{}),o&&e.jsx(nh,{onSessionExpiring:y,onSessionExpired:S}),e.jsx(rh,{}),e.jsx(ih,{})]})})}const ny=document.getElementById("root"),ry=Xf.createRoot(ny);ry.render(e.jsx(ka.StrictMode,{children:e.jsx(mh,{children:e.jsx(ly,{})})}));
